{"ast":null,"code":"var _jsxFileName = \"F:\\\\landinghub-iconic\\\\apps\\\\web\\\\src\\\\components\\\\create-page\\\\Canvas.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$(),\n  _s3 = $RefreshSig$(),\n  _s4 = $RefreshSig$();\nimport React, { useRef, useCallback, useState, useEffect, useMemo } from 'react';\nimport { useDrop } from 'react-dnd';\nimport { useHotkeys } from 'react-hotkeys-hook';\nimport { toast } from 'react-toastify';\nimport PropTypes from 'prop-types';\nimport Guidelines from './Guidelines';\nimport SelectionOverlay from './SelectionOverlay';\nimport { Element } from './Element';\nimport { ItemTypes, getCanvasPosition, snapToGrid, getElementBounds, renderComponentContent } from './helpers';\nimport AddSectionButton from './AddSectionButton';\nimport eventController from '../../utils/EventController';\n\n// Custom hook để quản lý drag-and-drop\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst useCanvasDrop = ({\n  pageData,\n  viewMode,\n  zoomLevel,\n  gridSize,\n  showGrid,\n  onAddElement,\n  onMoveChild,\n  updateCanvasHeight,\n  canvasRef,\n  canvasBounds,\n  setDragPreview,\n  setGuidelines\n}) => {\n  _s();\n  const [{\n    isOver,\n    dragItem\n  }, drop] = useDrop({\n    accept: [ItemTypes.ELEMENT, ItemTypes.CHILD_ELEMENT],\n    hover: (item, monitor) => {\n      const clientOffset = monitor.getClientOffset();\n      if (!clientOffset || !canvasRef.current) {\n        setDragPreview(null);\n        return;\n      }\n      const pos = getCanvasPosition(clientOffset.x, clientOffset.y, canvasRef.current, zoomLevel);\n      const snapPoints = getSnapPoints(pageData.elements, canvasBounds, viewMode);\n      const snapped = snapToGrid(pos.x, pos.y, showGrid ? gridSize : Infinity, snapPoints);\n      if (monitor.getItemType() === ItemTypes.ELEMENT && item.json) {\n        setDragPreview({\n          id: 'preview',\n          x: snapped.x,\n          y: snapped.y,\n          size: item.json.size || {\n            width: viewMode === 'mobile' ? 375 : 1200,\n            height: 400\n          },\n          type: item.json.type,\n          componentData: item.json.componentData || {\n            structure: 'ladi-standard'\n          },\n          styles: item.json.styles || {},\n          children: item.json.children || []\n        });\n      } else if (monitor.getItemType() === ItemTypes.CHILD_ELEMENT) {\n        const sourceElement = pageData.elements.find(el => el.id === item.parentId);\n        const child = sourceElement === null || sourceElement === void 0 ? void 0 : sourceElement.children.find(c => c.id === item.childId);\n        if (child) {\n          setDragPreview({\n            id: item.childId,\n            x: snapped.x,\n            y: snapped.y,\n            size: item.size || {\n              width: 200,\n              height: 50\n            },\n            type: child.type,\n            componentData: child.componentData || {},\n            styles: child.styles || {},\n            children: []\n          });\n        }\n      }\n      const newGuidelines = calculateGuidelines(pageData.elements, snapped, viewMode, canvasBounds);\n      setGuidelines(newGuidelines);\n    },\n    drop: (item, monitor) => {\n      const clientOffset = monitor.getClientOffset();\n      if (!clientOffset || !canvasRef.current) {\n        toast.error('Không thể xác định vị trí thả!');\n        setDragPreview(null);\n        setGuidelines([]);\n        return {\n          moved: false\n        };\n      }\n      const pos = getCanvasPosition(clientOffset.x, clientOffset.y, canvasRef.current, zoomLevel);\n      const snapPoints = getSnapPoints(pageData.elements, canvasBounds, viewMode);\n      const snapped = snapToGrid(pos.x, pos.y, showGrid ? gridSize : Infinity, snapPoints);\n      if (monitor.getItemType() === ItemTypes.CHILD_ELEMENT) {\n        const sourceSection = pageData.elements.find(el => el.id === item.parentId);\n        if (!sourceSection) {\n          toast.error('Không tìm thấy section nguồn!');\n          setDragPreview(null);\n          setGuidelines([]);\n          return {\n            moved: false\n          };\n        }\n        onMoveChild(item.parentId, item.childId, null, snapped);\n        toast.success('Đã di chuyển thành phần con ra canvas!');\n        setDragPreview(null);\n        setGuidelines([]);\n        return {\n          moved: true,\n          newPosition: snapped\n        };\n      } else if (monitor.getItemType() === ItemTypes.ELEMENT) {\n        if (item.json.type !== 'section' && item.json.type !== 'popup' && item.json.type !== 'modal') {\n          toast.error('Chỉ có thể thả section, popup hoặc modal lên canvas!');\n          setDragPreview(null);\n          setGuidelines([]);\n          return {\n            moved: false\n          };\n        }\n        const lastSectionY = pageData.elements.filter(el => el.type === 'section').reduce((maxY, el) => {\n          var _el$position, _el$position$viewMode, _el$size;\n          return Math.max(maxY, (((_el$position = el.position) === null || _el$position === void 0 ? void 0 : (_el$position$viewMode = _el$position[viewMode]) === null || _el$position$viewMode === void 0 ? void 0 : _el$position$viewMode.y) || 0) + (((_el$size = el.size) === null || _el$size === void 0 ? void 0 : _el$size.height) || 400));\n        }, 0);\n        const newElement = {\n          id: `${item.json.type}-${Date.now()}`,\n          type: item.json.type,\n          componentData: JSON.parse(JSON.stringify(item.json.componentData || {\n            structure: item.json.type === 'section' ? 'ladi-standard' : undefined\n          })),\n          position: {\n            [viewMode]: {\n              x: item.json.type === 'section' ? 0 : snapped.x,\n              y: item.json.type === 'section' ? lastSectionY + 10 : snapped.y\n            },\n            desktop: {\n              x: item.json.type === 'section' ? 0 : snapped.x,\n              y: item.json.type === 'section' ? lastSectionY + 10 : snapped.y\n            },\n            tablet: {\n              x: item.json.type === 'section' ? 0 : snapped.x,\n              y: item.json.type === 'section' ? lastSectionY + 10 : snapped.y\n            },\n            mobile: {\n              x: item.json.type === 'section' ? 0 : snapped.x,\n              y: item.json.type === 'section' ? lastSectionY + 10 : snapped.y\n            }\n          },\n          size: {\n            ...item.json.size,\n            width: viewMode === 'mobile' ? 375 : item.json.type === 'section' ? 1200 : 600\n          },\n          styles: JSON.parse(JSON.stringify(item.json.styles || {})),\n          children: JSON.parse(JSON.stringify(item.json.children || [])),\n          visible: true,\n          locked: false,\n          meta: {\n            updated_at: new Date().toISOString()\n          }\n        };\n        onAddElement(newElement);\n        if (item.json.type === 'section') {\n          updateCanvasHeight();\n        }\n        toast.success(`Đã thêm ${item.json.type} mới!`);\n        setDragPreview(null);\n        setGuidelines([]);\n        return {\n          moved: true,\n          newPosition: {\n            x: item.json.type === 'section' ? 0 : snapped.x,\n            y: item.json.type === 'section' ? lastSectionY + 10 : snapped.y\n          }\n        };\n      }\n      setDragPreview(null);\n      setGuidelines([]);\n      return {\n        moved: false\n      };\n    },\n    collect: monitor => ({\n      isOver: monitor.isOver(),\n      dragItem: monitor.getItem()\n    })\n  }, [pageData.elements, viewMode, zoomLevel, gridSize, showGrid, canvasBounds, onAddElement, onMoveChild, updateCanvasHeight, canvasRef]);\n  return {\n    isOver,\n    dragItem,\n    drop\n  };\n};\n\n// Custom hook để quản lý guidelines\n_s(useCanvasDrop, \"x11ABS5oa+Txa7zAYeWrrleHuRQ=\", false, function () {\n  return [useDrop];\n});\nconst useGuidelines = (pageData, viewMode, canvasBounds) => {\n  _s2();\n  const [guidelines, setGuidelines] = useState([]);\n  return {\n    guidelines,\n    setGuidelines\n  };\n};\n\n// Custom hook để quản lý popups\n_s2(useGuidelines, \"7KlrYhT6fl/V+KO6x61fAAmTwhw=\");\nconst usePopupManager = (pageData, selectedIds, onSelectElement, handleSelectElement) => {\n  _s3();\n  const [visiblePopups, setVisiblePopups] = useState([]);\n  useEffect(() => {\n    const unsubscribeOpen = eventController.subscribe(\"popup-open\", payload => {\n      const popupElement = pageData.elements.find(el => el.id === payload.popupId);\n      if (!popupElement) {\n        toast.error(`Popup \"${payload.popupId}\" not found!`);\n        return;\n      }\n      setVisiblePopups(prev => [...new Set([...prev, payload.popupId])]);\n      onSelectElement([payload.popupId]);\n    });\n    const unsubscribeClose = eventController.subscribe(\"popup-close\", payload => {\n      setVisiblePopups(prev => prev.filter(popupId => popupId !== payload.popupId));\n      if (selectedIds.includes(payload.popupId)) {\n        handleSelectElement([]);\n      }\n    });\n    return () => {\n      unsubscribeOpen();\n      unsubscribeClose();\n    };\n  }, [pageData.elements, onSelectElement, selectedIds, handleSelectElement]);\n  return {\n    visiblePopups,\n    setVisiblePopups\n  };\n};\n\n// Hàm tính toán snap points\n_s3(usePopupManager, \"E62hIMvDYUBbPwwcJR0OtI7WkZ0=\");\nconst getSnapPoints = (elements, canvasBounds, viewMode) => {\n  const points = [{\n    x: 0,\n    y: 0\n  }, {\n    x: viewMode === 'mobile' ? 375 : 1200,\n    y: canvasBounds.height\n  }, {\n    x: (viewMode === 'mobile' ? 375 : 1200) / 2,\n    y: canvasBounds.height / 2\n  }];\n  elements.forEach(el => {\n    var _el$children;\n    const bounds = getElementBounds(el);\n    points.push({\n      x: bounds.left,\n      y: bounds.top\n    }, {\n      x: bounds.right,\n      y: bounds.bottom\n    }, {\n      x: bounds.centerX,\n      y: bounds.centerY\n    }, {\n      x: bounds.left,\n      y: bounds.centerY\n    }, {\n      x: bounds.right,\n      y: bounds.centerY\n    }, {\n      x: bounds.centerX,\n      y: bounds.top\n    }, {\n      x: bounds.centerX,\n      y: bounds.bottom\n    });\n    (_el$children = el.children) === null || _el$children === void 0 ? void 0 : _el$children.forEach(child => {\n      const childBounds = getElementBounds(child);\n      points.push({\n        x: childBounds.left,\n        y: childBounds.top\n      }, {\n        x: childBounds.right,\n        y: childBounds.bottom\n      }, {\n        x: childBounds.centerX,\n        y: childBounds.centerY\n      }, {\n        x: childBounds.left,\n        y: childBounds.centerY\n      }, {\n        x: childBounds.right,\n        y: childBounds.centerY\n      }, {\n        x: childBounds.centerX,\n        y: childBounds.top\n      }, {\n        x: childBounds.centerX,\n        y: childBounds.bottom\n      });\n    });\n  });\n  return points;\n};\n\n// Hàm tính toán guidelines\nconst calculateGuidelines = (elements, snapped, viewMode, canvasBounds) => {\n  const newGuidelines = [];\n  elements.forEach(el => {\n    var _el$children2;\n    const bounds = getElementBounds(el);\n    if (Math.abs(snapped.x - bounds.left) < 15) newGuidelines.push({\n      vertical: true,\n      position: bounds.left\n    });\n    if (Math.abs(snapped.x - bounds.right) < 15) newGuidelines.push({\n      vertical: true,\n      position: bounds.right\n    });\n    if (Math.abs(snapped.x - bounds.centerX) < 15) newGuidelines.push({\n      vertical: true,\n      position: bounds.centerX\n    });\n    if (Math.abs(snapped.y - bounds.top) < 15) newGuidelines.push({\n      vertical: false,\n      position: bounds.top\n    });\n    if (Math.abs(snapped.y - bounds.bottom) < 15) newGuidelines.push({\n      vertical: false,\n      position: bounds.bottom\n    });\n    if (Math.abs(snapped.y - bounds.centerY) < 15) newGuidelines.push({\n      vertical: false,\n      position: bounds.centerY\n    });\n    (_el$children2 = el.children) === null || _el$children2 === void 0 ? void 0 : _el$children2.forEach(child => {\n      const childBounds = getElementBounds(child);\n      if (Math.abs(snapped.x - childBounds.left) < 15) newGuidelines.push({\n        vertical: true,\n        position: childBounds.left\n      });\n      if (Math.abs(snapped.x - childBounds.right) < 15) newGuidelines.push({\n        vertical: true,\n        position: childBounds.right\n      });\n      if (Math.abs(snapped.x - childBounds.centerX) < 15) newGuidelines.push({\n        vertical: true,\n        position: childBounds.centerX\n      });\n      if (Math.abs(snapped.y - childBounds.top) < 15) newGuidelines.push({\n        vertical: false,\n        position: childBounds.top\n      });\n      if (Math.abs(snapped.y - childBounds.bottom) < 15) newGuidelines.push({\n        vertical: false,\n        position: childBounds.bottom\n      });\n      if (Math.abs(snapped.y - childBounds.centerY) < 15) newGuidelines.push({\n        vertical: false,\n        position: childBounds.centerY\n      });\n    });\n  });\n  if (Math.abs(snapped.x) < 15) newGuidelines.push({\n    vertical: true,\n    position: 0\n  });\n  if (Math.abs(snapped.x - (viewMode === 'mobile' ? 375 : 1200)) < 15) newGuidelines.push({\n    vertical: true,\n    position: viewMode === 'mobile' ? 375 : 1200\n  });\n  if (Math.abs(snapped.x - (viewMode === 'mobile' ? 375 : 1200) / 2) < 15) newGuidelines.push({\n    vertical: true,\n    position: (viewMode === 'mobile' ? 375 : 1200) / 2\n  });\n  if (Math.abs(snapped.y) < 15) newGuidelines.push({\n    vertical: false,\n    position: 0\n  });\n  if (Math.abs(snapped.y - canvasBounds.height) < 15) newGuidelines.push({\n    vertical: false,\n    position: canvasBounds.height\n  });\n  if (Math.abs(snapped.y - canvasBounds.height / 2) < 15) newGuidelines.push({\n    vertical: false,\n    position: canvasBounds.height / 2\n  });\n  return newGuidelines;\n};\nconst Canvas = /*#__PURE__*/_s4(/*#__PURE__*/React.memo(_c = _s4(({\n  pageData,\n  selectedIds,\n  onSelectElement,\n  onUpdatePosition,\n  onUpdateSize,\n  onDeleteElement,\n  onAddElement,\n  onGroupElements,\n  viewMode,\n  zoomLevel,\n  gridSize,\n  showGrid,\n  onEditElement,\n  onDuplicateElement,\n  onMoveElementUp,\n  onMoveElementDown,\n  onSelectChild,\n  selectedChildId,\n  onAddChild,\n  onUpdateChildPosition,\n  onMoveChild,\n  guideLine,\n  onShowAddSectionPopup,\n  onSaveTemplate,\n  onToggleVisibility,\n  onDeleteChild\n}) => {\n  _s4();\n  const canvasRef = useRef(null);\n  const [contextMenu, setContextMenu] = useState(null);\n  const [dragPreview, setDragPreview] = useState(null);\n  const [showPopup, setShowPopup] = useState(false);\n  const [guideLinePosition, setGuideLinePosition] = useState((guideLine === null || guideLine === void 0 ? void 0 : guideLine.y) || 0);\n\n  // Tính canvasBounds trước khi gọi các hooks\n  const canvasBounds = useMemo(() => ({\n    width: canvasRef.current ? canvasRef.current.offsetWidth / (zoomLevel / 100) : viewMode === 'mobile' ? 375 : 1200,\n    height: canvasRef.current ? canvasRef.current.offsetHeight / (zoomLevel / 100) : 1000\n  }), [viewMode, zoomLevel]);\n  const {\n    guidelines,\n    setGuidelines\n  } = useGuidelines(pageData, viewMode, canvasBounds);\n  const {\n    visiblePopups,\n    setVisiblePopups\n  } = usePopupManager(pageData, selectedIds, onSelectElement, handleSelectElement);\n  const {\n    isOver,\n    dragItem,\n    drop\n  } = useCanvasDrop({\n    pageData,\n    viewMode,\n    zoomLevel,\n    gridSize,\n    showGrid,\n    onAddElement,\n    onMoveChild,\n    updateCanvasHeight,\n    canvasRef,\n    canvasBounds,\n    setDragPreview,\n    setGuidelines\n  });\n  const handleSelectElement = useCallback((ids, ctrlKey) => {\n    if (typeof onSelectElement !== 'function') {\n      console.error('onSelectElement is not a function');\n      return;\n    }\n    onSelectElement(ids, ctrlKey);\n    const selectedElements = pageData.elements.filter(el => ids.includes(el.id));\n    const popupIds = selectedElements.filter(el => el.type === 'popup' || el.type === 'modal').map(el => el.id);\n    setVisiblePopups(popupIds);\n  }, [onSelectElement, pageData.elements, setVisiblePopups]);\n  const updateCanvasHeight = useCallback(() => {\n    const lastSection = pageData.elements.filter(el => el.type === 'section').reduce((maxY, el) => {\n      var _el$position2, _el$position2$viewMod, _el$size2;\n      return Math.max(maxY, (((_el$position2 = el.position) === null || _el$position2 === void 0 ? void 0 : (_el$position2$viewMod = _el$position2[viewMode]) === null || _el$position2$viewMod === void 0 ? void 0 : _el$position2$viewMod.y) || 0) + (((_el$size2 = el.size) === null || _el$size2 === void 0 ? void 0 : _el$size2.height) || 400));\n    }, 0);\n    const newHeight = lastSection + 50;\n    setGuideLinePosition(lastSection + 10);\n    return newHeight;\n  }, [pageData.elements, viewMode]);\n  useEffect(() => {\n    updateCanvasHeight();\n  }, [updateCanvasHeight]);\n  const handleContextMenu = useCallback((id, position) => {\n    setContextMenu({\n      id,\n      position\n    });\n  }, []);\n  const handleCanvasClick = useCallback(e => {\n    e.stopPropagation();\n    if (e.target === canvasRef.current) {\n      handleSelectElement([]);\n      onSelectChild(null, null);\n      setContextMenu(null);\n      setDragPreview(null);\n      setVisiblePopups([]);\n    }\n  }, [handleSelectElement, onSelectChild]);\n  const handleKeyDown = useCallback(e => {\n    if (!selectedIds.length) return;\n    e.preventDefault();\n    e.stopPropagation();\n    const step = e.shiftKey ? 10 : 1;\n    selectedIds.forEach(id => {\n      var _element$position$vie5, _element$position$vie6;\n      const element = pageData.elements.find(el => el.id === id);\n      if (element && element.type !== 'section' && element.type !== 'popup' && element.type !== 'modal') {\n        var _element$position$vie, _element$position$vie2, _element$position$vie3, _element$position$vie4;\n        const newY = e.key === 'ArrowUp' ? Math.max(0, (((_element$position$vie = element.position[viewMode]) === null || _element$position$vie === void 0 ? void 0 : _element$position$vie.y) || 0) - step) : (((_element$position$vie2 = element.position[viewMode]) === null || _element$position$vie2 === void 0 ? void 0 : _element$position$vie2.y) || 0) + step;\n        const newX = e.key === 'ArrowLeft' ? Math.max(0, (((_element$position$vie3 = element.position[viewMode]) === null || _element$position$vie3 === void 0 ? void 0 : _element$position$vie3.x) || 0) - step) : (((_element$position$vie4 = element.position[viewMode]) === null || _element$position$vie4 === void 0 ? void 0 : _element$position$vie4.x) || 0) + step;\n        switch (e.key) {\n          case 'ArrowUp':\n          case 'ArrowDown':\n            onUpdatePosition(id, {\n              [viewMode]: {\n                x: ((_element$position$vie5 = element.position[viewMode]) === null || _element$position$vie5 === void 0 ? void 0 : _element$position$vie5.x) || 0,\n                y: newY\n              }\n            }, 'absolute');\n            break;\n          case 'ArrowLeft':\n          case 'ArrowRight':\n            onUpdatePosition(id, {\n              [viewMode]: {\n                x: newX,\n                y: ((_element$position$vie6 = element.position[viewMode]) === null || _element$position$vie6 === void 0 ? void 0 : _element$position$vie6.y) || 0\n              }\n            }, 'absolute');\n            break;\n          case 'Delete':\n          case 'Backspace':\n            onDeleteElement(id);\n            setVisiblePopups(prev => prev.filter(popupId => popupId !== id));\n            break;\n          case 'Escape':\n            handleSelectElement([]);\n            onSelectChild(null, null);\n            setContextMenu(null);\n            setDragPreview(null);\n            setVisiblePopups([]);\n            break;\n          default:\n            break;\n        }\n      }\n    });\n  }, [selectedIds, onUpdatePosition, onDeleteElement, handleSelectElement, onSelectChild, viewMode, pageData.elements]);\n  useHotkeys('ctrl+a', e => {\n    e.preventDefault();\n    handleSelectElement(pageData.elements.map(el => el.id));\n  }, [pageData.elements, handleSelectElement]);\n  useHotkeys('ctrl+g', e => {\n    e.preventDefault();\n    if (selectedIds.length > 1) {\n      onGroupElements(selectedIds);\n    }\n  }, [selectedIds, onGroupElements]);\n  useEffect(() => {\n    const handleClickOutside = () => {\n      setContextMenu(null);\n      setDragPreview(null);\n      setVisiblePopups([]);\n    };\n    if (contextMenu || visiblePopups.length > 0) {\n      document.addEventListener('click', handleClickOutside);\n      return () => document.removeEventListener('click', handleClickOutside);\n    }\n  }, [contextMenu, visiblePopups]);\n  const handleClosePopup = useCallback(id => {\n    setVisiblePopups(prev => prev.filter(popupId => popupId !== id));\n    handleSelectElement([]);\n  }, [handleSelectElement]);\n  const renderDragPreview = () => {\n    if (!dragPreview) return null;\n    const {\n      x,\n      y,\n      size,\n      type,\n      componentData,\n      styles,\n      children\n    } = dragPreview;\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"absolute border-2 border-dashed border-blue-500 bg-blue-100/50 pointer-events-none z-[1000] opacity-50\",\n      style: {\n        transform: `translate(${x}px, ${y}px)`,\n        width: size.width,\n        height: size.height,\n        ...styles\n      },\n      children: renderComponentContent(type, componentData || {}, styles || {}, children || [])\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 402,\n      columnNumber: 13\n    }, this);\n  };\n  const renderAddSectionButton = () => {\n    if (pageData.elements.length > 0) return null;\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"absolute left-1/2 top-1/2 transform -translate-x-1/2 -translate-y-1/2 z-[1000]\",\n      children: /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: e => {\n          e.stopPropagation();\n          setShowPopup(true);\n          if (typeof onShowAddSectionPopup === 'function') {\n            onShowAddSectionPopup();\n          }\n        },\n        className: \"px-6 py-3 bg-blue-600 text-white rounded-lg font-semibold cursor-pointer hover:bg-blue-700\",\n        children: \"Th\\xEAm Section\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 412,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 411,\n      columnNumber: 13\n    }, this);\n  };\n  const renderContextMenu = () => {\n    if (!contextMenu) return null;\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"fixed bg-white border border-gray-300 rounded shadow-lg min-w-[120px] z-[10000]\",\n      style: {\n        left: contextMenu.position.x,\n        top: contextMenu.position.y\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"px-3 py-2 cursor-pointer hover:bg-gray-100\",\n        onClick: () => {\n          onDeleteElement(contextMenu.id);\n          setContextMenu(null);\n          setVisiblePopups(prev => prev.filter(id => id !== contextMenu.id));\n        },\n        children: \"X\\xF3a\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 432,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"px-3 py-2 cursor-pointer hover:bg-gray-100\",\n        onClick: () => {\n          onGroupElements([contextMenu.id]);\n          setContextMenu(null);\n        },\n        children: \"Nh\\xF3m\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 435,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"px-3 py-2 cursor-pointer hover:bg-gray-100\",\n        onClick: () => {\n          onToggleVisibility(contextMenu.id);\n          setContextMenu(null);\n        },\n        children: \"\\u1EA8n/Hi\\u1EC7n\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 438,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 431,\n      columnNumber: 13\n    }, this);\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"relative w-full h-screen overflow-y-auto focus:outline-none\",\n    onKeyDown: handleKeyDown,\n    tabIndex: 0,\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      ref: node => {\n        canvasRef.current = node;\n        drop(node);\n      },\n      className: `relative mx-auto ${viewMode === 'mobile' ? 'w-[375px]' : viewMode === 'tablet' ? 'w-[768px]' : 'w-[1200px]'}`,\n      onClick: handleCanvasClick,\n      style: {\n        height: pageData.canvas.height ? `${pageData.canvas.height}px` : 'auto',\n        background: pageData.canvas.background,\n        transform: `scale(${zoomLevel / 100})`,\n        transformOrigin: 'top center'\n      },\n      children: [/*#__PURE__*/_jsxDEV(Guidelines, {\n        guidelines: guidelines,\n        zoomLevel: zoomLevel\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 461,\n        columnNumber: 17\n      }, this), pageData.elements.map(element => /*#__PURE__*/_jsxDEV(Element, {\n        element: element,\n        isSelected: selectedIds.includes(element.id),\n        onSelectElement: handleSelectElement,\n        onUpdatePosition: onUpdatePosition,\n        viewMode: viewMode,\n        zoomLevel: zoomLevel,\n        gridSize: gridSize,\n        onContextMenu: handleContextMenu,\n        canvasBounds: canvasBounds,\n        canvasRef: canvasRef,\n        onSelectChild: onSelectChild,\n        selectedChildId: selectedChildId,\n        onAddChild: onAddChild,\n        onUpdateChildPosition: onUpdateChildPosition,\n        onMoveChild: onMoveChild,\n        showGrid: showGrid,\n        setDragPreview: setDragPreview,\n        visiblePopups: visiblePopups,\n        onClosePopup: handleClosePopup,\n        onSaveTemplate: onSaveTemplate,\n        onToggleVisibility: onToggleVisibility,\n        onEditElement: onEditElement,\n        onDuplicateElement: onDuplicateElement,\n        onMoveElementUp: onMoveElementUp,\n        onMoveElementDown: onMoveElementDown,\n        onDeleteElement: onDeleteElement,\n        onDeleteChild: onDeleteChild\n      }, element.id, false, {\n        fileName: _jsxFileName,\n        lineNumber: 463,\n        columnNumber: 21\n      }, this)), renderDragPreview(), (guideLine === null || guideLine === void 0 ? void 0 : guideLine.show) && /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"absolute left-1/2 transform -translate-x-1/2 w-full h-px bg-blue-500 opacity-50 z-[1001]\",\n          style: {\n            top: guideLinePosition\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 497,\n          columnNumber: 25\n        }, this), pageData.elements.length > 0 && /*#__PURE__*/_jsxDEV(AddSectionButton, {\n          guideLinePosition: guideLinePosition,\n          setShowPopup: setShowPopup,\n          onShowAddSectionPopup: onShowAddSectionPopup\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 499,\n          columnNumber: 29\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"absolute top-0 w-px h-full bg-blue-500 opacity-50 z-[1001]\",\n          style: {\n            left: viewMode === 'mobile' ? 'calc(50% - 187.5px)' : 'calc(50% - 600px)'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 501,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"absolute top-0 w-px h-full bg-blue-500 opacity-50 z-[1001]\",\n          style: {\n            left: viewMode === 'mobile' ? 'calc(50% + 187.5px)' : 'calc(50% + 600px)'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 502,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true), /*#__PURE__*/_jsxDEV(SelectionOverlay, {\n        selectedElements: pageData.elements.filter(el => selectedIds.includes(el.id)),\n        onResize: onUpdateSize,\n        zoomLevel: zoomLevel\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 505,\n        columnNumber: 17\n      }, this), renderContextMenu(), renderAddSectionButton()]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 447,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 446,\n    columnNumber: 9\n  }, this);\n}, \"MOUpymle7phR54tlczgc0BMxlZ8=\", false, function () {\n  return [useGuidelines, usePopupManager, useCanvasDrop, useHotkeys, useHotkeys];\n})), \"MOUpymle7phR54tlczgc0BMxlZ8=\", false, function () {\n  return [useGuidelines, usePopupManager, useCanvasDrop, useHotkeys, useHotkeys];\n});\n_c2 = Canvas;\nCanvas.propTypes = {\n  pageData: PropTypes.shape({\n    canvas: PropTypes.shape({\n      width: PropTypes.number,\n      height: PropTypes.oneOfType([PropTypes.number, PropTypes.string]),\n      background: PropTypes.string\n    }).isRequired,\n    elements: PropTypes.arrayOf(PropTypes.shape({\n      id: PropTypes.string.isRequired,\n      type: PropTypes.string.isRequired,\n      position: PropTypes.object,\n      size: PropTypes.shape({\n        width: PropTypes.number,\n        height: PropTypes.number\n      }),\n      styles: PropTypes.object,\n      children: PropTypes.array,\n      visible: PropTypes.bool,\n      locked: PropTypes.bool,\n      meta: PropTypes.shape({\n        created_at: PropTypes.string,\n        updated_at: PropTypes.string\n      })\n    })).isRequired,\n    meta: PropTypes.shape({\n      created_at: PropTypes.string,\n      updated_at: PropTypes.string\n    })\n  }).isRequired,\n  selectedIds: PropTypes.arrayOf(PropTypes.string).isRequired,\n  onSelectElement: PropTypes.func.isRequired,\n  onUpdatePosition: PropTypes.func.isRequired,\n  onUpdateSize: PropTypes.func.isRequired,\n  onDeleteElement: PropTypes.func.isRequired,\n  onAddElement: PropTypes.func.isRequired,\n  onGroupElements: PropTypes.func.isRequired,\n  viewMode: PropTypes.oneOf(['desktop', 'tablet', 'mobile']).isRequired,\n  zoomLevel: PropTypes.number.isRequired,\n  gridSize: PropTypes.number.isRequired,\n  showGrid: PropTypes.bool.isRequired,\n  onEditElement: PropTypes.func.isRequired,\n  onDuplicateElement: PropTypes.func.isRequired,\n  onMoveElementUp: PropTypes.func.isRequired,\n  onMoveElementDown: PropTypes.func.isRequired,\n  onSelectChild: PropTypes.func.isRequired,\n  selectedChildId: PropTypes.string,\n  onAddChild: PropTypes.func.isRequired,\n  onUpdateChildPosition: PropTypes.func.isRequired,\n  onMoveChild: PropTypes.func.isRequired,\n  guideLine: PropTypes.shape({\n    show: PropTypes.bool,\n    y: PropTypes.number\n  }),\n  onShowAddSectionPopup: PropTypes.func.isRequired,\n  onSaveTemplate: PropTypes.func.isRequired,\n  onToggleVisibility: PropTypes.func.isRequired,\n  onDeleteChild: PropTypes.func.isRequired\n};\nexport default Canvas;\nvar _c, _c2;\n$RefreshReg$(_c, \"Canvas$React.memo\");\n$RefreshReg$(_c2, \"Canvas\");","map":{"version":3,"names":["React","useRef","useCallback","useState","useEffect","useMemo","useDrop","useHotkeys","toast","PropTypes","Guidelines","SelectionOverlay","Element","ItemTypes","getCanvasPosition","snapToGrid","getElementBounds","renderComponentContent","AddSectionButton","eventController","jsxDEV","_jsxDEV","Fragment","_Fragment","useCanvasDrop","pageData","viewMode","zoomLevel","gridSize","showGrid","onAddElement","onMoveChild","updateCanvasHeight","canvasRef","canvasBounds","setDragPreview","setGuidelines","_s","isOver","dragItem","drop","accept","ELEMENT","CHILD_ELEMENT","hover","item","monitor","clientOffset","getClientOffset","current","pos","x","y","snapPoints","getSnapPoints","elements","snapped","Infinity","getItemType","json","id","size","width","height","type","componentData","structure","styles","children","sourceElement","find","el","parentId","child","c","childId","newGuidelines","calculateGuidelines","error","moved","sourceSection","success","newPosition","lastSectionY","filter","reduce","maxY","_el$position","_el$position$viewMode","_el$size","Math","max","position","newElement","Date","now","JSON","parse","stringify","undefined","desktop","tablet","mobile","visible","locked","meta","updated_at","toISOString","collect","getItem","useGuidelines","_s2","guidelines","usePopupManager","selectedIds","onSelectElement","handleSelectElement","_s3","visiblePopups","setVisiblePopups","unsubscribeOpen","subscribe","payload","popupElement","popupId","prev","Set","unsubscribeClose","includes","points","forEach","_el$children","bounds","push","left","top","right","bottom","centerX","centerY","childBounds","_el$children2","abs","vertical","Canvas","_s4","memo","_c","onUpdatePosition","onUpdateSize","onDeleteElement","onGroupElements","onEditElement","onDuplicateElement","onMoveElementUp","onMoveElementDown","onSelectChild","selectedChildId","onAddChild","onUpdateChildPosition","guideLine","onShowAddSectionPopup","onSaveTemplate","onToggleVisibility","onDeleteChild","contextMenu","setContextMenu","dragPreview","showPopup","setShowPopup","guideLinePosition","setGuideLinePosition","offsetWidth","offsetHeight","ids","ctrlKey","console","selectedElements","popupIds","map","lastSection","_el$position2","_el$position2$viewMod","_el$size2","newHeight","handleContextMenu","handleCanvasClick","e","stopPropagation","target","handleKeyDown","length","preventDefault","step","shiftKey","_element$position$vie5","_element$position$vie6","element","_element$position$vie","_element$position$vie2","_element$position$vie3","_element$position$vie4","newY","key","newX","handleClickOutside","document","addEventListener","removeEventListener","handleClosePopup","renderDragPreview","className","style","transform","fileName","_jsxFileName","lineNumber","columnNumber","renderAddSectionButton","onClick","renderContextMenu","onKeyDown","tabIndex","ref","node","canvas","background","transformOrigin","isSelected","onContextMenu","onClosePopup","show","onResize","_c2","propTypes","shape","number","oneOfType","string","isRequired","arrayOf","object","array","bool","created_at","func","oneOf","$RefreshReg$"],"sources":["F:/landinghub-iconic/apps/web/src/components/create-page/Canvas.js"],"sourcesContent":["import React, { useRef, useCallback, useState, useEffect, useMemo } from 'react';\r\nimport { useDrop } from 'react-dnd';\r\nimport { useHotkeys } from 'react-hotkeys-hook';\r\nimport { toast } from 'react-toastify';\r\nimport PropTypes from 'prop-types';\r\nimport Guidelines from './Guidelines';\r\nimport SelectionOverlay from './SelectionOverlay';\r\nimport { Element } from './Element';\r\nimport { ItemTypes, getCanvasPosition, snapToGrid, getElementBounds, renderComponentContent } from './helpers';\r\nimport AddSectionButton from './AddSectionButton';\r\nimport eventController from '../../utils/EventController';\r\n\r\n// Custom hook để quản lý drag-and-drop\r\nconst useCanvasDrop = ({ pageData, viewMode, zoomLevel, gridSize, showGrid, onAddElement, onMoveChild, updateCanvasHeight, canvasRef, canvasBounds, setDragPreview, setGuidelines }) => {\r\n    const [{ isOver, dragItem }, drop] = useDrop({\r\n        accept: [ItemTypes.ELEMENT, ItemTypes.CHILD_ELEMENT],\r\n        hover: (item, monitor) => {\r\n            const clientOffset = monitor.getClientOffset();\r\n            if (!clientOffset || !canvasRef.current) {\r\n                setDragPreview(null);\r\n                return;\r\n            }\r\n            const pos = getCanvasPosition(clientOffset.x, clientOffset.y, canvasRef.current, zoomLevel);\r\n            const snapPoints = getSnapPoints(pageData.elements, canvasBounds, viewMode);\r\n            const snapped = snapToGrid(pos.x, pos.y, showGrid ? gridSize : Infinity, snapPoints);\r\n\r\n            if (monitor.getItemType() === ItemTypes.ELEMENT && item.json) {\r\n                setDragPreview({\r\n                    id: 'preview',\r\n                    x: snapped.x,\r\n                    y: snapped.y,\r\n                    size: item.json.size || { width: viewMode === 'mobile' ? 375 : 1200, height: 400 },\r\n                    type: item.json.type,\r\n                    componentData: item.json.componentData || { structure: 'ladi-standard' },\r\n                    styles: item.json.styles || {},\r\n                    children: item.json.children || [],\r\n                });\r\n            } else if (monitor.getItemType() === ItemTypes.CHILD_ELEMENT) {\r\n                const sourceElement = pageData.elements.find((el) => el.id === item.parentId);\r\n                const child = sourceElement?.children.find((c) => c.id === item.childId);\r\n                if (child) {\r\n                    setDragPreview({\r\n                        id: item.childId,\r\n                        x: snapped.x,\r\n                        y: snapped.y,\r\n                        size: item.size || { width: 200, height: 50 },\r\n                        type: child.type,\r\n                        componentData: child.componentData || {},\r\n                        styles: child.styles || {},\r\n                        children: [],\r\n                    });\r\n                }\r\n            }\r\n\r\n            const newGuidelines = calculateGuidelines(pageData.elements, snapped, viewMode, canvasBounds);\r\n            setGuidelines(newGuidelines);\r\n        },\r\n        drop: (item, monitor) => {\r\n            const clientOffset = monitor.getClientOffset();\r\n            if (!clientOffset || !canvasRef.current) {\r\n                toast.error('Không thể xác định vị trí thả!');\r\n                setDragPreview(null);\r\n                setGuidelines([]);\r\n                return { moved: false };\r\n            }\r\n            const pos = getCanvasPosition(clientOffset.x, clientOffset.y, canvasRef.current, zoomLevel);\r\n            const snapPoints = getSnapPoints(pageData.elements, canvasBounds, viewMode);\r\n            const snapped = snapToGrid(pos.x, pos.y, showGrid ? gridSize : Infinity, snapPoints);\r\n\r\n            if (monitor.getItemType() === ItemTypes.CHILD_ELEMENT) {\r\n                const sourceSection = pageData.elements.find((el) => el.id === item.parentId);\r\n                if (!sourceSection) {\r\n                    toast.error('Không tìm thấy section nguồn!');\r\n                    setDragPreview(null);\r\n                    setGuidelines([]);\r\n                    return { moved: false };\r\n                }\r\n                onMoveChild(item.parentId, item.childId, null, snapped);\r\n                toast.success('Đã di chuyển thành phần con ra canvas!');\r\n                setDragPreview(null);\r\n                setGuidelines([]);\r\n                return { moved: true, newPosition: snapped };\r\n            } else if (monitor.getItemType() === ItemTypes.ELEMENT) {\r\n                if (item.json.type !== 'section' && item.json.type !== 'popup' && item.json.type !== 'modal') {\r\n                    toast.error('Chỉ có thể thả section, popup hoặc modal lên canvas!');\r\n                    setDragPreview(null);\r\n                    setGuidelines([]);\r\n                    return { moved: false };\r\n                }\r\n                const lastSectionY = pageData.elements\r\n                    .filter((el) => el.type === 'section')\r\n                    .reduce((maxY, el) => Math.max(maxY, (el.position?.[viewMode]?.y || 0) + (el.size?.height || 400)), 0);\r\n                const newElement = {\r\n                    id: `${item.json.type}-${Date.now()}`,\r\n                    type: item.json.type,\r\n                    componentData: JSON.parse(JSON.stringify(item.json.componentData || { structure: item.json.type === 'section' ? 'ladi-standard' : undefined })),\r\n                    position: {\r\n                        [viewMode]: { x: item.json.type === 'section' ? 0 : snapped.x, y: item.json.type === 'section' ? lastSectionY + 10 : snapped.y },\r\n                        desktop: { x: item.json.type === 'section' ? 0 : snapped.x, y: item.json.type === 'section' ? lastSectionY + 10 : snapped.y },\r\n                        tablet: { x: item.json.type === 'section' ? 0 : snapped.x, y: item.json.type === 'section' ? lastSectionY + 10 : snapped.y },\r\n                        mobile: { x: item.json.type === 'section' ? 0 : snapped.x, y: item.json.type === 'section' ? lastSectionY + 10 : snapped.y },\r\n                    },\r\n                    size: { ...item.json.size, width: viewMode === 'mobile' ? 375 : item.json.type === 'section' ? 1200 : 600 },\r\n                    styles: JSON.parse(JSON.stringify(item.json.styles || {})),\r\n                    children: JSON.parse(JSON.stringify(item.json.children || [])),\r\n                    visible: true,\r\n                    locked: false,\r\n                    meta: { updated_at: new Date().toISOString() },\r\n                };\r\n                onAddElement(newElement);\r\n                if (item.json.type === 'section') {\r\n                    updateCanvasHeight();\r\n                }\r\n                toast.success(`Đã thêm ${item.json.type} mới!`);\r\n                setDragPreview(null);\r\n                setGuidelines([]);\r\n                return { moved: true, newPosition: { x: item.json.type === 'section' ? 0 : snapped.x, y: item.json.type === 'section' ? lastSectionY + 10 : snapped.y } };\r\n            }\r\n            setDragPreview(null);\r\n            setGuidelines([]);\r\n            return { moved: false };\r\n        },\r\n        collect: (monitor) => ({ isOver: monitor.isOver(), dragItem: monitor.getItem() }),\r\n    }, [pageData.elements, viewMode, zoomLevel, gridSize, showGrid, canvasBounds, onAddElement, onMoveChild, updateCanvasHeight, canvasRef]);\r\n\r\n    return { isOver, dragItem, drop };\r\n};\r\n\r\n// Custom hook để quản lý guidelines\r\nconst useGuidelines = (pageData, viewMode, canvasBounds) => {\r\n    const [guidelines, setGuidelines] = useState([]);\r\n    return { guidelines, setGuidelines };\r\n};\r\n\r\n// Custom hook để quản lý popups\r\nconst usePopupManager = (pageData, selectedIds, onSelectElement, handleSelectElement) => {\r\n    const [visiblePopups, setVisiblePopups] = useState([]);\r\n\r\n    useEffect(() => {\r\n        const unsubscribeOpen = eventController.subscribe(\"popup-open\", (payload) => {\r\n            const popupElement = pageData.elements.find((el) => el.id === payload.popupId);\r\n            if (!popupElement) {\r\n                toast.error(`Popup \"${payload.popupId}\" not found!`);\r\n                return;\r\n            }\r\n            setVisiblePopups((prev) => [...new Set([...prev, payload.popupId])]);\r\n            onSelectElement([payload.popupId]);\r\n        });\r\n\r\n        const unsubscribeClose = eventController.subscribe(\"popup-close\", (payload) => {\r\n            setVisiblePopups((prev) => prev.filter((popupId) => popupId !== payload.popupId));\r\n            if (selectedIds.includes(payload.popupId)) {\r\n                handleSelectElement([]);\r\n            }\r\n        });\r\n\r\n        return () => {\r\n            unsubscribeOpen();\r\n            unsubscribeClose();\r\n        };\r\n    }, [pageData.elements, onSelectElement, selectedIds, handleSelectElement]);\r\n\r\n    return { visiblePopups, setVisiblePopups };\r\n};\r\n\r\n// Hàm tính toán snap points\r\nconst getSnapPoints = (elements, canvasBounds, viewMode) => {\r\n    const points = [\r\n        { x: 0, y: 0 },\r\n        { x: viewMode === 'mobile' ? 375 : 1200, y: canvasBounds.height },\r\n        { x: (viewMode === 'mobile' ? 375 : 1200) / 2, y: canvasBounds.height / 2 },\r\n    ];\r\n    elements.forEach((el) => {\r\n        const bounds = getElementBounds(el);\r\n        points.push(\r\n            { x: bounds.left, y: bounds.top },\r\n            { x: bounds.right, y: bounds.bottom },\r\n            { x: bounds.centerX, y: bounds.centerY },\r\n            { x: bounds.left, y: bounds.centerY },\r\n            { x: bounds.right, y: bounds.centerY },\r\n            { x: bounds.centerX, y: bounds.top },\r\n            { x: bounds.centerX, y: bounds.bottom }\r\n        );\r\n        el.children?.forEach((child) => {\r\n            const childBounds = getElementBounds(child);\r\n            points.push(\r\n                { x: childBounds.left, y: childBounds.top },\r\n                { x: childBounds.right, y: childBounds.bottom },\r\n                { x: childBounds.centerX, y: childBounds.centerY },\r\n                { x: childBounds.left, y: childBounds.centerY },\r\n                { x: childBounds.right, y: childBounds.centerY },\r\n                { x: childBounds.centerX, y: childBounds.top },\r\n                { x: childBounds.centerX, y: childBounds.bottom }\r\n            );\r\n        });\r\n    });\r\n    return points;\r\n};\r\n\r\n// Hàm tính toán guidelines\r\nconst calculateGuidelines = (elements, snapped, viewMode, canvasBounds) => {\r\n    const newGuidelines = [];\r\n    elements.forEach((el) => {\r\n        const bounds = getElementBounds(el);\r\n        if (Math.abs(snapped.x - bounds.left) < 15) newGuidelines.push({ vertical: true, position: bounds.left });\r\n        if (Math.abs(snapped.x - bounds.right) < 15) newGuidelines.push({ vertical: true, position: bounds.right });\r\n        if (Math.abs(snapped.x - bounds.centerX) < 15) newGuidelines.push({ vertical: true, position: bounds.centerX });\r\n        if (Math.abs(snapped.y - bounds.top) < 15) newGuidelines.push({ vertical: false, position: bounds.top });\r\n        if (Math.abs(snapped.y - bounds.bottom) < 15) newGuidelines.push({ vertical: false, position: bounds.bottom });\r\n        if (Math.abs(snapped.y - bounds.centerY) < 15) newGuidelines.push({ vertical: false, position: bounds.centerY });\r\n        el.children?.forEach((child) => {\r\n            const childBounds = getElementBounds(child);\r\n            if (Math.abs(snapped.x - childBounds.left) < 15) newGuidelines.push({ vertical: true, position: childBounds.left });\r\n            if (Math.abs(snapped.x - childBounds.right) < 15) newGuidelines.push({ vertical: true, position: childBounds.right });\r\n            if (Math.abs(snapped.x - childBounds.centerX) < 15) newGuidelines.push({ vertical: true, position: childBounds.centerX });\r\n            if (Math.abs(snapped.y - childBounds.top) < 15) newGuidelines.push({ vertical: false, position: childBounds.top });\r\n            if (Math.abs(snapped.y - childBounds.bottom) < 15) newGuidelines.push({ vertical: false, position: childBounds.bottom });\r\n            if (Math.abs(snapped.y - childBounds.centerY) < 15) newGuidelines.push({ vertical: false, position: childBounds.centerY });\r\n        });\r\n    });\r\n    if (Math.abs(snapped.x) < 15) newGuidelines.push({ vertical: true, position: 0 });\r\n    if (Math.abs(snapped.x - (viewMode === 'mobile' ? 375 : 1200)) < 15)\r\n        newGuidelines.push({ vertical: true, position: viewMode === 'mobile' ? 375 : 1200 });\r\n    if (Math.abs(snapped.x - (viewMode === 'mobile' ? 375 : 1200) / 2) < 15)\r\n        newGuidelines.push({ vertical: true, position: (viewMode === 'mobile' ? 375 : 1200) / 2 });\r\n    if (Math.abs(snapped.y) < 15) newGuidelines.push({ vertical: false, position: 0 });\r\n    if (Math.abs(snapped.y - canvasBounds.height) < 15) newGuidelines.push({ vertical: false, position: canvasBounds.height });\r\n    if (Math.abs(snapped.y - canvasBounds.height / 2) < 15)\r\n        newGuidelines.push({ vertical: false, position: canvasBounds.height / 2 });\r\n    return newGuidelines;\r\n};\r\n\r\nconst Canvas = React.memo(({\r\n                               pageData,\r\n                               selectedIds,\r\n                               onSelectElement,\r\n                               onUpdatePosition,\r\n                               onUpdateSize,\r\n                               onDeleteElement,\r\n                               onAddElement,\r\n                               onGroupElements,\r\n                               viewMode,\r\n                               zoomLevel,\r\n                               gridSize,\r\n                               showGrid,\r\n                               onEditElement,\r\n                               onDuplicateElement,\r\n                               onMoveElementUp,\r\n                               onMoveElementDown,\r\n                               onSelectChild,\r\n                               selectedChildId,\r\n                               onAddChild,\r\n                               onUpdateChildPosition,\r\n                               onMoveChild,\r\n                               guideLine,\r\n                               onShowAddSectionPopup,\r\n                               onSaveTemplate,\r\n                               onToggleVisibility,\r\n                               onDeleteChild,\r\n                           }) => {\r\n    const canvasRef = useRef(null);\r\n    const [contextMenu, setContextMenu] = useState(null);\r\n    const [dragPreview, setDragPreview] = useState(null);\r\n    const [showPopup, setShowPopup] = useState(false);\r\n    const [guideLinePosition, setGuideLinePosition] = useState(guideLine?.y || 0);\r\n\r\n    // Tính canvasBounds trước khi gọi các hooks\r\n    const canvasBounds = useMemo(() => ({\r\n        width: canvasRef.current ? canvasRef.current.offsetWidth / (zoomLevel / 100) : (viewMode === 'mobile' ? 375 : 1200),\r\n        height: canvasRef.current ? canvasRef.current.offsetHeight / (zoomLevel / 100) : 1000,\r\n    }), [viewMode, zoomLevel]);\r\n\r\n    const { guidelines, setGuidelines } = useGuidelines(pageData, viewMode, canvasBounds);\r\n    const { visiblePopups, setVisiblePopups } = usePopupManager(pageData, selectedIds, onSelectElement, handleSelectElement);\r\n    const { isOver, dragItem, drop } = useCanvasDrop({\r\n        pageData,\r\n        viewMode,\r\n        zoomLevel,\r\n        gridSize,\r\n        showGrid,\r\n        onAddElement,\r\n        onMoveChild,\r\n        updateCanvasHeight,\r\n        canvasRef,\r\n        canvasBounds,\r\n        setDragPreview,\r\n        setGuidelines,\r\n    });\r\n\r\n    const handleSelectElement = useCallback((ids, ctrlKey) => {\r\n        if (typeof onSelectElement !== 'function') {\r\n            console.error('onSelectElement is not a function');\r\n            return;\r\n        }\r\n        onSelectElement(ids, ctrlKey);\r\n        const selectedElements = pageData.elements.filter((el) => ids.includes(el.id));\r\n        const popupIds = selectedElements\r\n            .filter((el) => el.type === 'popup' || el.type === 'modal')\r\n            .map((el) => el.id);\r\n        setVisiblePopups(popupIds);\r\n    }, [onSelectElement, pageData.elements, setVisiblePopups]);\r\n\r\n    const updateCanvasHeight = useCallback(() => {\r\n        const lastSection = pageData.elements\r\n            .filter((el) => el.type === 'section')\r\n            .reduce((maxY, el) => Math.max(maxY, (el.position?.[viewMode]?.y || 0) + (el.size?.height || 400)), 0);\r\n        const newHeight = lastSection + 50;\r\n        setGuideLinePosition(lastSection + 10);\r\n        return newHeight;\r\n    }, [pageData.elements, viewMode]);\r\n\r\n    useEffect(() => {\r\n        updateCanvasHeight();\r\n    }, [updateCanvasHeight]);\r\n\r\n    const handleContextMenu = useCallback((id, position) => {\r\n        setContextMenu({ id, position });\r\n    }, []);\r\n\r\n    const handleCanvasClick = useCallback((e) => {\r\n        e.stopPropagation();\r\n        if (e.target === canvasRef.current) {\r\n            handleSelectElement([]);\r\n            onSelectChild(null, null);\r\n            setContextMenu(null);\r\n            setDragPreview(null);\r\n            setVisiblePopups([]);\r\n        }\r\n    }, [handleSelectElement, onSelectChild]);\r\n\r\n    const handleKeyDown = useCallback((e) => {\r\n        if (!selectedIds.length) return;\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        const step = e.shiftKey ? 10 : 1;\r\n        selectedIds.forEach((id) => {\r\n            const element = pageData.elements.find((el) => el.id === id);\r\n            if (element && element.type !== 'section' && element.type !== 'popup' && element.type !== 'modal') {\r\n                const newY = e.key === 'ArrowUp' ? Math.max(0, (element.position[viewMode]?.y || 0) - step) : (element.position[viewMode]?.y || 0) + step;\r\n                const newX = e.key === 'ArrowLeft' ? Math.max(0, (element.position[viewMode]?.x || 0) - step) : (element.position[viewMode]?.x || 0) + step;\r\n                switch (e.key) {\r\n                    case 'ArrowUp':\r\n                    case 'ArrowDown':\r\n                        onUpdatePosition(id, { [viewMode]: { x: element.position[viewMode]?.x || 0, y: newY } }, 'absolute');\r\n                        break;\r\n                    case 'ArrowLeft':\r\n                    case 'ArrowRight':\r\n                        onUpdatePosition(id, { [viewMode]: { x: newX, y: element.position[viewMode]?.y || 0 } }, 'absolute');\r\n                        break;\r\n                    case 'Delete':\r\n                    case 'Backspace':\r\n                        onDeleteElement(id);\r\n                        setVisiblePopups((prev) => prev.filter((popupId) => popupId !== id));\r\n                        break;\r\n                    case 'Escape':\r\n                        handleSelectElement([]);\r\n                        onSelectChild(null, null);\r\n                        setContextMenu(null);\r\n                        setDragPreview(null);\r\n                        setVisiblePopups([]);\r\n                        break;\r\n                    default:\r\n                        break;\r\n                }\r\n            }\r\n        });\r\n    }, [selectedIds, onUpdatePosition, onDeleteElement, handleSelectElement, onSelectChild, viewMode, pageData.elements]);\r\n\r\n    useHotkeys('ctrl+a', (e) => {\r\n        e.preventDefault();\r\n        handleSelectElement(pageData.elements.map((el) => el.id));\r\n    }, [pageData.elements, handleSelectElement]);\r\n\r\n    useHotkeys('ctrl+g', (e) => {\r\n        e.preventDefault();\r\n        if (selectedIds.length > 1) {\r\n            onGroupElements(selectedIds);\r\n        }\r\n    }, [selectedIds, onGroupElements]);\r\n\r\n    useEffect(() => {\r\n        const handleClickOutside = () => {\r\n            setContextMenu(null);\r\n            setDragPreview(null);\r\n            setVisiblePopups([]);\r\n        };\r\n        if (contextMenu || visiblePopups.length > 0) {\r\n            document.addEventListener('click', handleClickOutside);\r\n            return () => document.removeEventListener('click', handleClickOutside);\r\n        }\r\n    }, [contextMenu, visiblePopups]);\r\n\r\n    const handleClosePopup = useCallback((id) => {\r\n        setVisiblePopups((prev) => prev.filter((popupId) => popupId !== id));\r\n        handleSelectElement([]);\r\n    }, [handleSelectElement]);\r\n\r\n    const renderDragPreview = () => {\r\n        if (!dragPreview) return null;\r\n        const { x, y, size, type, componentData, styles, children } = dragPreview;\r\n        return (\r\n            <div className=\"absolute border-2 border-dashed border-blue-500 bg-blue-100/50 pointer-events-none z-[1000] opacity-50\" style={{ transform: `translate(${x}px, ${y}px)`, width: size.width, height: size.height, ...styles }}>\r\n                {renderComponentContent(type, componentData || {}, styles || {}, children || [])}\r\n            </div>\r\n        );\r\n    };\r\n\r\n    const renderAddSectionButton = () => {\r\n        if (pageData.elements.length > 0) return null;\r\n        return (\r\n            <div className=\"absolute left-1/2 top-1/2 transform -translate-x-1/2 -translate-y-1/2 z-[1000]\">\r\n                <button\r\n                    onClick={(e) => {\r\n                        e.stopPropagation();\r\n                        setShowPopup(true);\r\n                        if (typeof onShowAddSectionPopup === 'function') {\r\n                            onShowAddSectionPopup();\r\n                        }\r\n                    }}\r\n                    className=\"px-6 py-3 bg-blue-600 text-white rounded-lg font-semibold cursor-pointer hover:bg-blue-700\"\r\n                >\r\n                    Thêm Section\r\n                </button>\r\n            </div>\r\n        );\r\n    };\r\n\r\n    const renderContextMenu = () => {\r\n        if (!contextMenu) return null;\r\n        return (\r\n            <div className=\"fixed bg-white border border-gray-300 rounded shadow-lg min-w-[120px] z-[10000]\" style={{ left: contextMenu.position.x, top: contextMenu.position.y }}>\r\n                <div className=\"px-3 py-2 cursor-pointer hover:bg-gray-100\" onClick={() => { onDeleteElement(contextMenu.id); setContextMenu(null); setVisiblePopups((prev) => prev.filter((id) => id !== contextMenu.id)); }}>\r\n                    Xóa\r\n                </div>\r\n                <div className=\"px-3 py-2 cursor-pointer hover:bg-gray-100\" onClick={() => { onGroupElements([contextMenu.id]); setContextMenu(null); }}>\r\n                    Nhóm\r\n                </div>\r\n                <div className=\"px-3 py-2 cursor-pointer hover:bg-gray-100\" onClick={() => { onToggleVisibility(contextMenu.id); setContextMenu(null); }}>\r\n                    Ẩn/Hiện\r\n                </div>\r\n            </div>\r\n        );\r\n    };\r\n\r\n    return (\r\n        <div className=\"relative w-full h-screen overflow-y-auto focus:outline-none\" onKeyDown={handleKeyDown} tabIndex={0}>\r\n            <div\r\n                ref={(node) => {\r\n                    canvasRef.current = node;\r\n                    drop(node);\r\n                }}\r\n                className={`relative mx-auto ${viewMode === 'mobile' ? 'w-[375px]' : viewMode === 'tablet' ? 'w-[768px]' : 'w-[1200px]'}`}\r\n                onClick={handleCanvasClick}\r\n                style={{\r\n                    height: pageData.canvas.height ? `${pageData.canvas.height}px` : 'auto',\r\n                    background: pageData.canvas.background,\r\n                    transform: `scale(${zoomLevel / 100})`,\r\n                    transformOrigin: 'top center',\r\n                }}\r\n            >\r\n                <Guidelines guidelines={guidelines} zoomLevel={zoomLevel} />\r\n                {pageData.elements.map((element) => (\r\n                    <Element\r\n                        key={element.id}\r\n                        element={element}\r\n                        isSelected={selectedIds.includes(element.id)}\r\n                        onSelectElement={handleSelectElement}\r\n                        onUpdatePosition={onUpdatePosition}\r\n                        viewMode={viewMode}\r\n                        zoomLevel={zoomLevel}\r\n                        gridSize={gridSize}\r\n                        onContextMenu={handleContextMenu}\r\n                        canvasBounds={canvasBounds}\r\n                        canvasRef={canvasRef}\r\n                        onSelectChild={onSelectChild}\r\n                        selectedChildId={selectedChildId}\r\n                        onAddChild={onAddChild}\r\n                        onUpdateChildPosition={onUpdateChildPosition}\r\n                        onMoveChild={onMoveChild}\r\n                        showGrid={showGrid}\r\n                        setDragPreview={setDragPreview}\r\n                        visiblePopups={visiblePopups}\r\n                        onClosePopup={handleClosePopup}\r\n                        onSaveTemplate={onSaveTemplate}\r\n                        onToggleVisibility={onToggleVisibility}\r\n                        onEditElement={onEditElement}\r\n                        onDuplicateElement={onDuplicateElement}\r\n                        onMoveElementUp={onMoveElementUp}\r\n                        onMoveElementDown={onMoveElementDown}\r\n                        onDeleteElement={onDeleteElement}\r\n                        onDeleteChild={onDeleteChild}\r\n                    />\r\n                ))}\r\n                {renderDragPreview()}\r\n                {guideLine?.show && (\r\n                    <>\r\n                        <div className=\"absolute left-1/2 transform -translate-x-1/2 w-full h-px bg-blue-500 opacity-50 z-[1001]\" style={{ top: guideLinePosition }} />\r\n                        {pageData.elements.length > 0 && (\r\n                            <AddSectionButton guideLinePosition={guideLinePosition} setShowPopup={setShowPopup} onShowAddSectionPopup={onShowAddSectionPopup} />\r\n                        )}\r\n                        <div className=\"absolute top-0 w-px h-full bg-blue-500 opacity-50 z-[1001]\" style={{ left: viewMode === 'mobile' ? 'calc(50% - 187.5px)' : 'calc(50% - 600px)' }} />\r\n                        <div className=\"absolute top-0 w-px h-full bg-blue-500 opacity-50 z-[1001]\" style={{ left: viewMode === 'mobile' ? 'calc(50% + 187.5px)' : 'calc(50% + 600px)' }} />\r\n                    </>\r\n                )}\r\n                <SelectionOverlay\r\n                    selectedElements={pageData.elements.filter((el) => selectedIds.includes(el.id))}\r\n                    onResize={onUpdateSize}\r\n                    zoomLevel={zoomLevel}\r\n                />\r\n                {renderContextMenu()}\r\n                {renderAddSectionButton()}\r\n            </div>\r\n        </div>\r\n    );\r\n});\r\n\r\nCanvas.propTypes = {\r\n    pageData: PropTypes.shape({\r\n        canvas: PropTypes.shape({\r\n            width: PropTypes.number,\r\n            height: PropTypes.oneOfType([PropTypes.number, PropTypes.string]),\r\n            background: PropTypes.string,\r\n        }).isRequired,\r\n        elements: PropTypes.arrayOf(PropTypes.shape({\r\n            id: PropTypes.string.isRequired,\r\n            type: PropTypes.string.isRequired,\r\n            position: PropTypes.object,\r\n            size: PropTypes.shape({\r\n                width: PropTypes.number,\r\n                height: PropTypes.number,\r\n            }),\r\n            styles: PropTypes.object,\r\n            children: PropTypes.array,\r\n            visible: PropTypes.bool,\r\n            locked: PropTypes.bool,\r\n            meta: PropTypes.shape({\r\n                created_at: PropTypes.string,\r\n                updated_at: PropTypes.string,\r\n            }),\r\n        })).isRequired,\r\n        meta: PropTypes.shape({\r\n            created_at: PropTypes.string,\r\n            updated_at: PropTypes.string,\r\n        }),\r\n    }).isRequired,\r\n    selectedIds: PropTypes.arrayOf(PropTypes.string).isRequired,\r\n    onSelectElement: PropTypes.func.isRequired,\r\n    onUpdatePosition: PropTypes.func.isRequired,\r\n    onUpdateSize: PropTypes.func.isRequired,\r\n    onDeleteElement: PropTypes.func.isRequired,\r\n    onAddElement: PropTypes.func.isRequired,\r\n    onGroupElements: PropTypes.func.isRequired,\r\n    viewMode: PropTypes.oneOf(['desktop', 'tablet', 'mobile']).isRequired,\r\n    zoomLevel: PropTypes.number.isRequired,\r\n    gridSize: PropTypes.number.isRequired,\r\n    showGrid: PropTypes.bool.isRequired,\r\n    onEditElement: PropTypes.func.isRequired,\r\n    onDuplicateElement: PropTypes.func.isRequired,\r\n    onMoveElementUp: PropTypes.func.isRequired,\r\n    onMoveElementDown: PropTypes.func.isRequired,\r\n    onSelectChild: PropTypes.func.isRequired,\r\n    selectedChildId: PropTypes.string,\r\n    onAddChild: PropTypes.func.isRequired,\r\n    onUpdateChildPosition: PropTypes.func.isRequired,\r\n    onMoveChild: PropTypes.func.isRequired,\r\n    guideLine: PropTypes.shape({\r\n        show: PropTypes.bool,\r\n        y: PropTypes.number,\r\n    }),\r\n    onShowAddSectionPopup: PropTypes.func.isRequired,\r\n    onSaveTemplate: PropTypes.func.isRequired,\r\n    onToggleVisibility: PropTypes.func.isRequired,\r\n    onDeleteChild: PropTypes.func.isRequired,\r\n};\r\n\r\nexport default Canvas;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}