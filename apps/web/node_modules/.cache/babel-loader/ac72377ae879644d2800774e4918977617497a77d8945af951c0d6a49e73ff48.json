{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useReducer, useCallback, useEffect, useRef } from 'react';\nimport { useHotkeys } from 'react-hotkeys-hook';\nimport { toast } from 'react-toastify';\nimport api from '@landinghub/api';\nimport { parse } from 'node-html-parser';\n\n// Initial state giống như trong CreateLandingPage\nconst initialState = {\n  pageData: {\n    canvas: {\n      width: 1200,\n      height: 'auto',\n      background: '#ffffff'\n    },\n    elements: []\n  },\n  selectedIds: [],\n  history: [],\n  historyIndex: -1,\n  viewMode: 'desktop',\n  zoomLevel: 100,\n  gridSize: 8,\n  showGrid: true,\n  leftSidebarCollapsed: false,\n  rightSidebarCollapsed: false\n};\n\n// Reducer giống như trong CreateLandingPage\nconst reducer = (state, action) => {\n  switch (action.type) {\n    case 'SET_PAGE_DATA':\n      return {\n        ...state,\n        pageData: action.payload,\n        history: [...state.history.slice(0, state.historyIndex + 1), action.payload],\n        historyIndex: state.historyIndex + 1\n      };\n    case 'ADD_ELEMENT':\n      const newElement = {\n        ...action.payload,\n        id: `${action.payload.id}-${Date.now()}`,\n        position: {\n          desktop: action.payload.position.desktop,\n          tablet: action.payload.position.tablet,\n          mobile: action.payload.position.mobile\n        }\n      };\n      const newPageDataAdd = {\n        ...state.pageData,\n        elements: [...state.pageData.elements, newElement]\n      };\n      return {\n        ...state,\n        pageData: newPageDataAdd,\n        history: [...state.history.slice(0, state.historyIndex + 1), newPageDataAdd],\n        historyIndex: state.historyIndex + 1,\n        selectedIds: [newElement.id]\n      };\n    case 'UPDATE_POSITION':\n      const newPageDataPos = {\n        ...state.pageData,\n        elements: state.pageData.elements.map(el => action.payload.ids.includes(el.id) ? {\n          ...el,\n          position: {\n            ...el.position,\n            [state.viewMode]: {\n              x: el.position[state.viewMode].x + (action.payload.position[state.viewMode].x || 0),\n              y: el.position[state.viewMode].y + (action.payload.position[state.viewMode].y || 0)\n            }\n          }\n        } : el)\n      };\n      return {\n        ...state,\n        pageData: newPageDataPos,\n        history: action.payload.commit ? [...state.history.slice(0, state.historyIndex + 1), newPageDataPos] : state.history,\n        historyIndex: action.payload.commit ? state.historyIndex + 1 : state.historyIndex\n      };\n    case 'UPDATE_SIZE':\n      const newPageDataSize = {\n        ...state.pageData,\n        elements: state.pageData.elements.map(el => el.id === action.payload.id ? {\n          ...el,\n          size: action.payload.size\n        } : el)\n      };\n      return {\n        ...state,\n        pageData: newPageDataSize,\n        history: [...state.history.slice(0, state.historyIndex + 1), newPageDataSize],\n        historyIndex: state.historyIndex + 1\n      };\n    case 'DELETE_ELEMENT':\n      const newPageDataDel = {\n        ...state.pageData,\n        elements: state.pageData.elements.filter(el => !action.payload.includes(el.id))\n      };\n      return {\n        ...state,\n        pageData: newPageDataDel,\n        history: [...state.history.slice(0, state.historyIndex + 1), newPageDataDel],\n        historyIndex: state.historyIndex + 1,\n        selectedIds: state.selectedIds.filter(id => !action.payload.includes(id))\n      };\n    case 'SELECT_ELEMENT':\n      return {\n        ...state,\n        selectedIds: action.payload\n      };\n    case 'GROUP_ELEMENTS':\n      const groupId = `group-${Date.now()}`;\n      const newPageDataGroup = {\n        ...state.pageData,\n        elements: [...state.pageData.elements.filter(el => !action.payload.includes(el.id)), {\n          id: groupId,\n          type: 'group',\n          position: {\n            desktop: {\n              x: 0,\n              y: 0\n            },\n            tablet: {\n              x: 0,\n              y: 0\n            },\n            mobile: {\n              x: 0,\n              y: 0\n            }\n          },\n          size: {\n            width: 300,\n            height: 200\n          },\n          children: action.payload\n        }]\n      };\n      return {\n        ...state,\n        pageData: newPageDataGroup,\n        history: [...state.history.slice(0, state.historyIndex + 1), newPageDataGroup],\n        historyIndex: state.historyIndex + 1,\n        selectedIds: [groupId]\n      };\n    case 'UNDO':\n      if (state.historyIndex <= 0) return state;\n      return {\n        ...state,\n        pageData: state.history[state.historyIndex - 1],\n        historyIndex: state.historyIndex - 1\n      };\n    case 'REDO':\n      if (state.historyIndex >= state.history.length - 1) return state;\n      return {\n        ...state,\n        pageData: state.history[state.historyIndex + 1],\n        historyIndex: state.historyIndex + 1\n      };\n    case 'SET_VIEW_MODE':\n      return {\n        ...state,\n        viewMode: action.payload\n      };\n    case 'SET_ZOOM':\n      return {\n        ...state,\n        zoomLevel: action.payload\n      };\n    case 'TOGGLE_GRID':\n      return {\n        ...state,\n        showGrid: !state.showGrid\n      };\n    case 'SET_GRID_SIZE':\n      return {\n        ...state,\n        gridSize: action.payload\n      };\n    case 'TOGGLE_SIDEBAR':\n      return {\n        ...state,\n        [action.payload.side === 'left' ? 'leftSidebarCollapsed' : 'rightSidebarCollapsed']: !state[action.payload.side === 'left' ? 'leftSidebarCollapsed' : 'rightSidebarCollapsed']\n      };\n    default:\n      return state;\n  }\n};\n\n// Hàm parse HTML thành pageData\nconst parseHTMLToPageData = html => {\n  const root = parse(html);\n  const pageContainer = root.querySelector('.page-container');\n  if (!pageContainer) {\n    console.warn('No .page-container found in HTML');\n    return initialState.pageData;\n  }\n  const elements = [];\n  pageContainer.childNodes.forEach((node, index) => {\n    if (node.tagName === 'DIV') {\n      var _node$firstChild, _node$firstChild$tagN;\n      const styles = node.getAttribute('style') || '';\n      const styleObj = styles.split(';').reduce((acc, style) => {\n        const [key, value] = style.split(':').map(s => s.trim());\n        if (key && value) acc[key] = value;\n        return acc;\n      }, {});\n      const position = {\n        desktop: {\n          x: parseFloat(styleObj.left) || 0,\n          y: parseFloat(styleObj.top) || 0\n        },\n        tablet: {\n          x: parseFloat(styleObj.left) || 0,\n          y: parseFloat(styleObj.top) || 0\n        },\n        mobile: {\n          x: parseFloat(styleObj.left) || 0,\n          y: parseFloat(styleObj.top) || 0\n        }\n      };\n      const size = {\n        width: parseFloat(styleObj.width) || 0,\n        height: parseFloat(styleObj.height) || 0\n      };\n      let type = 'container';\n      let children = [];\n      node.childNodes.forEach(child => {\n        if (child.tagName === 'H2') {\n          children.push({\n            id: `child-${index}-${Date.now()}`,\n            type: 'heading',\n            content: child.textContent,\n            styles: child.getAttribute('style') ? parseStyles(child.getAttribute('style')) : {}\n          });\n        } else if (child.tagName === 'P') {\n          children.push({\n            id: `child-${index}-${Date.now()}`,\n            type: 'paragraph',\n            content: child.textContent,\n            styles: child.getAttribute('style') ? parseStyles(child.getAttribute('style')) : {}\n          });\n        } else if (child.tagName === 'BUTTON') {\n          children.push({\n            id: `child-${index}-${Date.now()}`,\n            type: 'button',\n            content: child.textContent,\n            styles: child.getAttribute('style') ? parseStyles(child.getAttribute('style')) : {}\n          });\n        }\n      });\n      elements.push({\n        id: `element-${index}-${Date.now()}`,\n        type: children.length > 0 ? 'container' : ((_node$firstChild = node.firstChild) === null || _node$firstChild === void 0 ? void 0 : (_node$firstChild$tagN = _node$firstChild.tagName) === null || _node$firstChild$tagN === void 0 ? void 0 : _node$firstChild$tagN.toLowerCase()) || 'container',\n        position,\n        size,\n        styles: styleObj,\n        children: children.length > 0 ? children : undefined,\n        componentData: children.length === 0 ? {\n          content: node.textContent\n        } : undefined\n      });\n    }\n  });\n  return {\n    canvas: {\n      width: 1200,\n      height: 'auto',\n      background: '#ffffff'\n    },\n    elements\n  };\n};\nconst parseStyles = styleString => {\n  return styleString.split(';').reduce((acc, style) => {\n    const [key, value] = style.split(':').map(s => s.trim());\n    if (key && value) acc[key] = value;\n    return acc;\n  }, {});\n};\nconst useLandingPage = (pageId, navigate) => {\n  _s();\n  const [state, dispatch] = useReducer(reducer, initialState);\n  const fileInputRef = useRef(null);\n  const {\n    pageData,\n    selectedIds,\n    history,\n    historyIndex,\n    viewMode,\n    zoomLevel,\n    gridSize,\n    showGrid,\n    leftSidebarCollapsed,\n    rightSidebarCollapsed\n  } = state;\n  const addElement = useCallback(element => {\n    dispatch({\n      type: 'ADD_ELEMENT',\n      payload: element\n    });\n  }, []);\n  const updatePosition = useCallback((ids, position, commit) => {\n    dispatch({\n      type: 'UPDATE_POSITION',\n      payload: {\n        ids,\n        position,\n        commit\n      }\n    });\n  }, []);\n  const updateSize = useCallback((id, size) => {\n    dispatch({\n      type: 'UPDATE_SIZE',\n      payload: {\n        id,\n        size\n      }\n    });\n  }, []);\n  const deleteElement = useCallback(ids => {\n    dispatch({\n      type: 'DELETE_ELEMENT',\n      payload: ids\n    });\n  }, []);\n  const selectElement = useCallback(ids => {\n    dispatch({\n      type: 'SELECT_ELEMENT',\n      payload: ids\n    });\n  }, []);\n  const groupElements = useCallback(ids => {\n    dispatch({\n      type: 'GROUP_ELEMENTS',\n      payload: ids\n    });\n    toast.success('Đã nhóm phần tử!');\n  }, []);\n  const undo = useCallback(() => {\n    dispatch({\n      type: 'UNDO'\n    });\n    toast.info('Đã hoàn tác!');\n  }, []);\n  const redo = useCallback(() => {\n    dispatch({\n      type: 'REDO'\n    });\n    toast.info('Đã khôi phục!');\n  }, []);\n  const handleZoom = useCallback(direction => {\n    dispatch({\n      type: 'SET_ZOOM',\n      payload: direction === 'in' ? Math.min(200, zoomLevel + 10) : Math.max(50, zoomLevel - 10)\n    });\n  }, [zoomLevel]);\n  const handleSave = useCallback(async () => {\n    if (!pageId) {\n      toast.error('Không tìm thấy ID trang. Vui lòng tạo trang mới từ dashboard.');\n      return;\n    }\n    try {\n      const htmlContent = renderStaticHTML(pageData); // Hàm renderStaticHTML từ CreateLanding\n      const response = await api.put(`/api/pages/${pageId}`, {\n        html: htmlContent\n      });\n      if (response.data.success) {\n        toast.success('Lưu trang thành công!');\n      } else {\n        toast.error('Lưu trang thất bại: ' + (response.data.error || 'Lỗi không xác định'));\n      }\n    } catch (error) {\n      var _error$response, _error$response$data;\n      console.error('Lỗi khi lưu trang:', error);\n      toast.error('Lỗi khi lưu trang: ' + (((_error$response = error.response) === null || _error$response === void 0 ? void 0 : (_error$response$data = _error$response.data) === null || _error$response$data === void 0 ? void 0 : _error$response$data.error) || error.message));\n    }\n  }, [pageData, pageId]);\n\n  // Tải dữ liệu từ S3 khi chỉnh sửa\n  useEffect(() => {\n    if (!pageId) {\n      toast.error('Không tìm thấy ID trang. Vui lòng tạo trang mới từ dashboard.');\n      navigate('/pages');\n      return;\n    }\n    const fetchPageContent = async () => {\n      try {\n        const response = await api.get(`/api/pages/${pageId}/content`);\n        if (response.data.html) {\n          const parsedPageData = parseHTMLToPageData(response.data.html);\n          dispatch({\n            type: 'SET_PAGE_DATA',\n            payload: parsedPageData\n          });\n        }\n      } catch (error) {\n        var _error$response2, _error$response2$data, _error$response3;\n        console.error('Lỗi khi lấy nội dung trang:', error);\n        toast.error('Lỗi khi lấy nội dung trang: ' + (((_error$response2 = error.response) === null || _error$response2 === void 0 ? void 0 : (_error$response2$data = _error$response2.data) === null || _error$response2$data === void 0 ? void 0 : _error$response2$data.error) || error.message));\n        if (((_error$response3 = error.response) === null || _error$response3 === void 0 ? void 0 : _error$response3.status) === 401) {\n          localStorage.removeItem('token');\n          navigate('/auth');\n        } else {\n          navigate('/pages');\n        }\n      }\n    };\n    fetchPageContent();\n  }, [pageId, navigate]);\n\n  // Auto-save\n  useEffect(() => {\n    const autoSave = setTimeout(() => {\n      if (pageData.elements.length > 0) {\n        localStorage.setItem('landing-page-builder-autosave', JSON.stringify({\n          pageData,\n          viewMode,\n          zoomLevel\n        }));\n        toast.info('Đã tự động lưu!');\n      }\n    }, 30000);\n    return () => clearTimeout(autoSave);\n  }, [pageData, viewMode, zoomLevel]);\n\n  // Hotkeys\n  useHotkeys('ctrl+s', handleSave, [handleSave]);\n  useHotkeys('ctrl+z', undo, [undo]);\n  useHotkeys('ctrl+shift+z', redo, [redo]);\n  useHotkeys('ctrl+d', () => {\n    selectedIds.forEach(id => {\n      const element = pageData.elements.find(el => el.id === id);\n      if (element) {\n        addElement({\n          ...element,\n          id: `${element.id}-copy-${Date.now()}`,\n          position: {\n            desktop: {\n              x: element.position.desktop.x + 20,\n              y: element.position.desktop.y + 20\n            },\n            tablet: {\n              x: element.position.tablet.x + 20,\n              y: element.position.tablet.y + 20\n            },\n            mobile: {\n              x: element.position.mobile.x + 20,\n              y: element.position.mobile.y + 20\n            }\n          }\n        });\n      }\n    });\n  }, [selectedIds, pageData.elements, addElement]);\n  return {\n    pageData,\n    selectedIds,\n    historyIndex,\n    history,\n    viewMode,\n    zoomLevel,\n    gridSize,\n    showGrid,\n    leftSidebarCollapsed,\n    rightSidebarCollapsed,\n    addElement,\n    updatePosition,\n    updateSize,\n    deleteElement,\n    selectElement,\n    groupElements,\n    undo,\n    redo,\n    handleZoom,\n    handleSave,\n    setViewMode: mode => dispatch({\n      type: 'SET_VIEW_MODE',\n      payload: mode\n    }),\n    toggleGrid: () => dispatch({\n      type: 'TOGGLE_GRID'\n    }),\n    setGridSize: size => dispatch({\n      type: 'SET_GRID_SIZE',\n      payload: size\n    }),\n    toggleSidebar: side => dispatch({\n      type: 'TOGGLE_SIDEBAR',\n      payload: {\n        side\n      }\n    }),\n    fileInputRef\n  };\n};\n\n// Hàm renderStaticHTML (tái sử dụng từ CreateLanding)\n_s(useLandingPage, \"afxrj8HYWYEteh7NBAKf9tE6vug=\", false, function () {\n  return [useHotkeys, useHotkeys, useHotkeys, useHotkeys];\n});\nconst renderStaticHTML = pageData => {\n  let html = `\n        <!DOCTYPE html>\n        <html lang=\"vi\">\n        <head>\n            <meta charset=\"UTF-8\">\n            <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n            <title>Landing Page</title>\n            <style>\n                body { font-family: Arial, sans-serif; margin: 0; padding: 0; }\n                .page-container { position: relative; width: ${pageData.canvas.width}px; min-height: 600px; margin: 0 auto; background: ${pageData.canvas.background}; }\n            </style>\n        </head>\n        <body>\n            <div class=\"page-container\">\n    `;\n  pageData.elements.forEach(element => {\n    const {\n      type,\n      componentData,\n      position,\n      size,\n      styles,\n      children\n    } = element;\n    const positionStyles = position !== null && position !== void 0 && position.desktop ? `position: absolute; left: ${position.desktop.x}px; top: ${position.desktop.y}px;` : '';\n    const sizeStyles = size ? `width: ${size.width}px; height: ${size.height}px;` : '';\n    const cssStyles = styles ? Object.entries(styles).map(([key, value]) => `${key}: ${value};`).join(' ') : '';\n    let elementHtml = `<div style=\"${positionStyles} ${sizeStyles} ${cssStyles}\">`;\n    if (type === 'section' || type === 'container' || type === 'group') {\n      if (children && children.length > 0) {\n        children.forEach(child => {\n          const childStyles = child.styles ? Object.entries(child.styles).map(([key, value]) => `${key}: ${value};`).join(' ') : '';\n          if (child.type === 'heading') {\n            elementHtml += `<h2 style=\"${childStyles}\">${child.content || 'Tiêu đề'}</h2>`;\n          } else if (child.type === 'paragraph') {\n            elementHtml += `<p style=\"${childStyles}\">${child.content || 'Đoạn văn'}</p>`;\n          } else if (child.type === 'button') {\n            elementHtml += `<button style=\"${childStyles}\">${child.content || 'Nút'}</button>`;\n          }\n        });\n      } else {\n        elementHtml += (componentData === null || componentData === void 0 ? void 0 : componentData.content) || '';\n      }\n    } else if (type === 'heading') {\n      elementHtml += `<h2 style=\"${cssStyles}\">${(componentData === null || componentData === void 0 ? void 0 : componentData.content) || 'Tiêu đề'}</h2>`;\n    } else if (type === 'paragraph') {\n      elementHtml += `<p style=\"${cssStyles}\">${(componentData === null || componentData === void 0 ? void 0 : componentData.content) || 'Đoạn văn'}</p>`;\n    } else if (type === 'button') {\n      elementHtml += `<button style=\"${cssStyles}\">${(componentData === null || componentData === void 0 ? void 0 : componentData.content) || 'Nút'}</button>`;\n    }\n    elementHtml += `</div>`;\n    html += elementHtml;\n  });\n  html += `\n            </div>\n        </body>\n        </html>\n    `;\n  return html;\n};\nexport default useLandingPage;","map":{"version":3,"names":["useReducer","useCallback","useEffect","useRef","useHotkeys","toast","api","parse","initialState","pageData","canvas","width","height","background","elements","selectedIds","history","historyIndex","viewMode","zoomLevel","gridSize","showGrid","leftSidebarCollapsed","rightSidebarCollapsed","reducer","state","action","type","payload","slice","newElement","id","Date","now","position","desktop","tablet","mobile","newPageDataAdd","newPageDataPos","map","el","ids","includes","x","y","commit","newPageDataSize","size","newPageDataDel","filter","groupId","newPageDataGroup","children","length","side","parseHTMLToPageData","html","root","pageContainer","querySelector","console","warn","childNodes","forEach","node","index","tagName","_node$firstChild","_node$firstChild$tagN","styles","getAttribute","styleObj","split","reduce","acc","style","key","value","s","trim","parseFloat","left","top","child","push","content","textContent","parseStyles","firstChild","toLowerCase","undefined","componentData","styleString","useLandingPage","pageId","navigate","_s","dispatch","fileInputRef","addElement","element","updatePosition","updateSize","deleteElement","selectElement","groupElements","success","undo","info","redo","handleZoom","direction","Math","min","max","handleSave","error","htmlContent","renderStaticHTML","response","put","data","_error$response","_error$response$data","message","fetchPageContent","get","parsedPageData","_error$response2","_error$response2$data","_error$response3","status","localStorage","removeItem","autoSave","setTimeout","setItem","JSON","stringify","clearTimeout","find","setViewMode","mode","toggleGrid","setGridSize","toggleSidebar","positionStyles","sizeStyles","cssStyles","Object","entries","join","elementHtml","childStyles"],"sources":["F:/landinghub-iconic/apps/web/src/hooks/useLandingPage.js"],"sourcesContent":["import { useReducer, useCallback, useEffect, useRef } from 'react';\r\nimport { useHotkeys } from 'react-hotkeys-hook';\r\nimport { toast } from 'react-toastify';\r\nimport api from '@landinghub/api';\r\nimport { parse } from 'node-html-parser';\r\n\r\n// Initial state giống như trong CreateLandingPage\r\nconst initialState = {\r\n    pageData: {\r\n        canvas: { width: 1200, height: 'auto', background: '#ffffff' },\r\n        elements: [],\r\n    },\r\n    selectedIds: [],\r\n    history: [],\r\n    historyIndex: -1,\r\n    viewMode: 'desktop',\r\n    zoomLevel: 100,\r\n    gridSize: 8,\r\n    showGrid: true,\r\n    leftSidebarCollapsed: false,\r\n    rightSidebarCollapsed: false,\r\n};\r\n\r\n// Reducer giống như trong CreateLandingPage\r\nconst reducer = (state, action) => {\r\n    switch (action.type) {\r\n        case 'SET_PAGE_DATA':\r\n            return {\r\n                ...state,\r\n                pageData: action.payload,\r\n                history: [...state.history.slice(0, state.historyIndex + 1), action.payload],\r\n                historyIndex: state.historyIndex + 1,\r\n            };\r\n        case 'ADD_ELEMENT':\r\n            const newElement = {\r\n                ...action.payload,\r\n                id: `${action.payload.id}-${Date.now()}`,\r\n                position: {\r\n                    desktop: action.payload.position.desktop,\r\n                    tablet: action.payload.position.tablet,\r\n                    mobile: action.payload.position.mobile,\r\n                },\r\n            };\r\n            const newPageDataAdd = {\r\n                ...state.pageData,\r\n                elements: [...state.pageData.elements, newElement],\r\n            };\r\n            return {\r\n                ...state,\r\n                pageData: newPageDataAdd,\r\n                history: [...state.history.slice(0, state.historyIndex + 1), newPageDataAdd],\r\n                historyIndex: state.historyIndex + 1,\r\n                selectedIds: [newElement.id],\r\n            };\r\n        case 'UPDATE_POSITION':\r\n            const newPageDataPos = {\r\n                ...state.pageData,\r\n                elements: state.pageData.elements.map((el) =>\r\n                    action.payload.ids.includes(el.id)\r\n                        ? {\r\n                            ...el,\r\n                            position: {\r\n                                ...el.position,\r\n                                [state.viewMode]: {\r\n                                    x: el.position[state.viewMode].x + (action.payload.position[state.viewMode].x || 0),\r\n                                    y: el.position[state.viewMode].y + (action.payload.position[state.viewMode].y || 0),\r\n                                },\r\n                            },\r\n                        }\r\n                        : el\r\n                ),\r\n            };\r\n            return {\r\n                ...state,\r\n                pageData: newPageDataPos,\r\n                history: action.payload.commit ? [...state.history.slice(0, state.historyIndex + 1), newPageDataPos] : state.history,\r\n                historyIndex: action.payload.commit ? state.historyIndex + 1 : state.historyIndex,\r\n            };\r\n        case 'UPDATE_SIZE':\r\n            const newPageDataSize = {\r\n                ...state.pageData,\r\n                elements: state.pageData.elements.map((el) =>\r\n                    el.id === action.payload.id ? { ...el, size: action.payload.size } : el\r\n                ),\r\n            };\r\n            return {\r\n                ...state,\r\n                pageData: newPageDataSize,\r\n                history: [...state.history.slice(0, state.historyIndex + 1), newPageDataSize],\r\n                historyIndex: state.historyIndex + 1,\r\n            };\r\n        case 'DELETE_ELEMENT':\r\n            const newPageDataDel = {\r\n                ...state.pageData,\r\n                elements: state.pageData.elements.filter((el) => !action.payload.includes(el.id)),\r\n            };\r\n            return {\r\n                ...state,\r\n                pageData: newPageDataDel,\r\n                history: [...state.history.slice(0, state.historyIndex + 1), newPageDataDel],\r\n                historyIndex: state.historyIndex + 1,\r\n                selectedIds: state.selectedIds.filter((id) => !action.payload.includes(id)),\r\n            };\r\n        case 'SELECT_ELEMENT':\r\n            return { ...state, selectedIds: action.payload };\r\n        case 'GROUP_ELEMENTS':\r\n            const groupId = `group-${Date.now()}`;\r\n            const newPageDataGroup = {\r\n                ...state.pageData,\r\n                elements: [\r\n                    ...state.pageData.elements.filter((el) => !action.payload.includes(el.id)),\r\n                    {\r\n                        id: groupId,\r\n                        type: 'group',\r\n                        position: {\r\n                            desktop: { x: 0, y: 0 },\r\n                            tablet: { x: 0, y: 0 },\r\n                            mobile: { x: 0, y: 0 },\r\n                        },\r\n                        size: { width: 300, height: 200 },\r\n                        children: action.payload,\r\n                    },\r\n                ],\r\n            };\r\n            return {\r\n                ...state,\r\n                pageData: newPageDataGroup,\r\n                history: [...state.history.slice(0, state.historyIndex + 1), newPageDataGroup],\r\n                historyIndex: state.historyIndex + 1,\r\n                selectedIds: [groupId],\r\n            };\r\n        case 'UNDO':\r\n            if (state.historyIndex <= 0) return state;\r\n            return {\r\n                ...state,\r\n                pageData: state.history[state.historyIndex - 1],\r\n                historyIndex: state.historyIndex - 1,\r\n            };\r\n        case 'REDO':\r\n            if (state.historyIndex >= state.history.length - 1) return state;\r\n            return {\r\n                ...state,\r\n                pageData: state.history[state.historyIndex + 1],\r\n                historyIndex: state.historyIndex + 1,\r\n            };\r\n        case 'SET_VIEW_MODE':\r\n            return { ...state, viewMode: action.payload };\r\n        case 'SET_ZOOM':\r\n            return { ...state, zoomLevel: action.payload };\r\n        case 'TOGGLE_GRID':\r\n            return { ...state, showGrid: !state.showGrid };\r\n        case 'SET_GRID_SIZE':\r\n            return { ...state, gridSize: action.payload };\r\n        case 'TOGGLE_SIDEBAR':\r\n            return {\r\n                ...state,\r\n                [action.payload.side === 'left' ? 'leftSidebarCollapsed' : 'rightSidebarCollapsed']:\r\n                    !state[action.payload.side === 'left' ? 'leftSidebarCollapsed' : 'rightSidebarCollapsed'],\r\n            };\r\n        default:\r\n            return state;\r\n    }\r\n};\r\n\r\n// Hàm parse HTML thành pageData\r\nconst parseHTMLToPageData = (html) => {\r\n    const root = parse(html);\r\n    const pageContainer = root.querySelector('.page-container');\r\n    if (!pageContainer) {\r\n        console.warn('No .page-container found in HTML');\r\n        return initialState.pageData;\r\n    }\r\n\r\n    const elements = [];\r\n    pageContainer.childNodes.forEach((node, index) => {\r\n        if (node.tagName === 'DIV') {\r\n            const styles = node.getAttribute('style') || '';\r\n            const styleObj = styles.split(';').reduce((acc, style) => {\r\n                const [key, value] = style.split(':').map(s => s.trim());\r\n                if (key && value) acc[key] = value;\r\n                return acc;\r\n            }, {});\r\n\r\n            const position = {\r\n                desktop: { x: parseFloat(styleObj.left) || 0, y: parseFloat(styleObj.top) || 0 },\r\n                tablet: { x: parseFloat(styleObj.left) || 0, y: parseFloat(styleObj.top) || 0 },\r\n                mobile: { x: parseFloat(styleObj.left) || 0, y: parseFloat(styleObj.top) || 0 },\r\n            };\r\n            const size = {\r\n                width: parseFloat(styleObj.width) || 0,\r\n                height: parseFloat(styleObj.height) || 0,\r\n            };\r\n\r\n            let type = 'container';\r\n            let children = [];\r\n\r\n            node.childNodes.forEach((child) => {\r\n                if (child.tagName === 'H2') {\r\n                    children.push({\r\n                        id: `child-${index}-${Date.now()}`,\r\n                        type: 'heading',\r\n                        content: child.textContent,\r\n                        styles: child.getAttribute('style') ? parseStyles(child.getAttribute('style')) : {},\r\n                    });\r\n                } else if (child.tagName === 'P') {\r\n                    children.push({\r\n                        id: `child-${index}-${Date.now()}`,\r\n                        type: 'paragraph',\r\n                        content: child.textContent,\r\n                        styles: child.getAttribute('style') ? parseStyles(child.getAttribute('style')) : {},\r\n                    });\r\n                } else if (child.tagName === 'BUTTON') {\r\n                    children.push({\r\n                        id: `child-${index}-${Date.now()}`,\r\n                        type: 'button',\r\n                        content: child.textContent,\r\n                        styles: child.getAttribute('style') ? parseStyles(child.getAttribute('style')) : {},\r\n                    });\r\n                }\r\n            });\r\n\r\n            elements.push({\r\n                id: `element-${index}-${Date.now()}`,\r\n                type: children.length > 0 ? 'container' : node.firstChild?.tagName?.toLowerCase() || 'container',\r\n                position,\r\n                size,\r\n                styles: styleObj,\r\n                children: children.length > 0 ? children : undefined,\r\n                componentData: children.length === 0 ? { content: node.textContent } : undefined,\r\n            });\r\n        }\r\n    });\r\n\r\n    return {\r\n        canvas: { width: 1200, height: 'auto', background: '#ffffff' },\r\n        elements,\r\n    };\r\n};\r\n\r\nconst parseStyles = (styleString) => {\r\n    return styleString.split(';').reduce((acc, style) => {\r\n        const [key, value] = style.split(':').map(s => s.trim());\r\n        if (key && value) acc[key] = value;\r\n        return acc;\r\n    }, {});\r\n};\r\n\r\nconst useLandingPage = (pageId, navigate) => {\r\n    const [state, dispatch] = useReducer(reducer, initialState);\r\n    const fileInputRef = useRef(null);\r\n\r\n    const { pageData, selectedIds, history, historyIndex, viewMode, zoomLevel, gridSize, showGrid, leftSidebarCollapsed, rightSidebarCollapsed } = state;\r\n\r\n    const addElement = useCallback((element) => {\r\n        dispatch({ type: 'ADD_ELEMENT', payload: element });\r\n    }, []);\r\n\r\n    const updatePosition = useCallback((ids, position, commit) => {\r\n        dispatch({ type: 'UPDATE_POSITION', payload: { ids, position, commit } });\r\n    }, []);\r\n\r\n    const updateSize = useCallback((id, size) => {\r\n        dispatch({ type: 'UPDATE_SIZE', payload: { id, size } });\r\n    }, []);\r\n\r\n    const deleteElement = useCallback((ids) => {\r\n        dispatch({ type: 'DELETE_ELEMENT', payload: ids });\r\n    }, []);\r\n\r\n    const selectElement = useCallback((ids) => {\r\n        dispatch({ type: 'SELECT_ELEMENT', payload: ids });\r\n    }, []);\r\n\r\n    const groupElements = useCallback((ids) => {\r\n        dispatch({ type: 'GROUP_ELEMENTS', payload: ids });\r\n        toast.success('Đã nhóm phần tử!');\r\n    }, []);\r\n\r\n    const undo = useCallback(() => {\r\n        dispatch({ type: 'UNDO' });\r\n        toast.info('Đã hoàn tác!');\r\n    }, []);\r\n\r\n    const redo = useCallback(() => {\r\n        dispatch({ type: 'REDO' });\r\n        toast.info('Đã khôi phục!');\r\n    }, []);\r\n\r\n    const handleZoom = useCallback((direction) => {\r\n        dispatch({ type: 'SET_ZOOM', payload: direction === 'in' ? Math.min(200, zoomLevel + 10) : Math.max(50, zoomLevel - 10) });\r\n    }, [zoomLevel]);\r\n\r\n    const handleSave = useCallback(async () => {\r\n        if (!pageId) {\r\n            toast.error('Không tìm thấy ID trang. Vui lòng tạo trang mới từ dashboard.');\r\n            return;\r\n        }\r\n\r\n        try {\r\n            const htmlContent = renderStaticHTML(pageData); // Hàm renderStaticHTML từ CreateLanding\r\n            const response = await api.put(`/api/pages/${pageId}`, { html: htmlContent });\r\n            if (response.data.success) {\r\n                toast.success('Lưu trang thành công!');\r\n            } else {\r\n                toast.error('Lưu trang thất bại: ' + (response.data.error || 'Lỗi không xác định'));\r\n            }\r\n        } catch (error) {\r\n            console.error('Lỗi khi lưu trang:', error);\r\n            toast.error('Lỗi khi lưu trang: ' + (error.response?.data?.error || error.message));\r\n        }\r\n    }, [pageData, pageId]);\r\n\r\n    // Tải dữ liệu từ S3 khi chỉnh sửa\r\n    useEffect(() => {\r\n        if (!pageId) {\r\n            toast.error('Không tìm thấy ID trang. Vui lòng tạo trang mới từ dashboard.');\r\n            navigate('/pages');\r\n            return;\r\n        }\r\n\r\n        const fetchPageContent = async () => {\r\n            try {\r\n                const response = await api.get(`/api/pages/${pageId}/content`);\r\n                if (response.data.html) {\r\n                    const parsedPageData = parseHTMLToPageData(response.data.html);\r\n                    dispatch({ type: 'SET_PAGE_DATA', payload: parsedPageData });\r\n                }\r\n            } catch (error) {\r\n                console.error('Lỗi khi lấy nội dung trang:', error);\r\n                toast.error('Lỗi khi lấy nội dung trang: ' + (error.response?.data?.error || error.message));\r\n                if (error.response?.status === 401) {\r\n                    localStorage.removeItem('token');\r\n                    navigate('/auth');\r\n                } else {\r\n                    navigate('/pages');\r\n                }\r\n            }\r\n        };\r\n        fetchPageContent();\r\n    }, [pageId, navigate]);\r\n\r\n    // Auto-save\r\n    useEffect(() => {\r\n        const autoSave = setTimeout(() => {\r\n            if (pageData.elements.length > 0) {\r\n                localStorage.setItem('landing-page-builder-autosave', JSON.stringify({ pageData, viewMode, zoomLevel }));\r\n                toast.info('Đã tự động lưu!');\r\n            }\r\n        }, 30000);\r\n        return () => clearTimeout(autoSave);\r\n    }, [pageData, viewMode, zoomLevel]);\r\n\r\n    // Hotkeys\r\n    useHotkeys('ctrl+s', handleSave, [handleSave]);\r\n    useHotkeys('ctrl+z', undo, [undo]);\r\n    useHotkeys('ctrl+shift+z', redo, [redo]);\r\n    useHotkeys('ctrl+d', () => {\r\n        selectedIds.forEach((id) => {\r\n            const element = pageData.elements.find((el) => el.id === id);\r\n            if (element) {\r\n                addElement({\r\n                    ...element,\r\n                    id: `${element.id}-copy-${Date.now()}`,\r\n                    position: {\r\n                        desktop: { x: element.position.desktop.x + 20, y: element.position.desktop.y + 20 },\r\n                        tablet: { x: element.position.tablet.x + 20, y: element.position.tablet.y + 20 },\r\n                        mobile: { x: element.position.mobile.x + 20, y: element.position.mobile.y + 20 },\r\n                    },\r\n                });\r\n            }\r\n        });\r\n    }, [selectedIds, pageData.elements, addElement]);\r\n\r\n    return {\r\n        pageData,\r\n        selectedIds,\r\n        historyIndex,\r\n        history,\r\n        viewMode,\r\n        zoomLevel,\r\n        gridSize,\r\n        showGrid,\r\n        leftSidebarCollapsed,\r\n        rightSidebarCollapsed,\r\n        addElement,\r\n        updatePosition,\r\n        updateSize,\r\n        deleteElement,\r\n        selectElement,\r\n        groupElements,\r\n        undo,\r\n        redo,\r\n        handleZoom,\r\n        handleSave,\r\n        setViewMode: (mode) => dispatch({ type: 'SET_VIEW_MODE', payload: mode }),\r\n        toggleGrid: () => dispatch({ type: 'TOGGLE_GRID' }),\r\n        setGridSize: (size) => dispatch({ type: 'SET_GRID_SIZE', payload: size }),\r\n        toggleSidebar: (side) => dispatch({ type: 'TOGGLE_SIDEBAR', payload: { side } }),\r\n        fileInputRef,\r\n    };\r\n};\r\n\r\n// Hàm renderStaticHTML (tái sử dụng từ CreateLanding)\r\nconst renderStaticHTML = (pageData) => {\r\n    let html = `\r\n        <!DOCTYPE html>\r\n        <html lang=\"vi\">\r\n        <head>\r\n            <meta charset=\"UTF-8\">\r\n            <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n            <title>Landing Page</title>\r\n            <style>\r\n                body { font-family: Arial, sans-serif; margin: 0; padding: 0; }\r\n                .page-container { position: relative; width: ${pageData.canvas.width}px; min-height: 600px; margin: 0 auto; background: ${pageData.canvas.background}; }\r\n            </style>\r\n        </head>\r\n        <body>\r\n            <div class=\"page-container\">\r\n    `;\r\n    pageData.elements.forEach((element) => {\r\n        const { type, componentData, position, size, styles, children } = element;\r\n        const positionStyles = position?.desktop ? `position: absolute; left: ${position.desktop.x}px; top: ${position.desktop.y}px;` : '';\r\n        const sizeStyles = size ? `width: ${size.width}px; height: ${size.height}px;` : '';\r\n        const cssStyles = styles ? Object.entries(styles).map(([key, value]) => `${key}: ${value};`).join(' ') : '';\r\n        let elementHtml = `<div style=\"${positionStyles} ${sizeStyles} ${cssStyles}\">`;\r\n\r\n        if (type === 'section' || type === 'container' || type === 'group') {\r\n            if (children && children.length > 0) {\r\n                children.forEach((child) => {\r\n                    const childStyles = child.styles ? Object.entries(child.styles).map(([key, value]) => `${key}: ${value};`).join(' ') : '';\r\n                    if (child.type === 'heading') {\r\n                        elementHtml += `<h2 style=\"${childStyles}\">${child.content || 'Tiêu đề'}</h2>`;\r\n                    } else if (child.type === 'paragraph') {\r\n                        elementHtml += `<p style=\"${childStyles}\">${child.content || 'Đoạn văn'}</p>`;\r\n                    } else if (child.type === 'button') {\r\n                        elementHtml += `<button style=\"${childStyles}\">${child.content || 'Nút'}</button>`;\r\n                    }\r\n                });\r\n            } else {\r\n                elementHtml += componentData?.content || '';\r\n            }\r\n        } else if (type === 'heading') {\r\n            elementHtml += `<h2 style=\"${cssStyles}\">${componentData?.content || 'Tiêu đề'}</h2>`;\r\n        } else if (type === 'paragraph') {\r\n            elementHtml += `<p style=\"${cssStyles}\">${componentData?.content || 'Đoạn văn'}</p>`;\r\n        } else if (type === 'button') {\r\n            elementHtml += `<button style=\"${cssStyles}\">${componentData?.content || 'Nút'}</button>`;\r\n        }\r\n        elementHtml += `</div>`;\r\n        html += elementHtml;\r\n    });\r\n    html += `\r\n            </div>\r\n        </body>\r\n        </html>\r\n    `;\r\n    return html;\r\n};\r\n\r\nexport default useLandingPage;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}