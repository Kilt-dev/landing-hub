{"ast":null,"code":"var _jsxFileName = \"F:\\\\landinghub-iconic\\\\apps\\\\web\\\\src\\\\components\\\\create-page\\\\Canvas.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$(),\n  _s3 = $RefreshSig$();\nimport React, { useRef, useMemo, useCallback, useState } from 'react';\nimport { useDrop, useDrag } from 'react-dnd';\nimport { useHotkeys } from 'react-hotkeys-hook';\nimport { toast } from 'react-toastify';\nimport QuickEditToolkit from './QuickEditToolkit';\nimport '../../styles/CreateLanding.css';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst ItemTypes = {\n  SECTION: 'section',\n  ELEMENT: 'element',\n  EXISTING_ELEMENT: 'existingElement'\n};\nconst Element = /*#__PURE__*/_s(/*#__PURE__*/React.memo(_c = _s(({\n  component,\n  index,\n  isSelected,\n  onSelectElement,\n  handleElementHover,\n  onDuplicateElement,\n  onDeleteElement,\n  onMoveElement,\n  updatePosition,\n  canvasRef,\n  sectionId,\n  onInlineEdit,\n  pageStructure,\n  zoomLevel,\n  viewMode\n}) => {\n  var _component$json$style, _component$json$style2, _component$json$style3, _component$json$style4, _component$json$style5;\n  _s();\n  const [{\n    isDragging\n  }, drag] = useDrag(() => ({\n    type: ItemTypes.EXISTING_ELEMENT,\n    item: {\n      id: component.id,\n      sectionId,\n      json: component.json\n    },\n    end: (item, monitor) => {\n      const clientOffset = monitor.getClientOffset();\n      if (clientOffset && canvasRef.current && sectionId && monitor.didDrop()) {\n        var _document$getElementB, _pageStructure$childr;\n        const sectionRect = (_document$getElementB = document.getElementById(sectionId)) === null || _document$getElementB === void 0 ? void 0 : _document$getElementB.getBoundingClientRect();\n        if (!sectionRect) return;\n        const newX = Math.round((clientOffset.x - sectionRect.left) / (zoomLevel / 100) / 10) * 10;\n        const newY = Math.round((clientOffset.y - sectionRect.top) / (zoomLevel / 100) / 10) * 10;\n        const section = pageStructure === null || pageStructure === void 0 ? void 0 : (_pageStructure$childr = pageStructure.children) === null || _pageStructure$childr === void 0 ? void 0 : _pageStructure$childr.find(s => s.id === sectionId);\n        let adjustedY = newY;\n        if (section) {\n          section.elements.forEach(el => {\n            if (el.id !== component.id) {\n              var _el$json$styles, _el$json$styles$viewM, _el$json$styles2, _el$json$styles2$view;\n              const elX = ((_el$json$styles = el.json.styles) === null || _el$json$styles === void 0 ? void 0 : (_el$json$styles$viewM = _el$json$styles[viewMode]) === null || _el$json$styles$viewM === void 0 ? void 0 : _el$json$styles$viewM.left) || 0;\n              const elY = ((_el$json$styles2 = el.json.styles) === null || _el$json$styles2 === void 0 ? void 0 : (_el$json$styles2$view = _el$json$styles2[viewMode]) === null || _el$json$styles2$view === void 0 ? void 0 : _el$json$styles2$view.top) || 0;\n              if (Math.abs(newX - elX) < 50 && Math.abs(newY - elY) < 50) {\n                adjustedY = elY + 20;\n              }\n            }\n          });\n        }\n        updatePosition(component.id, sectionId, {\n          desktop: {\n            left: newX,\n            top: adjustedY\n          },\n          mobile: {\n            left: Math.round(newX / 2),\n            top: Math.round(adjustedY / 2)\n          }\n        });\n      }\n    },\n    collect: monitor => ({\n      isDragging: !!monitor.isDragging()\n    })\n  }));\n  const handleMouseDown = e => {\n    e.stopPropagation();\n    onSelectElement(component);\n  };\n  const handleInlineEdit = e => {\n    if (onInlineEdit && e.target.contentEditable === 'true') {\n      onInlineEdit(component.id, sectionId, e.target.innerText);\n    }\n  };\n  const renderContent = () => {\n    var _styles$viewMode, _styles$viewMode2, _styles$viewMode3, _styles$viewMode4, _componentData$images, _componentData$images2;\n    const {\n      type,\n      componentData = {},\n      styles = {\n        desktop: {},\n        mobile: {}\n      },\n      children = []\n    } = component.json || {};\n    const containerStyle = {\n      ...(styles[viewMode] || {}),\n      position: 'absolute',\n      left: ((_styles$viewMode = styles[viewMode]) === null || _styles$viewMode === void 0 ? void 0 : _styles$viewMode.left) || 0,\n      top: ((_styles$viewMode2 = styles[viewMode]) === null || _styles$viewMode2 === void 0 ? void 0 : _styles$viewMode2.top) || 0,\n      maxWidth: '100%',\n      boxSizing: 'border-box',\n      transform: isSelected ? 'translate(-2px, -2px)' : 'none',\n      width: ((_styles$viewMode3 = styles[viewMode]) === null || _styles$viewMode3 === void 0 ? void 0 : _styles$viewMode3.width) || 'auto',\n      height: ((_styles$viewMode4 = styles[viewMode]) === null || _styles$viewMode4 === void 0 ? void 0 : _styles$viewMode4.height) || 'auto'\n    };\n    const renderChildren = () => {\n      return children.map((child, idx) => /*#__PURE__*/_jsxDEV(Element, {\n        component: {\n          id: child.id,\n          json: child\n        },\n        index: idx,\n        isSelected: isSelected && component.id === child.id,\n        onSelectElement: onSelectElement,\n        handleElementHover: handleElementHover,\n        onDuplicateElement: onDuplicateElement,\n        onDeleteElement: onDeleteElement,\n        onMoveElement: onMoveElement,\n        updatePosition: updatePosition,\n        canvasRef: canvasRef,\n        sectionId: sectionId,\n        onInlineEdit: onInlineEdit,\n        pageStructure: pageStructure,\n        zoomLevel: zoomLevel,\n        viewMode: viewMode\n      }, child.id, false, {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 21\n      }, this));\n    };\n    switch (type) {\n      case 'form':\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          style: containerStyle,\n          className: \"lpb-form-container\",\n          children: /*#__PURE__*/_jsxDEV(\"form\", {\n            onSubmit: e => e.preventDefault(),\n            onMouseDown: e => e.stopPropagation(),\n            children: [renderChildren(), /*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"submit\",\n              style: {\n                marginTop: '8px',\n                ...styles[viewMode]\n              },\n              onMouseDown: e => e.stopPropagation(),\n              children: \"Submit\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 122,\n              columnNumber: 33\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 120,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 119,\n          columnNumber: 25\n        }, this);\n      case 'button-group':\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          style: containerStyle,\n          className: \"lpb-button-group-container\",\n          children: renderChildren()\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 134,\n          columnNumber: 25\n        }, this);\n      case 'gallery':\n      case 'carousel':\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          style: containerStyle,\n          className: \"lpb-gallery-container\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              display: type === 'carousel' ? 'flex' : 'flex',\n              flexWrap: type === 'gallery' ? 'wrap' : 'nowrap',\n              gap: '10px'\n            },\n            children: renderChildren()\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 142,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 141,\n          columnNumber: 25\n        }, this);\n      case 'heading':\n        return /*#__PURE__*/_jsxDEV(\"h2\", {\n          style: containerStyle,\n          contentEditable: true,\n          suppressContentEditableWarning: true,\n          onBlur: handleInlineEdit,\n          onMouseDown: e => e.stopPropagation(),\n          children: componentData.content || 'Tiêu đề'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 149,\n          columnNumber: 25\n        }, this);\n      case 'paragraph':\n        return /*#__PURE__*/_jsxDEV(\"p\", {\n          style: containerStyle,\n          contentEditable: true,\n          suppressContentEditableWarning: true,\n          onBlur: handleInlineEdit,\n          onMouseDown: e => e.stopPropagation(),\n          children: componentData.content || 'Đoạn văn'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 161,\n          columnNumber: 25\n        }, this);\n      case 'button':\n        return /*#__PURE__*/_jsxDEV(\"button\", {\n          style: containerStyle,\n          contentEditable: true,\n          suppressContentEditableWarning: true,\n          onBlur: handleInlineEdit,\n          onMouseDown: e => e.stopPropagation(),\n          children: componentData.content || 'Nút'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 173,\n          columnNumber: 25\n        }, this);\n      case 'image':\n        return /*#__PURE__*/_jsxDEV(\"img\", {\n          src: componentData.src || ((_componentData$images = componentData.images) === null || _componentData$images === void 0 ? void 0 : (_componentData$images2 = _componentData$images[0]) === null || _componentData$images2 === void 0 ? void 0 : _componentData$images2.src) || 'https://via.placeholder.com/150',\n          alt: componentData.alt || 'Image',\n          style: containerStyle\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 185,\n          columnNumber: 25\n        }, this);\n      case 'input':\n        return /*#__PURE__*/_jsxDEV(\"input\", {\n          type: componentData.type || 'text',\n          placeholder: componentData.label || 'Input',\n          style: {\n            ...containerStyle,\n            width: '100%'\n          },\n          onMouseDown: e => e.stopPropagation()\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 193,\n          columnNumber: 25\n        }, this);\n      case 'textarea':\n        return /*#__PURE__*/_jsxDEV(\"textarea\", {\n          placeholder: componentData.label || 'Textarea',\n          style: {\n            ...containerStyle,\n            width: '100%'\n          },\n          onMouseDown: e => e.stopPropagation()\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 202,\n          columnNumber: 25\n        }, this);\n      case 'popup':\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          style: containerStyle,\n          className: \"lpb-popup-container\",\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            children: componentData.content || 'Popup nội dung'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 211,\n            columnNumber: 29\n          }, this), renderChildren()]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 210,\n          columnNumber: 25\n        }, this);\n      default:\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          style: containerStyle,\n          className: \"lpb-container\",\n          children: [componentData.title || componentData.content || 'Unknown', renderChildren()]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 217,\n          columnNumber: 25\n        }, this);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    ref: drag,\n    \"data-id\": component.id,\n    className: `lpb-canvas-element ${isSelected ? 'lpb-canvas-element-selected' : ''} ${isDragging ? 'lpb-canvas-element-dragging' : ''}`,\n    onMouseEnter: e => handleElementHover(e, component),\n    onMouseDown: handleMouseDown,\n    style: {\n      position: 'absolute',\n      left: ((_component$json$style = component.json.styles) === null || _component$json$style === void 0 ? void 0 : (_component$json$style2 = _component$json$style[viewMode]) === null || _component$json$style2 === void 0 ? void 0 : _component$json$style2.left) || 0,\n      top: ((_component$json$style3 = component.json.styles) === null || _component$json$style3 === void 0 ? void 0 : (_component$json$style4 = _component$json$style3[viewMode]) === null || _component$json$style4 === void 0 ? void 0 : _component$json$style4.top) || 0,\n      zIndex: isSelected ? 10 : 1,\n      boxSizing: 'border-box',\n      ...(((_component$json$style5 = component.json.styles) === null || _component$json$style5 === void 0 ? void 0 : _component$json$style5[viewMode]) || {})\n    },\n    children: renderContent()\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 226,\n    columnNumber: 13\n  }, this);\n}, \"wuumsFp4qAni9XRJfRhQAZjuD/k=\", false, function () {\n  return [useDrag];\n})), \"wuumsFp4qAni9XRJfRhQAZjuD/k=\", false, function () {\n  return [useDrag];\n});\n_c2 = Element;\nconst Section = /*#__PURE__*/_s2(/*#__PURE__*/React.memo(_c3 = _s2(({\n  section,\n  index,\n  selectedElement,\n  onSelectElement,\n  handleElementHover,\n  onDuplicateElement,\n  onDeleteElement,\n  onMoveElement,\n  updatePosition,\n  addElement,\n  canvasRef,\n  moveElement,\n  onInlineEdit,\n  onSelectSection,\n  viewMode,\n  pageStructure,\n  zoomLevel\n}) => {\n  var _section$json$styles, _section$json$styles$, _section$json$styles2, _section$json$styles3, _section$json$styles4, _section$json$styles5, _section$json$styles6, _section$json$styles7, _section$json$styles8, _section$json$styles9, _section$json$styles0, _section$json$styles1, _section$json$compone;\n  _s2();\n  const [{\n    isOver\n  }, drop] = useDrop(() => ({\n    accept: [ItemTypes.ELEMENT, ItemTypes.EXISTING_ELEMENT],\n    hover: (item, monitor) => {\n      if (!monitor.isOver({\n        shallow: true\n      })) return;\n      const clientOffset = monitor.getClientOffset();\n      if (clientOffset && canvasRef.current) {\n        var _document$getElementB2;\n        const sectionRect = (_document$getElementB2 = document.getElementById(section.id)) === null || _document$getElementB2 === void 0 ? void 0 : _document$getElementB2.getBoundingClientRect();\n        if (!sectionRect) return;\n        item.dropPosition = {\n          left: Math.round((clientOffset.x - sectionRect.left) / (zoomLevel / 100) / 10) * 10,\n          top: Math.round((clientOffset.y - sectionRect.top) / (zoomLevel / 100) / 10) * 10\n        };\n      }\n    },\n    drop: (item, monitor) => {\n      var _document$getElementB3;\n      const clientOffset = monitor.getClientOffset();\n      if (!clientOffset || !canvasRef.current) {\n        toast.error('Không thể xác định vị trí thả. Vui lòng thử lại!');\n        return;\n      }\n      const sectionRect = (_document$getElementB3 = document.getElementById(section.id)) === null || _document$getElementB3 === void 0 ? void 0 : _document$getElementB3.getBoundingClientRect();\n      if (!sectionRect) {\n        toast.error('Không tìm thấy section!');\n        return;\n      }\n      let position = {\n        left: Math.round((clientOffset.x - sectionRect.left) / (zoomLevel / 100) / 10) * 10,\n        top: Math.round((clientOffset.y - sectionRect.top) / (zoomLevel / 100) / 10) * 10\n      };\n      const sectionElements = section.elements || [];\n      sectionElements.forEach(el => {\n        var _item$json;\n        if (el.id !== (item.id || ((_item$json = item.json) === null || _item$json === void 0 ? void 0 : _item$json.id))) {\n          var _el$json$styles3, _el$json$styles3$view, _el$json$styles4, _el$json$styles4$view;\n          const elLeft = ((_el$json$styles3 = el.json.styles) === null || _el$json$styles3 === void 0 ? void 0 : (_el$json$styles3$view = _el$json$styles3[viewMode]) === null || _el$json$styles3$view === void 0 ? void 0 : _el$json$styles3$view.left) || 0;\n          const elTop = ((_el$json$styles4 = el.json.styles) === null || _el$json$styles4 === void 0 ? void 0 : (_el$json$styles4$view = _el$json$styles4[viewMode]) === null || _el$json$styles4$view === void 0 ? void 0 : _el$json$styles4$view.top) || 0;\n          if (Math.abs(position.left - elLeft) < 50 && Math.abs(position.top - elTop) < 50) {\n            position.top = elTop + 20;\n          }\n        }\n      });\n      if (item.json) {\n        addElement(section.id, {\n          id: item.id,\n          json: {\n            ...item.json,\n            styles: {\n              desktop: {\n                ...item.json.styles.desktop,\n                left: position.left,\n                top: position.top\n              },\n              mobile: {\n                ...item.json.styles.mobile,\n                left: Math.round(position.left / 2),\n                top: Math.round(position.top / 2)\n              }\n            }\n          }\n        }, section.elements.length);\n        toast.success('Đã thêm phần tử vào section!');\n      } else if (item.id) {\n        updatePosition(item.id, section.id, {\n          desktop: {\n            left: position.left,\n            top: position.top\n          },\n          mobile: {\n            left: Math.round(position.left / 2),\n            top: Math.round(position.top / 2)\n          }\n        });\n        moveElement(section.id, item.id, section.elements.length);\n        toast.success('Đã di chuyển phần tử!');\n      } else {\n        toast.error('Dữ liệu thả không hợp lệ!');\n      }\n    },\n    collect: monitor => ({\n      isOver: !!monitor.isOver()\n    })\n  }));\n  const handleSectionClick = e => {\n    e.stopPropagation();\n    onSelectSection(section);\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    ref: drop,\n    id: section.id,\n    className: `lpb-canvas-section ${isOver ? 'lpb-canvas-section-over' : ''} ${(selectedElement === null || selectedElement === void 0 ? void 0 : selectedElement.id) === section.id ? 'lpb-canvas-section-selected' : ''}`,\n    style: {\n      width: ((_section$json$styles = section.json.styles) === null || _section$json$styles === void 0 ? void 0 : (_section$json$styles$ = _section$json$styles[viewMode]) === null || _section$json$styles$ === void 0 ? void 0 : _section$json$styles$.width) || '1200px',\n      height: ((_section$json$styles2 = section.json.styles) === null || _section$json$styles2 === void 0 ? void 0 : (_section$json$styles3 = _section$json$styles2[viewMode]) === null || _section$json$styles3 === void 0 ? void 0 : _section$json$styles3.height) || 'auto',\n      minHeight: ((_section$json$styles4 = section.json.styles) === null || _section$json$styles4 === void 0 ? void 0 : (_section$json$styles5 = _section$json$styles4[viewMode]) === null || _section$json$styles5 === void 0 ? void 0 : _section$json$styles5.minHeight) || '200px',\n      position: 'relative',\n      margin: '0 auto 20px auto',\n      border: ((_section$json$styles6 = section.json.styles) === null || _section$json$styles6 === void 0 ? void 0 : (_section$json$styles7 = _section$json$styles6[viewMode]) === null || _section$json$styles7 === void 0 ? void 0 : _section$json$styles7.border) || '1px solid #ddd',\n      padding: ((_section$json$styles8 = section.json.styles) === null || _section$json$styles8 === void 0 ? void 0 : (_section$json$styles9 = _section$json$styles8[viewMode]) === null || _section$json$styles9 === void 0 ? void 0 : _section$json$styles9.padding) || '20px',\n      boxSizing: 'border-box',\n      background: ((_section$json$styles0 = section.json.styles) === null || _section$json$styles0 === void 0 ? void 0 : (_section$json$styles1 = _section$json$styles0[viewMode]) === null || _section$json$styles1 === void 0 ? void 0 : _section$json$styles1.background) || '#ffffff'\n    },\n    onMouseDown: handleSectionClick,\n    children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n      children: ((_section$json$compone = section.json.componentData) === null || _section$json$compone === void 0 ? void 0 : _section$json$compone.title) || 'Section'\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 360,\n      columnNumber: 17\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"lpb-canvas-section-content\",\n      children: (section.elements || []).map((element, idx) => /*#__PURE__*/_jsxDEV(Element, {\n        component: element,\n        index: idx,\n        isSelected: (selectedElement === null || selectedElement === void 0 ? void 0 : selectedElement.id) === element.id,\n        onSelectElement: onSelectElement,\n        handleElementHover: handleElementHover,\n        onDuplicateElement: onDuplicateElement,\n        onDeleteElement: onDeleteElement,\n        onMoveElement: onMoveElement,\n        updatePosition: updatePosition,\n        canvasRef: canvasRef,\n        sectionId: section.id,\n        onInlineEdit: onInlineEdit,\n        pageStructure: pageStructure,\n        zoomLevel: zoomLevel,\n        viewMode: viewMode\n      }, element.id, false, {\n        fileName: _jsxFileName,\n        lineNumber: 363,\n        columnNumber: 25\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 361,\n      columnNumber: 17\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 343,\n    columnNumber: 13\n  }, this);\n}, \"9166pYLrZ/JzF75YDim8ZjfICTM=\", false, function () {\n  return [useDrop];\n})), \"9166pYLrZ/JzF75YDim8ZjfICTM=\", false, function () {\n  return [useDrop];\n});\n_c4 = Section;\nconst Canvas = /*#__PURE__*/_s3(/*#__PURE__*/React.memo(_c5 = _s3(({\n  pageStructure,\n  selectedElement,\n  onSelectElement,\n  quickEditElement,\n  quickEditPosition,\n  onQuickEdit,\n  onCloseQuickEdit,\n  onDuplicateElement,\n  onDeleteElement,\n  onMoveElement,\n  viewMode,\n  addSection,\n  addElement,\n  moveElement,\n  ItemTypes,\n  zoomLevel,\n  setPageStructure,\n  updatePosition,\n  onInlineEdit\n}) => {\n  var _pageStructure$styles, _pageStructure$styles2, _pageStructure$styles3, _pageStructure$styles4, _pageStructure$styles5, _pageStructure$styles6;\n  _s3();\n  const canvasRef = useRef(null);\n  const [dropIndex, setDropIndex] = useState(null);\n  const [{\n    isOver\n  }, drop] = useDrop(() => ({\n    accept: [ItemTypes.SECTION],\n    hover: (item, monitor) => {\n      if (!monitor.isOver({\n        shallow: true\n      })) return;\n      const clientOffset = monitor.getClientOffset();\n      if (clientOffset && canvasRef.current) {\n        var _pageStructure$childr2;\n        const rect = canvasRef.current.getBoundingClientRect();\n        const y = clientOffset.y - rect.top;\n        const index = Math.min((pageStructure === null || pageStructure === void 0 ? void 0 : (_pageStructure$childr2 = pageStructure.children) === null || _pageStructure$childr2 === void 0 ? void 0 : _pageStructure$childr2.length) || 0, Math.floor(y / 200));\n        setDropIndex(index);\n      }\n    },\n    drop: (item, monitor) => {\n      var _pageStructure$childr3;\n      const clientOffset = monitor.getClientOffset();\n      if (!clientOffset || !canvasRef.current) {\n        toast.error('Không thể xác định vị trí thả. Vui lòng thử lại!');\n        return;\n      }\n      if (!item.json || !item.json.styles) {\n        toast.error('Dữ liệu thả không hợp lệ!');\n        return;\n      }\n      const rect = canvasRef.current.getBoundingClientRect();\n      const index = Math.min((pageStructure === null || pageStructure === void 0 ? void 0 : (_pageStructure$childr3 = pageStructure.children) === null || _pageStructure$childr3 === void 0 ? void 0 : _pageStructure$childr3.length) || 0, Math.floor((clientOffset.y - rect.top) / 200));\n      addSection({\n        id: item.id,\n        json: {\n          ...item.json,\n          styles: {\n            desktop: {\n              ...item.json.styles.desktop,\n              width: item.json.styles.desktop.width || '1200px',\n              minHeight: item.json.styles.desktop.minHeight || '200px'\n            },\n            mobile: {\n              ...item.json.styles.mobile,\n              width: item.json.styles.mobile.width || '100%',\n              minHeight: item.json.styles.mobile.minHeight || '150px'\n            }\n          }\n        },\n        elements: []\n      }, index);\n      toast.success('Đã thêm section mới!');\n      setDropIndex(null);\n    },\n    collect: monitor => ({\n      isOver: !!monitor.isOver()\n    })\n  }));\n  const handleElementHover = useCallback((e, component) => {\n    var _canvasRef$current;\n    if ((quickEditElement === null || quickEditElement === void 0 ? void 0 : quickEditElement.id) === component.id) return;\n    const rect = e.currentTarget.getBoundingClientRect();\n    const canvasRect = ((_canvasRef$current = canvasRef.current) === null || _canvasRef$current === void 0 ? void 0 : _canvasRef$current.getBoundingClientRect()) || {\n      left: 0,\n      top: 0\n    };\n    onQuickEdit(component, {\n      left: (rect.left - canvasRect.left) / (zoomLevel / 100),\n      top: (rect.top - canvasRect.top + 20) / (zoomLevel / 100)\n    });\n  }, [quickEditElement, onQuickEdit, zoomLevel]);\n  const handleSelectSection = useCallback(section => {\n    onSelectElement(section);\n  }, [onSelectElement]);\n  useHotkeys('delete', () => {\n    if (selectedElement) {\n      onDeleteElement(selectedElement);\n    }\n  }, [selectedElement, onDeleteElement]);\n  if (!pageStructure || !pageStructure.children) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"lpb-canvas-wrapper\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        ref: node => {\n          canvasRef.current = node;\n          drop(node);\n        },\n        className: `lpb-canvas ${viewMode === 'mobile' ? 'lpb-canvas-mobile' : viewMode === 'tablet' ? 'lpb-canvas-tablet' : ''}`,\n        onMouseLeave: onCloseQuickEdit,\n        style: {\n          zoom: `${zoomLevel / 100}`,\n          position: 'relative',\n          minHeight: '600px',\n          background: '#f9fafb'\n        },\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"lpb-canvas-content\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"lpb-canvas-empty-state\",\n            children: [/*#__PURE__*/_jsxDEV(\"i\", {\n              className: \"fas fa-layer-group\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 508,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: \"K\\xE9o th\\u1EA3 section \\u0111\\u1EC3 b\\u1EAFt \\u0111\\u1EA7u\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 509,\n              columnNumber: 33\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 507,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 506,\n          columnNumber: 25\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 492,\n        columnNumber: 21\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 491,\n      columnNumber: 17\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"lpb-canvas-wrapper\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      ref: node => {\n        canvasRef.current = node;\n        drop(node);\n      },\n      className: `lpb-canvas ${viewMode === 'mobile' ? 'lpb-canvas-mobile' : viewMode === 'tablet' ? 'lpb-canvas-tablet' : ''}`,\n      onMouseLeave: onCloseQuickEdit,\n      style: {\n        zoom: `${zoomLevel / 100}`,\n        position: 'relative',\n        minHeight: ((_pageStructure$styles = pageStructure.styles) === null || _pageStructure$styles === void 0 ? void 0 : (_pageStructure$styles2 = _pageStructure$styles[viewMode]) === null || _pageStructure$styles2 === void 0 ? void 0 : _pageStructure$styles2.minHeight) || '600px',\n        background: ((_pageStructure$styles3 = pageStructure.styles) === null || _pageStructure$styles3 === void 0 ? void 0 : (_pageStructure$styles4 = _pageStructure$styles3[viewMode]) === null || _pageStructure$styles4 === void 0 ? void 0 : _pageStructure$styles4.background) || '#f9fafb'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"lpb-canvas-content\",\n        children: pageStructure.children.length === 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"lpb-canvas-empty-state\",\n          children: [/*#__PURE__*/_jsxDEV(\"i\", {\n            className: \"fas fa-layer-group\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 536,\n            columnNumber: 33\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"K\\xE9o th\\u1EA3 section \\u0111\\u1EC3 b\\u1EAFt \\u0111\\u1EA7u\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 537,\n            columnNumber: 33\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 535,\n          columnNumber: 29\n        }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [pageStructure.children.map((section, index) => {\n            var _section$json$styles10, _section$json$styles11;\n            return /*#__PURE__*/_jsxDEV(React.Fragment, {\n              children: [dropIndex === index && /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"lpb-canvas-drop-zone\",\n                style: {\n                  height: '50px',\n                  background: 'rgba(0, 128, 255, 0.1)',\n                  border: '2px dashed #0080ff',\n                  margin: '10px auto',\n                  width: ((_section$json$styles10 = section.json.styles) === null || _section$json$styles10 === void 0 ? void 0 : (_section$json$styles11 = _section$json$styles10[viewMode]) === null || _section$json$styles11 === void 0 ? void 0 : _section$json$styles11.width) || '1200px'\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 544,\n                columnNumber: 45\n              }, this), /*#__PURE__*/_jsxDEV(Section, {\n                section: section,\n                index: index,\n                selectedElement: selectedElement,\n                onSelectElement: onSelectElement,\n                handleElementHover: handleElementHover,\n                onDuplicateElement: onDuplicateElement,\n                onDeleteElement: onDeleteElement,\n                onMoveElement: onMoveElement,\n                updatePosition: updatePosition,\n                addElement: addElement,\n                canvasRef: canvasRef,\n                moveElement: moveElement,\n                onInlineEdit: onInlineEdit,\n                onSelectSection: handleSelectSection,\n                viewMode: viewMode,\n                pageStructure: pageStructure,\n                zoomLevel: zoomLevel\n              }, section.id, false, {\n                fileName: _jsxFileName,\n                lineNumber: 555,\n                columnNumber: 41\n              }, this)]\n            }, section.id, true, {\n              fileName: _jsxFileName,\n              lineNumber: 542,\n              columnNumber: 37\n            }, this);\n          }), dropIndex === pageStructure.children.length && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"lpb-canvas-drop-zone\",\n            style: {\n              height: '50px',\n              background: 'rgba(0, 128, 255, 0.1)',\n              border: '2px dashed #0080ff',\n              margin: '10px auto',\n              width: ((_pageStructure$styles5 = pageStructure.styles) === null || _pageStructure$styles5 === void 0 ? void 0 : (_pageStructure$styles6 = _pageStructure$styles5[viewMode]) === null || _pageStructure$styles6 === void 0 ? void 0 : _pageStructure$styles6.width) || '1200px'\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 578,\n            columnNumber: 37\n          }, this)]\n        }, void 0, true)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 533,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(QuickEditToolkit, {\n        element: quickEditElement,\n        position: quickEditPosition,\n        onEdit: () => onSelectElement(quickEditElement),\n        onDuplicate: () => onDuplicateElement(quickEditElement),\n        onDelete: () => onDeleteElement(quickEditElement),\n        onMoveUp: () => onMoveElement(quickEditElement, 'up'),\n        onMoveDown: () => onMoveElement(quickEditElement, 'down'),\n        onClose: onCloseQuickEdit\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 592,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 519,\n      columnNumber: 17\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 518,\n    columnNumber: 13\n  }, this);\n}, \"scAB/rDIK+1X1cBUTb+EobmliG0=\", false, function () {\n  return [useDrop, useHotkeys];\n})), \"scAB/rDIK+1X1cBUTb+EobmliG0=\", false, function () {\n  return [useDrop, useHotkeys];\n});\n_c6 = Canvas;\nexport default Canvas;\nvar _c, _c2, _c3, _c4, _c5, _c6;\n$RefreshReg$(_c, \"Element$React.memo\");\n$RefreshReg$(_c2, \"Element\");\n$RefreshReg$(_c3, \"Section$React.memo\");\n$RefreshReg$(_c4, \"Section\");\n$RefreshReg$(_c5, \"Canvas$React.memo\");\n$RefreshReg$(_c6, \"Canvas\");","map":{"version":3,"names":["React","useRef","useMemo","useCallback","useState","useDrop","useDrag","useHotkeys","toast","QuickEditToolkit","jsxDEV","_jsxDEV","Fragment","_Fragment","ItemTypes","SECTION","ELEMENT","EXISTING_ELEMENT","Element","_s","memo","_c","component","index","isSelected","onSelectElement","handleElementHover","onDuplicateElement","onDeleteElement","onMoveElement","updatePosition","canvasRef","sectionId","onInlineEdit","pageStructure","zoomLevel","viewMode","_component$json$style","_component$json$style2","_component$json$style3","_component$json$style4","_component$json$style5","isDragging","drag","type","item","id","json","end","monitor","clientOffset","getClientOffset","current","didDrop","_document$getElementB","_pageStructure$childr","sectionRect","document","getElementById","getBoundingClientRect","newX","Math","round","x","left","newY","y","top","section","children","find","s","adjustedY","elements","forEach","el","_el$json$styles","_el$json$styles$viewM","_el$json$styles2","_el$json$styles2$view","elX","styles","elY","abs","desktop","mobile","collect","handleMouseDown","e","stopPropagation","handleInlineEdit","target","contentEditable","innerText","renderContent","_styles$viewMode","_styles$viewMode2","_styles$viewMode3","_styles$viewMode4","_componentData$images","_componentData$images2","componentData","containerStyle","position","maxWidth","boxSizing","transform","width","height","renderChildren","map","child","idx","fileName","_jsxFileName","lineNumber","columnNumber","style","className","onSubmit","preventDefault","onMouseDown","marginTop","display","flexWrap","gap","suppressContentEditableWarning","onBlur","content","src","images","alt","placeholder","label","title","ref","onMouseEnter","zIndex","_c2","Section","_s2","_c3","selectedElement","addElement","moveElement","onSelectSection","_section$json$styles","_section$json$styles$","_section$json$styles2","_section$json$styles3","_section$json$styles4","_section$json$styles5","_section$json$styles6","_section$json$styles7","_section$json$styles8","_section$json$styles9","_section$json$styles0","_section$json$styles1","_section$json$compone","isOver","drop","accept","hover","shallow","_document$getElementB2","dropPosition","_document$getElementB3","error","sectionElements","_item$json","_el$json$styles3","_el$json$styles3$view","_el$json$styles4","_el$json$styles4$view","elLeft","elTop","length","success","handleSectionClick","minHeight","margin","border","padding","background","element","_c4","Canvas","_s3","_c5","quickEditElement","quickEditPosition","onQuickEdit","onCloseQuickEdit","addSection","setPageStructure","_pageStructure$styles","_pageStructure$styles2","_pageStructure$styles3","_pageStructure$styles4","_pageStructure$styles5","_pageStructure$styles6","dropIndex","setDropIndex","_pageStructure$childr2","rect","min","floor","_pageStructure$childr3","_canvasRef$current","currentTarget","canvasRect","handleSelectSection","node","onMouseLeave","zoom","_section$json$styles10","_section$json$styles11","onEdit","onDuplicate","onDelete","onMoveUp","onMoveDown","onClose","_c6","$RefreshReg$"],"sources":["F:/landinghub-iconic/apps/web/src/components/create-page/Canvas.js"],"sourcesContent":["import React, { useRef, useMemo, useCallback, useState } from 'react';\r\nimport { useDrop, useDrag } from 'react-dnd';\r\nimport { useHotkeys } from 'react-hotkeys-hook';\r\nimport { toast } from 'react-toastify';\r\nimport QuickEditToolkit from './QuickEditToolkit';\r\nimport '../../styles/CreateLanding.css';\r\n\r\nconst ItemTypes = {\r\n    SECTION: 'section',\r\n    ELEMENT: 'element',\r\n    EXISTING_ELEMENT: 'existingElement',\r\n};\r\n\r\nconst Element = React.memo(\r\n    ({\r\n         component,\r\n         index,\r\n         isSelected,\r\n         onSelectElement,\r\n         handleElementHover,\r\n         onDuplicateElement,\r\n         onDeleteElement,\r\n         onMoveElement,\r\n         updatePosition,\r\n         canvasRef,\r\n         sectionId,\r\n         onInlineEdit,\r\n         pageStructure,\r\n         zoomLevel,\r\n         viewMode,\r\n     }) => {\r\n        const [{ isDragging }, drag] = useDrag(() => ({\r\n            type: ItemTypes.EXISTING_ELEMENT,\r\n            item: { id: component.id, sectionId, json: component.json },\r\n            end: (item, monitor) => {\r\n                const clientOffset = monitor.getClientOffset();\r\n                if (clientOffset && canvasRef.current && sectionId && monitor.didDrop()) {\r\n                    const sectionRect = document.getElementById(sectionId)?.getBoundingClientRect();\r\n                    if (!sectionRect) return;\r\n\r\n                    const newX = Math.round((clientOffset.x - sectionRect.left) / (zoomLevel / 100) / 10) * 10;\r\n                    const newY = Math.round((clientOffset.y - sectionRect.top) / (zoomLevel / 100) / 10) * 10;\r\n\r\n                    const section = pageStructure?.children?.find((s) => s.id === sectionId);\r\n                    let adjustedY = newY;\r\n                    if (section) {\r\n                        section.elements.forEach((el) => {\r\n                            if (el.id !== component.id) {\r\n                                const elX = el.json.styles?.[viewMode]?.left || 0;\r\n                                const elY = el.json.styles?.[viewMode]?.top || 0;\r\n                                if (Math.abs(newX - elX) < 50 && Math.abs(newY - elY) < 50) {\r\n                                    adjustedY = elY + 20;\r\n                                }\r\n                            }\r\n                        });\r\n                    }\r\n                    updatePosition(component.id, sectionId, {\r\n                        desktop: { left: newX, top: adjustedY },\r\n                        mobile: { left: Math.round(newX / 2), top: Math.round(adjustedY / 2) },\r\n                    });\r\n                }\r\n            },\r\n            collect: (monitor) => ({\r\n                isDragging: !!monitor.isDragging(),\r\n            }),\r\n        }));\r\n\r\n        const handleMouseDown = (e) => {\r\n            e.stopPropagation();\r\n            onSelectElement(component);\r\n        };\r\n\r\n        const handleInlineEdit = (e) => {\r\n            if (onInlineEdit && e.target.contentEditable === 'true') {\r\n                onInlineEdit(component.id, sectionId, e.target.innerText);\r\n            }\r\n        };\r\n\r\n        const renderContent = () => {\r\n            const { type, componentData = {}, styles = { desktop: {}, mobile: {} }, children = [] } = component.json || {};\r\n            const containerStyle = {\r\n                ...styles[viewMode] || {},\r\n                position: 'absolute',\r\n                left: styles[viewMode]?.left || 0,\r\n                top: styles[viewMode]?.top || 0,\r\n                maxWidth: '100%',\r\n                boxSizing: 'border-box',\r\n                transform: isSelected ? 'translate(-2px, -2px)' : 'none',\r\n                width: styles[viewMode]?.width || 'auto',\r\n                height: styles[viewMode]?.height || 'auto',\r\n            };\r\n\r\n            const renderChildren = () => {\r\n                return children.map((child, idx) => (\r\n                    <Element\r\n                        key={child.id}\r\n                        component={{ id: child.id, json: child }}\r\n                        index={idx}\r\n                        isSelected={isSelected && component.id === child.id}\r\n                        onSelectElement={onSelectElement}\r\n                        handleElementHover={handleElementHover}\r\n                        onDuplicateElement={onDuplicateElement}\r\n                        onDeleteElement={onDeleteElement}\r\n                        onMoveElement={onMoveElement}\r\n                        updatePosition={updatePosition}\r\n                        canvasRef={canvasRef}\r\n                        sectionId={sectionId}\r\n                        onInlineEdit={onInlineEdit}\r\n                        pageStructure={pageStructure}\r\n                        zoomLevel={zoomLevel}\r\n                        viewMode={viewMode}\r\n                    />\r\n                ));\r\n            };\r\n\r\n            switch (type) {\r\n                case 'form':\r\n                    return (\r\n                        <div style={containerStyle} className=\"lpb-form-container\">\r\n                            <form onSubmit={(e) => e.preventDefault()} onMouseDown={(e) => e.stopPropagation()}>\r\n                                {renderChildren()}\r\n                                <button\r\n                                    type=\"submit\"\r\n                                    style={{ marginTop: '8px', ...styles[viewMode] }}\r\n                                    onMouseDown={(e) => e.stopPropagation()}\r\n                                >\r\n                                    Submit\r\n                                </button>\r\n                            </form>\r\n                        </div>\r\n                    );\r\n                case 'button-group':\r\n                    return (\r\n                        <div style={containerStyle} className=\"lpb-button-group-container\">\r\n                            {renderChildren()}\r\n                        </div>\r\n                    );\r\n                case 'gallery':\r\n                case 'carousel':\r\n                    return (\r\n                        <div style={containerStyle} className=\"lpb-gallery-container\">\r\n                            <div style={{ display: type === 'carousel' ? 'flex' : 'flex', flexWrap: type === 'gallery' ? 'wrap' : 'nowrap', gap: '10px' }}>\r\n                                {renderChildren()}\r\n                            </div>\r\n                        </div>\r\n                    );\r\n                case 'heading':\r\n                    return (\r\n                        <h2\r\n                            style={containerStyle}\r\n                            contentEditable\r\n                            suppressContentEditableWarning\r\n                            onBlur={handleInlineEdit}\r\n                            onMouseDown={(e) => e.stopPropagation()}\r\n                        >\r\n                            {componentData.content || 'Tiêu đề'}\r\n                        </h2>\r\n                    );\r\n                case 'paragraph':\r\n                    return (\r\n                        <p\r\n                            style={containerStyle}\r\n                            contentEditable\r\n                            suppressContentEditableWarning\r\n                            onBlur={handleInlineEdit}\r\n                            onMouseDown={(e) => e.stopPropagation()}\r\n                        >\r\n                            {componentData.content || 'Đoạn văn'}\r\n                        </p>\r\n                    );\r\n                case 'button':\r\n                    return (\r\n                        <button\r\n                            style={containerStyle}\r\n                            contentEditable\r\n                            suppressContentEditableWarning\r\n                            onBlur={handleInlineEdit}\r\n                            onMouseDown={(e) => e.stopPropagation()}\r\n                        >\r\n                            {componentData.content || 'Nút'}\r\n                        </button>\r\n                    );\r\n                case 'image':\r\n                    return (\r\n                        <img\r\n                            src={componentData.src || componentData.images?.[0]?.src || 'https://via.placeholder.com/150'}\r\n                            alt={componentData.alt || 'Image'}\r\n                            style={containerStyle}\r\n                        />\r\n                    );\r\n                case 'input':\r\n                    return (\r\n                        <input\r\n                            type={componentData.type || 'text'}\r\n                            placeholder={componentData.label || 'Input'}\r\n                            style={{ ...containerStyle, width: '100%' }}\r\n                            onMouseDown={(e) => e.stopPropagation()}\r\n                        />\r\n                    );\r\n                case 'textarea':\r\n                    return (\r\n                        <textarea\r\n                            placeholder={componentData.label || 'Textarea'}\r\n                            style={{ ...containerStyle, width: '100%' }}\r\n                            onMouseDown={(e) => e.stopPropagation()}\r\n                        />\r\n                    );\r\n                case 'popup':\r\n                    return (\r\n                        <div style={containerStyle} className=\"lpb-popup-container\">\r\n                            <p>{componentData.content || 'Popup nội dung'}</p>\r\n                            {renderChildren()}\r\n                        </div>\r\n                    );\r\n                default:\r\n                    return (\r\n                        <div style={containerStyle} className=\"lpb-container\">\r\n                            {componentData.title || componentData.content || 'Unknown'}\r\n                            {renderChildren()}\r\n                        </div>\r\n                    );\r\n            }\r\n        };\r\n\r\n        return (\r\n            <div\r\n                ref={drag}\r\n                data-id={component.id}\r\n                className={`lpb-canvas-element ${isSelected ? 'lpb-canvas-element-selected' : ''} ${isDragging ? 'lpb-canvas-element-dragging' : ''}`}\r\n                onMouseEnter={(e) => handleElementHover(e, component)}\r\n                onMouseDown={handleMouseDown}\r\n                style={{\r\n                    position: 'absolute',\r\n                    left: component.json.styles?.[viewMode]?.left || 0,\r\n                    top: component.json.styles?.[viewMode]?.top || 0,\r\n                    zIndex: isSelected ? 10 : 1,\r\n                    boxSizing: 'border-box',\r\n                    ...(component.json.styles?.[viewMode] || {}),\r\n                }}\r\n            >\r\n                {renderContent()}\r\n            </div>\r\n        );\r\n    }\r\n);\r\n\r\nconst Section = React.memo(\r\n    ({\r\n         section,\r\n         index,\r\n         selectedElement,\r\n         onSelectElement,\r\n         handleElementHover,\r\n         onDuplicateElement,\r\n         onDeleteElement,\r\n         onMoveElement,\r\n         updatePosition,\r\n         addElement,\r\n         canvasRef,\r\n         moveElement,\r\n         onInlineEdit,\r\n         onSelectSection,\r\n         viewMode,\r\n         pageStructure,\r\n         zoomLevel,\r\n     }) => {\r\n        const [{ isOver }, drop] = useDrop(() => ({\r\n            accept: [ItemTypes.ELEMENT, ItemTypes.EXISTING_ELEMENT],\r\n            hover: (item, monitor) => {\r\n                if (!monitor.isOver({ shallow: true })) return;\r\n                const clientOffset = monitor.getClientOffset();\r\n                if (clientOffset && canvasRef.current) {\r\n                    const sectionRect = document.getElementById(section.id)?.getBoundingClientRect();\r\n                    if (!sectionRect) return;\r\n                    item.dropPosition = {\r\n                        left: Math.round((clientOffset.x - sectionRect.left) / (zoomLevel / 100) / 10) * 10,\r\n                        top: Math.round((clientOffset.y - sectionRect.top) / (zoomLevel / 100) / 10) * 10,\r\n                    };\r\n                }\r\n            },\r\n            drop: (item, monitor) => {\r\n                const clientOffset = monitor.getClientOffset();\r\n                if (!clientOffset || !canvasRef.current) {\r\n                    toast.error('Không thể xác định vị trí thả. Vui lòng thử lại!');\r\n                    return;\r\n                }\r\n                const sectionRect = document.getElementById(section.id)?.getBoundingClientRect();\r\n                if (!sectionRect) {\r\n                    toast.error('Không tìm thấy section!');\r\n                    return;\r\n                }\r\n\r\n                let position = {\r\n                    left: Math.round((clientOffset.x - sectionRect.left) / (zoomLevel / 100) / 10) * 10,\r\n                    top: Math.round((clientOffset.y - sectionRect.top) / (zoomLevel / 100) / 10) * 10,\r\n                };\r\n\r\n                const sectionElements = section.elements || [];\r\n                sectionElements.forEach((el) => {\r\n                    if (el.id !== (item.id || item.json?.id)) {\r\n                        const elLeft = el.json.styles?.[viewMode]?.left || 0;\r\n                        const elTop = el.json.styles?.[viewMode]?.top || 0;\r\n                        if (Math.abs(position.left - elLeft) < 50 && Math.abs(position.top - elTop) < 50) {\r\n                            position.top = elTop + 20;\r\n                        }\r\n                    }\r\n                });\r\n\r\n                if (item.json) {\r\n                    addElement(section.id, {\r\n                        id: item.id,\r\n                        json: {\r\n                            ...item.json,\r\n                            styles: {\r\n                                desktop: { ...item.json.styles.desktop, left: position.left, top: position.top },\r\n                                mobile: { ...item.json.styles.mobile, left: Math.round(position.left / 2), top: Math.round(position.top / 2) },\r\n                            },\r\n                        },\r\n                    }, section.elements.length);\r\n                    toast.success('Đã thêm phần tử vào section!');\r\n                } else if (item.id) {\r\n                    updatePosition(item.id, section.id, {\r\n                        desktop: { left: position.left, top: position.top },\r\n                        mobile: { left: Math.round(position.left / 2), top: Math.round(position.top / 2) },\r\n                    });\r\n                    moveElement(section.id, item.id, section.elements.length);\r\n                    toast.success('Đã di chuyển phần tử!');\r\n                } else {\r\n                    toast.error('Dữ liệu thả không hợp lệ!');\r\n                }\r\n            },\r\n            collect: (monitor) => ({\r\n                isOver: !!monitor.isOver(),\r\n            }),\r\n        }));\r\n\r\n        const handleSectionClick = (e) => {\r\n            e.stopPropagation();\r\n            onSelectSection(section);\r\n        };\r\n\r\n        return (\r\n            <div\r\n                ref={drop}\r\n                id={section.id}\r\n                className={`lpb-canvas-section ${isOver ? 'lpb-canvas-section-over' : ''} ${selectedElement?.id === section.id ? 'lpb-canvas-section-selected' : ''}`}\r\n                style={{\r\n                    width: section.json.styles?.[viewMode]?.width || '1200px',\r\n                    height: section.json.styles?.[viewMode]?.height || 'auto',\r\n                    minHeight: section.json.styles?.[viewMode]?.minHeight || '200px',\r\n                    position: 'relative',\r\n                    margin: '0 auto 20px auto',\r\n                    border: section.json.styles?.[viewMode]?.border || '1px solid #ddd',\r\n                    padding: section.json.styles?.[viewMode]?.padding || '20px',\r\n                    boxSizing: 'border-box',\r\n                    background: section.json.styles?.[viewMode]?.background || '#ffffff',\r\n                }}\r\n                onMouseDown={handleSectionClick}\r\n            >\r\n                <h3>{section.json.componentData?.title || 'Section'}</h3>\r\n                <div className=\"lpb-canvas-section-content\">\r\n                    {(section.elements || []).map((element, idx) => (\r\n                        <Element\r\n                            key={element.id}\r\n                            component={element}\r\n                            index={idx}\r\n                            isSelected={selectedElement?.id === element.id}\r\n                            onSelectElement={onSelectElement}\r\n                            handleElementHover={handleElementHover}\r\n                            onDuplicateElement={onDuplicateElement}\r\n                            onDeleteElement={onDeleteElement}\r\n                            onMoveElement={onMoveElement}\r\n                            updatePosition={updatePosition}\r\n                            canvasRef={canvasRef}\r\n                            sectionId={section.id}\r\n                            onInlineEdit={onInlineEdit}\r\n                            pageStructure={pageStructure}\r\n                            zoomLevel={zoomLevel}\r\n                            viewMode={viewMode}\r\n                        />\r\n                    ))}\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n);\r\n\r\nconst Canvas = React.memo(\r\n    ({\r\n         pageStructure,\r\n         selectedElement,\r\n         onSelectElement,\r\n         quickEditElement,\r\n         quickEditPosition,\r\n         onQuickEdit,\r\n         onCloseQuickEdit,\r\n         onDuplicateElement,\r\n         onDeleteElement,\r\n         onMoveElement,\r\n         viewMode,\r\n         addSection,\r\n         addElement,\r\n         moveElement,\r\n         ItemTypes,\r\n         zoomLevel,\r\n         setPageStructure,\r\n         updatePosition,\r\n         onInlineEdit,\r\n     }) => {\r\n        const canvasRef = useRef(null);\r\n        const [dropIndex, setDropIndex] = useState(null);\r\n\r\n        const [{ isOver }, drop] = useDrop(() => ({\r\n            accept: [ItemTypes.SECTION],\r\n            hover: (item, monitor) => {\r\n                if (!monitor.isOver({ shallow: true })) return;\r\n                const clientOffset = monitor.getClientOffset();\r\n                if (clientOffset && canvasRef.current) {\r\n                    const rect = canvasRef.current.getBoundingClientRect();\r\n                    const y = clientOffset.y - rect.top;\r\n                    const index = Math.min(pageStructure?.children?.length || 0, Math.floor(y / 200));\r\n                    setDropIndex(index);\r\n                }\r\n            },\r\n            drop: (item, monitor) => {\r\n                const clientOffset = monitor.getClientOffset();\r\n                if (!clientOffset || !canvasRef.current) {\r\n                    toast.error('Không thể xác định vị trí thả. Vui lòng thử lại!');\r\n                    return;\r\n                }\r\n                if (!item.json || !item.json.styles) {\r\n                    toast.error('Dữ liệu thả không hợp lệ!');\r\n                    return;\r\n                }\r\n                const rect = canvasRef.current.getBoundingClientRect();\r\n                const index = Math.min(pageStructure?.children?.length || 0, Math.floor((clientOffset.y - rect.top) / 200));\r\n                addSection(\r\n                    {\r\n                        id: item.id,\r\n                        json: {\r\n                            ...item.json,\r\n                            styles: {\r\n                                desktop: { ...item.json.styles.desktop, width: item.json.styles.desktop.width || '1200px', minHeight: item.json.styles.desktop.minHeight || '200px' },\r\n                                mobile: { ...item.json.styles.mobile, width: item.json.styles.mobile.width || '100%', minHeight: item.json.styles.mobile.minHeight || '150px' },\r\n                            },\r\n                        },\r\n                        elements: [],\r\n                    },\r\n                    index\r\n                );\r\n                toast.success('Đã thêm section mới!');\r\n                setDropIndex(null);\r\n            },\r\n            collect: (monitor) => ({\r\n                isOver: !!monitor.isOver(),\r\n            }),\r\n        }));\r\n\r\n        const handleElementHover = useCallback(\r\n            (e, component) => {\r\n                if (quickEditElement?.id === component.id) return;\r\n                const rect = e.currentTarget.getBoundingClientRect();\r\n                const canvasRect = canvasRef.current?.getBoundingClientRect() || { left: 0, top: 0 };\r\n                onQuickEdit(component, {\r\n                    left: (rect.left - canvasRect.left) / (zoomLevel / 100),\r\n                    top: (rect.top - canvasRect.top + 20) / (zoomLevel / 100),\r\n                });\r\n            },\r\n            [quickEditElement, onQuickEdit, zoomLevel]\r\n        );\r\n\r\n        const handleSelectSection = useCallback(\r\n            (section) => {\r\n                onSelectElement(section);\r\n            },\r\n            [onSelectElement]\r\n        );\r\n\r\n        useHotkeys(\r\n            'delete',\r\n            () => {\r\n                if (selectedElement) {\r\n                    onDeleteElement(selectedElement);\r\n                }\r\n            },\r\n            [selectedElement, onDeleteElement]\r\n        );\r\n\r\n        if (!pageStructure || !pageStructure.children) {\r\n            return (\r\n                <div className=\"lpb-canvas-wrapper\">\r\n                    <div\r\n                        ref={(node) => {\r\n                            canvasRef.current = node;\r\n                            drop(node);\r\n                        }}\r\n                        className={`lpb-canvas ${viewMode === 'mobile' ? 'lpb-canvas-mobile' : viewMode === 'tablet' ? 'lpb-canvas-tablet' : ''}`}\r\n                        onMouseLeave={onCloseQuickEdit}\r\n                        style={{\r\n                            zoom: `${zoomLevel / 100}`,\r\n                            position: 'relative',\r\n                            minHeight: '600px',\r\n                            background: '#f9fafb',\r\n                        }}\r\n                    >\r\n                        <div className=\"lpb-canvas-content\">\r\n                            <div className=\"lpb-canvas-empty-state\">\r\n                                <i className=\"fas fa-layer-group\"></i>\r\n                                <p>Kéo thả section để bắt đầu</p>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            );\r\n        }\r\n\r\n        return (\r\n            <div className=\"lpb-canvas-wrapper\">\r\n                <div\r\n                    ref={(node) => {\r\n                        canvasRef.current = node;\r\n                        drop(node);\r\n                    }}\r\n                    className={`lpb-canvas ${viewMode === 'mobile' ? 'lpb-canvas-mobile' : viewMode === 'tablet' ? 'lpb-canvas-tablet' : ''}`}\r\n                    onMouseLeave={onCloseQuickEdit}\r\n                    style={{\r\n                        zoom: `${zoomLevel / 100}`,\r\n                        position: 'relative',\r\n                        minHeight: pageStructure.styles?.[viewMode]?.minHeight || '600px',\r\n                        background: pageStructure.styles?.[viewMode]?.background || '#f9fafb',\r\n                    }}\r\n                >\r\n                    <div className=\"lpb-canvas-content\">\r\n                        {pageStructure.children.length === 0 ? (\r\n                            <div className=\"lpb-canvas-empty-state\">\r\n                                <i className=\"fas fa-layer-group\"></i>\r\n                                <p>Kéo thả section để bắt đầu</p>\r\n                            </div>\r\n                        ) : (\r\n                            <>\r\n                                {pageStructure.children.map((section, index) => (\r\n                                    <React.Fragment key={section.id}>\r\n                                        {dropIndex === index && (\r\n                                            <div\r\n                                                className=\"lpb-canvas-drop-zone\"\r\n                                                style={{\r\n                                                    height: '50px',\r\n                                                    background: 'rgba(0, 128, 255, 0.1)',\r\n                                                    border: '2px dashed #0080ff',\r\n                                                    margin: '10px auto',\r\n                                                    width: section.json.styles?.[viewMode]?.width || '1200px',\r\n                                                }}\r\n                                            />\r\n                                        )}\r\n                                        <Section\r\n                                            key={section.id}\r\n                                            section={section}\r\n                                            index={index}\r\n                                            selectedElement={selectedElement}\r\n                                            onSelectElement={onSelectElement}\r\n                                            handleElementHover={handleElementHover}\r\n                                            onDuplicateElement={onDuplicateElement}\r\n                                            onDeleteElement={onDeleteElement}\r\n                                            onMoveElement={onMoveElement}\r\n                                            updatePosition={updatePosition}\r\n                                            addElement={addElement}\r\n                                            canvasRef={canvasRef}\r\n                                            moveElement={moveElement}\r\n                                            onInlineEdit={onInlineEdit}\r\n                                            onSelectSection={handleSelectSection}\r\n                                            viewMode={viewMode}\r\n                                            pageStructure={pageStructure}\r\n                                            zoomLevel={zoomLevel}\r\n                                        />\r\n                                    </React.Fragment>\r\n                                ))}\r\n                                {dropIndex === pageStructure.children.length && (\r\n                                    <div\r\n                                        className=\"lpb-canvas-drop-zone\"\r\n                                        style={{\r\n                                            height: '50px',\r\n                                            background: 'rgba(0, 128, 255, 0.1)',\r\n                                            border: '2px dashed #0080ff',\r\n                                            margin: '10px auto',\r\n                                            width: pageStructure.styles?.[viewMode]?.width || '1200px',\r\n                                        }}\r\n                                    />\r\n                                )}\r\n                            </>\r\n                        )}\r\n                    </div>\r\n                    <QuickEditToolkit\r\n                        element={quickEditElement}\r\n                        position={quickEditPosition}\r\n                        onEdit={() => onSelectElement(quickEditElement)}\r\n                        onDuplicate={() => onDuplicateElement(quickEditElement)}\r\n                        onDelete={() => onDeleteElement(quickEditElement)}\r\n                        onMoveUp={() => onMoveElement(quickEditElement, 'up')}\r\n                        onMoveDown={() => onMoveElement(quickEditElement, 'down')}\r\n                        onClose={onCloseQuickEdit}\r\n                    />\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n);\r\n\r\nexport default Canvas;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}