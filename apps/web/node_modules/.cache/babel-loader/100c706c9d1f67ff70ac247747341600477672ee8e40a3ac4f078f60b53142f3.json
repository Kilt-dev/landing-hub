{"ast":null,"code":"var _jsxFileName = \"F:\\\\landinghub-iconic\\\\apps\\\\web\\\\src\\\\components\\\\create-page\\\\Canvas.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { useRef, useCallback, useState, useEffect } from 'react';\nimport { useDrop, useDrag } from 'react-dnd';\nimport { getEmptyImage } from 'react-dnd-html5-backend';\nimport { useHotkeys } from 'react-hotkeys-hook';\nimport { toast } from 'react-toastify';\nimport Guidelines from './Guidelines';\nimport Rulers from './Rulers';\nimport SelectionOverlay from './SelectionOverlay';\nimport '../../styles/Canvas.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ItemTypes = {\n  ELEMENT: 'element',\n  EXISTING_ELEMENT: 'existingElement'\n};\n\n// Tính toán tọa độ chính xác trong canvas\nconst getCanvasPosition = (mouseX, mouseY, canvasElement, zoomLevel) => {\n  if (!canvasElement || !zoomLevel || zoomLevel <= 0) {\n    console.error('Invalid canvas element or zoomLevel:', {\n      canvasElement,\n      zoomLevel\n    });\n    return {\n      x: 0,\n      y: 0\n    };\n  }\n  const canvasRect = canvasElement.getBoundingClientRect();\n  const scrollX = canvasElement.scrollLeft || 0;\n  const scrollY = canvasElement.scrollTop || 0;\n  const rawX = (mouseX - canvasRect.left + scrollX) / (zoomLevel / 100);\n  const rawY = (mouseY - canvasRect.top + scrollY) / (zoomLevel / 100);\n  return {\n    x: Math.max(0, rawX),\n    y: Math.max(0, rawY)\n  };\n};\n\n// Snap to grid với snap points\nconst snapToGrid = (x, y, gridSize, snapPoints = [], canvasBounds, disableSnap = false) => {\n  if (disableSnap) {\n    return {\n      x: Math.max(0, Math.min(x, canvasBounds.width)),\n      y: Math.max(0, Math.min(y, canvasBounds.height))\n    };\n  }\n  let snappedX = Math.round(x / gridSize) * gridSize;\n  let snappedY = Math.round(y / gridSize) * gridSize;\n  snapPoints.forEach(point => {\n    if (Math.abs(x - point.x) < 15) snappedX = point.x;\n    if (Math.abs(y - point.y) < 15) snappedY = point.y;\n  });\n  snappedX = Math.max(0, Math.min(snappedX, canvasBounds.width));\n  snappedY = Math.max(0, Math.min(snappedY, canvasBounds.height));\n  return {\n    x: snappedX,\n    y: snappedY\n  };\n};\n\n// Tính bounds của element\nconst getElementBounds = element => {\n  var _element$position$des, _element$position$des2, _element$position$des3, _element$size, _element$position$des4, _element$size2, _element$position$des5, _element$size3, _element$position$des6, _element$size4;\n  return {\n    left: ((_element$position$des = element.position.desktop) === null || _element$position$des === void 0 ? void 0 : _element$position$des.x) || 0,\n    top: ((_element$position$des2 = element.position.desktop) === null || _element$position$des2 === void 0 ? void 0 : _element$position$des2.y) || 0,\n    right: (((_element$position$des3 = element.position.desktop) === null || _element$position$des3 === void 0 ? void 0 : _element$position$des3.x) || 0) + (((_element$size = element.size) === null || _element$size === void 0 ? void 0 : _element$size.width) || 200),\n    bottom: (((_element$position$des4 = element.position.desktop) === null || _element$position$des4 === void 0 ? void 0 : _element$position$des4.y) || 0) + (((_element$size2 = element.size) === null || _element$size2 === void 0 ? void 0 : _element$size2.height) || 50),\n    centerX: (((_element$position$des5 = element.position.desktop) === null || _element$position$des5 === void 0 ? void 0 : _element$position$des5.x) || 0) + (((_element$size3 = element.size) === null || _element$size3 === void 0 ? void 0 : _element$size3.width) || 200) / 2,\n    centerY: (((_element$position$des6 = element.position.desktop) === null || _element$position$des6 === void 0 ? void 0 : _element$position$des6.y) || 0) + (((_element$size4 = element.size) === null || _element$size4 === void 0 ? void 0 : _element$size4.height) || 50) / 2\n  };\n};\n\n// Component Element\nconst Element = /*#__PURE__*/_s(/*#__PURE__*/React.memo(_c = _s(({\n  element,\n  isSelected,\n  onSelectElement,\n  onUpdatePosition,\n  viewMode,\n  zoomLevel,\n  gridSize,\n  onContextMenu,\n  canvasBounds,\n  canvasRef,\n  selectedIds\n}) => {\n  var _position$viewMode3, _position$viewMode4;\n  _s();\n  const {\n    id,\n    type,\n    componentData = {},\n    position = {},\n    size = {\n      width: 200,\n      height: 50\n    },\n    styles = {}\n  } = element;\n  const elementRef = useRef(null);\n  const [isDragStarted, setIsDragStarted] = useState(false);\n  const offsetRef = useRef({\n    x: 0,\n    y: 0\n  });\n  const [{\n    isDragging\n  }, drag, preview] = useDrag(() => ({\n    type: ItemTypes.EXISTING_ELEMENT,\n    item: () => {\n      var _elementRef$current, _canvasRef$current, _position$viewMode, _position$viewMode2;\n      setIsDragStarted(true);\n      const elementRect = (_elementRef$current = elementRef.current) === null || _elementRef$current === void 0 ? void 0 : _elementRef$current.getBoundingClientRect();\n      const canvasRect = (_canvasRef$current = canvasRef.current) === null || _canvasRef$current === void 0 ? void 0 : _canvasRef$current.getBoundingClientRect();\n      if (!elementRect || !canvasRect) {\n        console.error('Cannot calculate offset for element:', id);\n        return {\n          id,\n          offset: {\n            x: 0,\n            y: 0\n          },\n          selectedIds\n        };\n      }\n      const offset = {\n        x: (elementRect.left - canvasRect.left) / (zoomLevel / 100) - (((_position$viewMode = position[viewMode]) === null || _position$viewMode === void 0 ? void 0 : _position$viewMode.x) || 0),\n        y: (elementRect.top - canvasRect.top) / (zoomLevel / 100) - (((_position$viewMode2 = position[viewMode]) === null || _position$viewMode2 === void 0 ? void 0 : _position$viewMode2.y) || 0)\n      };\n      offsetRef.current = offset;\n      return {\n        id,\n        offset,\n        selectedIds,\n        elementSize: size,\n        elementPosition: position[viewMode] || {\n          x: 0,\n          y: 0\n        },\n        isExisting: true\n      };\n    },\n    end: (item, monitor) => {\n      setIsDragStarted(false);\n      const dropResult = monitor.getDropResult();\n      if (!dropResult || !dropResult.moved) {\n        console.log('Drag cancelled or invalid drop for element:', id);\n        return;\n      }\n      console.log('Drag ended successfully for element:', id, 'New position:', dropResult.newPosition);\n    },\n    collect: monitor => ({\n      isDragging: monitor.isDragging()\n    })\n  }), [id, size, position, viewMode, selectedIds]);\n  useEffect(() => {\n    preview(getEmptyImage(), {\n      captureDraggingState: true\n    });\n  }, [preview]);\n  const handleMouseDown = useCallback(e => {\n    e.stopPropagation();\n    if (!selectedIds.includes(id)) {\n      onSelectElement(id, e.ctrlKey);\n    }\n  }, [id, onSelectElement, selectedIds]);\n  const handleContextMenu = useCallback(e => {\n    e.preventDefault();\n    e.stopPropagation();\n    onContextMenu(id, {\n      x: e.clientX,\n      y: e.clientY\n    });\n  }, [id, onContextMenu]);\n  const renderComponent = useCallback(() => {\n    switch (type) {\n      case 'heading':\n        return /*#__PURE__*/_jsxDEV(\"h2\", {\n          style: {\n            fontSize: componentData.fontSize || '1.5rem',\n            color: componentData.color || '#1f2937',\n            margin: 0,\n            padding: 0,\n            userSelect: 'none'\n          },\n          children: componentData.content || 'Tiêu đề'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 144,\n          columnNumber: 25\n        }, this);\n      case 'paragraph':\n        return /*#__PURE__*/_jsxDEV(\"p\", {\n          style: {\n            fontSize: componentData.fontSize || '1rem',\n            color: componentData.color || '#1f2937',\n            margin: 0,\n            padding: 0,\n            userSelect: 'none'\n          },\n          children: componentData.content || 'Đoạn văn'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 150,\n          columnNumber: 25\n        }, this);\n      case 'button':\n        return /*#__PURE__*/_jsxDEV(\"button\", {\n          style: {\n            padding: '8px 16px',\n            borderRadius: '8px',\n            background: componentData.background || '#2563eb',\n            color: componentData.color || '#fff',\n            border: 'none',\n            cursor: 'pointer',\n            userSelect: 'none'\n          },\n          children: componentData.content || 'Nút'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 156,\n          columnNumber: 25\n        }, this);\n      case 'image':\n        return /*#__PURE__*/_jsxDEV(\"img\", {\n          src: componentData.src || 'https://via.placeholder.com/150',\n          alt: \"Image\",\n          style: {\n            maxWidth: '100%',\n            height: 'auto',\n            userSelect: 'none'\n          },\n          draggable: false\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 172,\n          columnNumber: 25\n        }, this);\n      case 'form':\n        return /*#__PURE__*/_jsxDEV(\"form\", {\n          style: {\n            display: 'flex',\n            flexDirection: 'column',\n            gap: '10px',\n            userSelect: 'none'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"text\",\n            placeholder: \"Input\",\n            style: {\n              padding: '8px',\n              borderRadius: '8px',\n              border: '1px solid #ccc'\n            },\n            readOnly: true\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 182,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"button\",\n            style: {\n              background: '#2563eb',\n              color: '#fff',\n              padding: '8px 16px',\n              borderRadius: '8px',\n              border: 'none',\n              cursor: 'pointer'\n            },\n            children: \"Submit\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 188,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 181,\n          columnNumber: 25\n        }, this);\n      default:\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            userSelect: 'none'\n          },\n          children: componentData.content || 'Unknown'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 204,\n          columnNumber: 28\n        }, this);\n    }\n  }, [type, componentData]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    ref: node => {\n      elementRef.current = node;\n      drag(node);\n    },\n    className: `lpb-canvas-element ${isSelected ? 'lpb-canvas-element-selected' : ''} ${isDragging ? 'lpb-canvas-element-dragging' : ''}`,\n    style: {\n      position: 'absolute',\n      transform: `translate(${((_position$viewMode3 = position[viewMode]) === null || _position$viewMode3 === void 0 ? void 0 : _position$viewMode3.x) || 0}px, ${((_position$viewMode4 = position[viewMode]) === null || _position$viewMode4 === void 0 ? void 0 : _position$viewMode4.y) || 0}px)`,\n      width: size.width,\n      height: size.height,\n      zIndex: position.z || 1,\n      opacity: isDragging ? 0.5 : 1,\n      cursor: isDragging ? 'grabbing' : 'grab',\n      boxShadow: isDragging ? '0 4px 8px rgba(0,0,0,0.2)' : 'none',\n      userSelect: 'none',\n      ...styles\n    },\n    onMouseDown: handleMouseDown,\n    onContextMenu: handleContextMenu,\n    children: renderComponent()\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 209,\n    columnNumber: 13\n  }, this);\n}, \"JStbg+BKU7a41DdKGOic41LPNXs=\", false, function () {\n  return [useDrag];\n})), \"JStbg+BKU7a41DdKGOic41LPNXs=\", false, function () {\n  return [useDrag];\n});\n\n// Component Canvas chính\n_c2 = Element;\nconst Canvas = /*#__PURE__*/_s2(/*#__PURE__*/React.memo(_c3 = _s2(({\n  pageData,\n  selectedIds,\n  onSelectElement,\n  onUpdatePosition,\n  onUpdateSize,\n  onDeleteElement,\n  onAddElement,\n  onGroupElements,\n  viewMode,\n  zoomLevel,\n  gridSize,\n  showGrid\n}) => {\n  var _pageData$canvas, _pageData$canvas2;\n  _s2();\n  const canvasRef = useRef(null);\n  const [guidelines, setGuidelines] = useState([]);\n  const [contextMenu, setContextMenu] = useState(null);\n  const [dragPreview, setDragPreview] = useState(null);\n  const [history, setHistory] = useState([]); // Stack cho undo/redo\n  const [historyIndex, setHistoryIndex] = useState(-1);\n  const canvasBounds = canvasRef.current ? {\n    width: canvasRef.current.offsetWidth / (zoomLevel / 100),\n    height: canvasRef.current.offsetHeight / (zoomLevel / 100)\n  } : {\n    width: 1200,\n    height: 1000\n  };\n  const getSnapPoints = useCallback(() => {\n    const points = [{\n      x: 0,\n      y: 0\n    }, {\n      x: canvasBounds.width,\n      y: canvasBounds.height\n    }, {\n      x: canvasBounds.width / 2,\n      y: canvasBounds.height / 2\n    }];\n    pageData.elements.forEach(el => {\n      const bounds = getElementBounds(el);\n      points.push({\n        x: bounds.left,\n        y: bounds.top\n      }, {\n        x: bounds.right,\n        y: bounds.bottom\n      }, {\n        x: bounds.centerX,\n        y: bounds.centerY\n      }, {\n        x: bounds.left,\n        y: bounds.centerY\n      }, {\n        x: bounds.right,\n        y: bounds.centerY\n      }, {\n        x: bounds.centerX,\n        y: bounds.top\n      }, {\n        x: bounds.centerX,\n        y: bounds.bottom\n      });\n    });\n    return points;\n  }, [pageData.elements, canvasBounds]);\n  const handleUpdatePosition = (id, newPos, mode, prevPos) => {\n    if (mode === 'replace' && prevPos) {\n      setHistory(prev => [...prev.slice(0, historyIndex + 1), {\n        id,\n        prevPos,\n        newPos\n      }]);\n      setHistoryIndex(prev => prev + 1);\n    }\n    onUpdatePosition(id, newPos, mode);\n  };\n  const handleUndo = useCallback(() => {\n    if (historyIndex >= 0) {\n      const {\n        id,\n        prevPos\n      } = history[historyIndex];\n      onUpdatePosition(id, {\n        [viewMode]: prevPos\n      }, 'replace');\n      setHistoryIndex(prev => prev - 1);\n      toast.info('Đã hoàn tác di chuyển');\n    }\n  }, [history, historyIndex, onUpdatePosition, viewMode]);\n  const handleRedo = useCallback(() => {\n    if (historyIndex < history.length - 1) {\n      const {\n        id,\n        newPos\n      } = history[historyIndex + 1];\n      onUpdatePosition(id, {\n        [viewMode]: newPos\n      }, 'replace');\n      setHistoryIndex(prev => prev + 1);\n      toast.info('Đã thực hiện lại di chuyển');\n    }\n  }, [history, historyIndex, onUpdatePosition, viewMode]);\n  useHotkeys('ctrl+z', handleUndo, [history, historyIndex]);\n  useHotkeys('ctrl+y', handleRedo, [history, historyIndex]);\n  const [{\n    isOver,\n    dragItem\n  }, drop] = useDrop(() => ({\n    accept: [ItemTypes.ELEMENT, ItemTypes.EXISTING_ELEMENT],\n    hover: (item, monitor) => {\n      var _monitor$getClientOff;\n      const clientOffset = monitor.getClientOffset();\n      if (!clientOffset || !canvasRef.current) return;\n      const pos = getCanvasPosition(clientOffset.x, clientOffset.y, canvasRef.current, zoomLevel);\n      const snapPoints = getSnapPoints();\n      const snapped = snapToGrid(pos.x, pos.y, showGrid ? gridSize : Infinity, snapPoints, canvasBounds, (_monitor$getClientOff = monitor.getClientOffset()) === null || _monitor$getClientOff === void 0 ? void 0 : _monitor$getClientOff.altKey);\n\n      // Cập nhật drag preview\n      if (item.isExisting) {\n        var _item$offset, _item$offset2;\n        setDragPreview({\n          id: item.id,\n          x: snapped.x - (((_item$offset = item.offset) === null || _item$offset === void 0 ? void 0 : _item$offset.x) || 0),\n          y: snapped.y - (((_item$offset2 = item.offset) === null || _item$offset2 === void 0 ? void 0 : _item$offset2.y) || 0),\n          size: item.elementSize || {\n            width: 200,\n            height: 50\n          }\n        });\n      } else if (item.json) {\n        setDragPreview({\n          id: 'preview',\n          x: snapped.x,\n          y: snapped.y,\n          size: item.json.size || {\n            width: 200,\n            height: 50\n          },\n          type: item.json.type,\n          componentData: item.json.componentData\n        });\n      }\n      const newGuidelines = [];\n      snapPoints.forEach(point => {\n        if (Math.abs(snapped.x - point.x) < 15) {\n          newGuidelines.push({\n            vertical: true,\n            position: point.x\n          });\n        }\n        if (Math.abs(snapped.y - point.y) < 15) {\n          newGuidelines.push({\n            vertical: false,\n            position: point.y\n          });\n        }\n      });\n      setGuidelines(newGuidelines);\n    },\n    drop: (item, monitor) => {\n      var _monitor$getClientOff2;\n      const clientOffset = monitor.getClientOffset();\n      if (!clientOffset || !canvasRef.current) {\n        toast.error('Không thể xác định vị trí thả!');\n        return {\n          moved: false\n        };\n      }\n      const pos = getCanvasPosition(clientOffset.x, clientOffset.y, canvasRef.current, zoomLevel);\n      const snapPoints = getSnapPoints();\n      const snapped = snapToGrid(pos.x, pos.y, showGrid ? gridSize : Infinity, snapPoints, canvasBounds, (_monitor$getClientOff2 = monitor.getClientOffset()) === null || _monitor$getClientOff2 === void 0 ? void 0 : _monitor$getClientOff2.altKey);\n      if (item.json && !item.isExisting) {\n        // Thêm phần tử mới từ ComponentLibrary\n        const newElement = {\n          id: `${item.id}-${Date.now()}`,\n          type: item.json.type,\n          componentData: item.json.componentData || {},\n          position: {\n            [viewMode]: snapped,\n            desktop: snapped,\n            tablet: snapped,\n            mobile: snapped\n          },\n          size: item.json.size || {\n            width: 200,\n            height: 50\n          },\n          styles: item.json.styles || {}\n        };\n        onAddElement(newElement);\n        toast.success('Đã thêm phần tử!');\n        setDragPreview(null);\n        setGuidelines([]);\n        return {\n          moved: true,\n          newPosition: snapped\n        };\n      } else if (item.id && item.isExisting) {\n        var _item$offset3, _item$elementPosition, _item$offset4, _item$elementPosition2;\n        // Di chuyển phần tử hiện có (bao gồm nhóm nếu được chọn)\n        const deltaX = snapped.x - (((_item$offset3 = item.offset) === null || _item$offset3 === void 0 ? void 0 : _item$offset3.x) || 0) - (((_item$elementPosition = item.elementPosition) === null || _item$elementPosition === void 0 ? void 0 : _item$elementPosition.x) || 0);\n        const deltaY = snapped.y - (((_item$offset4 = item.offset) === null || _item$offset4 === void 0 ? void 0 : _item$offset4.y) || 0) - (((_item$elementPosition2 = item.elementPosition) === null || _item$elementPosition2 === void 0 ? void 0 : _item$elementPosition2.y) || 0);\n        item.selectedIds.forEach(selectedId => {\n          const element = pageData.elements.find(el => el.id === selectedId);\n          if (element) {\n            const prevPos = element.position[viewMode] || {\n              x: 0,\n              y: 0\n            };\n            const newPos = {\n              x: Math.max(0, Math.min(prevPos.x + deltaX, canvasBounds.width - element.size.width)),\n              y: Math.max(0, Math.min(prevPos.y + deltaY, canvasBounds.height - element.size.height))\n            };\n            handleUpdatePosition(selectedId, {\n              [viewMode]: newPos\n            }, 'replace', prevPos);\n          }\n        });\n        toast.success('Đã di chuyển phần tử!');\n        setDragPreview(null);\n        setGuidelines([]);\n        return {\n          moved: true,\n          newPosition: snapped\n        };\n      }\n      setDragPreview(null);\n      setGuidelines([]);\n      return {\n        moved: false\n      };\n    },\n    collect: monitor => ({\n      isOver: monitor.isOver(),\n      dragItem: monitor.getItem()\n    })\n  }), [pageData.elements, viewMode, zoomLevel, gridSize, showGrid, canvasBounds, onAddElement, onUpdatePosition, selectedIds]);\n  const handleCanvasClick = useCallback(e => {\n    if (e.target === canvasRef.current) {\n      onSelectElement([]);\n      setContextMenu(null);\n    }\n  }, [onSelectElement]);\n  const handleContextMenu = useCallback((id, position) => {\n    setContextMenu({\n      id,\n      position\n    });\n  }, []);\n  const handleKeyDown = useCallback(e => {\n    if (!selectedIds.length) return;\n    e.preventDefault();\n    e.stopPropagation();\n    const step = e.shiftKey ? 10 : 1;\n    selectedIds.forEach(id => {\n      const element = pageData.elements.find(el => el.id === id);\n      if (!element) return;\n      const currentPos = element.position[viewMode] || {\n        x: 0,\n        y: 0\n      };\n      let newPos;\n      switch (e.key) {\n        case 'ArrowUp':\n          newPos = {\n            x: currentPos.x,\n            y: Math.max(0, currentPos.y - step)\n          };\n          break;\n        case 'ArrowDown':\n          newPos = {\n            x: currentPos.x,\n            y: Math.min(canvasBounds.height - element.size.height, currentPos.y + step)\n          };\n          break;\n        case 'ArrowLeft':\n          newPos = {\n            x: Math.max(0, currentPos.x - step),\n            y: currentPos.y\n          };\n          break;\n        case 'ArrowRight':\n          newPos = {\n            x: Math.min(canvasBounds.width - element.size.width, currentPos.x + step),\n            y: currentPos.y\n          };\n          break;\n        case 'Delete':\n        case 'Backspace':\n          onDeleteElement(id);\n          return;\n        case 'Escape':\n          onSelectElement([]);\n          setContextMenu(null);\n          return;\n        default:\n          return;\n      }\n      if (newPos) {\n        handleUpdatePosition(id, {\n          [viewMode]: newPos\n        }, 'replace', currentPos);\n      }\n    });\n  }, [selectedIds, onUpdatePosition, onDeleteElement, onSelectElement, viewMode, pageData.elements, canvasBounds]);\n  useHotkeys('ctrl+a', e => {\n    e.preventDefault();\n    onSelectElement(pageData.elements.map(el => el.id));\n  }, [pageData.elements, onSelectElement]);\n  useHotkeys('ctrl+g', e => {\n    e.preventDefault();\n    if (selectedIds.length > 1) {\n      onGroupElements(selectedIds);\n    }\n  }, [selectedIds, onGroupElements]);\n  useEffect(() => {\n    const handleClickOutside = () => setContextMenu(null);\n    if (contextMenu) {\n      document.addEventListener('click', handleClickOutside);\n      return () => document.removeEventListener('click', handleClickOutside);\n    }\n  }, [contextMenu]);\n  const renderDragPreview = () => {\n    if (!dragPreview) return null;\n    const {\n      x,\n      y,\n      size,\n      type,\n      componentData\n    } = dragPreview;\n    const previewStyle = {\n      position: 'absolute',\n      transform: `translate(${x}px, ${y}px)`,\n      width: size.width,\n      height: size.height,\n      border: '2px dashed #3b82f6',\n      background: 'rgba(59, 130, 246, 0.1)',\n      pointerEvents: 'none',\n      zIndex: 1000,\n      opacity: 0.5\n    };\n    if (type && componentData) {\n      // Preview chi tiết cho phần tử mới\n      switch (type) {\n        case 'heading':\n          return /*#__PURE__*/_jsxDEV(\"div\", {\n            style: previewStyle,\n            children: /*#__PURE__*/_jsxDEV(\"h2\", {\n              style: {\n                fontSize: componentData.fontSize || '1.5rem',\n                color: componentData.color || '#1f2937',\n                margin: 0,\n                padding: 0,\n                userSelect: 'none'\n              },\n              children: componentData.content || 'Tiêu đề'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 519,\n              columnNumber: 33\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 518,\n            columnNumber: 29\n          }, this);\n        case 'paragraph':\n          return /*#__PURE__*/_jsxDEV(\"div\", {\n            style: previewStyle,\n            children: /*#__PURE__*/_jsxDEV(\"p\", {\n              style: {\n                fontSize: componentData.fontSize || '1rem',\n                color: componentData.color || '#1f2937',\n                margin: 0,\n                padding: 0,\n                userSelect: 'none'\n              },\n              children: componentData.content || 'Đoạn văn'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 527,\n              columnNumber: 33\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 526,\n            columnNumber: 29\n          }, this);\n        case 'button':\n          return /*#__PURE__*/_jsxDEV(\"div\", {\n            style: previewStyle,\n            children: /*#__PURE__*/_jsxDEV(\"button\", {\n              style: {\n                padding: '8px 16px',\n                borderRadius: '8px',\n                background: componentData.background || '#2563eb',\n                color: componentData.color || '#fff',\n                border: 'none',\n                cursor: 'pointer',\n                userSelect: 'none'\n              },\n              children: componentData.content || 'Nút'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 535,\n              columnNumber: 33\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 534,\n            columnNumber: 29\n          }, this);\n        case 'image':\n          return /*#__PURE__*/_jsxDEV(\"div\", {\n            style: previewStyle,\n            children: /*#__PURE__*/_jsxDEV(\"img\", {\n              src: componentData.src || 'https://via.placeholder.com/150',\n              alt: \"Image Preview\",\n              style: {\n                maxWidth: '100%',\n                height: 'auto',\n                userSelect: 'none'\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 553,\n              columnNumber: 33\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 552,\n            columnNumber: 29\n          }, this);\n        case 'form':\n          return /*#__PURE__*/_jsxDEV(\"div\", {\n            style: previewStyle,\n            children: /*#__PURE__*/_jsxDEV(\"form\", {\n              style: {\n                display: 'flex',\n                flexDirection: 'column',\n                gap: '10px',\n                userSelect: 'none'\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"text\",\n                placeholder: \"Input\",\n                style: {\n                  padding: '8px',\n                  borderRadius: '8px',\n                  border: '1px solid #ccc'\n                },\n                readOnly: true\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 564,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                type: \"button\",\n                style: {\n                  background: '#2563eb',\n                  color: '#fff',\n                  padding: '8px 16px',\n                  borderRadius: '8px',\n                  border: 'none'\n                },\n                children: \"Submit\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 570,\n                columnNumber: 37\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 563,\n              columnNumber: 33\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 562,\n            columnNumber: 29\n          }, this);\n        default:\n          return /*#__PURE__*/_jsxDEV(\"div\", {\n            style: previewStyle\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 586,\n            columnNumber: 32\n          }, this);\n      }\n    }\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"lpb-drag-preview\",\n      style: previewStyle\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 590,\n      columnNumber: 20\n    }, this);\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"lpb-canvas-wrapper\",\n    onKeyDown: handleKeyDown,\n    tabIndex: 0,\n    style: {\n      outline: 'none'\n    },\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      ref: node => {\n        canvasRef.current = node;\n        drop(node);\n      },\n      className: `lpb-canvas ${viewMode === 'mobile' ? 'lpb-canvas-mobile' : viewMode === 'tablet' ? 'lpb-canvas-tablet' : ''}`,\n      style: {\n        position: 'relative',\n        minHeight: '100%',\n        background: ((_pageData$canvas = pageData.canvas) === null || _pageData$canvas === void 0 ? void 0 : _pageData$canvas.background) || '#ffffff',\n        transform: `scale(${zoomLevel / 100})`,\n        transformOrigin: 'top left',\n        overflow: 'hidden',\n        cursor: isOver ? 'copy' : 'default'\n      },\n      onClick: handleCanvasClick,\n      children: [/*#__PURE__*/_jsxDEV(Rulers, {\n        canvasWidth: ((_pageData$canvas2 = pageData.canvas) === null || _pageData$canvas2 === void 0 ? void 0 : _pageData$canvas2.width) || 1200,\n        canvasHeight: 1000,\n        zoomLevel: zoomLevel\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 612,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(Guidelines, {\n        guidelines: guidelines,\n        zoomLevel: zoomLevel\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 613,\n        columnNumber: 21\n      }, this), showGrid && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"lpb-canvas-grid\",\n        style: {\n          position: 'absolute',\n          top: 0,\n          left: 0,\n          right: 0,\n          bottom: 0,\n          backgroundImage: `\n                                    linear-gradient(to right, #e5e7eb 1px, transparent 1px),\n                                    linear-gradient(to bottom, #e5e7eb 1px, transparent 1px)\n                                `,\n          backgroundSize: `${gridSize}px ${gridSize}px`,\n          pointerEvents: 'none',\n          opacity: 0.5\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 615,\n        columnNumber: 25\n      }, this), pageData.elements.map(element => /*#__PURE__*/_jsxDEV(Element, {\n        element: element,\n        isSelected: selectedIds.includes(element.id),\n        onSelectElement: onSelectElement,\n        onUpdatePosition: handleUpdatePosition,\n        viewMode: viewMode,\n        zoomLevel: zoomLevel,\n        gridSize: showGrid ? gridSize : Infinity,\n        onContextMenu: handleContextMenu,\n        canvasBounds: canvasBounds,\n        canvasRef: canvasRef,\n        selectedIds: selectedIds\n      }, element.id, false, {\n        fileName: _jsxFileName,\n        lineNumber: 634,\n        columnNumber: 25\n      }, this)), renderDragPreview(), /*#__PURE__*/_jsxDEV(SelectionOverlay, {\n        selectedElements: pageData.elements.filter(el => selectedIds.includes(el.id)),\n        onResize: onUpdateSize,\n        zoomLevel: zoomLevel\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 650,\n        columnNumber: 21\n      }, this), contextMenu && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"lpb-context-menu\",\n        style: {\n          position: 'fixed',\n          left: contextMenu.position.x,\n          top: contextMenu.position.y,\n          zIndex: 10000,\n          background: '#fff',\n          border: '1px solid #ccc',\n          borderRadius: '4px',\n          boxShadow: '0 2px 8px rgba(0,0,0,0.15)',\n          minWidth: '120px'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"lpb-context-menu-item\",\n          style: {\n            padding: '8px 12px',\n            cursor: 'pointer',\n            borderBottom: '1px solid #eee'\n          },\n          onClick: () => {\n            onDeleteElement(contextMenu.id);\n            setContextMenu(null);\n          },\n          children: \"Delete\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 670,\n          columnNumber: 29\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"lpb-context-menu-item\",\n          style: {\n            padding: '8px 12px',\n            cursor: 'pointer'\n          },\n          onClick: () => {\n            onGroupElements([contextMenu.id]);\n            setContextMenu(null);\n          },\n          children: \"Group\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 680,\n          columnNumber: 29\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 656,\n        columnNumber: 25\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 595,\n      columnNumber: 17\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 594,\n    columnNumber: 13\n  }, this);\n}, \"IMXe40brRBzedzjXH+xHHKoDfOc=\", false, function () {\n  return [useHotkeys, useHotkeys, useDrop, useHotkeys, useHotkeys];\n})), \"IMXe40brRBzedzjXH+xHHKoDfOc=\", false, function () {\n  return [useHotkeys, useHotkeys, useDrop, useHotkeys, useHotkeys];\n});\n_c4 = Canvas;\nexport default Canvas;\nvar _c, _c2, _c3, _c4;\n$RefreshReg$(_c, \"Element$React.memo\");\n$RefreshReg$(_c2, \"Element\");\n$RefreshReg$(_c3, \"Canvas$React.memo\");\n$RefreshReg$(_c4, \"Canvas\");","map":{"version":3,"names":["React","useRef","useCallback","useState","useEffect","useDrop","useDrag","getEmptyImage","useHotkeys","toast","Guidelines","Rulers","SelectionOverlay","jsxDEV","_jsxDEV","ItemTypes","ELEMENT","EXISTING_ELEMENT","getCanvasPosition","mouseX","mouseY","canvasElement","zoomLevel","console","error","x","y","canvasRect","getBoundingClientRect","scrollX","scrollLeft","scrollY","scrollTop","rawX","left","rawY","top","Math","max","snapToGrid","gridSize","snapPoints","canvasBounds","disableSnap","min","width","height","snappedX","round","snappedY","forEach","point","abs","getElementBounds","element","_element$position$des","_element$position$des2","_element$position$des3","_element$size","_element$position$des4","_element$size2","_element$position$des5","_element$size3","_element$position$des6","_element$size4","position","desktop","right","size","bottom","centerX","centerY","Element","_s","memo","_c","isSelected","onSelectElement","onUpdatePosition","viewMode","onContextMenu","canvasRef","selectedIds","_position$viewMode3","_position$viewMode4","id","type","componentData","styles","elementRef","isDragStarted","setIsDragStarted","offsetRef","isDragging","drag","preview","item","_elementRef$current","_canvasRef$current","_position$viewMode","_position$viewMode2","elementRect","current","offset","elementSize","elementPosition","isExisting","end","monitor","dropResult","getDropResult","moved","log","newPosition","collect","captureDraggingState","handleMouseDown","e","stopPropagation","includes","ctrlKey","handleContextMenu","preventDefault","clientX","clientY","renderComponent","style","fontSize","color","margin","padding","userSelect","children","content","fileName","_jsxFileName","lineNumber","columnNumber","borderRadius","background","border","cursor","src","alt","maxWidth","draggable","display","flexDirection","gap","placeholder","readOnly","ref","node","className","transform","zIndex","z","opacity","boxShadow","onMouseDown","_c2","Canvas","_s2","_c3","pageData","onUpdateSize","onDeleteElement","onAddElement","onGroupElements","showGrid","_pageData$canvas","_pageData$canvas2","guidelines","setGuidelines","contextMenu","setContextMenu","dragPreview","setDragPreview","history","setHistory","historyIndex","setHistoryIndex","offsetWidth","offsetHeight","getSnapPoints","points","elements","el","bounds","push","handleUpdatePosition","newPos","mode","prevPos","prev","slice","handleUndo","info","handleRedo","length","isOver","dragItem","drop","accept","hover","_monitor$getClientOff","clientOffset","getClientOffset","pos","snapped","Infinity","altKey","_item$offset","_item$offset2","json","newGuidelines","vertical","_monitor$getClientOff2","newElement","Date","now","tablet","mobile","success","_item$offset3","_item$elementPosition","_item$offset4","_item$elementPosition2","deltaX","deltaY","selectedId","find","getItem","handleCanvasClick","target","handleKeyDown","step","shiftKey","currentPos","key","map","handleClickOutside","document","addEventListener","removeEventListener","renderDragPreview","previewStyle","pointerEvents","onKeyDown","tabIndex","outline","minHeight","canvas","transformOrigin","overflow","onClick","canvasWidth","canvasHeight","backgroundImage","backgroundSize","selectedElements","filter","onResize","minWidth","borderBottom","_c4","$RefreshReg$"],"sources":["F:/landinghub-iconic/apps/web/src/components/create-page/Canvas.js"],"sourcesContent":["import React, { useRef, useCallback, useState, useEffect } from 'react';\r\nimport { useDrop, useDrag } from 'react-dnd';\r\nimport { getEmptyImage } from 'react-dnd-html5-backend';\r\nimport { useHotkeys } from 'react-hotkeys-hook';\r\nimport { toast } from 'react-toastify';\r\nimport Guidelines from './Guidelines';\r\nimport Rulers from './Rulers';\r\nimport SelectionOverlay from './SelectionOverlay';\r\nimport '../../styles/Canvas.css';\r\n\r\nconst ItemTypes = {\r\n    ELEMENT: 'element',\r\n    EXISTING_ELEMENT: 'existingElement',\r\n};\r\n\r\n// Tính toán tọa độ chính xác trong canvas\r\nconst getCanvasPosition = (mouseX, mouseY, canvasElement, zoomLevel) => {\r\n    if (!canvasElement || !zoomLevel || zoomLevel <= 0) {\r\n        console.error('Invalid canvas element or zoomLevel:', { canvasElement, zoomLevel });\r\n        return { x: 0, y: 0 };\r\n    }\r\n\r\n    const canvasRect = canvasElement.getBoundingClientRect();\r\n    const scrollX = canvasElement.scrollLeft || 0;\r\n    const scrollY = canvasElement.scrollTop || 0;\r\n\r\n    const rawX = (mouseX - canvasRect.left + scrollX) / (zoomLevel / 100);\r\n    const rawY = (mouseY - canvasRect.top + scrollY) / (zoomLevel / 100);\r\n\r\n    return { x: Math.max(0, rawX), y: Math.max(0, rawY) };\r\n};\r\n\r\n// Snap to grid với snap points\r\nconst snapToGrid = (x, y, gridSize, snapPoints = [], canvasBounds, disableSnap = false) => {\r\n    if (disableSnap) {\r\n        return {\r\n            x: Math.max(0, Math.min(x, canvasBounds.width)),\r\n            y: Math.max(0, Math.min(y, canvasBounds.height)),\r\n        };\r\n    }\r\n\r\n    let snappedX = Math.round(x / gridSize) * gridSize;\r\n    let snappedY = Math.round(y / gridSize) * gridSize;\r\n\r\n    snapPoints.forEach((point) => {\r\n        if (Math.abs(x - point.x) < 15) snappedX = point.x;\r\n        if (Math.abs(y - point.y) < 15) snappedY = point.y;\r\n    });\r\n\r\n    snappedX = Math.max(0, Math.min(snappedX, canvasBounds.width));\r\n    snappedY = Math.max(0, Math.min(snappedY, canvasBounds.height));\r\n\r\n    return { x: snappedX, y: snappedY };\r\n};\r\n\r\n// Tính bounds của element\r\nconst getElementBounds = (element) => ({\r\n    left: element.position.desktop?.x || 0,\r\n    top: element.position.desktop?.y || 0,\r\n    right: (element.position.desktop?.x || 0) + (element.size?.width || 200),\r\n    bottom: (element.position.desktop?.y || 0) + (element.size?.height || 50),\r\n    centerX: (element.position.desktop?.x || 0) + (element.size?.width || 200) / 2,\r\n    centerY: (element.position.desktop?.y || 0) + (element.size?.height || 50) / 2,\r\n});\r\n\r\n// Component Element\r\nconst Element = React.memo(\r\n    ({\r\n         element,\r\n         isSelected,\r\n         onSelectElement,\r\n         onUpdatePosition,\r\n         viewMode,\r\n         zoomLevel,\r\n         gridSize,\r\n         onContextMenu,\r\n         canvasBounds,\r\n         canvasRef,\r\n         selectedIds,\r\n     }) => {\r\n        const { id, type, componentData = {}, position = {}, size = { width: 200, height: 50 }, styles = {} } = element;\r\n        const elementRef = useRef(null);\r\n        const [isDragStarted, setIsDragStarted] = useState(false);\r\n        const offsetRef = useRef({ x: 0, y: 0 });\r\n\r\n        const [{ isDragging }, drag, preview] = useDrag(() => ({\r\n            type: ItemTypes.EXISTING_ELEMENT,\r\n            item: () => {\r\n                setIsDragStarted(true);\r\n                const elementRect = elementRef.current?.getBoundingClientRect();\r\n                const canvasRect = canvasRef.current?.getBoundingClientRect();\r\n                if (!elementRect || !canvasRect) {\r\n                    console.error('Cannot calculate offset for element:', id);\r\n                    return { id, offset: { x: 0, y: 0 }, selectedIds };\r\n                }\r\n                const offset = {\r\n                    x: (elementRect.left - canvasRect.left) / (zoomLevel / 100) - (position[viewMode]?.x || 0),\r\n                    y: (elementRect.top - canvasRect.top) / (zoomLevel / 100) - (position[viewMode]?.y || 0),\r\n                };\r\n                offsetRef.current = offset;\r\n                return { id, offset, selectedIds, elementSize: size, elementPosition: position[viewMode] || { x: 0, y: 0 }, isExisting: true };\r\n            },\r\n            end: (item, monitor) => {\r\n                setIsDragStarted(false);\r\n                const dropResult = monitor.getDropResult();\r\n                if (!dropResult || !dropResult.moved) {\r\n                    console.log('Drag cancelled or invalid drop for element:', id);\r\n                    return;\r\n                }\r\n                console.log('Drag ended successfully for element:', id, 'New position:', dropResult.newPosition);\r\n            },\r\n            collect: (monitor) => ({\r\n                isDragging: monitor.isDragging(),\r\n            }),\r\n        }), [id, size, position, viewMode, selectedIds]);\r\n\r\n        useEffect(() => {\r\n            preview(getEmptyImage(), { captureDraggingState: true });\r\n        }, [preview]);\r\n\r\n        const handleMouseDown = useCallback(\r\n            (e) => {\r\n                e.stopPropagation();\r\n                if (!selectedIds.includes(id)) {\r\n                    onSelectElement(id, e.ctrlKey);\r\n                }\r\n            },\r\n            [id, onSelectElement, selectedIds]\r\n        );\r\n\r\n        const handleContextMenu = useCallback(\r\n            (e) => {\r\n                e.preventDefault();\r\n                e.stopPropagation();\r\n                onContextMenu(id, { x: e.clientX, y: e.clientY });\r\n            },\r\n            [id, onContextMenu]\r\n        );\r\n\r\n        const renderComponent = useCallback(() => {\r\n            switch (type) {\r\n                case 'heading':\r\n                    return (\r\n                        <h2 style={{ fontSize: componentData.fontSize || '1.5rem', color: componentData.color || '#1f2937', margin: 0, padding: 0, userSelect: 'none' }}>\r\n                            {componentData.content || 'Tiêu đề'}\r\n                        </h2>\r\n                    );\r\n                case 'paragraph':\r\n                    return (\r\n                        <p style={{ fontSize: componentData.fontSize || '1rem', color: componentData.color || '#1f2937', margin: 0, padding: 0, userSelect: 'none' }}>\r\n                            {componentData.content || 'Đoạn văn'}\r\n                        </p>\r\n                    );\r\n                case 'button':\r\n                    return (\r\n                        <button\r\n                            style={{\r\n                                padding: '8px 16px',\r\n                                borderRadius: '8px',\r\n                                background: componentData.background || '#2563eb',\r\n                                color: componentData.color || '#fff',\r\n                                border: 'none',\r\n                                cursor: 'pointer',\r\n                                userSelect: 'none',\r\n                            }}\r\n                        >\r\n                            {componentData.content || 'Nút'}\r\n                        </button>\r\n                    );\r\n                case 'image':\r\n                    return (\r\n                        <img\r\n                            src={componentData.src || 'https://via.placeholder.com/150'}\r\n                            alt=\"Image\"\r\n                            style={{ maxWidth: '100%', height: 'auto', userSelect: 'none' }}\r\n                            draggable={false}\r\n                        />\r\n                    );\r\n                case 'form':\r\n                    return (\r\n                        <form style={{ display: 'flex', flexDirection: 'column', gap: '10px', userSelect: 'none' }}>\r\n                            <input\r\n                                type=\"text\"\r\n                                placeholder=\"Input\"\r\n                                style={{ padding: '8px', borderRadius: '8px', border: '1px solid #ccc' }}\r\n                                readOnly\r\n                            />\r\n                            <button\r\n                                type=\"button\"\r\n                                style={{\r\n                                    background: '#2563eb',\r\n                                    color: '#fff',\r\n                                    padding: '8px 16px',\r\n                                    borderRadius: '8px',\r\n                                    border: 'none',\r\n                                    cursor: 'pointer',\r\n                                }}\r\n                            >\r\n                                Submit\r\n                            </button>\r\n                        </form>\r\n                    );\r\n                default:\r\n                    return <div style={{ userSelect: 'none' }}>{componentData.content || 'Unknown'}</div>;\r\n            }\r\n        }, [type, componentData]);\r\n\r\n        return (\r\n            <div\r\n                ref={(node) => {\r\n                    elementRef.current = node;\r\n                    drag(node);\r\n                }}\r\n                className={`lpb-canvas-element ${isSelected ? 'lpb-canvas-element-selected' : ''} ${isDragging ? 'lpb-canvas-element-dragging' : ''}`}\r\n                style={{\r\n                    position: 'absolute',\r\n                    transform: `translate(${position[viewMode]?.x || 0}px, ${position[viewMode]?.y || 0}px)`,\r\n                    width: size.width,\r\n                    height: size.height,\r\n                    zIndex: position.z || 1,\r\n                    opacity: isDragging ? 0.5 : 1,\r\n                    cursor: isDragging ? 'grabbing' : 'grab',\r\n                    boxShadow: isDragging ? '0 4px 8px rgba(0,0,0,0.2)' : 'none',\r\n                    userSelect: 'none',\r\n                    ...styles,\r\n                }}\r\n                onMouseDown={handleMouseDown}\r\n                onContextMenu={handleContextMenu}\r\n            >\r\n                {renderComponent()}\r\n            </div>\r\n        );\r\n    }\r\n);\r\n\r\n// Component Canvas chính\r\nconst Canvas = React.memo(\r\n    ({\r\n         pageData,\r\n         selectedIds,\r\n         onSelectElement,\r\n         onUpdatePosition,\r\n         onUpdateSize,\r\n         onDeleteElement,\r\n         onAddElement,\r\n         onGroupElements,\r\n         viewMode,\r\n         zoomLevel,\r\n         gridSize,\r\n         showGrid,\r\n     }) => {\r\n        const canvasRef = useRef(null);\r\n        const [guidelines, setGuidelines] = useState([]);\r\n        const [contextMenu, setContextMenu] = useState(null);\r\n        const [dragPreview, setDragPreview] = useState(null);\r\n        const [history, setHistory] = useState([]); // Stack cho undo/redo\r\n        const [historyIndex, setHistoryIndex] = useState(-1);\r\n\r\n        const canvasBounds = canvasRef.current\r\n            ? {\r\n                width: canvasRef.current.offsetWidth / (zoomLevel / 100),\r\n                height: canvasRef.current.offsetHeight / (zoomLevel / 100),\r\n            }\r\n            : { width: 1200, height: 1000 };\r\n\r\n        const getSnapPoints = useCallback(() => {\r\n            const points = [\r\n                { x: 0, y: 0 },\r\n                { x: canvasBounds.width, y: canvasBounds.height },\r\n                { x: canvasBounds.width / 2, y: canvasBounds.height / 2 },\r\n            ];\r\n\r\n            pageData.elements.forEach((el) => {\r\n                const bounds = getElementBounds(el);\r\n                points.push(\r\n                    { x: bounds.left, y: bounds.top },\r\n                    { x: bounds.right, y: bounds.bottom },\r\n                    { x: bounds.centerX, y: bounds.centerY },\r\n                    { x: bounds.left, y: bounds.centerY },\r\n                    { x: bounds.right, y: bounds.centerY },\r\n                    { x: bounds.centerX, y: bounds.top },\r\n                    { x: bounds.centerX, y: bounds.bottom }\r\n                );\r\n            });\r\n\r\n            return points;\r\n        }, [pageData.elements, canvasBounds]);\r\n\r\n        const handleUpdatePosition = (id, newPos, mode, prevPos) => {\r\n            if (mode === 'replace' && prevPos) {\r\n                setHistory((prev) => [...prev.slice(0, historyIndex + 1), { id, prevPos, newPos }]);\r\n                setHistoryIndex((prev) => prev + 1);\r\n            }\r\n            onUpdatePosition(id, newPos, mode);\r\n        };\r\n\r\n        const handleUndo = useCallback(() => {\r\n            if (historyIndex >= 0) {\r\n                const { id, prevPos } = history[historyIndex];\r\n                onUpdatePosition(id, { [viewMode]: prevPos }, 'replace');\r\n                setHistoryIndex((prev) => prev - 1);\r\n                toast.info('Đã hoàn tác di chuyển');\r\n            }\r\n        }, [history, historyIndex, onUpdatePosition, viewMode]);\r\n\r\n        const handleRedo = useCallback(() => {\r\n            if (historyIndex < history.length - 1) {\r\n                const { id, newPos } = history[historyIndex + 1];\r\n                onUpdatePosition(id, { [viewMode]: newPos }, 'replace');\r\n                setHistoryIndex((prev) => prev + 1);\r\n                toast.info('Đã thực hiện lại di chuyển');\r\n            }\r\n        }, [history, historyIndex, onUpdatePosition, viewMode]);\r\n\r\n        useHotkeys('ctrl+z', handleUndo, [history, historyIndex]);\r\n        useHotkeys('ctrl+y', handleRedo, [history, historyIndex]);\r\n\r\n        const [{ isOver, dragItem }, drop] = useDrop(() => ({\r\n            accept: [ItemTypes.ELEMENT, ItemTypes.EXISTING_ELEMENT],\r\n            hover: (item, monitor) => {\r\n                const clientOffset = monitor.getClientOffset();\r\n                if (!clientOffset || !canvasRef.current) return;\r\n\r\n                const pos = getCanvasPosition(clientOffset.x, clientOffset.y, canvasRef.current, zoomLevel);\r\n                const snapPoints = getSnapPoints();\r\n                const snapped = snapToGrid(pos.x, pos.y, showGrid ? gridSize : Infinity, snapPoints, canvasBounds, monitor.getClientOffset()?.altKey);\r\n\r\n                // Cập nhật drag preview\r\n                if (item.isExisting) {\r\n                    setDragPreview({\r\n                        id: item.id,\r\n                        x: snapped.x - (item.offset?.x || 0),\r\n                        y: snapped.y - (item.offset?.y || 0),\r\n                        size: item.elementSize || { width: 200, height: 50 },\r\n                    });\r\n                } else if (item.json) {\r\n                    setDragPreview({\r\n                        id: 'preview',\r\n                        x: snapped.x,\r\n                        y: snapped.y,\r\n                        size: item.json.size || { width: 200, height: 50 },\r\n                        type: item.json.type,\r\n                        componentData: item.json.componentData,\r\n                    });\r\n                }\r\n\r\n                const newGuidelines = [];\r\n                snapPoints.forEach((point) => {\r\n                    if (Math.abs(snapped.x - point.x) < 15) {\r\n                        newGuidelines.push({ vertical: true, position: point.x });\r\n                    }\r\n                    if (Math.abs(snapped.y - point.y) < 15) {\r\n                        newGuidelines.push({ vertical: false, position: point.y });\r\n                    }\r\n                });\r\n                setGuidelines(newGuidelines);\r\n            },\r\n            drop: (item, monitor) => {\r\n                const clientOffset = monitor.getClientOffset();\r\n                if (!clientOffset || !canvasRef.current) {\r\n                    toast.error('Không thể xác định vị trí thả!');\r\n                    return { moved: false };\r\n                }\r\n\r\n                const pos = getCanvasPosition(clientOffset.x, clientOffset.y, canvasRef.current, zoomLevel);\r\n                const snapPoints = getSnapPoints();\r\n                const snapped = snapToGrid(pos.x, pos.y, showGrid ? gridSize : Infinity, snapPoints, canvasBounds, monitor.getClientOffset()?.altKey);\r\n\r\n                if (item.json && !item.isExisting) {\r\n                    // Thêm phần tử mới từ ComponentLibrary\r\n                    const newElement = {\r\n                        id: `${item.id}-${Date.now()}`,\r\n                        type: item.json.type,\r\n                        componentData: item.json.componentData || {},\r\n                        position: { [viewMode]: snapped, desktop: snapped, tablet: snapped, mobile: snapped },\r\n                        size: item.json.size || { width: 200, height: 50 },\r\n                        styles: item.json.styles || {},\r\n                    };\r\n                    onAddElement(newElement);\r\n                    toast.success('Đã thêm phần tử!');\r\n                    setDragPreview(null);\r\n                    setGuidelines([]);\r\n                    return { moved: true, newPosition: snapped };\r\n                } else if (item.id && item.isExisting) {\r\n                    // Di chuyển phần tử hiện có (bao gồm nhóm nếu được chọn)\r\n                    const deltaX = snapped.x - (item.offset?.x || 0) - (item.elementPosition?.x || 0);\r\n                    const deltaY = snapped.y - (item.offset?.y || 0) - (item.elementPosition?.y || 0);\r\n\r\n                    item.selectedIds.forEach((selectedId) => {\r\n                        const element = pageData.elements.find((el) => el.id === selectedId);\r\n                        if (element) {\r\n                            const prevPos = element.position[viewMode] || { x: 0, y: 0 };\r\n                            const newPos = {\r\n                                x: Math.max(0, Math.min(prevPos.x + deltaX, canvasBounds.width - element.size.width)),\r\n                                y: Math.max(0, Math.min(prevPos.y + deltaY, canvasBounds.height - element.size.height)),\r\n                            };\r\n                            handleUpdatePosition(selectedId, { [viewMode]: newPos }, 'replace', prevPos);\r\n                        }\r\n                    });\r\n                    toast.success('Đã di chuyển phần tử!');\r\n                    setDragPreview(null);\r\n                    setGuidelines([]);\r\n                    return { moved: true, newPosition: snapped };\r\n                }\r\n\r\n                setDragPreview(null);\r\n                setGuidelines([]);\r\n                return { moved: false };\r\n            },\r\n            collect: (monitor) => ({\r\n                isOver: monitor.isOver(),\r\n                dragItem: monitor.getItem(),\r\n            }),\r\n        }), [pageData.elements, viewMode, zoomLevel, gridSize, showGrid, canvasBounds, onAddElement, onUpdatePosition, selectedIds]);\r\n\r\n        const handleCanvasClick = useCallback(\r\n            (e) => {\r\n                if (e.target === canvasRef.current) {\r\n                    onSelectElement([]);\r\n                    setContextMenu(null);\r\n                }\r\n            },\r\n            [onSelectElement]\r\n        );\r\n\r\n        const handleContextMenu = useCallback((id, position) => {\r\n            setContextMenu({ id, position });\r\n        }, []);\r\n\r\n        const handleKeyDown = useCallback(\r\n            (e) => {\r\n                if (!selectedIds.length) return;\r\n\r\n                e.preventDefault();\r\n                e.stopPropagation();\r\n\r\n                const step = e.shiftKey ? 10 : 1;\r\n\r\n                selectedIds.forEach((id) => {\r\n                    const element = pageData.elements.find((el) => el.id === id);\r\n                    if (!element) return;\r\n\r\n                    const currentPos = element.position[viewMode] || { x: 0, y: 0 };\r\n                    let newPos;\r\n                    switch (e.key) {\r\n                        case 'ArrowUp':\r\n                            newPos = { x: currentPos.x, y: Math.max(0, currentPos.y - step) };\r\n                            break;\r\n                        case 'ArrowDown':\r\n                            newPos = { x: currentPos.x, y: Math.min(canvasBounds.height - element.size.height, currentPos.y + step) };\r\n                            break;\r\n                        case 'ArrowLeft':\r\n                            newPos = { x: Math.max(0, currentPos.x - step), y: currentPos.y };\r\n                            break;\r\n                        case 'ArrowRight':\r\n                            newPos = { x: Math.min(canvasBounds.width - element.size.width, currentPos.x + step), y: currentPos.y };\r\n                            break;\r\n                        case 'Delete':\r\n                        case 'Backspace':\r\n                            onDeleteElement(id);\r\n                            return;\r\n                        case 'Escape':\r\n                            onSelectElement([]);\r\n                            setContextMenu(null);\r\n                            return;\r\n                        default:\r\n                            return;\r\n                    }\r\n                    if (newPos) {\r\n                        handleUpdatePosition(id, { [viewMode]: newPos }, 'replace', currentPos);\r\n                    }\r\n                });\r\n            },\r\n            [selectedIds, onUpdatePosition, onDeleteElement, onSelectElement, viewMode, pageData.elements, canvasBounds]\r\n        );\r\n\r\n        useHotkeys('ctrl+a', (e) => {\r\n            e.preventDefault();\r\n            onSelectElement(pageData.elements.map((el) => el.id));\r\n        }, [pageData.elements, onSelectElement]);\r\n\r\n        useHotkeys('ctrl+g', (e) => {\r\n            e.preventDefault();\r\n            if (selectedIds.length > 1) {\r\n                onGroupElements(selectedIds);\r\n            }\r\n        }, [selectedIds, onGroupElements]);\r\n\r\n        useEffect(() => {\r\n            const handleClickOutside = () => setContextMenu(null);\r\n            if (contextMenu) {\r\n                document.addEventListener('click', handleClickOutside);\r\n                return () => document.removeEventListener('click', handleClickOutside);\r\n            }\r\n        }, [contextMenu]);\r\n\r\n        const renderDragPreview = () => {\r\n            if (!dragPreview) return null;\r\n            const { x, y, size, type, componentData } = dragPreview;\r\n\r\n            const previewStyle = {\r\n                position: 'absolute',\r\n                transform: `translate(${x}px, ${y}px)`,\r\n                width: size.width,\r\n                height: size.height,\r\n                border: '2px dashed #3b82f6',\r\n                background: 'rgba(59, 130, 246, 0.1)',\r\n                pointerEvents: 'none',\r\n                zIndex: 1000,\r\n                opacity: 0.5,\r\n            };\r\n\r\n            if (type && componentData) {\r\n                // Preview chi tiết cho phần tử mới\r\n                switch (type) {\r\n                    case 'heading':\r\n                        return (\r\n                            <div style={previewStyle}>\r\n                                <h2 style={{ fontSize: componentData.fontSize || '1.5rem', color: componentData.color || '#1f2937', margin: 0, padding: 0, userSelect: 'none' }}>\r\n                                    {componentData.content || 'Tiêu đề'}\r\n                                </h2>\r\n                            </div>\r\n                        );\r\n                    case 'paragraph':\r\n                        return (\r\n                            <div style={previewStyle}>\r\n                                <p style={{ fontSize: componentData.fontSize || '1rem', color: componentData.color || '#1f2937', margin: 0, padding: 0, userSelect: 'none' }}>\r\n                                    {componentData.content || 'Đoạn văn'}\r\n                                </p>\r\n                            </div>\r\n                        );\r\n                    case 'button':\r\n                        return (\r\n                            <div style={previewStyle}>\r\n                                <button\r\n                                    style={{\r\n                                        padding: '8px 16px',\r\n                                        borderRadius: '8px',\r\n                                        background: componentData.background || '#2563eb',\r\n                                        color: componentData.color || '#fff',\r\n                                        border: 'none',\r\n                                        cursor: 'pointer',\r\n                                        userSelect: 'none',\r\n                                    }}\r\n                                >\r\n                                    {componentData.content || 'Nút'}\r\n                                </button>\r\n                            </div>\r\n                        );\r\n                    case 'image':\r\n                        return (\r\n                            <div style={previewStyle}>\r\n                                <img\r\n                                    src={componentData.src || 'https://via.placeholder.com/150'}\r\n                                    alt=\"Image Preview\"\r\n                                    style={{ maxWidth: '100%', height: 'auto', userSelect: 'none' }}\r\n                                />\r\n                            </div>\r\n                        );\r\n                    case 'form':\r\n                        return (\r\n                            <div style={previewStyle}>\r\n                                <form style={{ display: 'flex', flexDirection: 'column', gap: '10px', userSelect: 'none' }}>\r\n                                    <input\r\n                                        type=\"text\"\r\n                                        placeholder=\"Input\"\r\n                                        style={{ padding: '8px', borderRadius: '8px', border: '1px solid #ccc' }}\r\n                                        readOnly\r\n                                    />\r\n                                    <button\r\n                                        type=\"button\"\r\n                                        style={{\r\n                                            background: '#2563eb',\r\n                                            color: '#fff',\r\n                                            padding: '8px 16px',\r\n                                            borderRadius: '8px',\r\n                                            border: 'none',\r\n                                        }}\r\n                                    >\r\n                                        Submit\r\n                                    </button>\r\n                                </form>\r\n                            </div>\r\n                        );\r\n                    default:\r\n                        return <div style={previewStyle} />;\r\n                }\r\n            }\r\n\r\n            return <div className=\"lpb-drag-preview\" style={previewStyle} />;\r\n        };\r\n\r\n        return (\r\n            <div className=\"lpb-canvas-wrapper\" onKeyDown={handleKeyDown} tabIndex={0} style={{ outline: 'none' }}>\r\n                <div\r\n                    ref={(node) => {\r\n                        canvasRef.current = node;\r\n                        drop(node);\r\n                    }}\r\n                    className={`lpb-canvas ${viewMode === 'mobile' ? 'lpb-canvas-mobile' : viewMode === 'tablet' ? 'lpb-canvas-tablet' : ''}`}\r\n                    style={{\r\n                        position: 'relative',\r\n                        minHeight: '100%',\r\n                        background: pageData.canvas?.background || '#ffffff',\r\n                        transform: `scale(${zoomLevel / 100})`,\r\n                        transformOrigin: 'top left',\r\n                        overflow: 'hidden',\r\n                        cursor: isOver ? 'copy' : 'default',\r\n                    }}\r\n                    onClick={handleCanvasClick}\r\n                >\r\n                    <Rulers canvasWidth={pageData.canvas?.width || 1200} canvasHeight={1000} zoomLevel={zoomLevel} />\r\n                    <Guidelines guidelines={guidelines} zoomLevel={zoomLevel} />\r\n                    {showGrid && (\r\n                        <div\r\n                            className=\"lpb-canvas-grid\"\r\n                            style={{\r\n                                position: 'absolute',\r\n                                top: 0,\r\n                                left: 0,\r\n                                right: 0,\r\n                                bottom: 0,\r\n                                backgroundImage: `\r\n                                    linear-gradient(to right, #e5e7eb 1px, transparent 1px),\r\n                                    linear-gradient(to bottom, #e5e7eb 1px, transparent 1px)\r\n                                `,\r\n                                backgroundSize: `${gridSize}px ${gridSize}px`,\r\n                                pointerEvents: 'none',\r\n                                opacity: 0.5,\r\n                            }}\r\n                        />\r\n                    )}\r\n                    {pageData.elements.map((element) => (\r\n                        <Element\r\n                            key={element.id}\r\n                            element={element}\r\n                            isSelected={selectedIds.includes(element.id)}\r\n                            onSelectElement={onSelectElement}\r\n                            onUpdatePosition={handleUpdatePosition}\r\n                            viewMode={viewMode}\r\n                            zoomLevel={zoomLevel}\r\n                            gridSize={showGrid ? gridSize : Infinity}\r\n                            onContextMenu={handleContextMenu}\r\n                            canvasBounds={canvasBounds}\r\n                            canvasRef={canvasRef}\r\n                            selectedIds={selectedIds}\r\n                        />\r\n                    ))}\r\n                    {renderDragPreview()}\r\n                    <SelectionOverlay\r\n                        selectedElements={pageData.elements.filter((el) => selectedIds.includes(el.id))}\r\n                        onResize={onUpdateSize}\r\n                        zoomLevel={zoomLevel}\r\n                    />\r\n                    {contextMenu && (\r\n                        <div\r\n                            className=\"lpb-context-menu\"\r\n                            style={{\r\n                                position: 'fixed',\r\n                                left: contextMenu.position.x,\r\n                                top: contextMenu.position.y,\r\n                                zIndex: 10000,\r\n                                background: '#fff',\r\n                                border: '1px solid #ccc',\r\n                                borderRadius: '4px',\r\n                                boxShadow: '0 2px 8px rgba(0,0,0,0.15)',\r\n                                minWidth: '120px',\r\n                            }}\r\n                        >\r\n                            <div\r\n                                className=\"lpb-context-menu-item\"\r\n                                style={{ padding: '8px 12px', cursor: 'pointer', borderBottom: '1px solid #eee' }}\r\n                                onClick={() => {\r\n                                    onDeleteElement(contextMenu.id);\r\n                                    setContextMenu(null);\r\n                                }}\r\n                            >\r\n                                Delete\r\n                            </div>\r\n                            <div\r\n                                className=\"lpb-context-menu-item\"\r\n                                style={{ padding: '8px 12px', cursor: 'pointer' }}\r\n                                onClick={() => {\r\n                                    onGroupElements([contextMenu.id]);\r\n                                    setContextMenu(null);\r\n                                }}\r\n                            >\r\n                                Group\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n);\r\n\r\nexport default Canvas;"],"mappings":";;;AAAA,OAAOA,KAAK,IAAIC,MAAM,EAAEC,WAAW,EAAEC,QAAQ,EAAEC,SAAS,QAAQ,OAAO;AACvE,SAASC,OAAO,EAAEC,OAAO,QAAQ,WAAW;AAC5C,SAASC,aAAa,QAAQ,yBAAyB;AACvD,SAASC,UAAU,QAAQ,oBAAoB;AAC/C,SAASC,KAAK,QAAQ,gBAAgB;AACtC,OAAOC,UAAU,MAAM,cAAc;AACrC,OAAOC,MAAM,MAAM,UAAU;AAC7B,OAAOC,gBAAgB,MAAM,oBAAoB;AACjD,OAAO,yBAAyB;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAEjC,MAAMC,SAAS,GAAG;EACdC,OAAO,EAAE,SAAS;EAClBC,gBAAgB,EAAE;AACtB,CAAC;;AAED;AACA,MAAMC,iBAAiB,GAAGA,CAACC,MAAM,EAAEC,MAAM,EAAEC,aAAa,EAAEC,SAAS,KAAK;EACpE,IAAI,CAACD,aAAa,IAAI,CAACC,SAAS,IAAIA,SAAS,IAAI,CAAC,EAAE;IAChDC,OAAO,CAACC,KAAK,CAAC,sCAAsC,EAAE;MAAEH,aAAa;MAAEC;IAAU,CAAC,CAAC;IACnF,OAAO;MAAEG,CAAC,EAAE,CAAC;MAAEC,CAAC,EAAE;IAAE,CAAC;EACzB;EAEA,MAAMC,UAAU,GAAGN,aAAa,CAACO,qBAAqB,CAAC,CAAC;EACxD,MAAMC,OAAO,GAAGR,aAAa,CAACS,UAAU,IAAI,CAAC;EAC7C,MAAMC,OAAO,GAAGV,aAAa,CAACW,SAAS,IAAI,CAAC;EAE5C,MAAMC,IAAI,GAAG,CAACd,MAAM,GAAGQ,UAAU,CAACO,IAAI,GAAGL,OAAO,KAAKP,SAAS,GAAG,GAAG,CAAC;EACrE,MAAMa,IAAI,GAAG,CAACf,MAAM,GAAGO,UAAU,CAACS,GAAG,GAAGL,OAAO,KAAKT,SAAS,GAAG,GAAG,CAAC;EAEpE,OAAO;IAAEG,CAAC,EAAEY,IAAI,CAACC,GAAG,CAAC,CAAC,EAAEL,IAAI,CAAC;IAAEP,CAAC,EAAEW,IAAI,CAACC,GAAG,CAAC,CAAC,EAAEH,IAAI;EAAE,CAAC;AACzD,CAAC;;AAED;AACA,MAAMI,UAAU,GAAGA,CAACd,CAAC,EAAEC,CAAC,EAAEc,QAAQ,EAAEC,UAAU,GAAG,EAAE,EAAEC,YAAY,EAAEC,WAAW,GAAG,KAAK,KAAK;EACvF,IAAIA,WAAW,EAAE;IACb,OAAO;MACHlB,CAAC,EAAEY,IAAI,CAACC,GAAG,CAAC,CAAC,EAAED,IAAI,CAACO,GAAG,CAACnB,CAAC,EAAEiB,YAAY,CAACG,KAAK,CAAC,CAAC;MAC/CnB,CAAC,EAAEW,IAAI,CAACC,GAAG,CAAC,CAAC,EAAED,IAAI,CAACO,GAAG,CAAClB,CAAC,EAAEgB,YAAY,CAACI,MAAM,CAAC;IACnD,CAAC;EACL;EAEA,IAAIC,QAAQ,GAAGV,IAAI,CAACW,KAAK,CAACvB,CAAC,GAAGe,QAAQ,CAAC,GAAGA,QAAQ;EAClD,IAAIS,QAAQ,GAAGZ,IAAI,CAACW,KAAK,CAACtB,CAAC,GAAGc,QAAQ,CAAC,GAAGA,QAAQ;EAElDC,UAAU,CAACS,OAAO,CAAEC,KAAK,IAAK;IAC1B,IAAId,IAAI,CAACe,GAAG,CAAC3B,CAAC,GAAG0B,KAAK,CAAC1B,CAAC,CAAC,GAAG,EAAE,EAAEsB,QAAQ,GAAGI,KAAK,CAAC1B,CAAC;IAClD,IAAIY,IAAI,CAACe,GAAG,CAAC1B,CAAC,GAAGyB,KAAK,CAACzB,CAAC,CAAC,GAAG,EAAE,EAAEuB,QAAQ,GAAGE,KAAK,CAACzB,CAAC;EACtD,CAAC,CAAC;EAEFqB,QAAQ,GAAGV,IAAI,CAACC,GAAG,CAAC,CAAC,EAAED,IAAI,CAACO,GAAG,CAACG,QAAQ,EAAEL,YAAY,CAACG,KAAK,CAAC,CAAC;EAC9DI,QAAQ,GAAGZ,IAAI,CAACC,GAAG,CAAC,CAAC,EAAED,IAAI,CAACO,GAAG,CAACK,QAAQ,EAAEP,YAAY,CAACI,MAAM,CAAC,CAAC;EAE/D,OAAO;IAAErB,CAAC,EAAEsB,QAAQ;IAAErB,CAAC,EAAEuB;EAAS,CAAC;AACvC,CAAC;;AAED;AACA,MAAMI,gBAAgB,GAAIC,OAAO;EAAA,IAAAC,qBAAA,EAAAC,sBAAA,EAAAC,sBAAA,EAAAC,aAAA,EAAAC,sBAAA,EAAAC,cAAA,EAAAC,sBAAA,EAAAC,cAAA,EAAAC,sBAAA,EAAAC,cAAA;EAAA,OAAM;IACnC9B,IAAI,EAAE,EAAAqB,qBAAA,GAAAD,OAAO,CAACW,QAAQ,CAACC,OAAO,cAAAX,qBAAA,uBAAxBA,qBAAA,CAA0B9B,CAAC,KAAI,CAAC;IACtCW,GAAG,EAAE,EAAAoB,sBAAA,GAAAF,OAAO,CAACW,QAAQ,CAACC,OAAO,cAAAV,sBAAA,uBAAxBA,sBAAA,CAA0B9B,CAAC,KAAI,CAAC;IACrCyC,KAAK,EAAE,CAAC,EAAAV,sBAAA,GAAAH,OAAO,CAACW,QAAQ,CAACC,OAAO,cAAAT,sBAAA,uBAAxBA,sBAAA,CAA0BhC,CAAC,KAAI,CAAC,KAAK,EAAAiC,aAAA,GAAAJ,OAAO,CAACc,IAAI,cAAAV,aAAA,uBAAZA,aAAA,CAAcb,KAAK,KAAI,GAAG,CAAC;IACxEwB,MAAM,EAAE,CAAC,EAAAV,sBAAA,GAAAL,OAAO,CAACW,QAAQ,CAACC,OAAO,cAAAP,sBAAA,uBAAxBA,sBAAA,CAA0BjC,CAAC,KAAI,CAAC,KAAK,EAAAkC,cAAA,GAAAN,OAAO,CAACc,IAAI,cAAAR,cAAA,uBAAZA,cAAA,CAAcd,MAAM,KAAI,EAAE,CAAC;IACzEwB,OAAO,EAAE,CAAC,EAAAT,sBAAA,GAAAP,OAAO,CAACW,QAAQ,CAACC,OAAO,cAAAL,sBAAA,uBAAxBA,sBAAA,CAA0BpC,CAAC,KAAI,CAAC,IAAI,CAAC,EAAAqC,cAAA,GAAAR,OAAO,CAACc,IAAI,cAAAN,cAAA,uBAAZA,cAAA,CAAcjB,KAAK,KAAI,GAAG,IAAI,CAAC;IAC9E0B,OAAO,EAAE,CAAC,EAAAR,sBAAA,GAAAT,OAAO,CAACW,QAAQ,CAACC,OAAO,cAAAH,sBAAA,uBAAxBA,sBAAA,CAA0BrC,CAAC,KAAI,CAAC,IAAI,CAAC,EAAAsC,cAAA,GAAAV,OAAO,CAACc,IAAI,cAAAJ,cAAA,uBAAZA,cAAA,CAAclB,MAAM,KAAI,EAAE,IAAI;EACjF,CAAC;AAAA,CAAC;;AAEF;AACA,MAAM0B,OAAO,gBAAAC,EAAA,cAAGzE,KAAK,CAAC0E,IAAI,CAAAC,EAAA,GAAAF,EAAA,CACtB,CAAC;EACInB,OAAO;EACPsB,UAAU;EACVC,eAAe;EACfC,gBAAgB;EAChBC,QAAQ;EACRzD,SAAS;EACTkB,QAAQ;EACRwC,aAAa;EACbtC,YAAY;EACZuC,SAAS;EACTC;AACJ,CAAC,KAAK;EAAA,IAAAC,mBAAA,EAAAC,mBAAA;EAAAX,EAAA;EACH,MAAM;IAAEY,EAAE;IAAEC,IAAI;IAAEC,aAAa,GAAG,CAAC,CAAC;IAAEtB,QAAQ,GAAG,CAAC,CAAC;IAAEG,IAAI,GAAG;MAAEvB,KAAK,EAAE,GAAG;MAAEC,MAAM,EAAE;IAAG,CAAC;IAAE0C,MAAM,GAAG,CAAC;EAAE,CAAC,GAAGlC,OAAO;EAC/G,MAAMmC,UAAU,GAAGxF,MAAM,CAAC,IAAI,CAAC;EAC/B,MAAM,CAACyF,aAAa,EAAEC,gBAAgB,CAAC,GAAGxF,QAAQ,CAAC,KAAK,CAAC;EACzD,MAAMyF,SAAS,GAAG3F,MAAM,CAAC;IAAEwB,CAAC,EAAE,CAAC;IAAEC,CAAC,EAAE;EAAE,CAAC,CAAC;EAExC,MAAM,CAAC;IAAEmE;EAAW,CAAC,EAAEC,IAAI,EAAEC,OAAO,CAAC,GAAGzF,OAAO,CAAC,OAAO;IACnDgF,IAAI,EAAEvE,SAAS,CAACE,gBAAgB;IAChC+E,IAAI,EAAEA,CAAA,KAAM;MAAA,IAAAC,mBAAA,EAAAC,kBAAA,EAAAC,kBAAA,EAAAC,mBAAA;MACRT,gBAAgB,CAAC,IAAI,CAAC;MACtB,MAAMU,WAAW,IAAAJ,mBAAA,GAAGR,UAAU,CAACa,OAAO,cAAAL,mBAAA,uBAAlBA,mBAAA,CAAoBrE,qBAAqB,CAAC,CAAC;MAC/D,MAAMD,UAAU,IAAAuE,kBAAA,GAAGjB,SAAS,CAACqB,OAAO,cAAAJ,kBAAA,uBAAjBA,kBAAA,CAAmBtE,qBAAqB,CAAC,CAAC;MAC7D,IAAI,CAACyE,WAAW,IAAI,CAAC1E,UAAU,EAAE;QAC7BJ,OAAO,CAACC,KAAK,CAAC,sCAAsC,EAAE6D,EAAE,CAAC;QACzD,OAAO;UAAEA,EAAE;UAAEkB,MAAM,EAAE;YAAE9E,CAAC,EAAE,CAAC;YAAEC,CAAC,EAAE;UAAE,CAAC;UAAEwD;QAAY,CAAC;MACtD;MACA,MAAMqB,MAAM,GAAG;QACX9E,CAAC,EAAE,CAAC4E,WAAW,CAACnE,IAAI,GAAGP,UAAU,CAACO,IAAI,KAAKZ,SAAS,GAAG,GAAG,CAAC,IAAI,EAAA6E,kBAAA,GAAAlC,QAAQ,CAACc,QAAQ,CAAC,cAAAoB,kBAAA,uBAAlBA,kBAAA,CAAoB1E,CAAC,KAAI,CAAC,CAAC;QAC1FC,CAAC,EAAE,CAAC2E,WAAW,CAACjE,GAAG,GAAGT,UAAU,CAACS,GAAG,KAAKd,SAAS,GAAG,GAAG,CAAC,IAAI,EAAA8E,mBAAA,GAAAnC,QAAQ,CAACc,QAAQ,CAAC,cAAAqB,mBAAA,uBAAlBA,mBAAA,CAAoB1E,CAAC,KAAI,CAAC;MAC3F,CAAC;MACDkE,SAAS,CAACU,OAAO,GAAGC,MAAM;MAC1B,OAAO;QAAElB,EAAE;QAAEkB,MAAM;QAAErB,WAAW;QAAEsB,WAAW,EAAEpC,IAAI;QAAEqC,eAAe,EAAExC,QAAQ,CAACc,QAAQ,CAAC,IAAI;UAAEtD,CAAC,EAAE,CAAC;UAAEC,CAAC,EAAE;QAAE,CAAC;QAAEgF,UAAU,EAAE;MAAK,CAAC;IAClI,CAAC;IACDC,GAAG,EAAEA,CAACX,IAAI,EAAEY,OAAO,KAAK;MACpBjB,gBAAgB,CAAC,KAAK,CAAC;MACvB,MAAMkB,UAAU,GAAGD,OAAO,CAACE,aAAa,CAAC,CAAC;MAC1C,IAAI,CAACD,UAAU,IAAI,CAACA,UAAU,CAACE,KAAK,EAAE;QAClCxF,OAAO,CAACyF,GAAG,CAAC,6CAA6C,EAAE3B,EAAE,CAAC;QAC9D;MACJ;MACA9D,OAAO,CAACyF,GAAG,CAAC,sCAAsC,EAAE3B,EAAE,EAAE,eAAe,EAAEwB,UAAU,CAACI,WAAW,CAAC;IACpG,CAAC;IACDC,OAAO,EAAGN,OAAO,KAAM;MACnBf,UAAU,EAAEe,OAAO,CAACf,UAAU,CAAC;IACnC,CAAC;EACL,CAAC,CAAC,EAAE,CAACR,EAAE,EAAEjB,IAAI,EAAEH,QAAQ,EAAEc,QAAQ,EAAEG,WAAW,CAAC,CAAC;EAEhD9E,SAAS,CAAC,MAAM;IACZ2F,OAAO,CAACxF,aAAa,CAAC,CAAC,EAAE;MAAE4G,oBAAoB,EAAE;IAAK,CAAC,CAAC;EAC5D,CAAC,EAAE,CAACpB,OAAO,CAAC,CAAC;EAEb,MAAMqB,eAAe,GAAGlH,WAAW,CAC9BmH,CAAC,IAAK;IACHA,CAAC,CAACC,eAAe,CAAC,CAAC;IACnB,IAAI,CAACpC,WAAW,CAACqC,QAAQ,CAAClC,EAAE,CAAC,EAAE;MAC3BR,eAAe,CAACQ,EAAE,EAAEgC,CAAC,CAACG,OAAO,CAAC;IAClC;EACJ,CAAC,EACD,CAACnC,EAAE,EAAER,eAAe,EAAEK,WAAW,CACrC,CAAC;EAED,MAAMuC,iBAAiB,GAAGvH,WAAW,CAChCmH,CAAC,IAAK;IACHA,CAAC,CAACK,cAAc,CAAC,CAAC;IAClBL,CAAC,CAACC,eAAe,CAAC,CAAC;IACnBtC,aAAa,CAACK,EAAE,EAAE;MAAE5D,CAAC,EAAE4F,CAAC,CAACM,OAAO;MAAEjG,CAAC,EAAE2F,CAAC,CAACO;IAAQ,CAAC,CAAC;EACrD,CAAC,EACD,CAACvC,EAAE,EAAEL,aAAa,CACtB,CAAC;EAED,MAAM6C,eAAe,GAAG3H,WAAW,CAAC,MAAM;IACtC,QAAQoF,IAAI;MACR,KAAK,SAAS;QACV,oBACIxE,OAAA;UAAIgH,KAAK,EAAE;YAAEC,QAAQ,EAAExC,aAAa,CAACwC,QAAQ,IAAI,QAAQ;YAAEC,KAAK,EAAEzC,aAAa,CAACyC,KAAK,IAAI,SAAS;YAAEC,MAAM,EAAE,CAAC;YAAEC,OAAO,EAAE,CAAC;YAAEC,UAAU,EAAE;UAAO,CAAE;UAAAC,QAAA,EAC3I7C,aAAa,CAAC8C,OAAO,IAAI;QAAS;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACnC,CAAC;MAEb,KAAK,WAAW;QACZ,oBACI3H,OAAA;UAAGgH,KAAK,EAAE;YAAEC,QAAQ,EAAExC,aAAa,CAACwC,QAAQ,IAAI,MAAM;YAAEC,KAAK,EAAEzC,aAAa,CAACyC,KAAK,IAAI,SAAS;YAAEC,MAAM,EAAE,CAAC;YAAEC,OAAO,EAAE,CAAC;YAAEC,UAAU,EAAE;UAAO,CAAE;UAAAC,QAAA,EACxI7C,aAAa,CAAC8C,OAAO,IAAI;QAAU;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACrC,CAAC;MAEZ,KAAK,QAAQ;QACT,oBACI3H,OAAA;UACIgH,KAAK,EAAE;YACHI,OAAO,EAAE,UAAU;YACnBQ,YAAY,EAAE,KAAK;YACnBC,UAAU,EAAEpD,aAAa,CAACoD,UAAU,IAAI,SAAS;YACjDX,KAAK,EAAEzC,aAAa,CAACyC,KAAK,IAAI,MAAM;YACpCY,MAAM,EAAE,MAAM;YACdC,MAAM,EAAE,SAAS;YACjBV,UAAU,EAAE;UAChB,CAAE;UAAAC,QAAA,EAED7C,aAAa,CAAC8C,OAAO,IAAI;QAAK;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAC3B,CAAC;MAEjB,KAAK,OAAO;QACR,oBACI3H,OAAA;UACIgI,GAAG,EAAEvD,aAAa,CAACuD,GAAG,IAAI,iCAAkC;UAC5DC,GAAG,EAAC,OAAO;UACXjB,KAAK,EAAE;YAAEkB,QAAQ,EAAE,MAAM;YAAElG,MAAM,EAAE,MAAM;YAAEqF,UAAU,EAAE;UAAO,CAAE;UAChEc,SAAS,EAAE;QAAM;UAAAX,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACpB,CAAC;MAEV,KAAK,MAAM;QACP,oBACI3H,OAAA;UAAMgH,KAAK,EAAE;YAAEoB,OAAO,EAAE,MAAM;YAAEC,aAAa,EAAE,QAAQ;YAAEC,GAAG,EAAE,MAAM;YAAEjB,UAAU,EAAE;UAAO,CAAE;UAAAC,QAAA,gBACvFtH,OAAA;YACIwE,IAAI,EAAC,MAAM;YACX+D,WAAW,EAAC,OAAO;YACnBvB,KAAK,EAAE;cAAEI,OAAO,EAAE,KAAK;cAAEQ,YAAY,EAAE,KAAK;cAAEE,MAAM,EAAE;YAAiB,CAAE;YACzEU,QAAQ;UAAA;YAAAhB,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACX,CAAC,eACF3H,OAAA;YACIwE,IAAI,EAAC,QAAQ;YACbwC,KAAK,EAAE;cACHa,UAAU,EAAE,SAAS;cACrBX,KAAK,EAAE,MAAM;cACbE,OAAO,EAAE,UAAU;cACnBQ,YAAY,EAAE,KAAK;cACnBE,MAAM,EAAE,MAAM;cACdC,MAAM,EAAE;YACZ,CAAE;YAAAT,QAAA,EACL;UAED;YAAAE,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACP,CAAC;MAEf;QACI,oBAAO3H,OAAA;UAAKgH,KAAK,EAAE;YAAEK,UAAU,EAAE;UAAO,CAAE;UAAAC,QAAA,EAAE7C,aAAa,CAAC8C,OAAO,IAAI;QAAS;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAM,CAAC;IAC7F;EACJ,CAAC,EAAE,CAACnD,IAAI,EAAEC,aAAa,CAAC,CAAC;EAEzB,oBACIzE,OAAA;IACIyI,GAAG,EAAGC,IAAI,IAAK;MACX/D,UAAU,CAACa,OAAO,GAAGkD,IAAI;MACzB1D,IAAI,CAAC0D,IAAI,CAAC;IACd,CAAE;IACFC,SAAS,EAAE,sBAAsB7E,UAAU,GAAG,6BAA6B,GAAG,EAAE,IAAIiB,UAAU,GAAG,6BAA6B,GAAG,EAAE,EAAG;IACtIiC,KAAK,EAAE;MACH7D,QAAQ,EAAE,UAAU;MACpByF,SAAS,EAAE,aAAa,EAAAvE,mBAAA,GAAAlB,QAAQ,CAACc,QAAQ,CAAC,cAAAI,mBAAA,uBAAlBA,mBAAA,CAAoB1D,CAAC,KAAI,CAAC,OAAO,EAAA2D,mBAAA,GAAAnB,QAAQ,CAACc,QAAQ,CAAC,cAAAK,mBAAA,uBAAlBA,mBAAA,CAAoB1D,CAAC,KAAI,CAAC,KAAK;MACxFmB,KAAK,EAAEuB,IAAI,CAACvB,KAAK;MACjBC,MAAM,EAAEsB,IAAI,CAACtB,MAAM;MACnB6G,MAAM,EAAE1F,QAAQ,CAAC2F,CAAC,IAAI,CAAC;MACvBC,OAAO,EAAEhE,UAAU,GAAG,GAAG,GAAG,CAAC;MAC7BgD,MAAM,EAAEhD,UAAU,GAAG,UAAU,GAAG,MAAM;MACxCiE,SAAS,EAAEjE,UAAU,GAAG,2BAA2B,GAAG,MAAM;MAC5DsC,UAAU,EAAE,MAAM;MAClB,GAAG3C;IACP,CAAE;IACFuE,WAAW,EAAE3C,eAAgB;IAC7BpC,aAAa,EAAEyC,iBAAkB;IAAAW,QAAA,EAEhCP,eAAe,CAAC;EAAC;IAAAS,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACjB,CAAC;AAEd,CAAC;EAAA,QAnJ2CnI,OAAO;AAAA,EAoJvD,CAAC;EAAA,QApJ+CA,OAAO;AAAA,EAoJtD;;AAED;AAAA0J,GAAA,GAzKMxF,OAAO;AA0Kb,MAAMyF,MAAM,gBAAAC,GAAA,cAAGlK,KAAK,CAAC0E,IAAI,CAAAyF,GAAA,GAAAD,GAAA,CACrB,CAAC;EACIE,QAAQ;EACRlF,WAAW;EACXL,eAAe;EACfC,gBAAgB;EAChBuF,YAAY;EACZC,eAAe;EACfC,YAAY;EACZC,eAAe;EACfzF,QAAQ;EACRzD,SAAS;EACTkB,QAAQ;EACRiI;AACJ,CAAC,KAAK;EAAA,IAAAC,gBAAA,EAAAC,iBAAA;EAAAT,GAAA;EACH,MAAMjF,SAAS,GAAGhF,MAAM,CAAC,IAAI,CAAC;EAC9B,MAAM,CAAC2K,UAAU,EAAEC,aAAa,CAAC,GAAG1K,QAAQ,CAAC,EAAE,CAAC;EAChD,MAAM,CAAC2K,WAAW,EAAEC,cAAc,CAAC,GAAG5K,QAAQ,CAAC,IAAI,CAAC;EACpD,MAAM,CAAC6K,WAAW,EAAEC,cAAc,CAAC,GAAG9K,QAAQ,CAAC,IAAI,CAAC;EACpD,MAAM,CAAC+K,OAAO,EAAEC,UAAU,CAAC,GAAGhL,QAAQ,CAAC,EAAE,CAAC,CAAC,CAAC;EAC5C,MAAM,CAACiL,YAAY,EAAEC,eAAe,CAAC,GAAGlL,QAAQ,CAAC,CAAC,CAAC,CAAC;EAEpD,MAAMuC,YAAY,GAAGuC,SAAS,CAACqB,OAAO,GAChC;IACEzD,KAAK,EAAEoC,SAAS,CAACqB,OAAO,CAACgF,WAAW,IAAIhK,SAAS,GAAG,GAAG,CAAC;IACxDwB,MAAM,EAAEmC,SAAS,CAACqB,OAAO,CAACiF,YAAY,IAAIjK,SAAS,GAAG,GAAG;EAC7D,CAAC,GACC;IAAEuB,KAAK,EAAE,IAAI;IAAEC,MAAM,EAAE;EAAK,CAAC;EAEnC,MAAM0I,aAAa,GAAGtL,WAAW,CAAC,MAAM;IACpC,MAAMuL,MAAM,GAAG,CACX;MAAEhK,CAAC,EAAE,CAAC;MAAEC,CAAC,EAAE;IAAE,CAAC,EACd;MAAED,CAAC,EAAEiB,YAAY,CAACG,KAAK;MAAEnB,CAAC,EAAEgB,YAAY,CAACI;IAAO,CAAC,EACjD;MAAErB,CAAC,EAAEiB,YAAY,CAACG,KAAK,GAAG,CAAC;MAAEnB,CAAC,EAAEgB,YAAY,CAACI,MAAM,GAAG;IAAE,CAAC,CAC5D;IAEDsH,QAAQ,CAACsB,QAAQ,CAACxI,OAAO,CAAEyI,EAAE,IAAK;MAC9B,MAAMC,MAAM,GAAGvI,gBAAgB,CAACsI,EAAE,CAAC;MACnCF,MAAM,CAACI,IAAI,CACP;QAAEpK,CAAC,EAAEmK,MAAM,CAAC1J,IAAI;QAAER,CAAC,EAAEkK,MAAM,CAACxJ;MAAI,CAAC,EACjC;QAAEX,CAAC,EAAEmK,MAAM,CAACzH,KAAK;QAAEzC,CAAC,EAAEkK,MAAM,CAACvH;MAAO,CAAC,EACrC;QAAE5C,CAAC,EAAEmK,MAAM,CAACtH,OAAO;QAAE5C,CAAC,EAAEkK,MAAM,CAACrH;MAAQ,CAAC,EACxC;QAAE9C,CAAC,EAAEmK,MAAM,CAAC1J,IAAI;QAAER,CAAC,EAAEkK,MAAM,CAACrH;MAAQ,CAAC,EACrC;QAAE9C,CAAC,EAAEmK,MAAM,CAACzH,KAAK;QAAEzC,CAAC,EAAEkK,MAAM,CAACrH;MAAQ,CAAC,EACtC;QAAE9C,CAAC,EAAEmK,MAAM,CAACtH,OAAO;QAAE5C,CAAC,EAAEkK,MAAM,CAACxJ;MAAI,CAAC,EACpC;QAAEX,CAAC,EAAEmK,MAAM,CAACtH,OAAO;QAAE5C,CAAC,EAAEkK,MAAM,CAACvH;MAAO,CAC1C,CAAC;IACL,CAAC,CAAC;IAEF,OAAOoH,MAAM;EACjB,CAAC,EAAE,CAACrB,QAAQ,CAACsB,QAAQ,EAAEhJ,YAAY,CAAC,CAAC;EAErC,MAAMoJ,oBAAoB,GAAGA,CAACzG,EAAE,EAAE0G,MAAM,EAAEC,IAAI,EAAEC,OAAO,KAAK;IACxD,IAAID,IAAI,KAAK,SAAS,IAAIC,OAAO,EAAE;MAC/Bd,UAAU,CAAEe,IAAI,IAAK,CAAC,GAAGA,IAAI,CAACC,KAAK,CAAC,CAAC,EAAEf,YAAY,GAAG,CAAC,CAAC,EAAE;QAAE/F,EAAE;QAAE4G,OAAO;QAAEF;MAAO,CAAC,CAAC,CAAC;MACnFV,eAAe,CAAEa,IAAI,IAAKA,IAAI,GAAG,CAAC,CAAC;IACvC;IACApH,gBAAgB,CAACO,EAAE,EAAE0G,MAAM,EAAEC,IAAI,CAAC;EACtC,CAAC;EAED,MAAMI,UAAU,GAAGlM,WAAW,CAAC,MAAM;IACjC,IAAIkL,YAAY,IAAI,CAAC,EAAE;MACnB,MAAM;QAAE/F,EAAE;QAAE4G;MAAQ,CAAC,GAAGf,OAAO,CAACE,YAAY,CAAC;MAC7CtG,gBAAgB,CAACO,EAAE,EAAE;QAAE,CAACN,QAAQ,GAAGkH;MAAQ,CAAC,EAAE,SAAS,CAAC;MACxDZ,eAAe,CAAEa,IAAI,IAAKA,IAAI,GAAG,CAAC,CAAC;MACnCzL,KAAK,CAAC4L,IAAI,CAAC,uBAAuB,CAAC;IACvC;EACJ,CAAC,EAAE,CAACnB,OAAO,EAAEE,YAAY,EAAEtG,gBAAgB,EAAEC,QAAQ,CAAC,CAAC;EAEvD,MAAMuH,UAAU,GAAGpM,WAAW,CAAC,MAAM;IACjC,IAAIkL,YAAY,GAAGF,OAAO,CAACqB,MAAM,GAAG,CAAC,EAAE;MACnC,MAAM;QAAElH,EAAE;QAAE0G;MAAO,CAAC,GAAGb,OAAO,CAACE,YAAY,GAAG,CAAC,CAAC;MAChDtG,gBAAgB,CAACO,EAAE,EAAE;QAAE,CAACN,QAAQ,GAAGgH;MAAO,CAAC,EAAE,SAAS,CAAC;MACvDV,eAAe,CAAEa,IAAI,IAAKA,IAAI,GAAG,CAAC,CAAC;MACnCzL,KAAK,CAAC4L,IAAI,CAAC,4BAA4B,CAAC;IAC5C;EACJ,CAAC,EAAE,CAACnB,OAAO,EAAEE,YAAY,EAAEtG,gBAAgB,EAAEC,QAAQ,CAAC,CAAC;EAEvDvE,UAAU,CAAC,QAAQ,EAAE4L,UAAU,EAAE,CAAClB,OAAO,EAAEE,YAAY,CAAC,CAAC;EACzD5K,UAAU,CAAC,QAAQ,EAAE8L,UAAU,EAAE,CAACpB,OAAO,EAAEE,YAAY,CAAC,CAAC;EAEzD,MAAM,CAAC;IAAEoB,MAAM;IAAEC;EAAS,CAAC,EAAEC,IAAI,CAAC,GAAGrM,OAAO,CAAC,OAAO;IAChDsM,MAAM,EAAE,CAAC5L,SAAS,CAACC,OAAO,EAAED,SAAS,CAACE,gBAAgB,CAAC;IACvD2L,KAAK,EAAEA,CAAC5G,IAAI,EAAEY,OAAO,KAAK;MAAA,IAAAiG,qBAAA;MACtB,MAAMC,YAAY,GAAGlG,OAAO,CAACmG,eAAe,CAAC,CAAC;MAC9C,IAAI,CAACD,YAAY,IAAI,CAAC7H,SAAS,CAACqB,OAAO,EAAE;MAEzC,MAAM0G,GAAG,GAAG9L,iBAAiB,CAAC4L,YAAY,CAACrL,CAAC,EAAEqL,YAAY,CAACpL,CAAC,EAAEuD,SAAS,CAACqB,OAAO,EAAEhF,SAAS,CAAC;MAC3F,MAAMmB,UAAU,GAAG+I,aAAa,CAAC,CAAC;MAClC,MAAMyB,OAAO,GAAG1K,UAAU,CAACyK,GAAG,CAACvL,CAAC,EAAEuL,GAAG,CAACtL,CAAC,EAAE+I,QAAQ,GAAGjI,QAAQ,GAAG0K,QAAQ,EAAEzK,UAAU,EAAEC,YAAY,GAAAmK,qBAAA,GAAEjG,OAAO,CAACmG,eAAe,CAAC,CAAC,cAAAF,qBAAA,uBAAzBA,qBAAA,CAA2BM,MAAM,CAAC;;MAErI;MACA,IAAInH,IAAI,CAACU,UAAU,EAAE;QAAA,IAAA0G,YAAA,EAAAC,aAAA;QACjBpC,cAAc,CAAC;UACX5F,EAAE,EAAEW,IAAI,CAACX,EAAE;UACX5D,CAAC,EAAEwL,OAAO,CAACxL,CAAC,IAAI,EAAA2L,YAAA,GAAApH,IAAI,CAACO,MAAM,cAAA6G,YAAA,uBAAXA,YAAA,CAAa3L,CAAC,KAAI,CAAC,CAAC;UACpCC,CAAC,EAAEuL,OAAO,CAACvL,CAAC,IAAI,EAAA2L,aAAA,GAAArH,IAAI,CAACO,MAAM,cAAA8G,aAAA,uBAAXA,aAAA,CAAa3L,CAAC,KAAI,CAAC,CAAC;UACpC0C,IAAI,EAAE4B,IAAI,CAACQ,WAAW,IAAI;YAAE3D,KAAK,EAAE,GAAG;YAAEC,MAAM,EAAE;UAAG;QACvD,CAAC,CAAC;MACN,CAAC,MAAM,IAAIkD,IAAI,CAACsH,IAAI,EAAE;QAClBrC,cAAc,CAAC;UACX5F,EAAE,EAAE,SAAS;UACb5D,CAAC,EAAEwL,OAAO,CAACxL,CAAC;UACZC,CAAC,EAAEuL,OAAO,CAACvL,CAAC;UACZ0C,IAAI,EAAE4B,IAAI,CAACsH,IAAI,CAAClJ,IAAI,IAAI;YAAEvB,KAAK,EAAE,GAAG;YAAEC,MAAM,EAAE;UAAG,CAAC;UAClDwC,IAAI,EAAEU,IAAI,CAACsH,IAAI,CAAChI,IAAI;UACpBC,aAAa,EAAES,IAAI,CAACsH,IAAI,CAAC/H;QAC7B,CAAC,CAAC;MACN;MAEA,MAAMgI,aAAa,GAAG,EAAE;MACxB9K,UAAU,CAACS,OAAO,CAAEC,KAAK,IAAK;QAC1B,IAAId,IAAI,CAACe,GAAG,CAAC6J,OAAO,CAACxL,CAAC,GAAG0B,KAAK,CAAC1B,CAAC,CAAC,GAAG,EAAE,EAAE;UACpC8L,aAAa,CAAC1B,IAAI,CAAC;YAAE2B,QAAQ,EAAE,IAAI;YAAEvJ,QAAQ,EAAEd,KAAK,CAAC1B;UAAE,CAAC,CAAC;QAC7D;QACA,IAAIY,IAAI,CAACe,GAAG,CAAC6J,OAAO,CAACvL,CAAC,GAAGyB,KAAK,CAACzB,CAAC,CAAC,GAAG,EAAE,EAAE;UACpC6L,aAAa,CAAC1B,IAAI,CAAC;YAAE2B,QAAQ,EAAE,KAAK;YAAEvJ,QAAQ,EAAEd,KAAK,CAACzB;UAAE,CAAC,CAAC;QAC9D;MACJ,CAAC,CAAC;MACFmJ,aAAa,CAAC0C,aAAa,CAAC;IAChC,CAAC;IACDb,IAAI,EAAEA,CAAC1G,IAAI,EAAEY,OAAO,KAAK;MAAA,IAAA6G,sBAAA;MACrB,MAAMX,YAAY,GAAGlG,OAAO,CAACmG,eAAe,CAAC,CAAC;MAC9C,IAAI,CAACD,YAAY,IAAI,CAAC7H,SAAS,CAACqB,OAAO,EAAE;QACrC7F,KAAK,CAACe,KAAK,CAAC,gCAAgC,CAAC;QAC7C,OAAO;UAAEuF,KAAK,EAAE;QAAM,CAAC;MAC3B;MAEA,MAAMiG,GAAG,GAAG9L,iBAAiB,CAAC4L,YAAY,CAACrL,CAAC,EAAEqL,YAAY,CAACpL,CAAC,EAAEuD,SAAS,CAACqB,OAAO,EAAEhF,SAAS,CAAC;MAC3F,MAAMmB,UAAU,GAAG+I,aAAa,CAAC,CAAC;MAClC,MAAMyB,OAAO,GAAG1K,UAAU,CAACyK,GAAG,CAACvL,CAAC,EAAEuL,GAAG,CAACtL,CAAC,EAAE+I,QAAQ,GAAGjI,QAAQ,GAAG0K,QAAQ,EAAEzK,UAAU,EAAEC,YAAY,GAAA+K,sBAAA,GAAE7G,OAAO,CAACmG,eAAe,CAAC,CAAC,cAAAU,sBAAA,uBAAzBA,sBAAA,CAA2BN,MAAM,CAAC;MAErI,IAAInH,IAAI,CAACsH,IAAI,IAAI,CAACtH,IAAI,CAACU,UAAU,EAAE;QAC/B;QACA,MAAMgH,UAAU,GAAG;UACfrI,EAAE,EAAE,GAAGW,IAAI,CAACX,EAAE,IAAIsI,IAAI,CAACC,GAAG,CAAC,CAAC,EAAE;UAC9BtI,IAAI,EAAEU,IAAI,CAACsH,IAAI,CAAChI,IAAI;UACpBC,aAAa,EAAES,IAAI,CAACsH,IAAI,CAAC/H,aAAa,IAAI,CAAC,CAAC;UAC5CtB,QAAQ,EAAE;YAAE,CAACc,QAAQ,GAAGkI,OAAO;YAAE/I,OAAO,EAAE+I,OAAO;YAAEY,MAAM,EAAEZ,OAAO;YAAEa,MAAM,EAAEb;UAAQ,CAAC;UACrF7I,IAAI,EAAE4B,IAAI,CAACsH,IAAI,CAAClJ,IAAI,IAAI;YAAEvB,KAAK,EAAE,GAAG;YAAEC,MAAM,EAAE;UAAG,CAAC;UAClD0C,MAAM,EAAEQ,IAAI,CAACsH,IAAI,CAAC9H,MAAM,IAAI,CAAC;QACjC,CAAC;QACD+E,YAAY,CAACmD,UAAU,CAAC;QACxBjN,KAAK,CAACsN,OAAO,CAAC,kBAAkB,CAAC;QACjC9C,cAAc,CAAC,IAAI,CAAC;QACpBJ,aAAa,CAAC,EAAE,CAAC;QACjB,OAAO;UAAE9D,KAAK,EAAE,IAAI;UAAEE,WAAW,EAAEgG;QAAQ,CAAC;MAChD,CAAC,MAAM,IAAIjH,IAAI,CAACX,EAAE,IAAIW,IAAI,CAACU,UAAU,EAAE;QAAA,IAAAsH,aAAA,EAAAC,qBAAA,EAAAC,aAAA,EAAAC,sBAAA;QACnC;QACA,MAAMC,MAAM,GAAGnB,OAAO,CAACxL,CAAC,IAAI,EAAAuM,aAAA,GAAAhI,IAAI,CAACO,MAAM,cAAAyH,aAAA,uBAAXA,aAAA,CAAavM,CAAC,KAAI,CAAC,CAAC,IAAI,EAAAwM,qBAAA,GAAAjI,IAAI,CAACS,eAAe,cAAAwH,qBAAA,uBAApBA,qBAAA,CAAsBxM,CAAC,KAAI,CAAC,CAAC;QACjF,MAAM4M,MAAM,GAAGpB,OAAO,CAACvL,CAAC,IAAI,EAAAwM,aAAA,GAAAlI,IAAI,CAACO,MAAM,cAAA2H,aAAA,uBAAXA,aAAA,CAAaxM,CAAC,KAAI,CAAC,CAAC,IAAI,EAAAyM,sBAAA,GAAAnI,IAAI,CAACS,eAAe,cAAA0H,sBAAA,uBAApBA,sBAAA,CAAsBzM,CAAC,KAAI,CAAC,CAAC;QAEjFsE,IAAI,CAACd,WAAW,CAAChC,OAAO,CAAEoL,UAAU,IAAK;UACrC,MAAMhL,OAAO,GAAG8G,QAAQ,CAACsB,QAAQ,CAAC6C,IAAI,CAAE5C,EAAE,IAAKA,EAAE,CAACtG,EAAE,KAAKiJ,UAAU,CAAC;UACpE,IAAIhL,OAAO,EAAE;YACT,MAAM2I,OAAO,GAAG3I,OAAO,CAACW,QAAQ,CAACc,QAAQ,CAAC,IAAI;cAAEtD,CAAC,EAAE,CAAC;cAAEC,CAAC,EAAE;YAAE,CAAC;YAC5D,MAAMqK,MAAM,GAAG;cACXtK,CAAC,EAAEY,IAAI,CAACC,GAAG,CAAC,CAAC,EAAED,IAAI,CAACO,GAAG,CAACqJ,OAAO,CAACxK,CAAC,GAAG2M,MAAM,EAAE1L,YAAY,CAACG,KAAK,GAAGS,OAAO,CAACc,IAAI,CAACvB,KAAK,CAAC,CAAC;cACrFnB,CAAC,EAAEW,IAAI,CAACC,GAAG,CAAC,CAAC,EAAED,IAAI,CAACO,GAAG,CAACqJ,OAAO,CAACvK,CAAC,GAAG2M,MAAM,EAAE3L,YAAY,CAACI,MAAM,GAAGQ,OAAO,CAACc,IAAI,CAACtB,MAAM,CAAC;YAC1F,CAAC;YACDgJ,oBAAoB,CAACwC,UAAU,EAAE;cAAE,CAACvJ,QAAQ,GAAGgH;YAAO,CAAC,EAAE,SAAS,EAAEE,OAAO,CAAC;UAChF;QACJ,CAAC,CAAC;QACFxL,KAAK,CAACsN,OAAO,CAAC,uBAAuB,CAAC;QACtC9C,cAAc,CAAC,IAAI,CAAC;QACpBJ,aAAa,CAAC,EAAE,CAAC;QACjB,OAAO;UAAE9D,KAAK,EAAE,IAAI;UAAEE,WAAW,EAAEgG;QAAQ,CAAC;MAChD;MAEAhC,cAAc,CAAC,IAAI,CAAC;MACpBJ,aAAa,CAAC,EAAE,CAAC;MACjB,OAAO;QAAE9D,KAAK,EAAE;MAAM,CAAC;IAC3B,CAAC;IACDG,OAAO,EAAGN,OAAO,KAAM;MACnB4F,MAAM,EAAE5F,OAAO,CAAC4F,MAAM,CAAC,CAAC;MACxBC,QAAQ,EAAE7F,OAAO,CAAC4H,OAAO,CAAC;IAC9B,CAAC;EACL,CAAC,CAAC,EAAE,CAACpE,QAAQ,CAACsB,QAAQ,EAAE3G,QAAQ,EAAEzD,SAAS,EAAEkB,QAAQ,EAAEiI,QAAQ,EAAE/H,YAAY,EAAE6H,YAAY,EAAEzF,gBAAgB,EAAEI,WAAW,CAAC,CAAC;EAE5H,MAAMuJ,iBAAiB,GAAGvO,WAAW,CAChCmH,CAAC,IAAK;IACH,IAAIA,CAAC,CAACqH,MAAM,KAAKzJ,SAAS,CAACqB,OAAO,EAAE;MAChCzB,eAAe,CAAC,EAAE,CAAC;MACnBkG,cAAc,CAAC,IAAI,CAAC;IACxB;EACJ,CAAC,EACD,CAAClG,eAAe,CACpB,CAAC;EAED,MAAM4C,iBAAiB,GAAGvH,WAAW,CAAC,CAACmF,EAAE,EAAEpB,QAAQ,KAAK;IACpD8G,cAAc,CAAC;MAAE1F,EAAE;MAAEpB;IAAS,CAAC,CAAC;EACpC,CAAC,EAAE,EAAE,CAAC;EAEN,MAAM0K,aAAa,GAAGzO,WAAW,CAC5BmH,CAAC,IAAK;IACH,IAAI,CAACnC,WAAW,CAACqH,MAAM,EAAE;IAEzBlF,CAAC,CAACK,cAAc,CAAC,CAAC;IAClBL,CAAC,CAACC,eAAe,CAAC,CAAC;IAEnB,MAAMsH,IAAI,GAAGvH,CAAC,CAACwH,QAAQ,GAAG,EAAE,GAAG,CAAC;IAEhC3J,WAAW,CAAChC,OAAO,CAAEmC,EAAE,IAAK;MACxB,MAAM/B,OAAO,GAAG8G,QAAQ,CAACsB,QAAQ,CAAC6C,IAAI,CAAE5C,EAAE,IAAKA,EAAE,CAACtG,EAAE,KAAKA,EAAE,CAAC;MAC5D,IAAI,CAAC/B,OAAO,EAAE;MAEd,MAAMwL,UAAU,GAAGxL,OAAO,CAACW,QAAQ,CAACc,QAAQ,CAAC,IAAI;QAAEtD,CAAC,EAAE,CAAC;QAAEC,CAAC,EAAE;MAAE,CAAC;MAC/D,IAAIqK,MAAM;MACV,QAAQ1E,CAAC,CAAC0H,GAAG;QACT,KAAK,SAAS;UACVhD,MAAM,GAAG;YAAEtK,CAAC,EAAEqN,UAAU,CAACrN,CAAC;YAAEC,CAAC,EAAEW,IAAI,CAACC,GAAG,CAAC,CAAC,EAAEwM,UAAU,CAACpN,CAAC,GAAGkN,IAAI;UAAE,CAAC;UACjE;QACJ,KAAK,WAAW;UACZ7C,MAAM,GAAG;YAAEtK,CAAC,EAAEqN,UAAU,CAACrN,CAAC;YAAEC,CAAC,EAAEW,IAAI,CAACO,GAAG,CAACF,YAAY,CAACI,MAAM,GAAGQ,OAAO,CAACc,IAAI,CAACtB,MAAM,EAAEgM,UAAU,CAACpN,CAAC,GAAGkN,IAAI;UAAE,CAAC;UACzG;QACJ,KAAK,WAAW;UACZ7C,MAAM,GAAG;YAAEtK,CAAC,EAAEY,IAAI,CAACC,GAAG,CAAC,CAAC,EAAEwM,UAAU,CAACrN,CAAC,GAAGmN,IAAI,CAAC;YAAElN,CAAC,EAAEoN,UAAU,CAACpN;UAAE,CAAC;UACjE;QACJ,KAAK,YAAY;UACbqK,MAAM,GAAG;YAAEtK,CAAC,EAAEY,IAAI,CAACO,GAAG,CAACF,YAAY,CAACG,KAAK,GAAGS,OAAO,CAACc,IAAI,CAACvB,KAAK,EAAEiM,UAAU,CAACrN,CAAC,GAAGmN,IAAI,CAAC;YAAElN,CAAC,EAAEoN,UAAU,CAACpN;UAAE,CAAC;UACvG;QACJ,KAAK,QAAQ;QACb,KAAK,WAAW;UACZ4I,eAAe,CAACjF,EAAE,CAAC;UACnB;QACJ,KAAK,QAAQ;UACTR,eAAe,CAAC,EAAE,CAAC;UACnBkG,cAAc,CAAC,IAAI,CAAC;UACpB;QACJ;UACI;MACR;MACA,IAAIgB,MAAM,EAAE;QACRD,oBAAoB,CAACzG,EAAE,EAAE;UAAE,CAACN,QAAQ,GAAGgH;QAAO,CAAC,EAAE,SAAS,EAAE+C,UAAU,CAAC;MAC3E;IACJ,CAAC,CAAC;EACN,CAAC,EACD,CAAC5J,WAAW,EAAEJ,gBAAgB,EAAEwF,eAAe,EAAEzF,eAAe,EAAEE,QAAQ,EAAEqF,QAAQ,CAACsB,QAAQ,EAAEhJ,YAAY,CAC/G,CAAC;EAEDlC,UAAU,CAAC,QAAQ,EAAG6G,CAAC,IAAK;IACxBA,CAAC,CAACK,cAAc,CAAC,CAAC;IAClB7C,eAAe,CAACuF,QAAQ,CAACsB,QAAQ,CAACsD,GAAG,CAAErD,EAAE,IAAKA,EAAE,CAACtG,EAAE,CAAC,CAAC;EACzD,CAAC,EAAE,CAAC+E,QAAQ,CAACsB,QAAQ,EAAE7G,eAAe,CAAC,CAAC;EAExCrE,UAAU,CAAC,QAAQ,EAAG6G,CAAC,IAAK;IACxBA,CAAC,CAACK,cAAc,CAAC,CAAC;IAClB,IAAIxC,WAAW,CAACqH,MAAM,GAAG,CAAC,EAAE;MACxB/B,eAAe,CAACtF,WAAW,CAAC;IAChC;EACJ,CAAC,EAAE,CAACA,WAAW,EAAEsF,eAAe,CAAC,CAAC;EAElCpK,SAAS,CAAC,MAAM;IACZ,MAAM6O,kBAAkB,GAAGA,CAAA,KAAMlE,cAAc,CAAC,IAAI,CAAC;IACrD,IAAID,WAAW,EAAE;MACboE,QAAQ,CAACC,gBAAgB,CAAC,OAAO,EAAEF,kBAAkB,CAAC;MACtD,OAAO,MAAMC,QAAQ,CAACE,mBAAmB,CAAC,OAAO,EAAEH,kBAAkB,CAAC;IAC1E;EACJ,CAAC,EAAE,CAACnE,WAAW,CAAC,CAAC;EAEjB,MAAMuE,iBAAiB,GAAGA,CAAA,KAAM;IAC5B,IAAI,CAACrE,WAAW,EAAE,OAAO,IAAI;IAC7B,MAAM;MAAEvJ,CAAC;MAAEC,CAAC;MAAE0C,IAAI;MAAEkB,IAAI;MAAEC;IAAc,CAAC,GAAGyF,WAAW;IAEvD,MAAMsE,YAAY,GAAG;MACjBrL,QAAQ,EAAE,UAAU;MACpByF,SAAS,EAAE,aAAajI,CAAC,OAAOC,CAAC,KAAK;MACtCmB,KAAK,EAAEuB,IAAI,CAACvB,KAAK;MACjBC,MAAM,EAAEsB,IAAI,CAACtB,MAAM;MACnB8F,MAAM,EAAE,oBAAoB;MAC5BD,UAAU,EAAE,yBAAyB;MACrC4G,aAAa,EAAE,MAAM;MACrB5F,MAAM,EAAE,IAAI;MACZE,OAAO,EAAE;IACb,CAAC;IAED,IAAIvE,IAAI,IAAIC,aAAa,EAAE;MACvB;MACA,QAAQD,IAAI;QACR,KAAK,SAAS;UACV,oBACIxE,OAAA;YAAKgH,KAAK,EAAEwH,YAAa;YAAAlH,QAAA,eACrBtH,OAAA;cAAIgH,KAAK,EAAE;gBAAEC,QAAQ,EAAExC,aAAa,CAACwC,QAAQ,IAAI,QAAQ;gBAAEC,KAAK,EAAEzC,aAAa,CAACyC,KAAK,IAAI,SAAS;gBAAEC,MAAM,EAAE,CAAC;gBAAEC,OAAO,EAAE,CAAC;gBAAEC,UAAU,EAAE;cAAO,CAAE;cAAAC,QAAA,EAC3I7C,aAAa,CAAC8C,OAAO,IAAI;YAAS;cAAAC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACnC;UAAC;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACJ,CAAC;QAEd,KAAK,WAAW;UACZ,oBACI3H,OAAA;YAAKgH,KAAK,EAAEwH,YAAa;YAAAlH,QAAA,eACrBtH,OAAA;cAAGgH,KAAK,EAAE;gBAAEC,QAAQ,EAAExC,aAAa,CAACwC,QAAQ,IAAI,MAAM;gBAAEC,KAAK,EAAEzC,aAAa,CAACyC,KAAK,IAAI,SAAS;gBAAEC,MAAM,EAAE,CAAC;gBAAEC,OAAO,EAAE,CAAC;gBAAEC,UAAU,EAAE;cAAO,CAAE;cAAAC,QAAA,EACxI7C,aAAa,CAAC8C,OAAO,IAAI;YAAU;cAAAC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACrC;UAAC;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACH,CAAC;QAEd,KAAK,QAAQ;UACT,oBACI3H,OAAA;YAAKgH,KAAK,EAAEwH,YAAa;YAAAlH,QAAA,eACrBtH,OAAA;cACIgH,KAAK,EAAE;gBACHI,OAAO,EAAE,UAAU;gBACnBQ,YAAY,EAAE,KAAK;gBACnBC,UAAU,EAAEpD,aAAa,CAACoD,UAAU,IAAI,SAAS;gBACjDX,KAAK,EAAEzC,aAAa,CAACyC,KAAK,IAAI,MAAM;gBACpCY,MAAM,EAAE,MAAM;gBACdC,MAAM,EAAE,SAAS;gBACjBV,UAAU,EAAE;cAChB,CAAE;cAAAC,QAAA,EAED7C,aAAa,CAAC8C,OAAO,IAAI;YAAK;cAAAC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAC3B;UAAC;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACR,CAAC;QAEd,KAAK,OAAO;UACR,oBACI3H,OAAA;YAAKgH,KAAK,EAAEwH,YAAa;YAAAlH,QAAA,eACrBtH,OAAA;cACIgI,GAAG,EAAEvD,aAAa,CAACuD,GAAG,IAAI,iCAAkC;cAC5DC,GAAG,EAAC,eAAe;cACnBjB,KAAK,EAAE;gBAAEkB,QAAQ,EAAE,MAAM;gBAAElG,MAAM,EAAE,MAAM;gBAAEqF,UAAU,EAAE;cAAO;YAAE;cAAAG,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACnE;UAAC;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACD,CAAC;QAEd,KAAK,MAAM;UACP,oBACI3H,OAAA;YAAKgH,KAAK,EAAEwH,YAAa;YAAAlH,QAAA,eACrBtH,OAAA;cAAMgH,KAAK,EAAE;gBAAEoB,OAAO,EAAE,MAAM;gBAAEC,aAAa,EAAE,QAAQ;gBAAEC,GAAG,EAAE,MAAM;gBAAEjB,UAAU,EAAE;cAAO,CAAE;cAAAC,QAAA,gBACvFtH,OAAA;gBACIwE,IAAI,EAAC,MAAM;gBACX+D,WAAW,EAAC,OAAO;gBACnBvB,KAAK,EAAE;kBAAEI,OAAO,EAAE,KAAK;kBAAEQ,YAAY,EAAE,KAAK;kBAAEE,MAAM,EAAE;gBAAiB,CAAE;gBACzEU,QAAQ;cAAA;gBAAAhB,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACX,CAAC,eACF3H,OAAA;gBACIwE,IAAI,EAAC,QAAQ;gBACbwC,KAAK,EAAE;kBACHa,UAAU,EAAE,SAAS;kBACrBX,KAAK,EAAE,MAAM;kBACbE,OAAO,EAAE,UAAU;kBACnBQ,YAAY,EAAE,KAAK;kBACnBE,MAAM,EAAE;gBACZ,CAAE;gBAAAR,QAAA,EACL;cAED;gBAAAE,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAQ,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACP;UAAC;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACN,CAAC;QAEd;UACI,oBAAO3H,OAAA;YAAKgH,KAAK,EAAEwH;UAAa;YAAAhH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAE,CAAC;MAC3C;IACJ;IAEA,oBAAO3H,OAAA;MAAK2I,SAAS,EAAC,kBAAkB;MAAC3B,KAAK,EAAEwH;IAAa;MAAAhH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAE,CAAC;EACpE,CAAC;EAED,oBACI3H,OAAA;IAAK2I,SAAS,EAAC,oBAAoB;IAAC+F,SAAS,EAAEb,aAAc;IAACc,QAAQ,EAAE,CAAE;IAAC3H,KAAK,EAAE;MAAE4H,OAAO,EAAE;IAAO,CAAE;IAAAtH,QAAA,eAClGtH,OAAA;MACIyI,GAAG,EAAGC,IAAI,IAAK;QACXvE,SAAS,CAACqB,OAAO,GAAGkD,IAAI;QACxBkD,IAAI,CAAClD,IAAI,CAAC;MACd,CAAE;MACFC,SAAS,EAAE,cAAc1E,QAAQ,KAAK,QAAQ,GAAG,mBAAmB,GAAGA,QAAQ,KAAK,QAAQ,GAAG,mBAAmB,GAAG,EAAE,EAAG;MAC1H+C,KAAK,EAAE;QACH7D,QAAQ,EAAE,UAAU;QACpB0L,SAAS,EAAE,MAAM;QACjBhH,UAAU,EAAE,EAAA+B,gBAAA,GAAAN,QAAQ,CAACwF,MAAM,cAAAlF,gBAAA,uBAAfA,gBAAA,CAAiB/B,UAAU,KAAI,SAAS;QACpDe,SAAS,EAAE,SAASpI,SAAS,GAAG,GAAG,GAAG;QACtCuO,eAAe,EAAE,UAAU;QAC3BC,QAAQ,EAAE,QAAQ;QAClBjH,MAAM,EAAE2D,MAAM,GAAG,MAAM,GAAG;MAC9B,CAAE;MACFuD,OAAO,EAAEtB,iBAAkB;MAAArG,QAAA,gBAE3BtH,OAAA,CAACH,MAAM;QAACqP,WAAW,EAAE,EAAArF,iBAAA,GAAAP,QAAQ,CAACwF,MAAM,cAAAjF,iBAAA,uBAAfA,iBAAA,CAAiB9H,KAAK,KAAI,IAAK;QAACoN,YAAY,EAAE,IAAK;QAAC3O,SAAS,EAAEA;MAAU;QAAAgH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAE,CAAC,eACjG3H,OAAA,CAACJ,UAAU;QAACkK,UAAU,EAAEA,UAAW;QAACtJ,SAAS,EAAEA;MAAU;QAAAgH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAE,CAAC,EAC3DgC,QAAQ,iBACL3J,OAAA;QACI2I,SAAS,EAAC,iBAAiB;QAC3B3B,KAAK,EAAE;UACH7D,QAAQ,EAAE,UAAU;UACpB7B,GAAG,EAAE,CAAC;UACNF,IAAI,EAAE,CAAC;UACPiC,KAAK,EAAE,CAAC;UACRE,MAAM,EAAE,CAAC;UACT6L,eAAe,EAAE;AACjD;AACA;AACA,iCAAiC;UACDC,cAAc,EAAE,GAAG3N,QAAQ,MAAMA,QAAQ,IAAI;UAC7C+M,aAAa,EAAE,MAAM;UACrB1F,OAAO,EAAE;QACb;MAAE;QAAAvB,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACL,CACJ,EACA2B,QAAQ,CAACsB,QAAQ,CAACsD,GAAG,CAAE1L,OAAO,iBAC3BxC,OAAA,CAAC0D,OAAO;QAEJlB,OAAO,EAAEA,OAAQ;QACjBsB,UAAU,EAAEM,WAAW,CAACqC,QAAQ,CAACjE,OAAO,CAAC+B,EAAE,CAAE;QAC7CR,eAAe,EAAEA,eAAgB;QACjCC,gBAAgB,EAAEgH,oBAAqB;QACvC/G,QAAQ,EAAEA,QAAS;QACnBzD,SAAS,EAAEA,SAAU;QACrBkB,QAAQ,EAAEiI,QAAQ,GAAGjI,QAAQ,GAAG0K,QAAS;QACzClI,aAAa,EAAEyC,iBAAkB;QACjC/E,YAAY,EAAEA,YAAa;QAC3BuC,SAAS,EAAEA,SAAU;QACrBC,WAAW,EAAEA;MAAY,GAXpB5B,OAAO,CAAC+B,EAAE;QAAAiD,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAYlB,CACJ,CAAC,EACD4G,iBAAiB,CAAC,CAAC,eACpBvO,OAAA,CAACF,gBAAgB;QACbwP,gBAAgB,EAAEhG,QAAQ,CAACsB,QAAQ,CAAC2E,MAAM,CAAE1E,EAAE,IAAKzG,WAAW,CAACqC,QAAQ,CAACoE,EAAE,CAACtG,EAAE,CAAC,CAAE;QAChFiL,QAAQ,EAAEjG,YAAa;QACvB/I,SAAS,EAAEA;MAAU;QAAAgH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACxB,CAAC,EACDqC,WAAW,iBACRhK,OAAA;QACI2I,SAAS,EAAC,kBAAkB;QAC5B3B,KAAK,EAAE;UACH7D,QAAQ,EAAE,OAAO;UACjB/B,IAAI,EAAE4I,WAAW,CAAC7G,QAAQ,CAACxC,CAAC;UAC5BW,GAAG,EAAE0I,WAAW,CAAC7G,QAAQ,CAACvC,CAAC;UAC3BiI,MAAM,EAAE,KAAK;UACbhB,UAAU,EAAE,MAAM;UAClBC,MAAM,EAAE,gBAAgB;UACxBF,YAAY,EAAE,KAAK;UACnBoB,SAAS,EAAE,4BAA4B;UACvCyG,QAAQ,EAAE;QACd,CAAE;QAAAnI,QAAA,gBAEFtH,OAAA;UACI2I,SAAS,EAAC,uBAAuB;UACjC3B,KAAK,EAAE;YAAEI,OAAO,EAAE,UAAU;YAAEW,MAAM,EAAE,SAAS;YAAE2H,YAAY,EAAE;UAAiB,CAAE;UAClFT,OAAO,EAAEA,CAAA,KAAM;YACXzF,eAAe,CAACQ,WAAW,CAACzF,EAAE,CAAC;YAC/B0F,cAAc,CAAC,IAAI,CAAC;UACxB,CAAE;UAAA3C,QAAA,EACL;QAED;UAAAE,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAK,CAAC,eACN3H,OAAA;UACI2I,SAAS,EAAC,uBAAuB;UACjC3B,KAAK,EAAE;YAAEI,OAAO,EAAE,UAAU;YAAEW,MAAM,EAAE;UAAU,CAAE;UAClDkH,OAAO,EAAEA,CAAA,KAAM;YACXvF,eAAe,CAAC,CAACM,WAAW,CAACzF,EAAE,CAAC,CAAC;YACjC0F,cAAc,CAAC,IAAI,CAAC;UACxB,CAAE;UAAA3C,QAAA,EACL;QAED;UAAAE,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAK,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACL,CACR;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACA;EAAC;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACL,CAAC;AAEd,CAAC;EAAA,QA5XGjI,UAAU,EACVA,UAAU,EAE2BH,OAAO,EA+J5CG,UAAU,EAKVA,UAAU;AAAA,EAsNlB,CAAC;EAAA,QA7XOA,UAAU,EACVA,UAAU,EAE2BH,OAAO,EA+J5CG,UAAU,EAKVA,UAAU;AAAA,EAsNjB;AAACiQ,GAAA,GA3cIxG,MAAM;AA6cZ,eAAeA,MAAM;AAAC,IAAAtF,EAAA,EAAAqF,GAAA,EAAAG,GAAA,EAAAsG,GAAA;AAAAC,YAAA,CAAA/L,EAAA;AAAA+L,YAAA,CAAA1G,GAAA;AAAA0G,YAAA,CAAAvG,GAAA;AAAAuG,YAAA,CAAAD,GAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}