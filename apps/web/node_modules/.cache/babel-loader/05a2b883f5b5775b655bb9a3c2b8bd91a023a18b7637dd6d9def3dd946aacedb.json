{"ast":null,"code":"/**\r\n * Responsive Sync Utilities\r\n * Tự động sync size, position, styles giữa các view modes (desktop, tablet, mobile)\r\n */\n\n/**\r\n * Tính scale factor giữa các view modes\r\n */\nexport const RESPONSIVE_DATA_KEYS = ['content', 'animation', 'title', 'overlayColor', 'overlayOpacity', 'backgroundType', 'rotate', 'scale', 'hoverZoom', 'hoverRotate', 'hoverGrayscale'];\nexport const getScaleFactor = (fromMode, toMode) => {\n  const widths = {\n    desktop: 1200,\n    tablet: 768,\n    mobile: 375\n  };\n  return widths[toMode] / widths[fromMode];\n};\n\n/**\r\n * Tự động scale size cho element\r\n */\nexport const autoScaleSize = (element, fromMode, toMode) => {\n  var _element$size4, _element$size5;\n  const scaleFactor = getScaleFactor(fromMode, toMode);\n\n  // Section luôn full-width\n  if (element.type === 'section') {\n    var _element$size;\n    return {\n      width: toMode === 'mobile' ? 375 : toMode === 'tablet' ? 768 : 1200,\n      height: ((_element$size = element.size) === null || _element$size === void 0 ? void 0 : _element$size.height) || 400\n    };\n  }\n\n  // Popup có width cố định\n  if (element.type === 'popup' || element.type === 'modal') {\n    var _element$size2, _element$size3;\n    return {\n      width: toMode === 'mobile' ? 340 : toMode === 'tablet' ? 600 : ((_element$size2 = element.size) === null || _element$size2 === void 0 ? void 0 : _element$size2.width) || 600,\n      height: ((_element$size3 = element.size) === null || _element$size3 === void 0 ? void 0 : _element$size3.height) || 400\n    };\n  }\n\n  // Scale các element khác\n  const baseWidth = ((_element$size4 = element.size) === null || _element$size4 === void 0 ? void 0 : _element$size4.width) || 200;\n  const baseHeight = ((_element$size5 = element.size) === null || _element$size5 === void 0 ? void 0 : _element$size5.height) || 50;\n  let scaledWidth = Math.round(baseWidth * scaleFactor);\n  let scaledHeight = Math.round(baseHeight * scaleFactor);\n\n  // Minimum sizes theo type\n  const minSizes = {\n    button: {\n      width: 80,\n      height: 32\n    },\n    icon: {\n      width: 24,\n      height: 24\n    },\n    image: {\n      width: 100,\n      height: 100\n    },\n    heading: {\n      width: 150,\n      height: 24\n    },\n    paragraph: {\n      width: 200,\n      height: 40\n    },\n    gallery: {\n      width: 300,\n      height: 200\n    },\n    default: {\n      width: 100,\n      height: 40\n    }\n  };\n  const minSize = minSizes[element.type] || minSizes.default;\n\n  // Maximum width cho mobile\n  if (toMode === 'mobile') {\n    scaledWidth = Math.min(scaledWidth, 340); // Để có padding 2 bên\n  }\n  return {\n    width: Math.max(scaledWidth, minSize.width),\n    height: Math.max(scaledHeight, minSize.height)\n  };\n};\n\n/**\r\n * Tự động scale position cho element\r\n */\nexport const autoScalePosition = (element, fromMode, toMode, newSize) => {\n  var _element$position, _element$size6;\n  const fromPos = ((_element$position = element.position) === null || _element$position === void 0 ? void 0 : _element$position[fromMode]) || {\n    x: 0,\n    y: 0,\n    z: 1\n  };\n  const scaleFactor = getScaleFactor(fromMode, toMode);\n\n  // Section luôn x = 0\n  if (element.type === 'section') {\n    return {\n      x: 0,\n      y: fromPos.y,\n      z: fromPos.z || 1\n    };\n  }\n\n  // Popup center\n  if (element.type === 'popup' || element.type === 'modal') {\n    return {\n      x: fromPos.x,\n      y: fromPos.y,\n      z: fromPos.z || 1001\n    };\n  }\n\n  // Scale position\n  let scaledX = Math.round(fromPos.x * scaleFactor);\n  let scaledY = Math.round(fromPos.y * scaleFactor);\n\n  // Đảm bảo không overflow\n  const canvasWidth = toMode === 'mobile' ? 375 : toMode === 'tablet' ? 768 : 1200;\n  const elementWidth = (newSize === null || newSize === void 0 ? void 0 : newSize.width) || ((_element$size6 = element.size) === null || _element$size6 === void 0 ? void 0 : _element$size6.width) || 200;\n  if (scaledX + elementWidth > canvasWidth) {\n    scaledX = Math.max(0, canvasWidth - elementWidth - 10);\n  }\n  return {\n    x: Math.max(0, scaledX),\n    y: Math.max(0, scaledY),\n    z: fromPos.z || 1\n  };\n};\n\n/**\r\n * Scale styles (font, padding, margin, etc.)\r\n */\nexport const autoScaleStyles = (styles, fromMode, toMode) => {\n  if (!styles) return {};\n  const scaleFactor = getScaleFactor(fromMode, toMode);\n  const scaledStyles = {\n    ...styles\n  };\n\n  // Properties cần scale\n  const scalableProps = ['fontSize', 'padding', 'paddingTop', 'paddingBottom', 'paddingLeft', 'paddingRight', 'margin', 'marginTop', 'marginBottom', 'marginLeft', 'marginRight', 'borderRadius', 'gap', 'borderWidth', 'strokeWidth', 'lineHeight'];\n  scalableProps.forEach(prop => {\n    if (scaledStyles[prop]) {\n      const value = scaledStyles[prop];\n\n      // Parse number + unit\n      if (typeof value === 'string') {\n        const match = value.match(/^([\\d.]+)(px|rem|em|%)$/);\n        if (match) {\n          const num = parseFloat(match[1]);\n          const unit = match[2];\n\n          // Scale pixel values\n          if (unit === 'px') {\n            const scaled = Math.round(num * scaleFactor * 10) / 10;\n            // Minimum values\n            const min = prop.includes('font') ? 10 : 4;\n            scaledStyles[prop] = `${Math.max(scaled, min)}${unit}`;\n          }\n        }\n      } else if (typeof value === 'number') {\n        const scaled = Math.round(value * scaleFactor);\n        const min = prop.includes('font') ? 10 : 4;\n        scaledStyles[prop] = Math.max(scaled, min);\n      }\n    }\n  });\n\n  // Scale compound values (padding: \"10px 20px\")\n  if (scaledStyles.padding && typeof scaledStyles.padding === 'string' && scaledStyles.padding.includes(' ')) {\n    const values = scaledStyles.padding.split(' ');\n    const scaledValues = values.map(val => {\n      const match = val.match(/^([\\d.]+)(px|rem|em)$/);\n      if (match) {\n        const num = parseFloat(match[1]);\n        const unit = match[2];\n        const scaled = Math.round(num * scaleFactor * 10) / 10;\n        return `${Math.max(scaled, 4)}${unit}`;\n      }\n      return val;\n    });\n    scaledStyles.padding = scaledValues.join(' ');\n  }\n  return scaledStyles;\n};\n\n/**\r\n * Scale componentData (columns, images grid, etc.)\r\n */\nexport const autoScaleComponentData = (componentData, toMode) => {\n  if (!componentData) return {};\n  const scaled = {\n    ...componentData\n  };\n  if (toMode === 'mobile') {\n    // Giảm columns cho mobile\n    if (scaled.columns && scaled.columns > 2) {\n      scaled.columns = 1;\n    }\n\n    // Grid template columns cho gallery\n    if (scaled.images && scaled.images.length > 0) {\n      scaled.gridTemplateColumns = 'repeat(2, 1fr)'; // Mobile: 2 columns\n    }\n\n    // Scale gap\n    if (scaled.gap) {\n      const match = scaled.gap.match(/^([\\d.]+)(px|rem)$/);\n      if (match) {\n        const value = parseFloat(match[1]);\n        const unit = match[2];\n        scaled.gap = `${Math.max(value * 0.5, 8)}${unit}`;\n      }\n    }\n  } else if (toMode === 'tablet') {\n    // Giảm columns cho tablet\n    if (scaled.columns && scaled.columns > 3) {\n      scaled.columns = 2;\n    }\n    if (scaled.images && scaled.images.length > 0) {\n      scaled.gridTemplateColumns = 'repeat(3, 1fr)'; // Tablet: 3 columns\n    }\n  }\n  return scaled;\n};\n\n/**\r\n * MAIN FUNCTION: Sync element giữa các view modes\r\n */\nexport const syncElementBetweenModes = (element, changedMode) => {\n  const modes = ['desktop', 'tablet', 'mobile'];\n  const updatedElement = {\n    ...element\n  };\n\n  // Đảm bảo có position cho tất cả modes\n  if (!updatedElement.position) {\n    updatedElement.position = {\n      desktop: {\n        x: 0,\n        y: 0,\n        z: 1\n      },\n      tablet: {\n        x: 0,\n        y: 0,\n        z: 1\n      },\n      mobile: {\n        x: 0,\n        y: 0,\n        z: 1\n      }\n    };\n  }\n\n  // Sync từ changedMode sang các modes khác\n  modes.forEach(targetMode => {\n    if (targetMode !== changedMode) {\n      // Scale size\n      const scaledSize = autoScaleSize(updatedElement, changedMode, targetMode);\n\n      // Scale position\n      const scaledPosition = autoScalePosition(updatedElement, changedMode, targetMode, scaledSize);\n\n      // Update position\n      updatedElement.position[targetMode] = scaledPosition;\n\n      // Update size (chỉ cần 1 size object, không phân theo mode)\n      if (targetMode === 'mobile') {\n        updatedElement.mobileSize = scaledSize;\n      } else if (targetMode === 'tablet') {\n        updatedElement.tabletSize = scaledSize;\n      }\n    }\n  });\n\n  // Scale styles cho mobile\n  if (!updatedElement.responsiveStyles) {\n    updatedElement.responsiveStyles = {};\n  }\n  updatedElement.responsiveStyles.mobile = autoScaleStyles(updatedElement.styles, 'desktop', 'mobile');\n  updatedElement.responsiveStyles.tablet = autoScaleStyles(updatedElement.styles, 'desktop', 'tablet');\n\n  // Scale componentData\n  updatedElement.mobileComponentData = autoScaleComponentData(updatedElement.componentData, 'mobile');\n  updatedElement.tabletComponentData = autoScaleComponentData(updatedElement.componentData, 'tablet');\n\n  // Sync children nếu có\n  if (updatedElement.children && updatedElement.children.length > 0) {\n    updatedElement.children = updatedElement.children.map(child => syncElementBetweenModes(child, changedMode));\n  }\n  return updatedElement;\n};\n\n/**\r\n * Sync toàn bộ pageData khi chuyển view mode\r\n */\nexport const syncAllElements = (pageData, currentMode) => {\n  return {\n    ...pageData,\n    elements: pageData.elements.map(element => syncElementBetweenModes(element, currentMode))\n  };\n};\n\n/**\r\n * Get responsive values dựa trên viewMode hiện tại\r\n */\nexport const getResponsiveValues = (element, viewMode) => {\n  var _element$size7, _element$position2, _element$styles, _element$componentDat;\n  // 1. Lấy giá trị Desktop làm nền tảng (luôn luôn)\n  const baseSize = ((_element$size7 = element.size) === null || _element$size7 === void 0 ? void 0 : _element$size7.desktop) || element.size || {\n    width: 200,\n    height: 50\n  };\n  const basePosition = ((_element$position2 = element.position) === null || _element$position2 === void 0 ? void 0 : _element$position2.desktop) || element.position || {\n    x: 0,\n    y: 0,\n    z: 1\n  };\n  const baseStyles = ((_element$styles = element.styles) === null || _element$styles === void 0 ? void 0 : _element$styles.desktop) || element.styles || {};\n\n  // 2. Xử lý Component Data (Quan trọng)\n  // Bắt đầu với TẤT CẢ data global (không nằm trong các bucket desktop/tablet/mobile)\n  const globalComponentData = {\n    ...element.componentData\n  };\n  delete globalComponentData.desktop;\n  delete globalComponentData.tablet;\n  delete globalComponentData.mobile;\n\n  // Lấy data responsive nền (desktop)\n  const baseResponsiveComponentData = ((_element$componentDat = element.componentData) === null || _element$componentDat === void 0 ? void 0 : _element$componentDat.desktop) || {};\n\n  // Merge global + desktop\n  let responsiveComponentData = {\n    ...globalComponentData,\n    ...baseResponsiveComponentData\n  };\n  let responsiveSize = {\n    ...baseSize\n  };\n  let responsivePosition = {\n    ...basePosition\n  };\n  let responsiveStyles = {\n    ...baseStyles\n  };\n\n  // 3. Nếu là Tablet, đè giá trị Tablet lên Desktop\n  if (viewMode === 'tablet') {\n    var _element$size8, _element$position3, _element$styles2, _element$componentDat2;\n    responsiveSize = {\n      ...responsiveSize,\n      ...(((_element$size8 = element.size) === null || _element$size8 === void 0 ? void 0 : _element$size8.tablet) || {})\n    };\n    responsivePosition = {\n      ...responsivePosition,\n      ...(((_element$position3 = element.position) === null || _element$position3 === void 0 ? void 0 : _element$position3.tablet) || {})\n    };\n    responsiveStyles = {\n      ...responsiveStyles,\n      ...(((_element$styles2 = element.styles) === null || _element$styles2 === void 0 ? void 0 : _element$styles2.tablet) || {})\n    };\n    responsiveComponentData = {\n      ...responsiveComponentData,\n      ...(((_element$componentDat2 = element.componentData) === null || _element$componentDat2 === void 0 ? void 0 : _element$componentDat2.tablet) || {})\n    };\n  }\n\n  // 4. Nếu là Mobile, đè giá trị Mobile lên (Desktop -> Tablet)\n  if (viewMode === 'mobile') {\n    var _element$size9, _element$size0, _element$position4, _element$position5, _element$styles3, _element$styles4, _element$componentDat3, _element$componentDat4;\n    responsiveSize = {\n      ...responsiveSize,\n      ...(((_element$size9 = element.size) === null || _element$size9 === void 0 ? void 0 : _element$size9.tablet) || {}),\n      ...(((_element$size0 = element.size) === null || _element$size0 === void 0 ? void 0 : _element$size0.mobile) || {})\n    };\n    responsivePosition = {\n      ...responsivePosition,\n      ...(((_element$position4 = element.position) === null || _element$position4 === void 0 ? void 0 : _element$position4.tablet) || {}),\n      ...(((_element$position5 = element.position) === null || _element$position5 === void 0 ? void 0 : _element$position5.mobile) || {})\n    };\n    responsiveStyles = {\n      ...responsiveStyles,\n      ...(((_element$styles3 = element.styles) === null || _element$styles3 === void 0 ? void 0 : _element$styles3.tablet) || {}),\n      ...(((_element$styles4 = element.styles) === null || _element$styles4 === void 0 ? void 0 : _element$styles4.mobile) || {})\n    };\n    responsiveComponentData = {\n      ...responsiveComponentData,\n      ...(((_element$componentDat3 = element.componentData) === null || _element$componentDat3 === void 0 ? void 0 : _element$componentDat3.tablet) || {}),\n      ...(((_element$componentDat4 = element.componentData) === null || _element$componentDat4 === void 0 ? void 0 : _element$componentDat4.mobile) || {})\n    };\n  }\n\n  // 5. Trả về bộ giá trị cuối cùng cho viewMode này\n  return {\n    size: responsiveSize,\n    position: responsivePosition,\n    styles: responsiveStyles,\n    componentData: responsiveComponentData\n  };\n};\n\n/**\r\n * Initialize responsive data cho elements chưa có\r\n */\nexport const initializeResponsiveData = pageData => {\n  return {\n    ...pageData,\n    elements: pageData.elements.map(element => {\n      var _element$position6, _element$position7;\n      // Nếu chưa có responsive data, tạo mới\n      if (!((_element$position6 = element.position) !== null && _element$position6 !== void 0 && _element$position6.mobile) || !((_element$position7 = element.position) !== null && _element$position7 !== void 0 && _element$position7.tablet)) {\n        return syncElementBetweenModes(element, 'desktop');\n      }\n      return element;\n    })\n  };\n};\n\n/**\r\n * Batch update khi user thay đổi nhiều elements\r\n */\nexport const batchSyncElements = (elements, changedMode) => {\n  return elements.map(element => syncElementBetweenModes(element, changedMode));\n};\nexport default {\n  getScaleFactor,\n  autoScaleSize,\n  autoScalePosition,\n  autoScaleStyles,\n  autoScaleComponentData,\n  syncElementBetweenModes,\n  syncAllElements,\n  getResponsiveValues,\n  initializeResponsiveData,\n  batchSyncElements\n};","map":{"version":3,"names":["RESPONSIVE_DATA_KEYS","getScaleFactor","fromMode","toMode","widths","desktop","tablet","mobile","autoScaleSize","element","_element$size4","_element$size5","scaleFactor","type","_element$size","width","height","size","_element$size2","_element$size3","baseWidth","baseHeight","scaledWidth","Math","round","scaledHeight","minSizes","button","icon","image","heading","paragraph","gallery","default","minSize","min","max","autoScalePosition","newSize","_element$position","_element$size6","fromPos","position","x","y","z","scaledX","scaledY","canvasWidth","elementWidth","autoScaleStyles","styles","scaledStyles","scalableProps","forEach","prop","value","match","num","parseFloat","unit","scaled","includes","padding","values","split","scaledValues","map","val","join","autoScaleComponentData","componentData","columns","images","length","gridTemplateColumns","gap","syncElementBetweenModes","changedMode","modes","updatedElement","targetMode","scaledSize","scaledPosition","mobileSize","tabletSize","responsiveStyles","mobileComponentData","tabletComponentData","children","child","syncAllElements","pageData","currentMode","elements","getResponsiveValues","viewMode","_element$size7","_element$position2","_element$styles","_element$componentDat","baseSize","basePosition","baseStyles","globalComponentData","baseResponsiveComponentData","responsiveComponentData","responsiveSize","responsivePosition","_element$size8","_element$position3","_element$styles2","_element$componentDat2","_element$size9","_element$size0","_element$position4","_element$position5","_element$styles3","_element$styles4","_element$componentDat3","_element$componentDat4","initializeResponsiveData","_element$position6","_element$position7","batchSyncElements"],"sources":["D:/landing-hub/apps/web/src/utils/responsiveSync.js"],"sourcesContent":["/**\r\n * Responsive Sync Utilities\r\n * Tự động sync size, position, styles giữa các view modes (desktop, tablet, mobile)\r\n */\r\n\r\n/**\r\n * Tính scale factor giữa các view modes\r\n */\r\nexport const RESPONSIVE_DATA_KEYS = [\r\n    'content',\r\n    'animation',\r\n    'title',\r\n    'overlayColor',\r\n    'overlayOpacity',\r\n    'backgroundType',\r\n    'rotate',\r\n    'scale',\r\n    'hoverZoom',\r\n    'hoverRotate',\r\n    'hoverGrayscale'\r\n];\r\nexport const getScaleFactor = (fromMode, toMode) => {\r\n    const widths = {\r\n        desktop: 1200,\r\n        tablet: 768,\r\n        mobile: 375\r\n    };\r\n    return widths[toMode] / widths[fromMode];\r\n};\r\n\r\n/**\r\n * Tự động scale size cho element\r\n */\r\nexport const autoScaleSize = (element, fromMode, toMode) => {\r\n    const scaleFactor = getScaleFactor(fromMode, toMode);\r\n\r\n    // Section luôn full-width\r\n    if (element.type === 'section') {\r\n        return {\r\n            width: toMode === 'mobile' ? 375 : toMode === 'tablet' ? 768 : 1200,\r\n            height: element.size?.height || 400\r\n        };\r\n    }\r\n\r\n    // Popup có width cố định\r\n    if (element.type === 'popup' || element.type === 'modal') {\r\n        return {\r\n            width: toMode === 'mobile' ? 340 : toMode === 'tablet' ? 600 : element.size?.width || 600,\r\n            height: element.size?.height || 400\r\n        };\r\n    }\r\n\r\n    // Scale các element khác\r\n    const baseWidth = element.size?.width || 200;\r\n    const baseHeight = element.size?.height || 50;\r\n\r\n    let scaledWidth = Math.round(baseWidth * scaleFactor);\r\n    let scaledHeight = Math.round(baseHeight * scaleFactor);\r\n\r\n    // Minimum sizes theo type\r\n    const minSizes = {\r\n        button: { width: 80, height: 32 },\r\n        icon: { width: 24, height: 24 },\r\n        image: { width: 100, height: 100 },\r\n        heading: { width: 150, height: 24 },\r\n        paragraph: { width: 200, height: 40 },\r\n        gallery: { width: 300, height: 200 },\r\n        default: { width: 100, height: 40 }\r\n    };\r\n\r\n    const minSize = minSizes[element.type] || minSizes.default;\r\n\r\n    // Maximum width cho mobile\r\n    if (toMode === 'mobile') {\r\n        scaledWidth = Math.min(scaledWidth, 340); // Để có padding 2 bên\r\n    }\r\n\r\n    return {\r\n        width: Math.max(scaledWidth, minSize.width),\r\n        height: Math.max(scaledHeight, minSize.height)\r\n    };\r\n};\r\n\r\n/**\r\n * Tự động scale position cho element\r\n */\r\nexport const autoScalePosition = (element, fromMode, toMode, newSize) => {\r\n    const fromPos = element.position?.[fromMode] || { x: 0, y: 0, z: 1 };\r\n    const scaleFactor = getScaleFactor(fromMode, toMode);\r\n\r\n    // Section luôn x = 0\r\n    if (element.type === 'section') {\r\n        return {\r\n            x: 0,\r\n            y: fromPos.y,\r\n            z: fromPos.z || 1\r\n        };\r\n    }\r\n\r\n    // Popup center\r\n    if (element.type === 'popup' || element.type === 'modal') {\r\n        return {\r\n            x: fromPos.x,\r\n            y: fromPos.y,\r\n            z: fromPos.z || 1001\r\n        };\r\n    }\r\n\r\n    // Scale position\r\n    let scaledX = Math.round(fromPos.x * scaleFactor);\r\n    let scaledY = Math.round(fromPos.y * scaleFactor);\r\n\r\n    // Đảm bảo không overflow\r\n    const canvasWidth = toMode === 'mobile' ? 375 : toMode === 'tablet' ? 768 : 1200;\r\n    const elementWidth = newSize?.width || element.size?.width || 200;\r\n\r\n    if (scaledX + elementWidth > canvasWidth) {\r\n        scaledX = Math.max(0, canvasWidth - elementWidth - 10);\r\n    }\r\n\r\n    return {\r\n        x: Math.max(0, scaledX),\r\n        y: Math.max(0, scaledY),\r\n        z: fromPos.z || 1\r\n    };\r\n};\r\n\r\n/**\r\n * Scale styles (font, padding, margin, etc.)\r\n */\r\nexport const autoScaleStyles = (styles, fromMode, toMode) => {\r\n    if (!styles) return {};\r\n\r\n    const scaleFactor = getScaleFactor(fromMode, toMode);\r\n    const scaledStyles = { ...styles };\r\n\r\n    // Properties cần scale\r\n    const scalableProps = [\r\n        'fontSize', 'padding', 'paddingTop', 'paddingBottom',\r\n        'paddingLeft', 'paddingRight', 'margin', 'marginTop',\r\n        'marginBottom', 'marginLeft', 'marginRight', 'borderRadius',\r\n        'gap', 'borderWidth', 'strokeWidth', 'lineHeight'\r\n    ];\r\n\r\n    scalableProps.forEach(prop => {\r\n        if (scaledStyles[prop]) {\r\n            const value = scaledStyles[prop];\r\n\r\n            // Parse number + unit\r\n            if (typeof value === 'string') {\r\n                const match = value.match(/^([\\d.]+)(px|rem|em|%)$/);\r\n                if (match) {\r\n                    const num = parseFloat(match[1]);\r\n                    const unit = match[2];\r\n\r\n                    // Scale pixel values\r\n                    if (unit === 'px') {\r\n                        const scaled = Math.round(num * scaleFactor * 10) / 10;\r\n                        // Minimum values\r\n                        const min = prop.includes('font') ? 10 : 4;\r\n                        scaledStyles[prop] = `${Math.max(scaled, min)}${unit}`;\r\n                    }\r\n                }\r\n            } else if (typeof value === 'number') {\r\n                const scaled = Math.round(value * scaleFactor);\r\n                const min = prop.includes('font') ? 10 : 4;\r\n                scaledStyles[prop] = Math.max(scaled, min);\r\n            }\r\n        }\r\n    });\r\n\r\n    // Scale compound values (padding: \"10px 20px\")\r\n    if (scaledStyles.padding && typeof scaledStyles.padding === 'string' && scaledStyles.padding.includes(' ')) {\r\n        const values = scaledStyles.padding.split(' ');\r\n        const scaledValues = values.map(val => {\r\n            const match = val.match(/^([\\d.]+)(px|rem|em)$/);\r\n            if (match) {\r\n                const num = parseFloat(match[1]);\r\n                const unit = match[2];\r\n                const scaled = Math.round(num * scaleFactor * 10) / 10;\r\n                return `${Math.max(scaled, 4)}${unit}`;\r\n            }\r\n            return val;\r\n        });\r\n        scaledStyles.padding = scaledValues.join(' ');\r\n    }\r\n\r\n    return scaledStyles;\r\n};\r\n\r\n/**\r\n * Scale componentData (columns, images grid, etc.)\r\n */\r\nexport const autoScaleComponentData = (componentData, toMode) => {\r\n    if (!componentData) return {};\r\n\r\n    const scaled = { ...componentData };\r\n\r\n    if (toMode === 'mobile') {\r\n        // Giảm columns cho mobile\r\n        if (scaled.columns && scaled.columns > 2) {\r\n            scaled.columns = 1;\r\n        }\r\n\r\n        // Grid template columns cho gallery\r\n        if (scaled.images && scaled.images.length > 0) {\r\n            scaled.gridTemplateColumns = 'repeat(2, 1fr)'; // Mobile: 2 columns\r\n        }\r\n\r\n        // Scale gap\r\n        if (scaled.gap) {\r\n            const match = scaled.gap.match(/^([\\d.]+)(px|rem)$/);\r\n            if (match) {\r\n                const value = parseFloat(match[1]);\r\n                const unit = match[2];\r\n                scaled.gap = `${Math.max(value * 0.5, 8)}${unit}`;\r\n            }\r\n        }\r\n    } else if (toMode === 'tablet') {\r\n        // Giảm columns cho tablet\r\n        if (scaled.columns && scaled.columns > 3) {\r\n            scaled.columns = 2;\r\n        }\r\n\r\n        if (scaled.images && scaled.images.length > 0) {\r\n            scaled.gridTemplateColumns = 'repeat(3, 1fr)'; // Tablet: 3 columns\r\n        }\r\n    }\r\n\r\n    return scaled;\r\n};\r\n\r\n/**\r\n * MAIN FUNCTION: Sync element giữa các view modes\r\n */\r\nexport const syncElementBetweenModes = (element, changedMode) => {\r\n    const modes = ['desktop', 'tablet', 'mobile'];\r\n    const updatedElement = { ...element };\r\n\r\n    // Đảm bảo có position cho tất cả modes\r\n    if (!updatedElement.position) {\r\n        updatedElement.position = {\r\n            desktop: { x: 0, y: 0, z: 1 },\r\n            tablet: { x: 0, y: 0, z: 1 },\r\n            mobile: { x: 0, y: 0, z: 1 }\r\n        };\r\n    }\r\n\r\n    // Sync từ changedMode sang các modes khác\r\n    modes.forEach(targetMode => {\r\n        if (targetMode !== changedMode) {\r\n            // Scale size\r\n            const scaledSize = autoScaleSize(updatedElement, changedMode, targetMode);\r\n\r\n            // Scale position\r\n            const scaledPosition = autoScalePosition(updatedElement, changedMode, targetMode, scaledSize);\r\n\r\n            // Update position\r\n            updatedElement.position[targetMode] = scaledPosition;\r\n\r\n            // Update size (chỉ cần 1 size object, không phân theo mode)\r\n            if (targetMode === 'mobile') {\r\n                updatedElement.mobileSize = scaledSize;\r\n            } else if (targetMode === 'tablet') {\r\n                updatedElement.tabletSize = scaledSize;\r\n            }\r\n        }\r\n    });\r\n\r\n    // Scale styles cho mobile\r\n    if (!updatedElement.responsiveStyles) {\r\n        updatedElement.responsiveStyles = {};\r\n    }\r\n\r\n    updatedElement.responsiveStyles.mobile = autoScaleStyles(\r\n        updatedElement.styles,\r\n        'desktop',\r\n        'mobile'\r\n    );\r\n\r\n    updatedElement.responsiveStyles.tablet = autoScaleStyles(\r\n        updatedElement.styles,\r\n        'desktop',\r\n        'tablet'\r\n    );\r\n\r\n    // Scale componentData\r\n    updatedElement.mobileComponentData = autoScaleComponentData(\r\n        updatedElement.componentData,\r\n        'mobile'\r\n    );\r\n\r\n    updatedElement.tabletComponentData = autoScaleComponentData(\r\n        updatedElement.componentData,\r\n        'tablet'\r\n    );\r\n\r\n    // Sync children nếu có\r\n    if (updatedElement.children && updatedElement.children.length > 0) {\r\n        updatedElement.children = updatedElement.children.map(child =>\r\n            syncElementBetweenModes(child, changedMode)\r\n        );\r\n    }\r\n\r\n    return updatedElement;\r\n};\r\n\r\n/**\r\n * Sync toàn bộ pageData khi chuyển view mode\r\n */\r\nexport const syncAllElements = (pageData, currentMode) => {\r\n    return {\r\n        ...pageData,\r\n        elements: pageData.elements.map(element =>\r\n            syncElementBetweenModes(element, currentMode)\r\n        )\r\n    };\r\n};\r\n\r\n/**\r\n * Get responsive values dựa trên viewMode hiện tại\r\n */\r\nexport const getResponsiveValues = (element, viewMode) => {\r\n    // 1. Lấy giá trị Desktop làm nền tảng (luôn luôn)\r\n    const baseSize = element.size?.desktop || element.size || { width: 200, height: 50 };\r\n    const basePosition = element.position?.desktop || element.position || { x: 0, y: 0, z: 1 };\r\n    const baseStyles = element.styles?.desktop || element.styles || {};\r\n\r\n    // 2. Xử lý Component Data (Quan trọng)\r\n    // Bắt đầu với TẤT CẢ data global (không nằm trong các bucket desktop/tablet/mobile)\r\n    const globalComponentData = { ...element.componentData };\r\n    delete globalComponentData.desktop;\r\n    delete globalComponentData.tablet;\r\n    delete globalComponentData.mobile;\r\n\r\n    // Lấy data responsive nền (desktop)\r\n    const baseResponsiveComponentData = element.componentData?.desktop || {};\r\n\r\n    // Merge global + desktop\r\n    let responsiveComponentData = { ...globalComponentData, ...baseResponsiveComponentData };\r\n    let responsiveSize = { ...baseSize };\r\n    let responsivePosition = { ...basePosition };\r\n    let responsiveStyles = { ...baseStyles };\r\n\r\n    // 3. Nếu là Tablet, đè giá trị Tablet lên Desktop\r\n    if (viewMode === 'tablet') {\r\n        responsiveSize = { ...responsiveSize, ...(element.size?.tablet || {}) };\r\n        responsivePosition = { ...responsivePosition, ...(element.position?.tablet || {}) };\r\n        responsiveStyles = { ...responsiveStyles, ...(element.styles?.tablet || {}) };\r\n        responsiveComponentData = { ...responsiveComponentData, ...(element.componentData?.tablet || {}) };\r\n    }\r\n\r\n    // 4. Nếu là Mobile, đè giá trị Mobile lên (Desktop -> Tablet)\r\n    if (viewMode === 'mobile') {\r\n        responsiveSize = { ...responsiveSize, ...(element.size?.tablet || {}), ...(element.size?.mobile || {}) };\r\n        responsivePosition = { ...responsivePosition, ...(element.position?.tablet || {}), ...(element.position?.mobile || {}) };\r\n        responsiveStyles = { ...responsiveStyles, ...(element.styles?.tablet || {}), ...(element.styles?.mobile || {}) };\r\n        responsiveComponentData = { ...responsiveComponentData, ...(element.componentData?.tablet || {}), ...(element.componentData?.mobile || {}) };\r\n    }\r\n\r\n    // 5. Trả về bộ giá trị cuối cùng cho viewMode này\r\n    return {\r\n        size: responsiveSize,\r\n        position: responsivePosition,\r\n        styles: responsiveStyles,\r\n        componentData: responsiveComponentData,\r\n    };\r\n};\r\n\r\n/**\r\n * Initialize responsive data cho elements chưa có\r\n */\r\nexport const initializeResponsiveData = (pageData) => {\r\n    return {\r\n        ...pageData,\r\n        elements: pageData.elements.map(element => {\r\n            // Nếu chưa có responsive data, tạo mới\r\n            if (!element.position?.mobile || !element.position?.tablet) {\r\n                return syncElementBetweenModes(element, 'desktop');\r\n            }\r\n            return element;\r\n        })\r\n    };\r\n};\r\n\r\n/**\r\n * Batch update khi user thay đổi nhiều elements\r\n */\r\nexport const batchSyncElements = (elements, changedMode) => {\r\n    return elements.map(element => syncElementBetweenModes(element, changedMode));\r\n};\r\n\r\nexport default {\r\n    getScaleFactor,\r\n    autoScaleSize,\r\n    autoScalePosition,\r\n    autoScaleStyles,\r\n    autoScaleComponentData,\r\n    syncElementBetweenModes,\r\n    syncAllElements,\r\n    getResponsiveValues,\r\n    initializeResponsiveData,\r\n    batchSyncElements\r\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}