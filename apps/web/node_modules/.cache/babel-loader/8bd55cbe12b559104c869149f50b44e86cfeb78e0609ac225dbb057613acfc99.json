{"ast":null,"code":"var _jsxFileName = \"F:\\\\landinghub-iconic\\\\apps\\\\web\\\\src\\\\components\\\\create-page\\\\Canvas.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { useRef, useCallback, useState, useEffect } from 'react';\nimport { useDrop, useDrag } from 'react-dnd';\nimport { useHotkeys } from 'react-hotkeys-hook';\nimport { toast } from 'react-toastify';\nimport Guidelines from './Guidelines';\nimport Rulers from './Rulers';\nimport SelectionOverlay from './SelectionOverlay';\nimport { throttle } from 'lodash';\nimport '../../styles/Canvas.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ItemTypes = {\n  ELEMENT: 'element',\n  EXISTING_ELEMENT: 'existingElement'\n};\n\n// Hàm tính tọa độ chính xác trên Canvas\nconst getCanvasPosition = (mouseX, mouseY, canvasRef, zoomLevel, scrollX = 0, scrollY = 0) => {\n  if (!canvasRef.current) {\n    console.error('Canvas ref is null in getCanvasPosition');\n    return {\n      x: 0,\n      y: 0\n    };\n  }\n  const canvasRect = canvasRef.current.getBoundingClientRect();\n  const scaleFactor = zoomLevel / 100;\n\n  // Tính toán vị trí chính xác với zoom và scroll\n  const x = (mouseX - canvasRect.left) / scaleFactor + scrollX / scaleFactor;\n  const y = (mouseY - canvasRect.top) / scaleFactor + scrollY / scaleFactor;\n  return {\n    x: Math.max(0, Math.round(x)),\n    y: Math.max(0, Math.round(y))\n  };\n};\n\n// Hàm snapping được cải thiện\nconst snapToGrid = (x, y, gridSize, snapPoints = [], canvasBounds, snapThreshold = 10) => {\n  let snappedX = gridSize > 0 ? Math.round(x / gridSize) * gridSize : x;\n  let snappedY = gridSize > 0 ? Math.round(y / gridSize) * gridSize : y;\n  let snapGuideLines = [];\n\n  // Snap to other elements\n  snapPoints.forEach(point => {\n    if (Math.abs(x - point.x) <= snapThreshold) {\n      snappedX = point.x;\n      snapGuideLines.push({\n        vertical: true,\n        position: point.x\n      });\n    }\n    if (Math.abs(y - point.y) <= snapThreshold) {\n      snappedY = point.y;\n      snapGuideLines.push({\n        vertical: false,\n        position: point.y\n      });\n    }\n  });\n\n  // Giới hạn trong canvas bounds\n  snappedX = Math.max(0, Math.min(snappedX, canvasBounds.width));\n  snappedY = Math.max(0, Math.min(snappedY, canvasBounds.height));\n  return {\n    x: snappedX,\n    y: snappedY,\n    snapGuideLines\n  };\n};\n\n// Hàm tính bounds của phần tử\nconst getElementBounds = element => {\n  var _element$position$des, _element$position$des2, _element$position$des3, _element$size, _element$position$des4, _element$size2, _element$position$des5, _element$size3, _element$position$des6, _element$size4;\n  return {\n    left: ((_element$position$des = element.position.desktop) === null || _element$position$des === void 0 ? void 0 : _element$position$des.x) || 0,\n    top: ((_element$position$des2 = element.position.desktop) === null || _element$position$des2 === void 0 ? void 0 : _element$position$des2.y) || 0,\n    right: (((_element$position$des3 = element.position.desktop) === null || _element$position$des3 === void 0 ? void 0 : _element$position$des3.x) || 0) + (((_element$size = element.size) === null || _element$size === void 0 ? void 0 : _element$size.width) || 200),\n    bottom: (((_element$position$des4 = element.position.desktop) === null || _element$position$des4 === void 0 ? void 0 : _element$position$des4.y) || 0) + (((_element$size2 = element.size) === null || _element$size2 === void 0 ? void 0 : _element$size2.height) || 50),\n    centerX: (((_element$position$des5 = element.position.desktop) === null || _element$position$des5 === void 0 ? void 0 : _element$position$des5.x) || 0) + (((_element$size3 = element.size) === null || _element$size3 === void 0 ? void 0 : _element$size3.width) || 200) / 2,\n    centerY: (((_element$position$des6 = element.position.desktop) === null || _element$position$des6 === void 0 ? void 0 : _element$position$des6.y) || 0) + (((_element$size4 = element.size) === null || _element$size4 === void 0 ? void 0 : _element$size4.height) || 50) / 2\n  };\n};\nconst Element = /*#__PURE__*/_s(/*#__PURE__*/React.memo(_c = _s(({\n  element,\n  isSelected,\n  onSelectElement,\n  onUpdatePosition,\n  viewMode,\n  zoomLevel,\n  gridSize,\n  onContextMenu,\n  canvasRef,\n  snapPoints,\n  canvasBounds,\n  onUpdateGuidelines\n}) => {\n  var _position$viewMode3, _position$viewMode4;\n  _s();\n  const {\n    id,\n    type,\n    componentData = {},\n    position = {},\n    size = {\n      width: 200,\n      height: 50\n    },\n    styles = {}\n  } = element;\n  const elementRef = useRef(null);\n  const [dragStartPos, setDragStartPos] = useState(null);\n  const [dragOffset, setDragOffset] = useState({\n    x: 0,\n    y: 0\n  });\n  const [isDraggingState, setIsDraggingState] = useState(false);\n  const [{\n    isDragging\n  }, drag] = useDrag(() => ({\n    type: ItemTypes.EXISTING_ELEMENT,\n    item: () => {\n      var _position$viewMode, _position$viewMode2;\n      if (!elementRef.current || !canvasRef.current) return {\n        id\n      };\n      const elementRect = elementRef.current.getBoundingClientRect();\n      const canvasRect = canvasRef.current.getBoundingClientRect();\n      const scaleFactor = zoomLevel / 100;\n      const offset = {\n        x: (elementRect.left - canvasRect.left) / scaleFactor - (((_position$viewMode = position[viewMode]) === null || _position$viewMode === void 0 ? void 0 : _position$viewMode.x) || 0),\n        y: (elementRect.top - canvasRect.top) / scaleFactor - (((_position$viewMode2 = position[viewMode]) === null || _position$viewMode2 === void 0 ? void 0 : _position$viewMode2.y) || 0)\n      };\n      setDragOffset(offset);\n      setDragStartPos(position[viewMode] || {\n        x: 0,\n        y: 0\n      });\n      setIsDraggingState(true);\n      return {\n        id,\n        offset,\n        elementId: id\n      };\n    },\n    end: (item, monitor) => {\n      setIsDraggingState(false);\n      const clientOffset = monitor.getClientOffset();\n      if (!clientOffset || !canvasRef.current) {\n        // Reset về vị trí ban đầu nếu drop không thành công\n        if (dragStartPos) {\n          onUpdatePosition(id, {\n            [viewMode]: dragStartPos\n          });\n        }\n        return;\n      }\n      const pos = getCanvasPosition(clientOffset.x, clientOffset.y, canvasRef, zoomLevel, canvasRef.current.scrollLeft, canvasRef.current.scrollTop);\n      const finalPos = {\n        x: pos.x - item.offset.x,\n        y: pos.y - item.offset.y\n      };\n      const snapped = snapToGrid(finalPos.x, finalPos.y, gridSize, snapPoints.filter(p => p.elementId !== id), canvasBounds);\n      onUpdatePosition(id, {\n        [viewMode]: snapped\n      }, true);\n      onUpdateGuidelines([]);\n    },\n    collect: monitor => ({\n      isDragging: !!monitor.isDragging()\n    })\n  }), [id, position, viewMode, zoomLevel, gridSize, snapPoints, canvasBounds, dragStartPos]);\n\n  // Xử lý di chuyển trong khi drag\n  useEffect(() => {\n    const handleDragMove = throttle(e => {\n      if (!isDragging || !canvasRef.current) return;\n      const pos = getCanvasPosition(e.clientX, e.clientY, canvasRef, zoomLevel, canvasRef.current.scrollLeft, canvasRef.current.scrollTop);\n      const newPos = {\n        x: pos.x - dragOffset.x,\n        y: pos.y - dragOffset.y\n      };\n      const snapped = snapToGrid(newPos.x, newPos.y, gridSize, snapPoints.filter(p => p.elementId !== id), canvasBounds);\n\n      // Cập nhật vị trí tạm thời\n      if (elementRef.current) {\n        elementRef.current.style.left = `${snapped.x}px`;\n        elementRef.current.style.top = `${snapped.y}px`;\n        elementRef.current.style.transform = 'translate(0, 0)';\n      }\n\n      // Cập nhật guidelines\n      onUpdateGuidelines(snapped.snapGuideLines || []);\n    }, 16); // 60fps\n\n    if (isDragging) {\n      document.addEventListener('mousemove', handleDragMove);\n      return () => {\n        document.removeEventListener('mousemove', handleDragMove);\n        handleDragMove.cancel();\n      };\n    }\n  }, [isDragging, dragOffset, zoomLevel, gridSize, snapPoints, canvasBounds, id, onUpdateGuidelines]);\n  const handleMouseDown = e => {\n    e.stopPropagation();\n    onSelectElement(id, e.ctrlKey || e.metaKey);\n  };\n  const handleContextMenu = e => {\n    e.preventDefault();\n    e.stopPropagation();\n    onContextMenu(id, {\n      x: e.clientX,\n      y: e.clientY\n    });\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    ref: node => {\n      elementRef.current = node;\n      drag(node);\n    },\n    className: `lpb-canvas-element ${isSelected ? 'lpb-canvas-element-selected' : ''} ${isDragging ? 'lpb-canvas-element-dragging' : ''}`,\n    style: {\n      position: 'absolute',\n      left: ((_position$viewMode3 = position[viewMode]) === null || _position$viewMode3 === void 0 ? void 0 : _position$viewMode3.x) || 0,\n      top: ((_position$viewMode4 = position[viewMode]) === null || _position$viewMode4 === void 0 ? void 0 : _position$viewMode4.y) || 0,\n      width: size.width,\n      height: size.height,\n      zIndex: position.z || (isDragging ? 1000 : 1),\n      cursor: isDragging ? 'grabbing' : isSelected ? 'move' : 'pointer',\n      opacity: isDragging ? 0.8 : 1,\n      transition: isDragging ? 'none' : 'all 0.2s ease',\n      boxShadow: isDragging ? '0 8px 24px rgba(0,0,0,0.3)' : isSelected ? '0 0 0 2px #2563eb' : 'none',\n      ...styles\n    },\n    onMouseDown: handleMouseDown,\n    onContextMenu: handleContextMenu,\n    children: (() => {\n      switch (type) {\n        case 'heading':\n          return /*#__PURE__*/_jsxDEV(\"h2\", {\n            style: {\n              fontSize: componentData.fontSize || '1.5rem',\n              color: componentData.color || '#1f2937',\n              margin: 0,\n              userSelect: 'none',\n              pointerEvents: 'none'\n            },\n            children: componentData.content || 'Tiêu đề'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 238,\n            columnNumber: 29\n          }, this);\n        case 'paragraph':\n          return /*#__PURE__*/_jsxDEV(\"p\", {\n            style: {\n              fontSize: componentData.fontSize || '1rem',\n              color: componentData.color || '#1f2937',\n              margin: 0,\n              userSelect: 'none',\n              pointerEvents: 'none'\n            },\n            children: componentData.content || 'Đoạn văn'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 250,\n            columnNumber: 29\n          }, this);\n        case 'button':\n          return /*#__PURE__*/_jsxDEV(\"button\", {\n            style: {\n              padding: '8px 16px',\n              borderRadius: '8px',\n              background: componentData.background || '#2563eb',\n              color: componentData.color || '#fff',\n              border: 'none',\n              cursor: 'pointer',\n              userSelect: 'none',\n              pointerEvents: 'none',\n              width: '100%',\n              height: '100%'\n            },\n            children: componentData.content || 'Nút'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 262,\n            columnNumber: 29\n          }, this);\n        case 'image':\n          return /*#__PURE__*/_jsxDEV(\"img\", {\n            src: componentData.src || 'https://via.placeholder.com/150',\n            alt: \"Image\",\n            style: {\n              width: '100%',\n              height: '100%',\n              objectFit: 'cover',\n              userSelect: 'none',\n              pointerEvents: 'none'\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 279,\n            columnNumber: 29\n          }, this);\n        case 'form':\n          return /*#__PURE__*/_jsxDEV(\"form\", {\n            style: {\n              display: 'flex',\n              flexDirection: 'column',\n              gap: '10px',\n              userSelect: 'none',\n              pointerEvents: 'none',\n              height: '100%'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"text\",\n              placeholder: \"Input\",\n              style: {\n                padding: '8px',\n                borderRadius: '8px',\n                border: '1px solid #ccc',\n                flex: 1\n              },\n              readOnly: true\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 301,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"button\",\n              style: {\n                background: '#2563eb',\n                color: '#fff',\n                padding: '8px 16px',\n                borderRadius: '8px',\n                border: 'none'\n              },\n              children: \"Submit\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 312,\n              columnNumber: 33\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 293,\n            columnNumber: 29\n          }, this);\n        default:\n          return /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              userSelect: 'none',\n              pointerEvents: 'none',\n              width: '100%',\n              height: '100%',\n              display: 'flex',\n              alignItems: 'center',\n              justifyContent: 'center'\n            },\n            children: componentData.content || 'Unknown'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 328,\n            columnNumber: 29\n          }, this);\n      }\n    })()\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 212,\n    columnNumber: 9\n  }, this);\n}, \"yvp0YPzgNqoi72/1M0VByuZlnuQ=\", false, function () {\n  return [useDrag];\n})), \"yvp0YPzgNqoi72/1M0VByuZlnuQ=\", false, function () {\n  return [useDrag];\n});\n_c2 = Element;\nconst Canvas = /*#__PURE__*/_s2(/*#__PURE__*/React.memo(_c3 = _s2(({\n  pageData,\n  selectedIds,\n  onSelectElement,\n  onUpdatePosition,\n  onUpdateSize,\n  onDeleteElement,\n  onAddElement,\n  onGroupElements,\n  viewMode,\n  zoomLevel,\n  gridSize,\n  showGrid\n}) => {\n  var _pageData$canvas, _pageData$canvas2, _pageData$canvas3, _pageData$elements2, _dragPreview$size, _dragPreview$size2, _pageData$elements3;\n  _s2();\n  const canvasRef = useRef(null);\n  const [guidelines, setGuidelines] = useState([]);\n  const [contextMenu, setContextMenu] = useState(null);\n  const [dragPreview, setDragPreview] = useState(null);\n  const canvasBounds = {\n    width: (pageData === null || pageData === void 0 ? void 0 : (_pageData$canvas = pageData.canvas) === null || _pageData$canvas === void 0 ? void 0 : _pageData$canvas.width) || 1200,\n    height: (pageData === null || pageData === void 0 ? void 0 : (_pageData$canvas2 = pageData.canvas) === null || _pageData$canvas2 === void 0 ? void 0 : _pageData$canvas2.height) || 1000\n  };\n\n  // Generate snap points từ tất cả elements\n  const snapPoints = React.useMemo(() => {\n    var _pageData$elements;\n    const points = (pageData === null || pageData === void 0 ? void 0 : (_pageData$elements = pageData.elements) === null || _pageData$elements === void 0 ? void 0 : _pageData$elements.flatMap(el => {\n      const bounds = getElementBounds(el);\n      return [{\n        x: bounds.left,\n        y: bounds.top,\n        elementId: el.id,\n        type: 'corner'\n      }, {\n        x: bounds.right,\n        y: bounds.bottom,\n        elementId: el.id,\n        type: 'corner'\n      }, {\n        x: bounds.centerX,\n        y: bounds.centerY,\n        elementId: el.id,\n        type: 'center'\n      }, {\n        x: bounds.left,\n        y: bounds.centerY,\n        elementId: el.id,\n        type: 'edge'\n      }, {\n        x: bounds.right,\n        y: bounds.centerY,\n        elementId: el.id,\n        type: 'edge'\n      }, {\n        x: bounds.centerX,\n        y: bounds.top,\n        elementId: el.id,\n        type: 'edge'\n      }, {\n        x: bounds.centerX,\n        y: bounds.bottom,\n        elementId: el.id,\n        type: 'edge'\n      }];\n    })) || [];\n\n    // Thêm canvas snap points\n    points.push({\n      x: 0,\n      y: 0,\n      type: 'canvas'\n    }, {\n      x: canvasBounds.width,\n      y: 0,\n      type: 'canvas'\n    }, {\n      x: 0,\n      y: canvasBounds.height,\n      type: 'canvas'\n    }, {\n      x: canvasBounds.width,\n      y: canvasBounds.height,\n      type: 'canvas'\n    }, {\n      x: canvasBounds.width / 2,\n      y: canvasBounds.height / 2,\n      type: 'canvas'\n    });\n    return points;\n  }, [pageData === null || pageData === void 0 ? void 0 : pageData.elements, canvasBounds]);\n  const [{\n    isOver\n  }, drop] = useDrop(() => ({\n    accept: [ItemTypes.ELEMENT, ItemTypes.EXISTING_ELEMENT],\n    hover: (item, monitor) => {\n      const clientOffset = monitor.getClientOffset();\n      if (!clientOffset || !canvasRef.current) return;\n      const pos = getCanvasPosition(clientOffset.x, clientOffset.y, canvasRef, zoomLevel, canvasRef.current.scrollLeft, canvasRef.current.scrollTop);\n      let targetPos = pos;\n\n      // Nếu là existing element, trừ đi offset\n      if (item.offset && item.elementId) {\n        targetPos = {\n          x: pos.x - item.offset.x,\n          y: pos.y - item.offset.y\n        };\n      }\n      const snapped = snapToGrid(targetPos.x, targetPos.y, showGrid ? gridSize : 0, snapPoints.filter(p => p.elementId !== item.elementId), canvasBounds);\n      setGuidelines(snapped.snapGuideLines || []);\n\n      // Show preview for new elements\n      if (item.json && !item.elementId) {\n        setDragPreview({\n          ...item.json,\n          position: snapped,\n          opacity: 0.5\n        });\n      }\n    },\n    drop: (item, monitor) => {\n      const clientOffset = monitor.getClientOffset();\n      if (!clientOffset || !canvasRef.current) {\n        toast.error('Không thể xác định vị trí thả!');\n        setDragPreview(null);\n        return;\n      }\n      const pos = getCanvasPosition(clientOffset.x, clientOffset.y, canvasRef, zoomLevel, canvasRef.current.scrollLeft, canvasRef.current.scrollTop);\n      let targetPos = pos;\n\n      // Nếu là existing element, trừ đi offset\n      if (item.offset && item.elementId) {\n        targetPos = {\n          x: pos.x - item.offset.x,\n          y: pos.y - item.offset.y\n        };\n      }\n      const snapped = snapToGrid(targetPos.x, targetPos.y, showGrid ? gridSize : 0, snapPoints.filter(p => p.elementId !== item.elementId), canvasBounds);\n      if (item.json && !item.elementId) {\n        // Thêm phần tử mới từ ComponentLibrary\n        const newElement = {\n          id: `${item.id}-${Date.now()}`,\n          type: item.json.type,\n          componentData: item.json.componentData || {},\n          position: {\n            [viewMode]: {\n              x: snapped.x,\n              y: snapped.y\n            },\n            desktop: {\n              x: snapped.x,\n              y: snapped.y\n            },\n            tablet: {\n              x: snapped.x,\n              y: snapped.y\n            },\n            mobile: {\n              x: snapped.x,\n              y: snapped.y\n            }\n          },\n          size: item.json.size || {\n            width: 200,\n            height: 50\n          },\n          styles: item.json.styles || {}\n        };\n        onAddElement(newElement);\n        toast.success('Đã thêm phần tử!');\n      }\n      setGuidelines([]);\n      setDragPreview(null);\n    },\n    collect: monitor => ({\n      isOver: !!monitor.isOver()\n    })\n  }), [viewMode, zoomLevel, gridSize, showGrid, snapPoints, canvasBounds, onAddElement]);\n  const handleCanvasClick = e => {\n    if (e.target === canvasRef.current) {\n      onSelectElement([]);\n      setContextMenu(null);\n    }\n  };\n  const handleContextMenu = (id, position) => {\n    setContextMenu({\n      id,\n      position\n    });\n  };\n  const handleUpdateGuidelines = useCallback(newGuidelines => {\n    setGuidelines(newGuidelines);\n  }, []);\n\n  // Keyboard navigation\n  const handleKeyDown = useCallback(e => {\n    if (!selectedIds.length) return;\n    const nudgeDistance = e.shiftKey ? 10 : 1;\n    switch (e.key) {\n      case 'ArrowUp':\n        e.preventDefault();\n        selectedIds.forEach(id => {\n          const element = pageData.elements.find(el => el.id === id);\n          if (element) {\n            const currentPos = element.position[viewMode] || {\n              x: 0,\n              y: 0\n            };\n            onUpdatePosition(id, {\n              [viewMode]: {\n                x: currentPos.x,\n                y: Math.max(0, currentPos.y - nudgeDistance)\n              }\n            }, true);\n          }\n        });\n        break;\n      case 'ArrowDown':\n        e.preventDefault();\n        selectedIds.forEach(id => {\n          const element = pageData.elements.find(el => el.id === id);\n          if (element) {\n            var _element$size5;\n            const currentPos = element.position[viewMode] || {\n              x: 0,\n              y: 0\n            };\n            onUpdatePosition(id, {\n              [viewMode]: {\n                x: currentPos.x,\n                y: Math.min(canvasBounds.height - (((_element$size5 = element.size) === null || _element$size5 === void 0 ? void 0 : _element$size5.height) || 50), currentPos.y + nudgeDistance)\n              }\n            }, true);\n          }\n        });\n        break;\n      case 'ArrowLeft':\n        e.preventDefault();\n        selectedIds.forEach(id => {\n          const element = pageData.elements.find(el => el.id === id);\n          if (element) {\n            const currentPos = element.position[viewMode] || {\n              x: 0,\n              y: 0\n            };\n            onUpdatePosition(id, {\n              [viewMode]: {\n                x: Math.max(0, currentPos.x - nudgeDistance),\n                y: currentPos.y\n              }\n            }, true);\n          }\n        });\n        break;\n      case 'ArrowRight':\n        e.preventDefault();\n        selectedIds.forEach(id => {\n          const element = pageData.elements.find(el => el.id === id);\n          if (element) {\n            var _element$size6;\n            const currentPos = element.position[viewMode] || {\n              x: 0,\n              y: 0\n            };\n            onUpdatePosition(id, {\n              [viewMode]: {\n                x: Math.min(canvasBounds.width - (((_element$size6 = element.size) === null || _element$size6 === void 0 ? void 0 : _element$size6.width) || 200), currentPos.x + nudgeDistance),\n                y: currentPos.y\n              }\n            }, true);\n          }\n        });\n        break;\n      case 'Delete':\n      case 'Backspace':\n        e.preventDefault();\n        selectedIds.forEach(id => onDeleteElement(id));\n        toast.success('Đã xóa phần tử!');\n        break;\n      case 'Escape':\n        e.preventDefault();\n        onSelectElement([]);\n        setContextMenu(null);\n        break;\n    }\n  }, [selectedIds, onUpdatePosition, onDeleteElement, onSelectElement, viewMode, pageData.elements, canvasBounds]);\n\n  // Hotkeys\n  useHotkeys('ctrl+a, cmd+a', e => {\n    e.preventDefault();\n    onSelectElement(pageData.elements.map(el => el.id));\n  }, [pageData.elements, onSelectElement]);\n  useHotkeys('ctrl+g, cmd+g', e => {\n    e.preventDefault();\n    if (selectedIds.length > 1) {\n      onGroupElements(selectedIds);\n    }\n  }, [selectedIds, onGroupElements]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"lpb-canvas-wrapper\",\n    onKeyDown: handleKeyDown,\n    tabIndex: 0,\n    style: {\n      outline: 'none',\n      height: '100%',\n      overflow: 'auto'\n    },\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      ref: node => {\n        canvasRef.current = node;\n        drop(node);\n      },\n      className: `lpb-canvas ${viewMode === 'mobile' ? 'lpb-canvas-mobile' : viewMode === 'tablet' ? 'lpb-canvas-tablet' : ''}`,\n      style: {\n        position: 'relative',\n        width: canvasBounds.width,\n        height: Math.max(canvasBounds.height, window.innerHeight),\n        background: (pageData === null || pageData === void 0 ? void 0 : (_pageData$canvas3 = pageData.canvas) === null || _pageData$canvas3 === void 0 ? void 0 : _pageData$canvas3.background) || '#ffffff',\n        transform: `scale(${zoomLevel / 100})`,\n        transformOrigin: 'top left',\n        cursor: isOver ? 'copy' : 'default',\n        overflow: 'visible'\n      },\n      onClick: handleCanvasClick,\n      children: [/*#__PURE__*/_jsxDEV(Rulers, {\n        canvasWidth: canvasBounds.width,\n        canvasHeight: canvasBounds.height,\n        zoomLevel: zoomLevel\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 641,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Guidelines, {\n        guidelines: guidelines,\n        zoomLevel: zoomLevel\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 647,\n        columnNumber: 17\n      }, this), showGrid && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"lpb-canvas-grid\",\n        style: {\n          position: 'absolute',\n          top: 0,\n          left: 0,\n          right: 0,\n          bottom: 0,\n          backgroundImage: `\n                                linear-gradient(to right, #e5e7eb 1px, transparent 1px),\n                                linear-gradient(to bottom, #e5e7eb 1px, transparent 1px)\n                            `,\n          backgroundSize: `${gridSize}px ${gridSize}px`,\n          pointerEvents: 'none',\n          opacity: 0.3\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 650,\n        columnNumber: 21\n      }, this), pageData === null || pageData === void 0 ? void 0 : (_pageData$elements2 = pageData.elements) === null || _pageData$elements2 === void 0 ? void 0 : _pageData$elements2.map(element => /*#__PURE__*/_jsxDEV(Element, {\n        element: element,\n        isSelected: selectedIds.includes(element.id),\n        onSelectElement: onSelectElement,\n        onUpdatePosition: onUpdatePosition,\n        viewMode: viewMode,\n        zoomLevel: zoomLevel,\n        gridSize: showGrid ? gridSize : 0,\n        onContextMenu: handleContextMenu,\n        canvasRef: canvasRef,\n        snapPoints: snapPoints,\n        canvasBounds: canvasBounds,\n        onUpdateGuidelines: handleUpdateGuidelines\n      }, element.id, false, {\n        fileName: _jsxFileName,\n        lineNumber: 671,\n        columnNumber: 21\n      }, this)), dragPreview && /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          position: 'absolute',\n          left: dragPreview.position.x,\n          top: dragPreview.position.y,\n          width: ((_dragPreview$size = dragPreview.size) === null || _dragPreview$size === void 0 ? void 0 : _dragPreview$size.width) || 200,\n          height: ((_dragPreview$size2 = dragPreview.size) === null || _dragPreview$size2 === void 0 ? void 0 : _dragPreview$size2.height) || 50,\n          opacity: 0.5,\n          border: '2px dashed #2563eb',\n          backgroundColor: 'rgba(37, 99, 235, 0.1)',\n          pointerEvents: 'none',\n          zIndex: 999\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 690,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(SelectionOverlay, {\n        selectedElements: (pageData === null || pageData === void 0 ? void 0 : (_pageData$elements3 = pageData.elements) === null || _pageData$elements3 === void 0 ? void 0 : _pageData$elements3.filter(el => selectedIds.includes(el.id))) || [],\n        onResize: onUpdateSize,\n        zoomLevel: zoomLevel,\n        viewMode: viewMode\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 706,\n        columnNumber: 17\n      }, this), contextMenu && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"lpb-context-menu\",\n        style: {\n          position: 'fixed',\n          left: contextMenu.position.x,\n          top: contextMenu.position.y,\n          background: 'white',\n          border: '1px solid #e5e7eb',\n          borderRadius: '8px',\n          boxShadow: '0 4px 16px rgba(0,0,0,0.15)',\n          zIndex: 10000,\n          minWidth: '150px'\n        },\n        onClick: e => e.stopPropagation(),\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"lpb-context-menu-item\",\n          style: {\n            padding: '12px 16px',\n            cursor: 'pointer',\n            borderBottom: '1px solid #f3f4f6',\n            fontSize: '14px',\n            transition: 'background-color 0.2s'\n          },\n          onMouseEnter: e => e.target.style.backgroundColor = '#f9fafb',\n          onMouseLeave: e => e.target.style.backgroundColor = 'transparent',\n          onClick: () => {\n            onDeleteElement(contextMenu.id);\n            setContextMenu(null);\n          },\n          children: \"\\uD83D\\uDDD1\\uFE0F Delete\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 730,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"lpb-context-menu-item\",\n          style: {\n            padding: '12px 16px',\n            cursor: 'pointer',\n            fontSize: '14px',\n            transition: 'background-color 0.2s'\n          },\n          onMouseEnter: e => e.target.style.backgroundColor = '#f9fafb',\n          onMouseLeave: e => e.target.style.backgroundColor = 'transparent',\n          onClick: () => {\n            const element = pageData.elements.find(el => el.id === contextMenu.id);\n            if (element) {\n              var _element$position$vie, _element$position$vie2;\n              const newElement = {\n                ...element,\n                id: `${element.id}-copy-${Date.now()}`,\n                position: {\n                  ...element.position,\n                  [viewMode]: {\n                    x: (((_element$position$vie = element.position[viewMode]) === null || _element$position$vie === void 0 ? void 0 : _element$position$vie.x) || 0) + 20,\n                    y: (((_element$position$vie2 = element.position[viewMode]) === null || _element$position$vie2 === void 0 ? void 0 : _element$position$vie2.y) || 0) + 20\n                  }\n                }\n              };\n              onAddElement(newElement);\n              toast.success('Đã sao chép phần tử!');\n            }\n            setContextMenu(null);\n          },\n          children: \"\\uD83D\\uDCCB Duplicate\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 748,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 715,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 620,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 614,\n    columnNumber: 9\n  }, this);\n}, \"2iyTt5tfwPc+Z1lsVD+r7fqrYC0=\", false, function () {\n  return [useDrop, useHotkeys, useHotkeys];\n})), \"2iyTt5tfwPc+Z1lsVD+r7fqrYC0=\", false, function () {\n  return [useDrop, useHotkeys, useHotkeys];\n});\n_c4 = Canvas;\nexport default Canvas;\nvar _c, _c2, _c3, _c4;\n$RefreshReg$(_c, \"Element$React.memo\");\n$RefreshReg$(_c2, \"Element\");\n$RefreshReg$(_c3, \"Canvas$React.memo\");\n$RefreshReg$(_c4, \"Canvas\");","map":{"version":3,"names":["React","useRef","useCallback","useState","useEffect","useDrop","useDrag","useHotkeys","toast","Guidelines","Rulers","SelectionOverlay","throttle","jsxDEV","_jsxDEV","ItemTypes","ELEMENT","EXISTING_ELEMENT","getCanvasPosition","mouseX","mouseY","canvasRef","zoomLevel","scrollX","scrollY","current","console","error","x","y","canvasRect","getBoundingClientRect","scaleFactor","left","top","Math","max","round","snapToGrid","gridSize","snapPoints","canvasBounds","snapThreshold","snappedX","snappedY","snapGuideLines","forEach","point","abs","push","vertical","position","min","width","height","getElementBounds","element","_element$position$des","_element$position$des2","_element$position$des3","_element$size","_element$position$des4","_element$size2","_element$position$des5","_element$size3","_element$position$des6","_element$size4","desktop","right","size","bottom","centerX","centerY","Element","_s","memo","_c","isSelected","onSelectElement","onUpdatePosition","viewMode","onContextMenu","onUpdateGuidelines","_position$viewMode3","_position$viewMode4","id","type","componentData","styles","elementRef","dragStartPos","setDragStartPos","dragOffset","setDragOffset","isDraggingState","setIsDraggingState","isDragging","drag","item","_position$viewMode","_position$viewMode2","elementRect","offset","elementId","end","monitor","clientOffset","getClientOffset","pos","scrollLeft","scrollTop","finalPos","snapped","filter","p","collect","handleDragMove","e","clientX","clientY","newPos","style","transform","document","addEventListener","removeEventListener","cancel","handleMouseDown","stopPropagation","ctrlKey","metaKey","handleContextMenu","preventDefault","ref","node","className","zIndex","z","cursor","opacity","transition","boxShadow","onMouseDown","children","fontSize","color","margin","userSelect","pointerEvents","content","fileName","_jsxFileName","lineNumber","columnNumber","padding","borderRadius","background","border","src","alt","objectFit","display","flexDirection","gap","placeholder","flex","readOnly","alignItems","justifyContent","_c2","Canvas","_s2","_c3","pageData","selectedIds","onUpdateSize","onDeleteElement","onAddElement","onGroupElements","showGrid","_pageData$canvas","_pageData$canvas2","_pageData$canvas3","_pageData$elements2","_dragPreview$size","_dragPreview$size2","_pageData$elements3","guidelines","setGuidelines","contextMenu","setContextMenu","dragPreview","setDragPreview","canvas","useMemo","_pageData$elements","points","elements","flatMap","el","bounds","isOver","drop","accept","hover","targetPos","json","newElement","Date","now","tablet","mobile","success","handleCanvasClick","target","handleUpdateGuidelines","newGuidelines","handleKeyDown","length","nudgeDistance","shiftKey","key","find","currentPos","_element$size5","_element$size6","map","onKeyDown","tabIndex","outline","overflow","window","innerHeight","transformOrigin","onClick","canvasWidth","canvasHeight","backgroundImage","backgroundSize","includes","backgroundColor","selectedElements","onResize","minWidth","borderBottom","onMouseEnter","onMouseLeave","_element$position$vie","_element$position$vie2","_c4","$RefreshReg$"],"sources":["F:/landinghub-iconic/apps/web/src/components/create-page/Canvas.js"],"sourcesContent":["import React, { useRef, useCallback, useState, useEffect } from 'react';\r\nimport { useDrop, useDrag } from 'react-dnd';\r\nimport { useHotkeys } from 'react-hotkeys-hook';\r\nimport { toast } from 'react-toastify';\r\nimport Guidelines from './Guidelines';\r\nimport Rulers from './Rulers';\r\nimport SelectionOverlay from './SelectionOverlay';\r\nimport { throttle } from 'lodash';\r\nimport '../../styles/Canvas.css';\r\n\r\nconst ItemTypes = {\r\n    ELEMENT: 'element',\r\n    EXISTING_ELEMENT: 'existingElement',\r\n};\r\n\r\n// Hàm tính tọa độ chính xác trên Canvas\r\nconst getCanvasPosition = (mouseX, mouseY, canvasRef, zoomLevel, scrollX = 0, scrollY = 0) => {\r\n    if (!canvasRef.current) {\r\n        console.error('Canvas ref is null in getCanvasPosition');\r\n        return { x: 0, y: 0 };\r\n    }\r\n    const canvasRect = canvasRef.current.getBoundingClientRect();\r\n    const scaleFactor = zoomLevel / 100;\r\n\r\n    // Tính toán vị trí chính xác với zoom và scroll\r\n    const x = (mouseX - canvasRect.left) / scaleFactor + scrollX / scaleFactor;\r\n    const y = (mouseY - canvasRect.top) / scaleFactor + scrollY / scaleFactor;\r\n\r\n    return {\r\n        x: Math.max(0, Math.round(x)),\r\n        y: Math.max(0, Math.round(y))\r\n    };\r\n};\r\n\r\n// Hàm snapping được cải thiện\r\nconst snapToGrid = (x, y, gridSize, snapPoints = [], canvasBounds, snapThreshold = 10) => {\r\n    let snappedX = gridSize > 0 ? Math.round(x / gridSize) * gridSize : x;\r\n    let snappedY = gridSize > 0 ? Math.round(y / gridSize) * gridSize : y;\r\n\r\n    let snapGuideLines = [];\r\n\r\n    // Snap to other elements\r\n    snapPoints.forEach((point) => {\r\n        if (Math.abs(x - point.x) <= snapThreshold) {\r\n            snappedX = point.x;\r\n            snapGuideLines.push({ vertical: true, position: point.x });\r\n        }\r\n        if (Math.abs(y - point.y) <= snapThreshold) {\r\n            snappedY = point.y;\r\n            snapGuideLines.push({ vertical: false, position: point.y });\r\n        }\r\n    });\r\n\r\n    // Giới hạn trong canvas bounds\r\n    snappedX = Math.max(0, Math.min(snappedX, canvasBounds.width));\r\n    snappedY = Math.max(0, Math.min(snappedY, canvasBounds.height));\r\n\r\n    return { x: snappedX, y: snappedY, snapGuideLines };\r\n};\r\n\r\n// Hàm tính bounds của phần tử\r\nconst getElementBounds = (element) => ({\r\n    left: element.position.desktop?.x || 0,\r\n    top: element.position.desktop?.y || 0,\r\n    right: (element.position.desktop?.x || 0) + (element.size?.width || 200),\r\n    bottom: (element.position.desktop?.y || 0) + (element.size?.height || 50),\r\n    centerX: (element.position.desktop?.x || 0) + (element.size?.width || 200) / 2,\r\n    centerY: (element.position.desktop?.y || 0) + (element.size?.height || 50) / 2,\r\n});\r\n\r\nconst Element = React.memo(({\r\n                                element,\r\n                                isSelected,\r\n                                onSelectElement,\r\n                                onUpdatePosition,\r\n                                viewMode,\r\n                                zoomLevel,\r\n                                gridSize,\r\n                                onContextMenu,\r\n                                canvasRef,\r\n                                snapPoints,\r\n                                canvasBounds,\r\n                                onUpdateGuidelines\r\n                            }) => {\r\n    const { id, type, componentData = {}, position = {}, size = { width: 200, height: 50 }, styles = {} } = element;\r\n    const elementRef = useRef(null);\r\n    const [dragStartPos, setDragStartPos] = useState(null);\r\n    const [dragOffset, setDragOffset] = useState({ x: 0, y: 0 });\r\n    const [isDraggingState, setIsDraggingState] = useState(false);\r\n\r\n    const [{ isDragging }, drag] = useDrag(() => ({\r\n        type: ItemTypes.EXISTING_ELEMENT,\r\n        item: () => {\r\n            if (!elementRef.current || !canvasRef.current) return { id };\r\n\r\n            const elementRect = elementRef.current.getBoundingClientRect();\r\n            const canvasRect = canvasRef.current.getBoundingClientRect();\r\n            const scaleFactor = zoomLevel / 100;\r\n\r\n            const offset = {\r\n                x: (elementRect.left - canvasRect.left) / scaleFactor - (position[viewMode]?.x || 0),\r\n                y: (elementRect.top - canvasRect.top) / scaleFactor - (position[viewMode]?.y || 0),\r\n            };\r\n\r\n            setDragOffset(offset);\r\n            setDragStartPos(position[viewMode] || { x: 0, y: 0 });\r\n            setIsDraggingState(true);\r\n\r\n            return { id, offset, elementId: id };\r\n        },\r\n        end: (item, monitor) => {\r\n            setIsDraggingState(false);\r\n            const clientOffset = monitor.getClientOffset();\r\n\r\n            if (!clientOffset || !canvasRef.current) {\r\n                // Reset về vị trí ban đầu nếu drop không thành công\r\n                if (dragStartPos) {\r\n                    onUpdatePosition(id, { [viewMode]: dragStartPos });\r\n                }\r\n                return;\r\n            }\r\n\r\n            const pos = getCanvasPosition(\r\n                clientOffset.x,\r\n                clientOffset.y,\r\n                canvasRef,\r\n                zoomLevel,\r\n                canvasRef.current.scrollLeft,\r\n                canvasRef.current.scrollTop\r\n            );\r\n\r\n            const finalPos = {\r\n                x: pos.x - item.offset.x,\r\n                y: pos.y - item.offset.y\r\n            };\r\n\r\n            const snapped = snapToGrid(\r\n                finalPos.x,\r\n                finalPos.y,\r\n                gridSize,\r\n                snapPoints.filter(p => p.elementId !== id),\r\n                canvasBounds\r\n            );\r\n\r\n            onUpdatePosition(id, { [viewMode]: snapped }, true);\r\n            onUpdateGuidelines([]);\r\n        },\r\n        collect: (monitor) => ({\r\n            isDragging: !!monitor.isDragging(),\r\n        }),\r\n    }), [id, position, viewMode, zoomLevel, gridSize, snapPoints, canvasBounds, dragStartPos]);\r\n\r\n    // Xử lý di chuyển trong khi drag\r\n    useEffect(() => {\r\n        const handleDragMove = throttle((e) => {\r\n            if (!isDragging || !canvasRef.current) return;\r\n\r\n            const pos = getCanvasPosition(\r\n                e.clientX,\r\n                e.clientY,\r\n                canvasRef,\r\n                zoomLevel,\r\n                canvasRef.current.scrollLeft,\r\n                canvasRef.current.scrollTop\r\n            );\r\n\r\n            const newPos = {\r\n                x: pos.x - dragOffset.x,\r\n                y: pos.y - dragOffset.y\r\n            };\r\n\r\n            const snapped = snapToGrid(\r\n                newPos.x,\r\n                newPos.y,\r\n                gridSize,\r\n                snapPoints.filter(p => p.elementId !== id),\r\n                canvasBounds\r\n            );\r\n\r\n            // Cập nhật vị trí tạm thời\r\n            if (elementRef.current) {\r\n                elementRef.current.style.left = `${snapped.x}px`;\r\n                elementRef.current.style.top = `${snapped.y}px`;\r\n                elementRef.current.style.transform = 'translate(0, 0)';\r\n            }\r\n\r\n            // Cập nhật guidelines\r\n            onUpdateGuidelines(snapped.snapGuideLines || []);\r\n        }, 16); // 60fps\r\n\r\n        if (isDragging) {\r\n            document.addEventListener('mousemove', handleDragMove);\r\n            return () => {\r\n                document.removeEventListener('mousemove', handleDragMove);\r\n                handleDragMove.cancel();\r\n            };\r\n        }\r\n    }, [isDragging, dragOffset, zoomLevel, gridSize, snapPoints, canvasBounds, id, onUpdateGuidelines]);\r\n\r\n    const handleMouseDown = (e) => {\r\n        e.stopPropagation();\r\n        onSelectElement(id, e.ctrlKey || e.metaKey);\r\n    };\r\n\r\n    const handleContextMenu = (e) => {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        onContextMenu(id, { x: e.clientX, y: e.clientY });\r\n    };\r\n\r\n    return (\r\n        <div\r\n            ref={(node) => {\r\n                elementRef.current = node;\r\n                drag(node);\r\n            }}\r\n            className={`lpb-canvas-element ${isSelected ? 'lpb-canvas-element-selected' : ''} ${isDragging ? 'lpb-canvas-element-dragging' : ''}`}\r\n            style={{\r\n                position: 'absolute',\r\n                left: position[viewMode]?.x || 0,\r\n                top: position[viewMode]?.y || 0,\r\n                width: size.width,\r\n                height: size.height,\r\n                zIndex: position.z || (isDragging ? 1000 : 1),\r\n                cursor: isDragging ? 'grabbing' : isSelected ? 'move' : 'pointer',\r\n                opacity: isDragging ? 0.8 : 1,\r\n                transition: isDragging ? 'none' : 'all 0.2s ease',\r\n                boxShadow: isDragging ? '0 8px 24px rgba(0,0,0,0.3)' : isSelected ? '0 0 0 2px #2563eb' : 'none',\r\n                ...styles,\r\n            }}\r\n            onMouseDown={handleMouseDown}\r\n            onContextMenu={handleContextMenu}\r\n        >\r\n            {(() => {\r\n                switch (type) {\r\n                    case 'heading':\r\n                        return (\r\n                            <h2 style={{\r\n                                fontSize: componentData.fontSize || '1.5rem',\r\n                                color: componentData.color || '#1f2937',\r\n                                margin: 0,\r\n                                userSelect: 'none',\r\n                                pointerEvents: 'none'\r\n                            }}>\r\n                                {componentData.content || 'Tiêu đề'}\r\n                            </h2>\r\n                        );\r\n                    case 'paragraph':\r\n                        return (\r\n                            <p style={{\r\n                                fontSize: componentData.fontSize || '1rem',\r\n                                color: componentData.color || '#1f2937',\r\n                                margin: 0,\r\n                                userSelect: 'none',\r\n                                pointerEvents: 'none'\r\n                            }}>\r\n                                {componentData.content || 'Đoạn văn'}\r\n                            </p>\r\n                        );\r\n                    case 'button':\r\n                        return (\r\n                            <button style={{\r\n                                padding: '8px 16px',\r\n                                borderRadius: '8px',\r\n                                background: componentData.background || '#2563eb',\r\n                                color: componentData.color || '#fff',\r\n                                border: 'none',\r\n                                cursor: 'pointer',\r\n                                userSelect: 'none',\r\n                                pointerEvents: 'none',\r\n                                width: '100%',\r\n                                height: '100%'\r\n                            }}>\r\n                                {componentData.content || 'Nút'}\r\n                            </button>\r\n                        );\r\n                    case 'image':\r\n                        return (\r\n                            <img\r\n                                src={componentData.src || 'https://via.placeholder.com/150'}\r\n                                alt=\"Image\"\r\n                                style={{\r\n                                    width: '100%',\r\n                                    height: '100%',\r\n                                    objectFit: 'cover',\r\n                                    userSelect: 'none',\r\n                                    pointerEvents: 'none'\r\n                                }}\r\n                            />\r\n                        );\r\n                    case 'form':\r\n                        return (\r\n                            <form style={{\r\n                                display: 'flex',\r\n                                flexDirection: 'column',\r\n                                gap: '10px',\r\n                                userSelect: 'none',\r\n                                pointerEvents: 'none',\r\n                                height: '100%'\r\n                            }}>\r\n                                <input\r\n                                    type=\"text\"\r\n                                    placeholder=\"Input\"\r\n                                    style={{\r\n                                        padding: '8px',\r\n                                        borderRadius: '8px',\r\n                                        border: '1px solid #ccc',\r\n                                        flex: 1\r\n                                    }}\r\n                                    readOnly\r\n                                />\r\n                                <button\r\n                                    type=\"button\"\r\n                                    style={{\r\n                                        background: '#2563eb',\r\n                                        color: '#fff',\r\n                                        padding: '8px 16px',\r\n                                        borderRadius: '8px',\r\n                                        border: 'none'\r\n                                    }}\r\n                                >\r\n                                    Submit\r\n                                </button>\r\n                            </form>\r\n                        );\r\n                    default:\r\n                        return (\r\n                            <div style={{\r\n                                userSelect: 'none',\r\n                                pointerEvents: 'none',\r\n                                width: '100%',\r\n                                height: '100%',\r\n                                display: 'flex',\r\n                                alignItems: 'center',\r\n                                justifyContent: 'center'\r\n                            }}>\r\n                                {componentData.content || 'Unknown'}\r\n                            </div>\r\n                        );\r\n                }\r\n            })()}\r\n        </div>\r\n    );\r\n});\r\n\r\nconst Canvas = React.memo(({\r\n                               pageData,\r\n                               selectedIds,\r\n                               onSelectElement,\r\n                               onUpdatePosition,\r\n                               onUpdateSize,\r\n                               onDeleteElement,\r\n                               onAddElement,\r\n                               onGroupElements,\r\n                               viewMode,\r\n                               zoomLevel,\r\n                               gridSize,\r\n                               showGrid,\r\n                           }) => {\r\n    const canvasRef = useRef(null);\r\n    const [guidelines, setGuidelines] = useState([]);\r\n    const [contextMenu, setContextMenu] = useState(null);\r\n    const [dragPreview, setDragPreview] = useState(null);\r\n\r\n    const canvasBounds = {\r\n        width: pageData?.canvas?.width || 1200,\r\n        height: pageData?.canvas?.height || 1000,\r\n    };\r\n\r\n    // Generate snap points từ tất cả elements\r\n    const snapPoints = React.useMemo(() => {\r\n        const points = pageData?.elements?.flatMap((el) => {\r\n            const bounds = getElementBounds(el);\r\n            return [\r\n                { x: bounds.left, y: bounds.top, elementId: el.id, type: 'corner' },\r\n                { x: bounds.right, y: bounds.bottom, elementId: el.id, type: 'corner' },\r\n                { x: bounds.centerX, y: bounds.centerY, elementId: el.id, type: 'center' },\r\n                { x: bounds.left, y: bounds.centerY, elementId: el.id, type: 'edge' },\r\n                { x: bounds.right, y: bounds.centerY, elementId: el.id, type: 'edge' },\r\n                { x: bounds.centerX, y: bounds.top, elementId: el.id, type: 'edge' },\r\n                { x: bounds.centerX, y: bounds.bottom, elementId: el.id, type: 'edge' },\r\n            ];\r\n        }) || [];\r\n\r\n        // Thêm canvas snap points\r\n        points.push(\r\n            { x: 0, y: 0, type: 'canvas' },\r\n            { x: canvasBounds.width, y: 0, type: 'canvas' },\r\n            { x: 0, y: canvasBounds.height, type: 'canvas' },\r\n            { x: canvasBounds.width, y: canvasBounds.height, type: 'canvas' },\r\n            { x: canvasBounds.width / 2, y: canvasBounds.height / 2, type: 'canvas' }\r\n        );\r\n\r\n        return points;\r\n    }, [pageData?.elements, canvasBounds]);\r\n\r\n    const [{ isOver }, drop] = useDrop(() => ({\r\n        accept: [ItemTypes.ELEMENT, ItemTypes.EXISTING_ELEMENT],\r\n        hover: (item, monitor) => {\r\n            const clientOffset = monitor.getClientOffset();\r\n            if (!clientOffset || !canvasRef.current) return;\r\n\r\n            const pos = getCanvasPosition(\r\n                clientOffset.x,\r\n                clientOffset.y,\r\n                canvasRef,\r\n                zoomLevel,\r\n                canvasRef.current.scrollLeft,\r\n                canvasRef.current.scrollTop\r\n            );\r\n\r\n            let targetPos = pos;\r\n\r\n            // Nếu là existing element, trừ đi offset\r\n            if (item.offset && item.elementId) {\r\n                targetPos = {\r\n                    x: pos.x - item.offset.x,\r\n                    y: pos.y - item.offset.y\r\n                };\r\n            }\r\n\r\n            const snapped = snapToGrid(\r\n                targetPos.x,\r\n                targetPos.y,\r\n                showGrid ? gridSize : 0,\r\n                snapPoints.filter(p => p.elementId !== item.elementId),\r\n                canvasBounds\r\n            );\r\n\r\n            setGuidelines(snapped.snapGuideLines || []);\r\n\r\n            // Show preview for new elements\r\n            if (item.json && !item.elementId) {\r\n                setDragPreview({\r\n                    ...item.json,\r\n                    position: snapped,\r\n                    opacity: 0.5\r\n                });\r\n            }\r\n        },\r\n        drop: (item, monitor) => {\r\n            const clientOffset = monitor.getClientOffset();\r\n            if (!clientOffset || !canvasRef.current) {\r\n                toast.error('Không thể xác định vị trí thả!');\r\n                setDragPreview(null);\r\n                return;\r\n            }\r\n\r\n            const pos = getCanvasPosition(\r\n                clientOffset.x,\r\n                clientOffset.y,\r\n                canvasRef,\r\n                zoomLevel,\r\n                canvasRef.current.scrollLeft,\r\n                canvasRef.current.scrollTop\r\n            );\r\n\r\n            let targetPos = pos;\r\n\r\n            // Nếu là existing element, trừ đi offset\r\n            if (item.offset && item.elementId) {\r\n                targetPos = {\r\n                    x: pos.x - item.offset.x,\r\n                    y: pos.y - item.offset.y\r\n                };\r\n            }\r\n\r\n            const snapped = snapToGrid(\r\n                targetPos.x,\r\n                targetPos.y,\r\n                showGrid ? gridSize : 0,\r\n                snapPoints.filter(p => p.elementId !== item.elementId),\r\n                canvasBounds\r\n            );\r\n\r\n            if (item.json && !item.elementId) {\r\n                // Thêm phần tử mới từ ComponentLibrary\r\n                const newElement = {\r\n                    id: `${item.id}-${Date.now()}`,\r\n                    type: item.json.type,\r\n                    componentData: item.json.componentData || {},\r\n                    position: {\r\n                        [viewMode]: { x: snapped.x, y: snapped.y },\r\n                        desktop: { x: snapped.x, y: snapped.y },\r\n                        tablet: { x: snapped.x, y: snapped.y },\r\n                        mobile: { x: snapped.x, y: snapped.y }\r\n                    },\r\n                    size: item.json.size || { width: 200, height: 50 },\r\n                    styles: item.json.styles || {},\r\n                };\r\n\r\n                onAddElement(newElement);\r\n                toast.success('Đã thêm phần tử!');\r\n            }\r\n\r\n            setGuidelines([]);\r\n            setDragPreview(null);\r\n        },\r\n        collect: (monitor) => ({\r\n            isOver: !!monitor.isOver(),\r\n        }),\r\n    }), [viewMode, zoomLevel, gridSize, showGrid, snapPoints, canvasBounds, onAddElement]);\r\n\r\n    const handleCanvasClick = (e) => {\r\n        if (e.target === canvasRef.current) {\r\n            onSelectElement([]);\r\n            setContextMenu(null);\r\n        }\r\n    };\r\n\r\n    const handleContextMenu = (id, position) => {\r\n        setContextMenu({ id, position });\r\n    };\r\n\r\n    const handleUpdateGuidelines = useCallback((newGuidelines) => {\r\n        setGuidelines(newGuidelines);\r\n    }, []);\r\n\r\n    // Keyboard navigation\r\n    const handleKeyDown = useCallback((e) => {\r\n        if (!selectedIds.length) return;\r\n\r\n        const nudgeDistance = e.shiftKey ? 10 : 1;\r\n\r\n        switch (e.key) {\r\n            case 'ArrowUp':\r\n                e.preventDefault();\r\n                selectedIds.forEach((id) => {\r\n                    const element = pageData.elements.find((el) => el.id === id);\r\n                    if (element) {\r\n                        const currentPos = element.position[viewMode] || { x: 0, y: 0 };\r\n                        onUpdatePosition(id, {\r\n                            [viewMode]: {\r\n                                x: currentPos.x,\r\n                                y: Math.max(0, currentPos.y - nudgeDistance)\r\n                            }\r\n                        }, true);\r\n                    }\r\n                });\r\n                break;\r\n            case 'ArrowDown':\r\n                e.preventDefault();\r\n                selectedIds.forEach((id) => {\r\n                    const element = pageData.elements.find((el) => el.id === id);\r\n                    if (element) {\r\n                        const currentPos = element.position[viewMode] || { x: 0, y: 0 };\r\n                        onUpdatePosition(id, {\r\n                            [viewMode]: {\r\n                                x: currentPos.x,\r\n                                y: Math.min(canvasBounds.height - (element.size?.height || 50), currentPos.y + nudgeDistance)\r\n                            }\r\n                        }, true);\r\n                    }\r\n                });\r\n                break;\r\n            case 'ArrowLeft':\r\n                e.preventDefault();\r\n                selectedIds.forEach((id) => {\r\n                    const element = pageData.elements.find((el) => el.id === id);\r\n                    if (element) {\r\n                        const currentPos = element.position[viewMode] || { x: 0, y: 0 };\r\n                        onUpdatePosition(id, {\r\n                            [viewMode]: {\r\n                                x: Math.max(0, currentPos.x - nudgeDistance),\r\n                                y: currentPos.y\r\n                            }\r\n                        }, true);\r\n                    }\r\n                });\r\n                break;\r\n            case 'ArrowRight':\r\n                e.preventDefault();\r\n                selectedIds.forEach((id) => {\r\n                    const element = pageData.elements.find((el) => el.id === id);\r\n                    if (element) {\r\n                        const currentPos = element.position[viewMode] || { x: 0, y: 0 };\r\n                        onUpdatePosition(id, {\r\n                            [viewMode]: {\r\n                                x: Math.min(canvasBounds.width - (element.size?.width || 200), currentPos.x + nudgeDistance),\r\n                                y: currentPos.y\r\n                            }\r\n                        }, true);\r\n                    }\r\n                });\r\n                break;\r\n            case 'Delete':\r\n            case 'Backspace':\r\n                e.preventDefault();\r\n                selectedIds.forEach((id) => onDeleteElement(id));\r\n                toast.success('Đã xóa phần tử!');\r\n                break;\r\n            case 'Escape':\r\n                e.preventDefault();\r\n                onSelectElement([]);\r\n                setContextMenu(null);\r\n                break;\r\n        }\r\n    }, [selectedIds, onUpdatePosition, onDeleteElement, onSelectElement, viewMode, pageData.elements, canvasBounds]);\r\n\r\n    // Hotkeys\r\n    useHotkeys('ctrl+a, cmd+a', (e) => {\r\n        e.preventDefault();\r\n        onSelectElement(pageData.elements.map((el) => el.id));\r\n    }, [pageData.elements, onSelectElement]);\r\n\r\n    useHotkeys('ctrl+g, cmd+g', (e) => {\r\n        e.preventDefault();\r\n        if (selectedIds.length > 1) {\r\n            onGroupElements(selectedIds);\r\n        }\r\n    }, [selectedIds, onGroupElements]);\r\n\r\n    return (\r\n        <div\r\n            className=\"lpb-canvas-wrapper\"\r\n            onKeyDown={handleKeyDown}\r\n            tabIndex={0}\r\n            style={{ outline: 'none', height: '100%', overflow: 'auto' }}\r\n        >\r\n            <div\r\n                ref={(node) => {\r\n                    canvasRef.current = node;\r\n                    drop(node);\r\n                }}\r\n                className={`lpb-canvas ${\r\n                    viewMode === 'mobile' ? 'lpb-canvas-mobile' :\r\n                        viewMode === 'tablet' ? 'lpb-canvas-tablet' : ''\r\n                }`}\r\n                style={{\r\n                    position: 'relative',\r\n                    width: canvasBounds.width,\r\n                    height: Math.max(canvasBounds.height, window.innerHeight),\r\n                    background: pageData?.canvas?.background || '#ffffff',\r\n                    transform: `scale(${zoomLevel / 100})`,\r\n                    transformOrigin: 'top left',\r\n                    cursor: isOver ? 'copy' : 'default',\r\n                    overflow: 'visible'\r\n                }}\r\n                onClick={handleCanvasClick}\r\n            >\r\n                <Rulers\r\n                    canvasWidth={canvasBounds.width}\r\n                    canvasHeight={canvasBounds.height}\r\n                    zoomLevel={zoomLevel}\r\n                />\r\n\r\n                <Guidelines guidelines={guidelines} zoomLevel={zoomLevel} />\r\n\r\n                {showGrid && (\r\n                    <div\r\n                        className=\"lpb-canvas-grid\"\r\n                        style={{\r\n                            position: 'absolute',\r\n                            top: 0,\r\n                            left: 0,\r\n                            right: 0,\r\n                            bottom: 0,\r\n                            backgroundImage: `\r\n                                linear-gradient(to right, #e5e7eb 1px, transparent 1px),\r\n                                linear-gradient(to bottom, #e5e7eb 1px, transparent 1px)\r\n                            `,\r\n                            backgroundSize: `${gridSize}px ${gridSize}px`,\r\n                            pointerEvents: 'none',\r\n                            opacity: 0.3,\r\n                        }}\r\n                    />\r\n                )}\r\n\r\n                {/* Render elements */}\r\n                {pageData?.elements?.map((element) => (\r\n                    <Element\r\n                        key={element.id}\r\n                        element={element}\r\n                        isSelected={selectedIds.includes(element.id)}\r\n                        onSelectElement={onSelectElement}\r\n                        onUpdatePosition={onUpdatePosition}\r\n                        viewMode={viewMode}\r\n                        zoomLevel={zoomLevel}\r\n                        gridSize={showGrid ? gridSize : 0}\r\n                        onContextMenu={handleContextMenu}\r\n                        canvasRef={canvasRef}\r\n                        snapPoints={snapPoints}\r\n                        canvasBounds={canvasBounds}\r\n                        onUpdateGuidelines={handleUpdateGuidelines}\r\n                    />\r\n                ))}\r\n\r\n                {/* Drag preview for new elements */}\r\n                {dragPreview && (\r\n                    <div\r\n                        style={{\r\n                            position: 'absolute',\r\n                            left: dragPreview.position.x,\r\n                            top: dragPreview.position.y,\r\n                            width: dragPreview.size?.width || 200,\r\n                            height: dragPreview.size?.height || 50,\r\n                            opacity: 0.5,\r\n                            border: '2px dashed #2563eb',\r\n                            backgroundColor: 'rgba(37, 99, 235, 0.1)',\r\n                            pointerEvents: 'none',\r\n                            zIndex: 999\r\n                        }}\r\n                    />\r\n                )}\r\n\r\n                <SelectionOverlay\r\n                    selectedElements={pageData?.elements?.filter((el) => selectedIds.includes(el.id)) || []}\r\n                    onResize={onUpdateSize}\r\n                    zoomLevel={zoomLevel}\r\n                    viewMode={viewMode}\r\n                />\r\n\r\n                {/* Context Menu */}\r\n                {contextMenu && (\r\n                    <div\r\n                        className=\"lpb-context-menu\"\r\n                        style={{\r\n                            position: 'fixed',\r\n                            left: contextMenu.position.x,\r\n                            top: contextMenu.position.y,\r\n                            background: 'white',\r\n                            border: '1px solid #e5e7eb',\r\n                            borderRadius: '8px',\r\n                            boxShadow: '0 4px 16px rgba(0,0,0,0.15)',\r\n                            zIndex: 10000,\r\n                            minWidth: '150px'\r\n                        }}\r\n                        onClick={(e) => e.stopPropagation()}\r\n                    >\r\n                        <div\r\n                            className=\"lpb-context-menu-item\"\r\n                            style={{\r\n                                padding: '12px 16px',\r\n                                cursor: 'pointer',\r\n                                borderBottom: '1px solid #f3f4f6',\r\n                                fontSize: '14px',\r\n                                transition: 'background-color 0.2s'\r\n                            }}\r\n                            onMouseEnter={(e) => e.target.style.backgroundColor = '#f9fafb'}\r\n                            onMouseLeave={(e) => e.target.style.backgroundColor = 'transparent'}\r\n                            onClick={() => {\r\n                                onDeleteElement(contextMenu.id);\r\n                                setContextMenu(null);\r\n                            }}\r\n                        >\r\n                            🗑️ Delete\r\n                        </div>\r\n                        <div\r\n                            className=\"lpb-context-menu-item\"\r\n                            style={{\r\n                                padding: '12px 16px',\r\n                                cursor: 'pointer',\r\n                                fontSize: '14px',\r\n                                transition: 'background-color 0.2s'\r\n                            }}\r\n                            onMouseEnter={(e) => e.target.style.backgroundColor = '#f9fafb'}\r\n                            onMouseLeave={(e) => e.target.style.backgroundColor = 'transparent'}\r\n                            onClick={() => {\r\n                                const element = pageData.elements.find(el => el.id === contextMenu.id);\r\n                                if (element) {\r\n                                    const newElement = {\r\n                                        ...element,\r\n                                        id: `${element.id}-copy-${Date.now()}`,\r\n                                        position: {\r\n                                            ...element.position,\r\n                                            [viewMode]: {\r\n                                                x: (element.position[viewMode]?.x || 0) + 20,\r\n                                                y: (element.position[viewMode]?.y || 0) + 20\r\n                                            }\r\n                                        }\r\n                                    };\r\n                                    onAddElement(newElement);\r\n                                    toast.success('Đã sao chép phần tử!');\r\n                                }\r\n                                setContextMenu(null);\r\n                            }}\r\n                        >\r\n                            📋 Duplicate\r\n                        </div>\r\n                    </div>\r\n                )}\r\n            </div>\r\n        </div>\r\n    );\r\n});\r\n\r\nexport default Canvas;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}