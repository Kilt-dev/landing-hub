{"ast":null,"code":"// // ==================== EVENT RUNTIME GENERATOR ====================\n//\n// /**\n//  * Generate runtime script ƒë·ªÉ x·ª≠ l√Ω events trong HTML tƒ©nh\n//  * @param {Array} events - Danh s√°ch events t·ª´ pageData\n//  * @param {Array} popups - Danh s√°ch popup elements\n//  * @returns {string} - JavaScript code\n//  */\n// const generateEventRuntime = (events, popups) => {\n//     return `\n//     // Landing Page Builder Runtime v1.0\n//     (function() {\n//         'use strict';\n//\n//         window.LPB = window.LPB || {};\n//\n//         // ========== POPUP MANAGER ==========\n//         LPB.popups = {\n//             active: new Set(),\n//\n//             open: function(popupId, data) {\n//                 const popup = document.getElementById(popupId);\n//                 if (!popup) {\n//                     console.error('[LPB] Popup not found:', popupId);\n//                     return;\n//                 }\n//\n//                 // Update content n·∫øu c√≥ data\n//                 if (data && data.html) {\n//                     const content = popup.querySelector('.lpb-popup-body');\n//                     if (content) content.innerHTML = data.html;\n//                 }\n//\n//                 // Show popup\n//                 popup.classList.add('lpb-popup-active');\n//                 document.body.style.overflow = 'hidden';\n//                 this.active.add(popupId);\n//\n//                 // Analytics tracking\n//                 if (window.gtag) {\n//                     gtag('event', 'popup_open', {\n//                         event_category: 'Engagement',\n//                         event_label: popupId\n//                     });\n//                 }\n//             },\n//\n//             close: function(popupId) {\n//                 const popup = document.getElementById(popupId);\n//                 if (popup) {\n//                     popup.classList.remove('lpb-popup-active');\n//                     this.active.delete(popupId);\n//\n//                     // Restore scroll n·∫øu kh√¥ng c√≤n popup n√†o\n//                     if (this.active.size === 0) {\n//                         document.body.style.overflow = '';\n//                     }\n//                 }\n//             },\n//\n//             closeAll: function() {\n//                 this.active.forEach(id => this.close(id));\n//             }\n//         };\n//\n//         // ========== API MANAGER ==========\n//         LPB.api = {\n//             cache: new Map(),\n//\n//             getCacheKey: function(endpoint, params) {\n//                 return endpoint + JSON.stringify(params || {});\n//             },\n//\n//             fetch: async function(endpoint, options = {}) {\n//                 const cacheKey = this.getCacheKey(endpoint, options.params);\n//\n//                 // Check cache\n//                 if (this.cache.has(cacheKey)) {\n//                     const cached = this.cache.get(cacheKey);\n//                     const now = Date.now();\n//                     const TTL = options.ttl || 5 * 60 * 1000; // 5 ph√∫t default\n//\n//                     if (now - cached.timestamp < TTL) {\n//                         console.log('[LPB] Cache hit:', endpoint);\n//                         return cached.data;\n//                     }\n//                 }\n//\n//                 // Fetch m·ªõi\n//                 try {\n//                     console.log('[LPB] Fetching:', endpoint);\n//                     const response = await fetch(endpoint, {\n//                         method: options.method || 'GET',\n//                         headers: {\n//                             'Content-Type': 'application/json',\n//                             ...options.headers\n//                         },\n//                         body: options.data ? JSON.stringify(options.data) : undefined\n//                     });\n//\n//                     if (!response.ok) {\n//                         throw new Error(\\`HTTP \\${response.status}: \\${response.statusText}\\`);\n//                     }\n//\n//                     const data = await response.json();\n//\n//                     // Cache result\n//                     this.cache.set(cacheKey, {\n//                         data: data,\n//                         timestamp: Date.now()\n//                     });\n//\n//                     return data;\n//                 } catch (error) {\n//                     console.error('[LPB] API Error:', error);\n//                     throw error;\n//                 }\n//             },\n//\n//             clearCache: function(endpoint) {\n//                 if (endpoint) {\n//                     for (let key of this.cache.keys()) {\n//                         if (key.startsWith(endpoint)) {\n//                             this.cache.delete(key);\n//                         }\n//                     }\n//                 } else {\n//                     this.cache.clear();\n//                 }\n//             }\n//         };\n//\n//         // ========== EVENT HANDLER ==========\n//         LPB.handleEvent = async function(config) {\n//             const { type } = config;\n//\n//             try {\n//                 switch(type) {\n//                     case 'openPopup':\n//                         if (!config.popupId) {\n//                             console.error('[LPB] Missing popupId');\n//                             return;\n//                         }\n//                         this.popups.open(config.popupId, config.data);\n//                         break;\n//\n//                     case 'closePopup':\n//                         const targetPopupId = config.popupId || config.elementId;\n//                         if (!targetPopupId) {\n//                             console.error('[LPB] Missing popupId');\n//                             return;\n//                         }\n//                         this.popups.close(targetPopupId);\n//                         break;\n//\n//                     case 'triggerApi':\n//                         if (!config.apiUrl) {\n//                             console.error('[LPB] Missing apiUrl');\n//                             return;\n//                         }\n//                         const data = await this.api.fetch(config.apiUrl, {\n//                             method: config.method || 'GET',\n//                             params: config.params,\n//                             data: config.data\n//                         });\n//\n//                         // Update target n·∫øu c√≥\n//                         if (config.updateTarget) {\n//                             const target = document.getElementById(config.updateTarget);\n//                             if (target && data.html) {\n//                                 target.innerHTML = data.html;\n//                             }\n//                         }\n//                         break;\n//\n//                     case 'both':\n//                         // Open popup immediately v·ªõi loading\n//                         this.popups.open(config.popupId, {\n//                             html: '<div style=\"text-align:center;padding:40px;\"><div class=\"lpb-spinner\"></div><p>ƒêang t·∫£i...</p></div>'\n//                         });\n//\n//                         // Fetch API in background\n//                         const apiData = await this.api.fetch(config.apiUrl, {\n//                             method: config.method || 'GET',\n//                             params: config.params\n//                         });\n//\n//                         // Update popup content\n//                         this.popups.open(config.popupId, { html: apiData.html || JSON.stringify(apiData) });\n//                         break;\n//\n//                     case 'navigate':\n//                         if (!config.url) {\n//                             console.error('[LPB] Missing url');\n//                             return;\n//                         }\n//                         if (config.newTab) {\n//                             window.open(config.url, '_blank');\n//                         } else {\n//                             window.location.href = config.url;\n//                         }\n//                         break;\n//\n//                     case 'scrollToSection':\n//                         if (!config.sectionId) {\n//                             console.error('[LPB] Missing sectionId');\n//                             return;\n//                         }\n//                         const section = document.querySelector(\\`[data-element-id=\"\\${config.sectionId}\"]\\`);\n//                         if (section) {\n//                             section.scrollIntoView({\n//                                 behavior: config.smooth !== false ? 'smooth' : 'auto',\n//                                 block: 'start'\n//                             });\n//                         } else {\n//                             console.error('[LPB] Section not found:', config.sectionId);\n//                         }\n//                         break;\n//\n//                     case 'submitForm':\n//                         if (!config.apiUrl) {\n//                             console.error('[LPB] Missing apiUrl');\n//                             return;\n//                         }\n//                         console.log('[LPB] Form submit to:', config.apiUrl);\n//                         break;\n//\n//                     default:\n//                         console.warn('[LPB] Unknown event type:', type);\n//                 }\n//             } catch (error) {\n//                 console.error('[LPB] Event handling error:', error);\n//                 alert('C√≥ l·ªói x·∫£y ra: ' + error.message);\n//             }\n//         };\n//\n//         // ========== AUTO-BIND EVENTS ==========\n//         const eventsConfig = ${JSON.stringify(events)};\n//\n//         document.addEventListener('DOMContentLoaded', function() {\n//             console.log('[LPB] Initializing events...', eventsConfig.length);\n//\n//             eventsConfig.forEach(config => {\n//                 const element = document.getElementById(config.elementId);\n//                 if (!element) {\n//                     console.warn('[LPB] Element not found:', config.elementId);\n//                     return;\n//                 }\n//\n//                 // Bind onClick\n//                 if (config.events.onClick && config.events.onClick.type !== 'none') {\n//                     element.addEventListener('click', function(e) {\n//                         e.preventDefault();\n//                         e.stopPropagation();\n//                         LPB.handleEvent(config.events.onClick);\n//                     });\n//\n//                     element.style.cursor = 'pointer';\n//                 }\n//\n//                 // Bind hover prefetch\n//                 if (config.events.onClick?.params?.apiConfig?.preload) {\n//                     element.addEventListener('mouseenter', function() {\n//                         LPB.api.fetch(\n//                             config.events.onClick.params.apiConfig.endpoint,\n//                             config.events.onClick.params.apiConfig\n//                         ).catch(() => {}); // Silent prefetch\n//                     }, { once: true });\n//                 }\n//\n//                 // Bind onHover effects\n//                 if (config.events.onHover) {\n//                     const hoverClass = config.events.onHover.className;\n//                     if (hoverClass) {\n//                         element.addEventListener('mouseenter', function() {\n//                             this.classList.add(hoverClass);\n//                         });\n//                         element.addEventListener('mouseleave', function() {\n//                             this.classList.remove(hoverClass);\n//                         });\n//                     }\n//                 }\n//             });\n//\n//             console.log('[LPB] Events initialized!');\n//         });\n//\n//         // ========== ESC TO CLOSE POPUP ==========\n//         document.addEventListener('keydown', function(e) {\n//             if (e.key === 'Escape') {\n//                 LPB.popups.closeAll();\n//             }\n//         });\n//\n//         console.log('[LPB] Runtime loaded');\n//     })();\n//     `;\n// };\n//\n// /**\n//  * Extract t·∫•t c·∫£ events t·ª´ pageData elements\n//  * @param {Object} pageData - Page data object\n//  * @returns {Array} - Array of event configs\n//  */\n// const extractEvents = (pageData) => {\n//     const events = [];\n//\n//     const processElement = (element, parentId = null) => {\n//         const elementId = element.id;\n//\n//         // Check element events\n//         if (element.componentData?.events) {\n//             events.push({\n//                 elementId: elementId,\n//                 events: element.componentData.events,\n//                 type: element.type,\n//                 parentId: parentId\n//             });\n//         }\n//\n//         // Check children events\n//         if (Array.isArray(element.children)) {\n//             element.children.forEach(child => {\n//                 if (child.componentData?.events) {\n//                     events.push({\n//                         elementId: child.id,\n//                         events: child.componentData.events,\n//                         type: child.type,\n//                         parentId: elementId\n//                     });\n//                 }\n//\n//                 // Recursive cho nested children\n//                 if (Array.isArray(child.children)) {\n//                     processElement(child, child.id);\n//                 }\n//             });\n//         }\n//     };\n//\n//     pageData.elements.forEach(element => {\n//         processElement(element);\n//     });\n//\n//     return events;\n// };\n//\n// /**\n//  * Render t·∫•t c·∫£ popups th√†nh HTML\n//  * @param {Array} popups - Array of popup elements\n//  * @returns {string} - HTML string\n//  */\n// const renderPopupsHTML = (popups) => {\n//     return popups.map(popup => {\n//         const { id, componentData = {}, styles = {}, size = {}, children = [] } = popup;\n//\n//         // Render children content\n//         const childrenHTML = children.map(child =>\n//             renderElementHTML(child, true)\n//         ).join('');\n//\n//         return `\n//             <div\n//                 id=\"${id}\"\n//                 class=\"lpb-popup\"\n//                 data-element-id=\"${id}\"\n//                 style=\"display:none;\"\n//             >\n//                 <!-- Overlay -->\n//                 <div\n//                     class=\"lpb-popup-overlay\"\n//                     onclick=\"LPB.popups.close('${id}')\"\n//                 ></div>\n//\n//                 <!-- Popup Container -->\n//                 <div\n//                     class=\"lpb-popup-container\"\n//                     style=\"\n//                         width: ${size.width || 600}px;\n//                         max-width: 90vw;\n//                         min-height: ${size.height || 400}px;\n//                         background: ${styles.background || componentData.background || 'rgba(255, 255, 255, 0.95)'};\n//                         border-radius: ${styles.borderRadius || componentData.borderRadius || '12px'};\n//                         box-shadow: 0 8px 32px rgba(0, 0, 0, 0.25);\n//                     \"\n//                 >\n//                     <!-- Header -->\n//                     <div class=\"lpb-popup-header\">\n//                         <h3 style=\"margin:0; font-size:16px; font-weight:600; color:#111827;\">\n//                             ${componentData.title || 'Popup Title'}\n//                         </h3>\n//                         <button\n//                             class=\"lpb-popup-close\"\n//                             onclick=\"LPB.popups.close('${id}')\"\n//                             aria-label=\"Close popup\"\n//                         >\n//                             ‚úï\n//                         </button>\n//                     </div>\n//\n//                     <!-- Body -->\n//                     <div class=\"lpb-popup-body\" style=\"padding: ${componentData.padding || '20px'};\">\n//                         ${childrenHTML || `<p style=\"color:#6b7280;\">${componentData.content || 'Popup content'}</p>`}\n//                     </div>\n//                 </div>\n//             </div>\n//         `;\n//     }).join('\\n');\n// };\n//\n// /**\n//  * Render m·ªôt element th√†nh HTML v·ªõi proper ID\n//  * @param {Object} element - Element object\n//  * @param {boolean} isChild - Whether this is a child element\n//  * @returns {string} - HTML string\n//  */\n// const renderElementHTML = (element, isChild = false) => {\n//     const { id, type, componentData = {}, styles = {}, size = {}, position = {}, children = [] } = element;\n//\n//     // Convert styles object to inline CSS\n//     const inlineStyles = Object.entries(styles)\n//         .filter(([key]) => !key.startsWith(':') && !key.startsWith('@'))\n//         .map(([key, value]) => {\n//             const kebabKey = key.replace(/[A-Z]/g, m => `-${m.toLowerCase()}`);\n//             return `${kebabKey}:${value}`;\n//         })\n//         .join(';');\n//\n//     // Base attributes\n//     const baseAttrs = `\n//         id=\"${id}\"\n//         data-element-id=\"${id}\"\n//         data-type=\"${type}\"\n//         class=\"lpb-element lpb-${type}\"\n//     `;\n//\n//     // Position styles cho child elements\n//     const positionStyles = isChild ? `\n//         position: absolute;\n//         left: ${position.desktop?.x || 0}px;\n//         top: ${position.desktop?.y || 0}px;\n//         width: ${size.width || 200}px;\n//         height: ${size.height || 50}px;\n//     ` : '';\n//\n//     // Render based on type\n//     switch(type) {\n//         case 'section':\n//             return renderSectionHTML(element);\n//\n//         case 'button':\n//             return `\n//                 <button\n//                     ${baseAttrs}\n//                     style=\"${inlineStyles}; ${positionStyles}\"\n//                 >\n//                     ${componentData.content || 'Button'}\n//                 </button>\n//             `;\n//\n//         case 'heading':\n//             const HeadingTag = componentData.level || 'h2';\n//             return `\n//                 <${HeadingTag}\n//                     ${baseAttrs}\n//                     style=\"${inlineStyles}; ${positionStyles}\"\n//                 >\n//                     ${componentData.content || 'Heading'}\n//                 </${HeadingTag}>\n//             `;\n//\n//         case 'paragraph':\n//             return `\n//                 <p\n//                     ${baseAttrs}\n//                     style=\"${inlineStyles}; ${positionStyles}\"\n//                 >\n//                     ${componentData.content || 'Paragraph'}\n//                 </p>\n//             `;\n//\n//         case 'image':\n//             return `\n//                 <img\n//                     ${baseAttrs}\n//                     src=\"${componentData.src || componentData.imageUrl || 'https://via.placeholder.com/150'}\"\n//                     alt=\"${componentData.alt || 'Image'}\"\n//                     style=\"${inlineStyles}; ${positionStyles}\"\n//                 />\n//             `;\n//\n//         case 'icon':\n//             const isSvg = componentData.icon?.startsWith('<svg');\n//             return `\n//                 <div\n//                     ${baseAttrs}\n//                     style=\"${inlineStyles}; ${positionStyles}\"\n//                     title=\"${componentData.title || ''}\"\n//                 >\n//                     ${componentData.imageUrl\n//                 ? `<img src=\"${componentData.imageUrl}\" alt=\"${componentData.title || 'Icon'}\" style=\"width:100%;height:100%;object-fit:contain;\" />`\n//                 : isSvg\n//                     ? componentData.icon\n//                     : componentData.icon\n//                         ? `<i class=\"${componentData.icon}\"></i>`\n//                         : 'üì¶'\n//             }\n//                 </div>\n//             `;\n//\n//         case 'gallery':\n//             return renderGalleryHTML(element, isChild);\n//\n//         default:\n//             return `\n//                 <div\n//                     ${baseAttrs}\n//                     style=\"${inlineStyles}; ${positionStyles}\"\n//                 >\n//                     ${componentData.content || type}\n//                 </div>\n//             `;\n//     }\n// };\n//\n// /**\n//  * Render gallery element\n//  */\n// const renderGalleryHTML = (element, isChild) => {\n//     const { id, componentData = {}, styles = {}, size = {}, position = {} } = element;\n//\n//     const positionStyles = isChild ? `\n//         position: absolute;\n//         left: ${position.desktop?.x || 0}px;\n//         top: ${position.desktop?.y || 0}px;\n//     ` : '';\n//\n//     const images = componentData.images || [];\n//\n//     return `\n//         <div\n//             id=\"${id}\"\n//             data-element-id=\"${id}\"\n//             data-type=\"gallery\"\n//             class=\"lpb-element lpb-gallery\"\n//             style=\"${positionStyles} width: ${size.width || 380}px; height: ${size.height || 300}px;\"\n//         >\n//             <div style=\"\n//                 display: ${styles.display || 'grid'};\n//                 grid-template-columns: ${styles.gridTemplateColumns || 'repeat(auto-fill, minmax(150px, 1fr))'};\n//                 gap: ${styles.gap || '10px'};\n//                 width: 100%;\n//                 height: 100%;\n//             \">\n//                 ${images.map((imageUrl, index) => `\n//                     <div style=\"\n//                         position: relative;\n//                         overflow: hidden;\n//                         border-radius: ${styles.borderRadius || '8px'};\n//                         aspect-ratio: 1 / 1;\n//                     \">\n//                         <img\n//                             src=\"${imageUrl || 'https://via.placeholder.com/150'}\"\n//                             alt=\"Gallery ${index + 1}\"\n//                             style=\"\n//                                 width: 100%;\n//                                 height: 100%;\n//                                 object-fit: ${styles.objectFit || 'cover'};\n//                                 object-position: ${styles.objectPosition || 'center'};\n//                             \"\n//                             loading=\"lazy\"\n//                         />\n//                     </div>\n//                 `).join('')}\n//                 ${images.length === 0 ? `\n//                     <div style=\"\n//                         display: flex;\n//                         flex-direction: column;\n//                         align-items: center;\n//                         justify-content: center;\n//                         color: #9ca3af;\n//                         text-align: center;\n//                         grid-column: 1 / -1;\n//                     \">\n//                         <i class=\"fas fa-image\" style=\"font-size: 48px; margin-bottom: 8px;\"></i>\n//                         <p>Empty gallery</p>\n//                     </div>\n//                 ` : ''}\n//             </div>\n//         </div>\n//     `;\n// };\n//\n// /**\n//  * Render section v·ªõi children\n//  */\n// const renderSectionHTML = (section) => {\n//     const { id, componentData = {}, styles = {}, size = {}, position = {}, children = [] } = section;\n//\n//     // Render children\n//     const childrenHTML = children.map(child =>\n//         renderElementHTML(child, true)\n//     ).join('\\n');\n//\n//     return `\n//         <section\n//             id=\"${id}\"\n//             data-element-id=\"${id}\"\n//             class=\"lpb-section ladi-section\"\n//             style=\"\n//                 position: absolute;\n//                 top: ${position.desktop?.y || 0}px;\n//                 left: 50%;\n//                 transform: translateX(-50%);\n//                 width: 1200px;\n//                 height: ${size.height || 400}px;\n//             \"\n//         >\n//             <!-- Background -->\n//             <div class=\"ladi-section-background\" style=\"\n//                 position: absolute;\n//                 inset: 0;\n//                 z-index: 0;\n//                 background-color: ${componentData.backgroundColor || styles.backgroundColor || 'transparent'};\n//                 background-image: ${componentData.backgroundImage ? `url(${componentData.backgroundImage})` : 'none'};\n//                 background-size: cover;\n//                 background-position: center;\n//             \"></div>\n//\n//             <!-- Overlay -->\n//             <div class=\"ladi-overlay\" style=\"\n//                 position: absolute;\n//                 inset: 0;\n//                 z-index: 0;\n//                 background-color: ${componentData.overlayColor || 'transparent'};\n//                 opacity: ${componentData.overlayOpacity || 0};\n//             \"></div>\n//\n//             <!-- Container -->\n//             <div class=\"ladi-container\" style=\"\n//                 position: relative;\n//                 z-index: 1;\n//                 padding: ${componentData.padding || styles.padding || '20px'};\n//                 width: 100%;\n//                 height: 100%;\n//             \">\n//                 ${childrenHTML}\n//             </div>\n//         </section>\n//     `;\n// };\n//\n// /**\n//  * Generate CSS t·ª´ pageData\n//  */\n// const generateCSS = (pageData) => {\n//     let css = `\n//         * {\n//             box-sizing: border-box;\n//         }\n//\n//         body {\n//             margin: 0;\n//             padding: 0;\n//         }\n//\n//         .lpb-element {\n//             transition: all 0.3s ease;\n//         }\n//     `;\n//\n//     // Extract pseudo-classes v√† animations t·ª´ elements\n//     pageData.elements.forEach(element => {\n//         const { id, styles = {} } = element;\n//\n//         // Process hover states\n//         if (styles[':hover']) {\n//             css += `\\n#${id}:hover {`;\n//             Object.entries(styles[':hover']).forEach(([key, value]) => {\n//                 const kebabKey = key.replace(/[A-Z]/g, m => `-${m.toLowerCase()}`);\n//                 css += `${kebabKey}:${value};`;\n//             });\n//             css += `}`;\n//         }\n//\n//         // Process keyframes\n//         Object.entries(styles).forEach(([key, value]) => {\n//             if (key.startsWith('@keyframes')) {\n//                 css += `\\n${key} {`;\n//                 Object.entries(value).forEach(([frame, props]) => {\n//                     css += `${frame} {`;\n//                     Object.entries(props).forEach(([prop, val]) => {\n//                         const kebabProp = prop.replace(/[A-Z]/g, m => `-${m.toLowerCase()}`);\n//                         css += `${kebabProp}:${val};`;\n//                     });\n//                     css += `}`;\n//                 });\n//                 css += `}`;\n//             }\n//         });\n//\n//         // Process children\n//         if (element.children) {\n//             element.children.forEach(child => {\n//                 if (child.styles?.[':hover']) {\n//                     css += `\\n#${child.id}:hover {`;\n//                     Object.entries(child.styles[':hover']).forEach(([key, value]) => {\n//                         const kebabKey = key.replace(/[A-Z]/g, m => `-${m.toLowerCase()}`);\n//                         css += `${kebabKey}:${value};`;\n//                     });\n//                     css += `}`;\n//                 }\n//             });\n//         }\n//     });\n//\n//     return css;\n// };\n//\n// /**\n//  * Render to√†n b·ªô pageData th√†nh static HTML v·ªõi embedded runtime\n//  * @param {Object} pageData - Page data\n//  * @returns {string} - Complete HTML document\n//  */\n// export const renderStaticHTML = (pageData) => {\n//     // Extract components\n//     const popups = pageData.elements.filter(el => el.type === 'popup');\n//     const sections = pageData.elements.filter(el => el.type === 'section');\n//     const events = extractEvents(pageData);\n//\n//     // Generate HTML parts\n//     const sectionsHTML = sections.map(section => renderSectionHTML(section)).join('\\n');\n//     const popupsHTML = renderPopupsHTML(popups);\n//     const runtimeScript = generateEventRuntime(events, popups);\n//\n//     // Generate CSS\n//     const cssContent = generateCSS(pageData);\n//\n//     // Combine everything\n//     return `<!DOCTYPE html>\n// <html lang=\"vi\">\n// <head>\n//     <meta charset=\"UTF-8\">\n//     <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n//     <meta name=\"description\" content=\"${pageData.meta?.description || 'Landing page generated by LandingHub'}\">\n//     <title>${pageData.meta?.title || 'Landing Page'}</title>\n//\n//     <!-- Font Awesome -->\n//     <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css\" crossorigin=\"anonymous\" referrerpolicy=\"no-referrer\" />\n//\n//     <!-- Styles -->\n//     <style>\n//         ${cssContent}\n//\n//         /* Popup Styles */\n//         .lpb-popup {\n//             position: fixed;\n//             inset: 0;\n//             z-index: 9999;\n//             display: none;\n//             align-items: center;\n//             justify-content: center;\n//         }\n//\n//         .lpb-popup.lpb-popup-active {\n//             display: flex;\n//         }\n//\n//         .lpb-popup-overlay {\n//             position: absolute;\n//             inset: 0;\n//             background: rgba(0, 0, 0, 0.5);\n//             cursor: pointer;\n//         }\n//\n//         .lpb-popup-container {\n//             position: relative;\n//             z-index: 1;\n//             background: white;\n//             border-radius: 12px;\n//             max-height: 90vh;\n//             overflow-y: auto;\n//             box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);\n//         }\n//\n//         .lpb-popup-header {\n//             display: flex;\n//             justify-content: space-between;\n//             align-items: center;\n//             padding: 16px 20px;\n//             border-bottom: 1px solid #e5e7eb;\n//             background: linear-gradient(to bottom, #f9fafb, #ffffff);\n//         }\n//\n//         .lpb-popup-close {\n//             width: 28px;\n//             height: 28px;\n//             border: none;\n//             background: transparent;\n//             cursor: pointer;\n//             border-radius: 6px;\n//             display: flex;\n//             align-items: center;\n//             justify-content: center;\n//             transition: all 0.15s ease;\n//             color: #6b7280;\n//             font-size: 18px;\n//             font-weight: bold;\n//         }\n//\n//         .lpb-popup-close:hover {\n//             background: #f3f4f6;\n//             color: #111827;\n//         }\n//\n//         .lpb-popup-body {\n//             padding: 20px;\n//         }\n//\n//         /* Loading Spinner */\n//         .lpb-spinner {\n//             border: 3px solid #f3f3f3;\n//             border-top: 3px solid #3b82f6;\n//             border-radius: 50%;\n//             width: 40px;\n//             height: 40px;\n//             animation: spin 1s linear infinite;\n//             margin: 0 auto;\n//         }\n//\n//         @keyframes spin {\n//             0% { transform: rotate(0deg); }\n//             100% { transform: rotate(360deg); }\n//         }\n//\n//         /* Responsive */\n//         @media (max-width: 768px) {\n//             .lpb-section {\n//                 width: 100% !important;\n//             }\n//\n//             .lpb-popup-container {\n//                 width: 90% !important;\n//                 max-width: 90vw !important;\n//             }\n//         }\n//     </style>\n// </head>\n// <body style=\"margin: 0; padding: 0; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\">\n//     <!-- Canvas -->\n//     <div id=\"lpb-canvas\" style=\"\n//         position: relative;\n//         min-height: 100vh;\n//         background: ${pageData.canvas?.background || '#ffffff'};\n//     \">\n//         ${sectionsHTML}\n//     </div>\n//\n//     <!-- Popups -->\n//     ${popupsHTML}\n//\n//     <!-- Runtime Script -->\n//     <script>\n//         ${runtimeScript}\n//     </script>\n//\n//     <!-- Google Analytics (optional) -->\n//     ${pageData.analytics?.googleAnalyticsId ? `\n//     <script async src=\"https://www.googletagmanager.com/gtag/js?id=${pageData.analytics.googleAnalyticsId}\"></script>\n//     <script>\n//         window.dataLayer = window.dataLayer || [];\n//         function gtag(){dataLayer.push(arguments);}\n//         gtag('js', new Date());\n//         gtag('config', '${pageData.analytics.googleAnalyticsId}');\n//     </script>\n//     ` : ''}\n// </body>\n// </html>`;\n// };\n//\n// /**\n//  * Parse HTML string th√†nh pageData structure\n//  */\n// export const parseHTMLToPageData = (htmlString) => {\n//     const parser = new DOMParser();\n//     const doc = parser.parseFromString(htmlString, 'text/html');\n//\n//     const pageData = {\n//         canvas: {\n//             width: 1200,\n//             height: 'auto',\n//             background: '#ffffff'\n//         },\n//         elements: [],\n//         meta: {}\n//     };\n//\n//     try {\n//         // Parse canvas\n//         const canvasEl = doc.getElementById('lpb-canvas');\n//         if (canvasEl) {\n//             pageData.canvas.background = canvasEl.style.background || '#ffffff';\n//         }\n//\n//         // Parse meta\n//         const titleEl = doc.querySelector('title');\n//         if (titleEl) {\n//             pageData.meta.title = titleEl.textContent;\n//         }\n//\n//         const descEl = doc.querySelector('meta[name=\"description\"]');\n//         if (descEl) {\n//             pageData.meta.description = descEl.getAttribute('content');\n//         }\n//\n//         // Parse sections\n//         const sections = doc.querySelectorAll('.lpb-section');\n//         sections.forEach(sectionEl => {\n//             const section = parseSectionElement(sectionEl);\n//             if (section) {\n//                 pageData.elements.push(section);\n//             }\n//         });\n//\n//         // Parse popups\n//         const popups = doc.querySelectorAll('.lpb-popup');\n//         popups.forEach(popupEl => {\n//             const popup = parsePopupElement(popupEl);\n//             if (popup) {\n//                 pageData.elements.push(popup);\n//             }\n//         });\n//\n//         // Parse events t·ª´ script\n//         const scripts = doc.querySelectorAll('script');\n//         scripts.forEach(script => {\n//             const content = script.textContent || script.innerHTML;\n//             const eventsMatch = content.match(/const eventsConfig = (\\[[\\s\\S]*?\\]);/);\n//             if (eventsMatch) {\n//                 try {\n//                     const events = JSON.parse(eventsMatch[1]);\n//                     events.forEach(eventConfig => {\n//                         const element = findElementById(pageData.elements, eventConfig.elementId);\n//                         if (element) {\n//                             if (!element.componentData) {\n//                                 element.componentData = {};\n//                             }\n//                             element.componentData.events = eventConfig.events;\n//                         }\n//                     });\n//                 } catch (e) {\n//                     console.warn('Cannot parse events config:', e);\n//                 }\n//             }\n//         });\n//\n//         console.log('[parseHTMLToPageData] Parsed successfully:', pageData.elements.length, 'elements');\n//         return pageData;\n//\n//     } catch (error) {\n//         console.error('[parseHTMLToPageData] Parse error:', error);\n//         return {\n//             canvas: { width: 1200, height: 'auto', background: '#ffffff' },\n//             elements: [],\n//             meta: {}\n//         };\n//     }\n// };\n//\n// // ==================== HELPER FUNCTIONS ====================\n//\n// const parseSectionElement = (sectionEl) => {\n//     const id = sectionEl.id || `section-${Date.now()}`;\n//     const topMatch = sectionEl.style.top?.match(/(\\d+)px/);\n//     const top = topMatch ? parseInt(topMatch[1]) : 0;\n//     const widthMatch = sectionEl.style.width?.match(/(\\d+)px/);\n//     const heightMatch = sectionEl.style.height?.match(/(\\d+)px/);\n//     const width = widthMatch ? parseInt(widthMatch[1]) : 1200;\n//     const height = heightMatch ? parseInt(heightMatch[1]) : 400;\n//\n//     const bgEl = sectionEl.querySelector('.ladi-section-background');\n//     const overlayEl = sectionEl.querySelector('.ladi-overlay');\n//     const containerEl = sectionEl.querySelector('.ladi-container');\n//\n//     const componentData = { structure: 'ladi-standard' };\n//\n//     if (bgEl) {\n//         const bgStyle = bgEl.style;\n//         componentData.backgroundColor = bgStyle.backgroundColor || 'transparent';\n//         const bgImageMatch = bgStyle.backgroundImage?.match(/url\\(['\"]?(.+?)['\"]?\\)/);\n//         if (bgImageMatch) {\n//             componentData.backgroundImage = bgImageMatch[1];\n//             componentData.backgroundType = 'image';\n//         } else if (componentData.backgroundColor !== 'transparent') {\n//             componentData.backgroundType = 'color';\n//         }\n//         componentData.backgroundPosition = bgStyle.backgroundPosition || 'center';\n//     }\n//\n//     if (overlayEl) {\n//         componentData.overlayColor = overlayEl.style.backgroundColor || 'transparent';\n//         componentData.overlayOpacity = parseFloat(overlayEl.style.opacity) || 0;\n//     }\n//\n//     const styles = parseInlineStyles(sectionEl.style);\n//\n//     if (containerEl) {\n//         componentData.padding = containerEl.style.padding || '20px';\n//     }\n//\n//     const children = [];\n//     if (containerEl) {\n//         const childElements = containerEl.querySelectorAll('.lpb-element[data-element-id]');\n//         childElements.forEach(childEl => {\n//             if (childEl.parentElement === containerEl || childEl.parentElement?.parentElement === containerEl) {\n//                 const child = parseChildElement(childEl);\n//                 if (child) {\n//                     children.push(child);\n//                 }\n//             }\n//         });\n//     }\n//\n//     return {\n//         id,\n//         type: 'section',\n//         componentData,\n//         position: {\n//             desktop: { x: 0, y: top },\n//             tablet: { x: 0, y: top },\n//             mobile: { x: 0, y: top }\n//         },\n//         size: { width, height },\n//         styles,\n//         children,\n//         visible: true,\n//         locked: false\n//     };\n// };\n//\n// const parsePopupElement = (popupEl) => {\n//     const id = popupEl.id || `popup-${Date.now()}`;\n//     const containerEl = popupEl.querySelector('.lpb-popup-container');\n//     if (!containerEl) return null;\n//\n//     const widthMatch = containerEl.style.width?.match(/(\\d+)px/);\n//     const minHeightMatch = containerEl.style.minHeight?.match(/(\\d+)px/);\n//     const width = widthMatch ? parseInt(widthMatch[1]) : 600;\n//     const height = minHeightMatch ? parseInt(minHeightMatch[1]) : 400;\n//\n//     const headerEl = popupEl.querySelector('.lpb-popup-header h3');\n//     const bodyEl = popupEl.querySelector('.lpb-popup-body');\n//\n//     const componentData = {\n//         title: headerEl?.textContent || 'Popup',\n//         background: containerEl.style.background || 'rgba(255, 255, 255, 0.95)',\n//         borderRadius: containerEl.style.borderRadius || '12px',\n//         padding: bodyEl?.style.padding || '20px'\n//     };\n//\n//     const styles = parseInlineStyles(containerEl.style);\n//\n//     const children = [];\n//     if (bodyEl) {\n//         const childElements = bodyEl.querySelectorAll('.lpb-element[data-element-id]');\n//         childElements.forEach(childEl => {\n//             const child = parseChildElement(childEl);\n//             if (child) {\n//                 children.push(child);\n//             }\n//         });\n//     }\n//\n//     return {\n//         id,\n//         type: 'popup',\n//         componentData,\n//         position: {\n//             desktop: { x: 0, y: 0 },\n//             tablet: { x: 0, y: 0 },\n//             mobile: { x: 0, y: 0 }\n//         },\n//         size: { width, height },\n//         styles,\n//         children,\n//         visible: true,\n//         locked: false\n//     };\n// };\n//\n// const parseChildElement = (element) => {\n//     const id = element.id || element.getAttribute('data-element-id') || `element-${Date.now()}`;\n//     const type = element.getAttribute('data-type') || inferTypeFromElement(element);\n//\n//     const leftMatch = element.style.left?.match(/(\\d+)px/);\n//     const topMatch = element.style.top?.match(/(\\d+)px/);\n//     const left = leftMatch ? parseInt(leftMatch[1]) : 0;\n//     const top = topMatch ? parseInt(topMatch[1]) : 0;\n//\n//     const widthMatch = element.style.width?.match(/(\\d+)px/);\n//     const heightMatch = element.style.height?.match(/(\\d+)px/);\n//     const width = widthMatch ? parseInt(widthMatch[1]) : (type === 'icon' ? 50 : 200);\n//     const height = heightMatch ? parseInt(heightMatch[1]) : (type === 'icon' ? 50 : 50);\n//\n//     const styles = parseInlineStyles(element.style);\n//     const componentData = parseComponentData(element, type);\n//\n//     return {\n//         id,\n//         type,\n//         componentData,\n//         position: {\n//             desktop: { x: left, y: top },\n//             tablet: { x: left, y: top },\n//             mobile: { x: left, y: top }\n//         },\n//         size: { width, height },\n//         styles,\n//         children: [],\n//         visible: true,\n//         locked: false\n//     };\n// };\n//\n// const parseComponentData = (element, type) => {\n//     const componentData = {};\n//\n//     switch (type) {\n//         case 'button':\n//             componentData.content = element.textContent || 'Button';\n//             componentData.background = element.style.background;\n//             componentData.color = element.style.color;\n//             componentData.borderRadius = element.style.borderRadius;\n//             componentData.border = element.style.border;\n//             componentData.fontSize = element.style.fontSize;\n//             componentData.fontWeight = element.style.fontWeight;\n//             break;\n//\n//         case 'heading':\n//             componentData.content = element.textContent || 'Heading';\n//             componentData.level = element.tagName.toLowerCase();\n//             componentData.fontSize = element.style.fontSize;\n//             componentData.color = element.style.color;\n//             componentData.fontWeight = element.style.fontWeight;\n//             componentData.textAlign = element.style.textAlign;\n//             break;\n//\n//         case 'paragraph':\n//             componentData.content = element.textContent || 'Paragraph';\n//             componentData.fontSize = element.style.fontSize;\n//             componentData.color = element.style.color;\n//             componentData.fontWeight = element.style.fontWeight;\n//             componentData.lineHeight = element.style.lineHeight;\n//             componentData.textAlign = element.style.textAlign;\n//             break;\n//\n//         case 'image':\n//             componentData.src = element.getAttribute('src');\n//             componentData.alt = element.getAttribute('alt');\n//             componentData.imageUrl = element.getAttribute('src');\n//             break;\n//\n//         case 'icon':\n//             const img = element.querySelector('img');\n//             const iconEl = element.querySelector('i');\n//             const svgEl = element.querySelector('svg');\n//\n//             if (img) {\n//                 componentData.imageUrl = img.getAttribute('src');\n//             } else if (svgEl) {\n//                 componentData.icon = svgEl.outerHTML;\n//             } else if (iconEl) {\n//                 componentData.icon = iconEl.className;\n//             }\n//             componentData.title = element.getAttribute('title') || '';\n//             break;\n//\n//         case 'gallery':\n//             const images = Array.from(element.querySelectorAll('img')).map(img => img.src);\n//             componentData.images = images;\n//             break;\n//\n//         default:\n//             componentData.content = element.textContent || '';\n//             break;\n//     }\n//\n//     return componentData;\n// };\n//\n// const parseInlineStyles = (styleObj) => {\n//     const styles = {};\n//     const importantProps = [\n//         'background', 'backgroundColor', 'backgroundImage', 'backgroundSize', 'backgroundPosition',\n//         'color', 'fontSize', 'fontWeight', 'fontFamily',\n//         'border', 'borderRadius', 'boxShadow', 'textShadow',\n//         'padding', 'margin',\n//         'display', 'alignItems', 'justifyContent', 'flexDirection', 'gap',\n//         'textAlign', 'lineHeight', 'textTransform',\n//         'cursor', 'transition', 'animation',\n//         'zIndex', 'opacity'\n//     ];\n//\n//     importantProps.forEach(prop => {\n//         if (styleObj[prop]) {\n//             styles[prop] = styleObj[prop];\n//         }\n//     });\n//\n//     return styles;\n// };\n//\n// const inferTypeFromElement = (element) => {\n//     const tagName = element.tagName.toLowerCase();\n//     const classList = element.classList;\n//\n//     if (classList.contains('lpb-button') || tagName === 'button') return 'button';\n//     if (classList.contains('lpb-icon')) return 'icon';\n//     if (classList.contains('lpb-gallery')) return 'gallery';\n//     if (classList.contains('lpb-section')) return 'section';\n//     if (classList.contains('lpb-popup')) return 'popup';\n//\n//     if (tagName.match(/^h[1-6]$/)) return 'heading';\n//     if (tagName === 'p') return 'paragraph';\n//     if (tagName === 'img') return 'image';\n//     if (tagName === 'hr') return 'divider';\n//     if (tagName === 'form') return 'form';\n//     if (tagName === 'ul' || tagName === 'ol') return 'list';\n//\n//     return 'container';\n// };\n//\n// const findElementById = (elements, id) => {\n//     for (const element of elements) {\n//         if (element.id === id) return element;\n//\n//         if (element.children && element.children.length > 0) {\n//             const found = findElementById(element.children, id);\n//             if (found) return found;\n//         }\n//     }\n//     return null;\n// };\n/**\r\n * Parse HTML string th√†nh pageData structure\r\n * PRIORITY 1: Extract embedded pageData t·ª´ <script id=\"lpb-page-data\">\r\n * PRIORITY 2: Parse DOM structure (fallback)\r\n */\nexport const parseHTMLToPageData = htmlString => {\n  console.log('üîç parseHTMLToPageData called, HTML length:', htmlString === null || htmlString === void 0 ? void 0 : htmlString.length);\n  if (!htmlString || typeof htmlString !== 'string') {\n    console.warn('‚ö†Ô∏è Invalid HTML input');\n    return getDefaultPageData();\n  }\n\n  // ==================== PRIORITY 1: EXTRACT EMBEDDED pageData ====================\n  try {\n    const pageDataMatch = htmlString.match(/<script type=\"application\\/json\" id=\"lpb-page-data\">\\s*([\\s\\S]*?)\\s*<\\/script>/);\n    if (pageDataMatch && pageDataMatch[1]) {\n      console.log('‚úÖ Found embedded pageData script tag');\n      try {\n        const embeddedPageData = JSON.parse(pageDataMatch[1]);\n\n        // Validate structure\n        if (embeddedPageData && embeddedPageData.canvas && Array.isArray(embeddedPageData.elements)) {\n          var _embeddedPageData$met, _embeddedPageData$met2, _embeddedPageData$met3, _embeddedPageData$met4, _embeddedPageData$met5, _embeddedPageData$met6;\n          console.log('‚úÖ Valid embedded pageData structure:', {\n            elementsCount: embeddedPageData.elements.length,\n            canvasWidth: embeddedPageData.canvas.width,\n            metaTitle: (_embeddedPageData$met = embeddedPageData.meta) === null || _embeddedPageData$met === void 0 ? void 0 : _embeddedPageData$met.title\n          });\n\n          // Normalize ƒë·ªÉ ƒë·∫£m b·∫£o t∆∞∆°ng th√≠ch v·ªõi Canvas\n          const normalizedPageData = {\n            canvas: {\n              width: embeddedPageData.canvas.width || 1200,\n              height: embeddedPageData.canvas.height || 'auto',\n              background: embeddedPageData.canvas.background || '#ffffff'\n            },\n            elements: embeddedPageData.elements.map(normalizeElement),\n            meta: {\n              title: ((_embeddedPageData$met2 = embeddedPageData.meta) === null || _embeddedPageData$met2 === void 0 ? void 0 : _embeddedPageData$met2.title) || 'Untitled Page',\n              description: ((_embeddedPageData$met3 = embeddedPageData.meta) === null || _embeddedPageData$met3 === void 0 ? void 0 : _embeddedPageData$met3.description) || '',\n              keywords: ((_embeddedPageData$met4 = embeddedPageData.meta) === null || _embeddedPageData$met4 === void 0 ? void 0 : _embeddedPageData$met4.keywords) || [],\n              created_at: ((_embeddedPageData$met5 = embeddedPageData.meta) === null || _embeddedPageData$met5 === void 0 ? void 0 : _embeddedPageData$met5.created_at) || new Date().toISOString(),\n              updated_at: ((_embeddedPageData$met6 = embeddedPageData.meta) === null || _embeddedPageData$met6 === void 0 ? void 0 : _embeddedPageData$met6.updated_at) || new Date().toISOString()\n            },\n            analytics: embeddedPageData.analytics || {}\n          };\n          console.log('‚úÖ Normalized pageData ready for Canvas:', {\n            elementsCount: normalizedPageData.elements.length,\n            firstElement: normalizedPageData.elements[0]\n          });\n          return normalizedPageData;\n        } else {\n          console.warn('‚ö†Ô∏è Invalid embedded pageData structure:', {\n            hasCanvas: !!(embeddedPageData !== null && embeddedPageData !== void 0 && embeddedPageData.canvas),\n            hasElements: Array.isArray(embeddedPageData === null || embeddedPageData === void 0 ? void 0 : embeddedPageData.elements),\n            elementsType: typeof (embeddedPageData === null || embeddedPageData === void 0 ? void 0 : embeddedPageData.elements)\n          });\n        }\n      } catch (parseError) {\n        console.error('‚ùå Failed to parse embedded pageData JSON:', parseError.message);\n        console.error('JSON content preview:', pageDataMatch[1].substring(0, 200));\n      }\n    } else {\n      console.log('‚ö†Ô∏è No embedded pageData found in HTML, trying DOM parsing...');\n    }\n  } catch (error) {\n    console.error('‚ùå Error extracting embedded pageData:', error);\n  }\n\n  // ==================== PRIORITY 2: PARSE DOM STRUCTURE ====================\n  console.log('‚öôÔ∏è Parsing HTML DOM structure as fallback...');\n  const parser = new DOMParser();\n  const doc = parser.parseFromString(htmlString, 'text/html');\n  const pageData = {\n    canvas: {\n      width: 1200,\n      height: 'auto',\n      background: '#ffffff'\n    },\n    elements: [],\n    meta: {\n      title: 'Untitled Page',\n      description: '',\n      keywords: []\n    }\n  };\n  try {\n    // Parse canvas background\n    const canvasEl = doc.getElementById('lpb-canvas');\n    if (canvasEl) {\n      pageData.canvas.background = canvasEl.style.background || '#ffffff';\n    }\n\n    // Parse meta tags\n    const titleEl = doc.querySelector('title');\n    if (titleEl) {\n      pageData.meta.title = titleEl.textContent;\n    }\n    const descEl = doc.querySelector('meta[name=\"description\"]');\n    if (descEl) {\n      pageData.meta.description = descEl.getAttribute('content');\n    }\n\n    // Parse sections\n    const sections = doc.querySelectorAll('.lpb-section, section.ladi-section, section');\n    console.log(`üì¶ Found ${sections.length} sections in DOM`);\n    sections.forEach((sectionEl, index) => {\n      const section = parseSectionElementFromDOM(sectionEl, index);\n      if (section) {\n        pageData.elements.push(section);\n      }\n    });\n\n    // Parse popups\n    const popups = doc.querySelectorAll('.lpb-popup');\n    console.log(`ü™ü Found ${popups.length} popups in DOM`);\n    popups.forEach(popupEl => {\n      const popup = parsePopupElementFromDOM(popupEl);\n      if (popup) {\n        pageData.elements.push(popup);\n      }\n    });\n    console.log(`‚úÖ DOM parsing completed: ${pageData.elements.length} elements`);\n    return pageData;\n  } catch (error) {\n    console.error('‚ùå DOM parse error:', error);\n    return getDefaultPageData();\n  }\n};\n\n/**\r\n * Get default empty pageData structure\r\n */\nconst getDefaultPageData = (title = 'Untitled Page', description = '') => {\n  return {\n    canvas: {\n      width: 1200,\n      height: 'auto',\n      background: '#ffffff'\n    },\n    elements: [],\n    meta: {\n      title,\n      description,\n      keywords: [],\n      created_at: new Date().toISOString(),\n      updated_at: new Date().toISOString()\n    }\n  };\n};\n\n/**\r\n * Normalize element structure ƒë·ªÉ ƒë·∫£m b·∫£o t∆∞∆°ng th√≠ch v·ªõi Canvas\r\n */\nconst normalizeElement = element => {\n  var _element$size, _element$size2;\n  const normalized = {\n    id: element.id || `element-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`,\n    type: element.type || 'container',\n    componentData: element.componentData || {},\n    position: normalizePosition(element.position),\n    size: {\n      width: ((_element$size = element.size) === null || _element$size === void 0 ? void 0 : _element$size.width) || (element.type === 'section' ? 1200 : 200),\n      height: ((_element$size2 = element.size) === null || _element$size2 === void 0 ? void 0 : _element$size2.height) || (element.type === 'section' ? 400 : 50)\n    },\n    styles: element.styles || {},\n    children: Array.isArray(element.children) ? element.children.map(normalizeElement) : [],\n    visible: element.visible !== false,\n    locked: element.locked || false\n  };\n  return normalized;\n};\n\n/**\r\n * Normalize position ƒë·ªÉ ƒë·∫£m b·∫£o c√≥ ƒë·∫ßy ƒë·ªß c√°c viewMode\r\n */\nconst normalizePosition = position => {\n  if (!position) {\n    return {\n      desktop: {\n        x: 0,\n        y: 0\n      },\n      tablet: {\n        x: 0,\n        y: 0\n      },\n      mobile: {\n        x: 0,\n        y: 0\n      }\n    };\n  }\n  const desktop = position.desktop || position.default || {\n    x: 0,\n    y: 0\n  };\n  const tablet = position.tablet || desktop;\n  const mobile = position.mobile || desktop;\n  return {\n    desktop: {\n      x: desktop.x || 0,\n      y: desktop.y || 0\n    },\n    tablet: {\n      x: tablet.x || 0,\n      y: tablet.y || 0\n    },\n    mobile: {\n      x: mobile.x || 0,\n      y: mobile.y || 0\n    }\n  };\n};\n\n/**\r\n * Parse section element t·ª´ DOM (RENAMED ƒë·ªÉ tr√°nh conflict)\r\n */\nconst parseSectionElementFromDOM = (sectionEl, index = 0) => {\n  var _sectionEl$style$top, _sectionEl$style$widt, _sectionEl$style$heig;\n  const id = sectionEl.id || sectionEl.getAttribute('data-element-id') || `section-${Date.now()}-${index}`;\n\n  // Parse position\n  const topMatch = (_sectionEl$style$top = sectionEl.style.top) === null || _sectionEl$style$top === void 0 ? void 0 : _sectionEl$style$top.match(/(-?\\d+)px/);\n  const top = topMatch ? parseInt(topMatch[1]) : index * 400;\n\n  // Parse size\n  const widthMatch = (_sectionEl$style$widt = sectionEl.style.width) === null || _sectionEl$style$widt === void 0 ? void 0 : _sectionEl$style$widt.match(/(\\d+)px/);\n  const heightMatch = (_sectionEl$style$heig = sectionEl.style.height) === null || _sectionEl$style$heig === void 0 ? void 0 : _sectionEl$style$heig.match(/(\\d+)px/);\n  const width = widthMatch ? parseInt(widthMatch[1]) : 1200;\n  const height = heightMatch ? parseInt(heightMatch[1]) : 400;\n\n  // Parse structure elements\n  const bgEl = sectionEl.querySelector('.ladi-section-background, .lpb-section-background');\n  const overlayEl = sectionEl.querySelector('.ladi-overlay, .lpb-overlay');\n  const containerEl = sectionEl.querySelector('.ladi-container, .lpb-container');\n  const componentData = {\n    structure: 'ladi-standard',\n    backgroundColor: 'transparent',\n    backgroundType: 'color'\n  };\n  if (bgEl) {\n    var _bgStyle$backgroundIm;\n    const bgStyle = bgEl.style;\n    componentData.backgroundColor = bgStyle.backgroundColor || 'transparent';\n    const bgImageMatch = (_bgStyle$backgroundIm = bgStyle.backgroundImage) === null || _bgStyle$backgroundIm === void 0 ? void 0 : _bgStyle$backgroundIm.match(/url\\(['\"]?(.+?)['\"]?\\)/);\n    if (bgImageMatch) {\n      componentData.backgroundImage = bgImageMatch[1];\n      componentData.backgroundType = 'image';\n    }\n    componentData.backgroundPosition = bgStyle.backgroundPosition || 'center';\n    componentData.backgroundSize = bgStyle.backgroundSize || 'cover';\n  }\n  if (overlayEl) {\n    componentData.overlayColor = overlayEl.style.backgroundColor || 'transparent';\n    componentData.overlayOpacity = parseFloat(overlayEl.style.opacity) || 0;\n  }\n  const styles = parseInlineStylesFromDOM(sectionEl.style);\n  if (containerEl) {\n    componentData.padding = containerEl.style.padding || '20px';\n  }\n\n  // Parse children\n  const children = [];\n  if (containerEl) {\n    const childElements = containerEl.querySelectorAll('.lpb-element[data-element-id]');\n    childElements.forEach(childEl => {\n      var _childEl$parentElemen;\n      if (childEl.parentElement === containerEl || ((_childEl$parentElemen = childEl.parentElement) === null || _childEl$parentElemen === void 0 ? void 0 : _childEl$parentElemen.parentElement) === containerEl) {\n        const child = parseChildElementFromDOM(childEl);\n        if (child) {\n          children.push(child);\n        }\n      }\n    });\n  }\n  console.log(`üì¶ Parsed section ${id}:`, {\n    position: {\n      y: top\n    },\n    size: {\n      width,\n      height\n    },\n    childrenCount: children.length\n  });\n  return {\n    id,\n    type: 'section',\n    componentData,\n    position: {\n      desktop: {\n        x: 0,\n        y: top\n      },\n      tablet: {\n        x: 0,\n        y: top\n      },\n      mobile: {\n        x: 0,\n        y: top\n      }\n    },\n    size: {\n      width,\n      height\n    },\n    styles,\n    children,\n    visible: true,\n    locked: false\n  };\n};\n\n/**\r\n * Parse popup element t·ª´ DOM (RENAMED)\r\n */\nconst parsePopupElementFromDOM = popupEl => {\n  var _containerEl$style$wi, _containerEl$style$mi, _headerEl$textContent;\n  const id = popupEl.id || `popup-${Date.now()}`;\n  const containerEl = popupEl.querySelector('.lpb-popup-container');\n  if (!containerEl) {\n    console.warn('‚ö†Ô∏è Popup container not found for:', id);\n    return null;\n  }\n  const widthMatch = (_containerEl$style$wi = containerEl.style.width) === null || _containerEl$style$wi === void 0 ? void 0 : _containerEl$style$wi.match(/(\\d+)px/);\n  const minHeightMatch = (_containerEl$style$mi = containerEl.style.minHeight) === null || _containerEl$style$mi === void 0 ? void 0 : _containerEl$style$mi.match(/(\\d+)px/);\n  const width = widthMatch ? parseInt(widthMatch[1]) : 600;\n  const height = minHeightMatch ? parseInt(minHeightMatch[1]) : 400;\n  const headerEl = popupEl.querySelector('.lpb-popup-header h3, .lpb-popup-header h2');\n  const bodyEl = popupEl.querySelector('.lpb-popup-body');\n  const componentData = {\n    title: (headerEl === null || headerEl === void 0 ? void 0 : (_headerEl$textContent = headerEl.textContent) === null || _headerEl$textContent === void 0 ? void 0 : _headerEl$textContent.trim()) || 'Popup',\n    background: containerEl.style.background || 'rgba(255, 255, 255, 0.95)',\n    borderRadius: containerEl.style.borderRadius || '12px',\n    padding: (bodyEl === null || bodyEl === void 0 ? void 0 : bodyEl.style.padding) || '20px'\n  };\n  const styles = parseInlineStylesFromDOM(containerEl.style);\n  const children = [];\n  if (bodyEl) {\n    const childElements = bodyEl.querySelectorAll('.lpb-element[data-element-id]');\n    childElements.forEach(childEl => {\n      const child = parseChildElementFromDOM(childEl);\n      if (child) {\n        children.push(child);\n      }\n    });\n  }\n  return {\n    id,\n    type: 'popup',\n    componentData,\n    position: {\n      desktop: {\n        x: 100,\n        y: 100\n      },\n      tablet: {\n        x: 100,\n        y: 100\n      },\n      mobile: {\n        x: 50,\n        y: 50\n      }\n    },\n    size: {\n      width,\n      height\n    },\n    styles,\n    children,\n    visible: true,\n    locked: false\n  };\n};\n\n/**\r\n * Parse child element t·ª´ DOM (RENAMED)\r\n */\nconst parseChildElementFromDOM = element => {\n  var _element$style$left, _element$style$top, _element$style$width, _element$style$height;\n  const id = element.id || element.getAttribute('data-element-id') || `element-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;\n  const type = element.getAttribute('data-type') || inferTypeFromElementDOM(element);\n  const leftMatch = (_element$style$left = element.style.left) === null || _element$style$left === void 0 ? void 0 : _element$style$left.match(/(-?\\d+)px/);\n  const topMatch = (_element$style$top = element.style.top) === null || _element$style$top === void 0 ? void 0 : _element$style$top.match(/(-?\\d+)px/);\n  const left = leftMatch ? parseInt(leftMatch[1]) : 0;\n  const top = topMatch ? parseInt(topMatch[1]) : 0;\n  const widthMatch = (_element$style$width = element.style.width) === null || _element$style$width === void 0 ? void 0 : _element$style$width.match(/(\\d+)px/);\n  const heightMatch = (_element$style$height = element.style.height) === null || _element$style$height === void 0 ? void 0 : _element$style$height.match(/(\\d+)px/);\n  const width = widthMatch ? parseInt(widthMatch[1]) : type === 'icon' ? 50 : 200;\n  const height = heightMatch ? parseInt(heightMatch[1]) : type === 'icon' ? 50 : 50;\n  const styles = parseInlineStylesFromDOM(element.style);\n  const componentData = parseComponentDataFromDOM(element, type);\n  return {\n    id,\n    type,\n    componentData,\n    position: {\n      desktop: {\n        x: left,\n        y: top\n      },\n      tablet: {\n        x: left,\n        y: top\n      },\n      mobile: {\n        x: left,\n        y: top\n      }\n    },\n    size: {\n      width,\n      height\n    },\n    styles,\n    children: [],\n    visible: element.style.display !== 'none',\n    locked: false\n  };\n};\n\n/**\r\n * Parse component data t·ª´ DOM element (RENAMED)\r\n */\nconst parseComponentDataFromDOM = (element, type) => {\n  var _element$textContent, _element$textContent2, _element$tagName, _element$textContent3, _element$textContent4;\n  const componentData = {};\n  switch (type) {\n    case 'button':\n      componentData.content = ((_element$textContent = element.textContent) === null || _element$textContent === void 0 ? void 0 : _element$textContent.trim()) || 'Button';\n      break;\n    case 'heading':\n      componentData.content = ((_element$textContent2 = element.textContent) === null || _element$textContent2 === void 0 ? void 0 : _element$textContent2.trim()) || 'Heading';\n      componentData.level = ((_element$tagName = element.tagName) === null || _element$tagName === void 0 ? void 0 : _element$tagName.toLowerCase()) || 'h2';\n      break;\n    case 'paragraph':\n      componentData.content = ((_element$textContent3 = element.textContent) === null || _element$textContent3 === void 0 ? void 0 : _element$textContent3.trim()) || 'Paragraph';\n      break;\n    case 'image':\n      componentData.src = element.getAttribute('src') || '';\n      componentData.alt = element.getAttribute('alt') || '';\n      componentData.imageUrl = element.getAttribute('src') || '';\n      break;\n    case 'icon':\n      const img = element.querySelector('img');\n      const iconEl = element.querySelector('i');\n      const svgEl = element.querySelector('svg');\n      if (img) {\n        componentData.imageUrl = img.getAttribute('src');\n        componentData.type = 'image';\n      } else if (svgEl) {\n        componentData.icon = svgEl.outerHTML;\n        componentData.type = 'svg';\n      } else if (iconEl) {\n        componentData.icon = iconEl.className;\n        componentData.type = 'fontawesome';\n      } else {\n        componentData.icon = 'fas fa-star';\n        componentData.type = 'fontawesome';\n      }\n      componentData.title = element.getAttribute('title') || '';\n      break;\n    case 'gallery':\n      const images = Array.from(element.querySelectorAll('img')).map(img => img.src).filter(src => src && !src.includes('placeholder'));\n      componentData.images = images;\n      componentData.layout = 'grid';\n      break;\n    default:\n      componentData.content = ((_element$textContent4 = element.textContent) === null || _element$textContent4 === void 0 ? void 0 : _element$textContent4.trim()) || '';\n      break;\n  }\n  return componentData;\n};\n\n/**\r\n * Parse inline styles t·ª´ CSSStyleDeclaration (RENAMED)\r\n */\nconst parseInlineStylesFromDOM = styleObj => {\n  const styles = {};\n  const importantProps = ['background', 'backgroundColor', 'backgroundImage', 'backgroundSize', 'backgroundPosition', 'color', 'fontSize', 'fontWeight', 'fontFamily', 'border', 'borderRadius', 'boxShadow', 'textShadow', 'padding', 'margin', 'display', 'alignItems', 'justifyContent', 'flexDirection', 'gap', 'textAlign', 'lineHeight', 'textTransform', 'letterSpacing', 'cursor', 'transition', 'animation', 'transform', 'zIndex', 'opacity', 'overflow'];\n  importantProps.forEach(prop => {\n    if (styleObj[prop]) {\n      styles[prop] = styleObj[prop];\n    }\n  });\n  return styles;\n};\n\n/**\r\n * Infer element type t·ª´ DOM element (RENAMED)\r\n */\nconst inferTypeFromElementDOM = element => {\n  var _element$tagName2;\n  const tagName = (_element$tagName2 = element.tagName) === null || _element$tagName2 === void 0 ? void 0 : _element$tagName2.toLowerCase();\n  const classList = element.classList;\n  if (classList.contains('lpb-button') || classList.contains('ladi-button')) return 'button';\n  if (classList.contains('lpb-icon') || classList.contains('ladi-icon')) return 'icon';\n  if (classList.contains('lpb-gallery') || classList.contains('ladi-gallery')) return 'gallery';\n  if (classList.contains('lpb-section') || classList.contains('ladi-section')) return 'section';\n  if (classList.contains('lpb-popup')) return 'popup';\n  if (tagName === 'button') return 'button';\n  if (tagName !== null && tagName !== void 0 && tagName.match(/^h[1-6]$/)) return 'heading';\n  if (tagName === 'p') return 'paragraph';\n  if (tagName === 'img') return 'image';\n  if (tagName === 'svg' || element.querySelector('svg')) return 'icon';\n  if (tagName === 'i' && element.className.includes('fa')) return 'icon';\n  if (element.querySelector('i.fa') || element.querySelector('svg')) {\n    return 'icon';\n  }\n  return 'container';\n};","map":{"version":3,"names":["parseHTMLToPageData","htmlString","console","log","length","warn","getDefaultPageData","pageDataMatch","match","embeddedPageData","JSON","parse","canvas","Array","isArray","elements","_embeddedPageData$met","_embeddedPageData$met2","_embeddedPageData$met3","_embeddedPageData$met4","_embeddedPageData$met5","_embeddedPageData$met6","elementsCount","canvasWidth","width","metaTitle","meta","title","normalizedPageData","height","background","map","normalizeElement","description","keywords","created_at","Date","toISOString","updated_at","analytics","firstElement","hasCanvas","hasElements","elementsType","parseError","error","message","substring","parser","DOMParser","doc","parseFromString","pageData","canvasEl","getElementById","style","titleEl","querySelector","textContent","descEl","getAttribute","sections","querySelectorAll","forEach","sectionEl","index","section","parseSectionElementFromDOM","push","popups","popupEl","popup","parsePopupElementFromDOM","element","_element$size","_element$size2","normalized","id","now","Math","random","toString","substr","type","componentData","position","normalizePosition","size","styles","children","visible","locked","desktop","x","y","tablet","mobile","default","_sectionEl$style$top","_sectionEl$style$widt","_sectionEl$style$heig","topMatch","top","parseInt","widthMatch","heightMatch","bgEl","overlayEl","containerEl","structure","backgroundColor","backgroundType","_bgStyle$backgroundIm","bgStyle","bgImageMatch","backgroundImage","backgroundPosition","backgroundSize","overlayColor","overlayOpacity","parseFloat","opacity","parseInlineStylesFromDOM","padding","childElements","childEl","_childEl$parentElemen","parentElement","child","parseChildElementFromDOM","childrenCount","_containerEl$style$wi","_containerEl$style$mi","_headerEl$textContent","minHeightMatch","minHeight","headerEl","bodyEl","trim","borderRadius","_element$style$left","_element$style$top","_element$style$width","_element$style$height","inferTypeFromElementDOM","leftMatch","left","parseComponentDataFromDOM","display","_element$textContent","_element$textContent2","_element$tagName","_element$textContent3","_element$textContent4","content","level","tagName","toLowerCase","src","alt","imageUrl","img","iconEl","svgEl","icon","outerHTML","className","images","from","filter","includes","layout","styleObj","importantProps","prop","_element$tagName2","classList","contains"],"sources":["F:/landinghub-iconic/apps/web/src/utils/pageUtils.js"],"sourcesContent":["// // ==================== EVENT RUNTIME GENERATOR ====================\r\n//\r\n// /**\r\n//  * Generate runtime script ƒë·ªÉ x·ª≠ l√Ω events trong HTML tƒ©nh\r\n//  * @param {Array} events - Danh s√°ch events t·ª´ pageData\r\n//  * @param {Array} popups - Danh s√°ch popup elements\r\n//  * @returns {string} - JavaScript code\r\n//  */\r\n// const generateEventRuntime = (events, popups) => {\r\n//     return `\r\n//     // Landing Page Builder Runtime v1.0\r\n//     (function() {\r\n//         'use strict';\r\n//\r\n//         window.LPB = window.LPB || {};\r\n//\r\n//         // ========== POPUP MANAGER ==========\r\n//         LPB.popups = {\r\n//             active: new Set(),\r\n//\r\n//             open: function(popupId, data) {\r\n//                 const popup = document.getElementById(popupId);\r\n//                 if (!popup) {\r\n//                     console.error('[LPB] Popup not found:', popupId);\r\n//                     return;\r\n//                 }\r\n//\r\n//                 // Update content n·∫øu c√≥ data\r\n//                 if (data && data.html) {\r\n//                     const content = popup.querySelector('.lpb-popup-body');\r\n//                     if (content) content.innerHTML = data.html;\r\n//                 }\r\n//\r\n//                 // Show popup\r\n//                 popup.classList.add('lpb-popup-active');\r\n//                 document.body.style.overflow = 'hidden';\r\n//                 this.active.add(popupId);\r\n//\r\n//                 // Analytics tracking\r\n//                 if (window.gtag) {\r\n//                     gtag('event', 'popup_open', {\r\n//                         event_category: 'Engagement',\r\n//                         event_label: popupId\r\n//                     });\r\n//                 }\r\n//             },\r\n//\r\n//             close: function(popupId) {\r\n//                 const popup = document.getElementById(popupId);\r\n//                 if (popup) {\r\n//                     popup.classList.remove('lpb-popup-active');\r\n//                     this.active.delete(popupId);\r\n//\r\n//                     // Restore scroll n·∫øu kh√¥ng c√≤n popup n√†o\r\n//                     if (this.active.size === 0) {\r\n//                         document.body.style.overflow = '';\r\n//                     }\r\n//                 }\r\n//             },\r\n//\r\n//             closeAll: function() {\r\n//                 this.active.forEach(id => this.close(id));\r\n//             }\r\n//         };\r\n//\r\n//         // ========== API MANAGER ==========\r\n//         LPB.api = {\r\n//             cache: new Map(),\r\n//\r\n//             getCacheKey: function(endpoint, params) {\r\n//                 return endpoint + JSON.stringify(params || {});\r\n//             },\r\n//\r\n//             fetch: async function(endpoint, options = {}) {\r\n//                 const cacheKey = this.getCacheKey(endpoint, options.params);\r\n//\r\n//                 // Check cache\r\n//                 if (this.cache.has(cacheKey)) {\r\n//                     const cached = this.cache.get(cacheKey);\r\n//                     const now = Date.now();\r\n//                     const TTL = options.ttl || 5 * 60 * 1000; // 5 ph√∫t default\r\n//\r\n//                     if (now - cached.timestamp < TTL) {\r\n//                         console.log('[LPB] Cache hit:', endpoint);\r\n//                         return cached.data;\r\n//                     }\r\n//                 }\r\n//\r\n//                 // Fetch m·ªõi\r\n//                 try {\r\n//                     console.log('[LPB] Fetching:', endpoint);\r\n//                     const response = await fetch(endpoint, {\r\n//                         method: options.method || 'GET',\r\n//                         headers: {\r\n//                             'Content-Type': 'application/json',\r\n//                             ...options.headers\r\n//                         },\r\n//                         body: options.data ? JSON.stringify(options.data) : undefined\r\n//                     });\r\n//\r\n//                     if (!response.ok) {\r\n//                         throw new Error(\\`HTTP \\${response.status}: \\${response.statusText}\\`);\r\n//                     }\r\n//\r\n//                     const data = await response.json();\r\n//\r\n//                     // Cache result\r\n//                     this.cache.set(cacheKey, {\r\n//                         data: data,\r\n//                         timestamp: Date.now()\r\n//                     });\r\n//\r\n//                     return data;\r\n//                 } catch (error) {\r\n//                     console.error('[LPB] API Error:', error);\r\n//                     throw error;\r\n//                 }\r\n//             },\r\n//\r\n//             clearCache: function(endpoint) {\r\n//                 if (endpoint) {\r\n//                     for (let key of this.cache.keys()) {\r\n//                         if (key.startsWith(endpoint)) {\r\n//                             this.cache.delete(key);\r\n//                         }\r\n//                     }\r\n//                 } else {\r\n//                     this.cache.clear();\r\n//                 }\r\n//             }\r\n//         };\r\n//\r\n//         // ========== EVENT HANDLER ==========\r\n//         LPB.handleEvent = async function(config) {\r\n//             const { type } = config;\r\n//\r\n//             try {\r\n//                 switch(type) {\r\n//                     case 'openPopup':\r\n//                         if (!config.popupId) {\r\n//                             console.error('[LPB] Missing popupId');\r\n//                             return;\r\n//                         }\r\n//                         this.popups.open(config.popupId, config.data);\r\n//                         break;\r\n//\r\n//                     case 'closePopup':\r\n//                         const targetPopupId = config.popupId || config.elementId;\r\n//                         if (!targetPopupId) {\r\n//                             console.error('[LPB] Missing popupId');\r\n//                             return;\r\n//                         }\r\n//                         this.popups.close(targetPopupId);\r\n//                         break;\r\n//\r\n//                     case 'triggerApi':\r\n//                         if (!config.apiUrl) {\r\n//                             console.error('[LPB] Missing apiUrl');\r\n//                             return;\r\n//                         }\r\n//                         const data = await this.api.fetch(config.apiUrl, {\r\n//                             method: config.method || 'GET',\r\n//                             params: config.params,\r\n//                             data: config.data\r\n//                         });\r\n//\r\n//                         // Update target n·∫øu c√≥\r\n//                         if (config.updateTarget) {\r\n//                             const target = document.getElementById(config.updateTarget);\r\n//                             if (target && data.html) {\r\n//                                 target.innerHTML = data.html;\r\n//                             }\r\n//                         }\r\n//                         break;\r\n//\r\n//                     case 'both':\r\n//                         // Open popup immediately v·ªõi loading\r\n//                         this.popups.open(config.popupId, {\r\n//                             html: '<div style=\"text-align:center;padding:40px;\"><div class=\"lpb-spinner\"></div><p>ƒêang t·∫£i...</p></div>'\r\n//                         });\r\n//\r\n//                         // Fetch API in background\r\n//                         const apiData = await this.api.fetch(config.apiUrl, {\r\n//                             method: config.method || 'GET',\r\n//                             params: config.params\r\n//                         });\r\n//\r\n//                         // Update popup content\r\n//                         this.popups.open(config.popupId, { html: apiData.html || JSON.stringify(apiData) });\r\n//                         break;\r\n//\r\n//                     case 'navigate':\r\n//                         if (!config.url) {\r\n//                             console.error('[LPB] Missing url');\r\n//                             return;\r\n//                         }\r\n//                         if (config.newTab) {\r\n//                             window.open(config.url, '_blank');\r\n//                         } else {\r\n//                             window.location.href = config.url;\r\n//                         }\r\n//                         break;\r\n//\r\n//                     case 'scrollToSection':\r\n//                         if (!config.sectionId) {\r\n//                             console.error('[LPB] Missing sectionId');\r\n//                             return;\r\n//                         }\r\n//                         const section = document.querySelector(\\`[data-element-id=\"\\${config.sectionId}\"]\\`);\r\n//                         if (section) {\r\n//                             section.scrollIntoView({\r\n//                                 behavior: config.smooth !== false ? 'smooth' : 'auto',\r\n//                                 block: 'start'\r\n//                             });\r\n//                         } else {\r\n//                             console.error('[LPB] Section not found:', config.sectionId);\r\n//                         }\r\n//                         break;\r\n//\r\n//                     case 'submitForm':\r\n//                         if (!config.apiUrl) {\r\n//                             console.error('[LPB] Missing apiUrl');\r\n//                             return;\r\n//                         }\r\n//                         console.log('[LPB] Form submit to:', config.apiUrl);\r\n//                         break;\r\n//\r\n//                     default:\r\n//                         console.warn('[LPB] Unknown event type:', type);\r\n//                 }\r\n//             } catch (error) {\r\n//                 console.error('[LPB] Event handling error:', error);\r\n//                 alert('C√≥ l·ªói x·∫£y ra: ' + error.message);\r\n//             }\r\n//         };\r\n//\r\n//         // ========== AUTO-BIND EVENTS ==========\r\n//         const eventsConfig = ${JSON.stringify(events)};\r\n//\r\n//         document.addEventListener('DOMContentLoaded', function() {\r\n//             console.log('[LPB] Initializing events...', eventsConfig.length);\r\n//\r\n//             eventsConfig.forEach(config => {\r\n//                 const element = document.getElementById(config.elementId);\r\n//                 if (!element) {\r\n//                     console.warn('[LPB] Element not found:', config.elementId);\r\n//                     return;\r\n//                 }\r\n//\r\n//                 // Bind onClick\r\n//                 if (config.events.onClick && config.events.onClick.type !== 'none') {\r\n//                     element.addEventListener('click', function(e) {\r\n//                         e.preventDefault();\r\n//                         e.stopPropagation();\r\n//                         LPB.handleEvent(config.events.onClick);\r\n//                     });\r\n//\r\n//                     element.style.cursor = 'pointer';\r\n//                 }\r\n//\r\n//                 // Bind hover prefetch\r\n//                 if (config.events.onClick?.params?.apiConfig?.preload) {\r\n//                     element.addEventListener('mouseenter', function() {\r\n//                         LPB.api.fetch(\r\n//                             config.events.onClick.params.apiConfig.endpoint,\r\n//                             config.events.onClick.params.apiConfig\r\n//                         ).catch(() => {}); // Silent prefetch\r\n//                     }, { once: true });\r\n//                 }\r\n//\r\n//                 // Bind onHover effects\r\n//                 if (config.events.onHover) {\r\n//                     const hoverClass = config.events.onHover.className;\r\n//                     if (hoverClass) {\r\n//                         element.addEventListener('mouseenter', function() {\r\n//                             this.classList.add(hoverClass);\r\n//                         });\r\n//                         element.addEventListener('mouseleave', function() {\r\n//                             this.classList.remove(hoverClass);\r\n//                         });\r\n//                     }\r\n//                 }\r\n//             });\r\n//\r\n//             console.log('[LPB] Events initialized!');\r\n//         });\r\n//\r\n//         // ========== ESC TO CLOSE POPUP ==========\r\n//         document.addEventListener('keydown', function(e) {\r\n//             if (e.key === 'Escape') {\r\n//                 LPB.popups.closeAll();\r\n//             }\r\n//         });\r\n//\r\n//         console.log('[LPB] Runtime loaded');\r\n//     })();\r\n//     `;\r\n// };\r\n//\r\n// /**\r\n//  * Extract t·∫•t c·∫£ events t·ª´ pageData elements\r\n//  * @param {Object} pageData - Page data object\r\n//  * @returns {Array} - Array of event configs\r\n//  */\r\n// const extractEvents = (pageData) => {\r\n//     const events = [];\r\n//\r\n//     const processElement = (element, parentId = null) => {\r\n//         const elementId = element.id;\r\n//\r\n//         // Check element events\r\n//         if (element.componentData?.events) {\r\n//             events.push({\r\n//                 elementId: elementId,\r\n//                 events: element.componentData.events,\r\n//                 type: element.type,\r\n//                 parentId: parentId\r\n//             });\r\n//         }\r\n//\r\n//         // Check children events\r\n//         if (Array.isArray(element.children)) {\r\n//             element.children.forEach(child => {\r\n//                 if (child.componentData?.events) {\r\n//                     events.push({\r\n//                         elementId: child.id,\r\n//                         events: child.componentData.events,\r\n//                         type: child.type,\r\n//                         parentId: elementId\r\n//                     });\r\n//                 }\r\n//\r\n//                 // Recursive cho nested children\r\n//                 if (Array.isArray(child.children)) {\r\n//                     processElement(child, child.id);\r\n//                 }\r\n//             });\r\n//         }\r\n//     };\r\n//\r\n//     pageData.elements.forEach(element => {\r\n//         processElement(element);\r\n//     });\r\n//\r\n//     return events;\r\n// };\r\n//\r\n// /**\r\n//  * Render t·∫•t c·∫£ popups th√†nh HTML\r\n//  * @param {Array} popups - Array of popup elements\r\n//  * @returns {string} - HTML string\r\n//  */\r\n// const renderPopupsHTML = (popups) => {\r\n//     return popups.map(popup => {\r\n//         const { id, componentData = {}, styles = {}, size = {}, children = [] } = popup;\r\n//\r\n//         // Render children content\r\n//         const childrenHTML = children.map(child =>\r\n//             renderElementHTML(child, true)\r\n//         ).join('');\r\n//\r\n//         return `\r\n//             <div\r\n//                 id=\"${id}\"\r\n//                 class=\"lpb-popup\"\r\n//                 data-element-id=\"${id}\"\r\n//                 style=\"display:none;\"\r\n//             >\r\n//                 <!-- Overlay -->\r\n//                 <div\r\n//                     class=\"lpb-popup-overlay\"\r\n//                     onclick=\"LPB.popups.close('${id}')\"\r\n//                 ></div>\r\n//\r\n//                 <!-- Popup Container -->\r\n//                 <div\r\n//                     class=\"lpb-popup-container\"\r\n//                     style=\"\r\n//                         width: ${size.width || 600}px;\r\n//                         max-width: 90vw;\r\n//                         min-height: ${size.height || 400}px;\r\n//                         background: ${styles.background || componentData.background || 'rgba(255, 255, 255, 0.95)'};\r\n//                         border-radius: ${styles.borderRadius || componentData.borderRadius || '12px'};\r\n//                         box-shadow: 0 8px 32px rgba(0, 0, 0, 0.25);\r\n//                     \"\r\n//                 >\r\n//                     <!-- Header -->\r\n//                     <div class=\"lpb-popup-header\">\r\n//                         <h3 style=\"margin:0; font-size:16px; font-weight:600; color:#111827;\">\r\n//                             ${componentData.title || 'Popup Title'}\r\n//                         </h3>\r\n//                         <button\r\n//                             class=\"lpb-popup-close\"\r\n//                             onclick=\"LPB.popups.close('${id}')\"\r\n//                             aria-label=\"Close popup\"\r\n//                         >\r\n//                             ‚úï\r\n//                         </button>\r\n//                     </div>\r\n//\r\n//                     <!-- Body -->\r\n//                     <div class=\"lpb-popup-body\" style=\"padding: ${componentData.padding || '20px'};\">\r\n//                         ${childrenHTML || `<p style=\"color:#6b7280;\">${componentData.content || 'Popup content'}</p>`}\r\n//                     </div>\r\n//                 </div>\r\n//             </div>\r\n//         `;\r\n//     }).join('\\n');\r\n// };\r\n//\r\n// /**\r\n//  * Render m·ªôt element th√†nh HTML v·ªõi proper ID\r\n//  * @param {Object} element - Element object\r\n//  * @param {boolean} isChild - Whether this is a child element\r\n//  * @returns {string} - HTML string\r\n//  */\r\n// const renderElementHTML = (element, isChild = false) => {\r\n//     const { id, type, componentData = {}, styles = {}, size = {}, position = {}, children = [] } = element;\r\n//\r\n//     // Convert styles object to inline CSS\r\n//     const inlineStyles = Object.entries(styles)\r\n//         .filter(([key]) => !key.startsWith(':') && !key.startsWith('@'))\r\n//         .map(([key, value]) => {\r\n//             const kebabKey = key.replace(/[A-Z]/g, m => `-${m.toLowerCase()}`);\r\n//             return `${kebabKey}:${value}`;\r\n//         })\r\n//         .join(';');\r\n//\r\n//     // Base attributes\r\n//     const baseAttrs = `\r\n//         id=\"${id}\"\r\n//         data-element-id=\"${id}\"\r\n//         data-type=\"${type}\"\r\n//         class=\"lpb-element lpb-${type}\"\r\n//     `;\r\n//\r\n//     // Position styles cho child elements\r\n//     const positionStyles = isChild ? `\r\n//         position: absolute;\r\n//         left: ${position.desktop?.x || 0}px;\r\n//         top: ${position.desktop?.y || 0}px;\r\n//         width: ${size.width || 200}px;\r\n//         height: ${size.height || 50}px;\r\n//     ` : '';\r\n//\r\n//     // Render based on type\r\n//     switch(type) {\r\n//         case 'section':\r\n//             return renderSectionHTML(element);\r\n//\r\n//         case 'button':\r\n//             return `\r\n//                 <button\r\n//                     ${baseAttrs}\r\n//                     style=\"${inlineStyles}; ${positionStyles}\"\r\n//                 >\r\n//                     ${componentData.content || 'Button'}\r\n//                 </button>\r\n//             `;\r\n//\r\n//         case 'heading':\r\n//             const HeadingTag = componentData.level || 'h2';\r\n//             return `\r\n//                 <${HeadingTag}\r\n//                     ${baseAttrs}\r\n//                     style=\"${inlineStyles}; ${positionStyles}\"\r\n//                 >\r\n//                     ${componentData.content || 'Heading'}\r\n//                 </${HeadingTag}>\r\n//             `;\r\n//\r\n//         case 'paragraph':\r\n//             return `\r\n//                 <p\r\n//                     ${baseAttrs}\r\n//                     style=\"${inlineStyles}; ${positionStyles}\"\r\n//                 >\r\n//                     ${componentData.content || 'Paragraph'}\r\n//                 </p>\r\n//             `;\r\n//\r\n//         case 'image':\r\n//             return `\r\n//                 <img\r\n//                     ${baseAttrs}\r\n//                     src=\"${componentData.src || componentData.imageUrl || 'https://via.placeholder.com/150'}\"\r\n//                     alt=\"${componentData.alt || 'Image'}\"\r\n//                     style=\"${inlineStyles}; ${positionStyles}\"\r\n//                 />\r\n//             `;\r\n//\r\n//         case 'icon':\r\n//             const isSvg = componentData.icon?.startsWith('<svg');\r\n//             return `\r\n//                 <div\r\n//                     ${baseAttrs}\r\n//                     style=\"${inlineStyles}; ${positionStyles}\"\r\n//                     title=\"${componentData.title || ''}\"\r\n//                 >\r\n//                     ${componentData.imageUrl\r\n//                 ? `<img src=\"${componentData.imageUrl}\" alt=\"${componentData.title || 'Icon'}\" style=\"width:100%;height:100%;object-fit:contain;\" />`\r\n//                 : isSvg\r\n//                     ? componentData.icon\r\n//                     : componentData.icon\r\n//                         ? `<i class=\"${componentData.icon}\"></i>`\r\n//                         : 'üì¶'\r\n//             }\r\n//                 </div>\r\n//             `;\r\n//\r\n//         case 'gallery':\r\n//             return renderGalleryHTML(element, isChild);\r\n//\r\n//         default:\r\n//             return `\r\n//                 <div\r\n//                     ${baseAttrs}\r\n//                     style=\"${inlineStyles}; ${positionStyles}\"\r\n//                 >\r\n//                     ${componentData.content || type}\r\n//                 </div>\r\n//             `;\r\n//     }\r\n// };\r\n//\r\n// /**\r\n//  * Render gallery element\r\n//  */\r\n// const renderGalleryHTML = (element, isChild) => {\r\n//     const { id, componentData = {}, styles = {}, size = {}, position = {} } = element;\r\n//\r\n//     const positionStyles = isChild ? `\r\n//         position: absolute;\r\n//         left: ${position.desktop?.x || 0}px;\r\n//         top: ${position.desktop?.y || 0}px;\r\n//     ` : '';\r\n//\r\n//     const images = componentData.images || [];\r\n//\r\n//     return `\r\n//         <div\r\n//             id=\"${id}\"\r\n//             data-element-id=\"${id}\"\r\n//             data-type=\"gallery\"\r\n//             class=\"lpb-element lpb-gallery\"\r\n//             style=\"${positionStyles} width: ${size.width || 380}px; height: ${size.height || 300}px;\"\r\n//         >\r\n//             <div style=\"\r\n//                 display: ${styles.display || 'grid'};\r\n//                 grid-template-columns: ${styles.gridTemplateColumns || 'repeat(auto-fill, minmax(150px, 1fr))'};\r\n//                 gap: ${styles.gap || '10px'};\r\n//                 width: 100%;\r\n//                 height: 100%;\r\n//             \">\r\n//                 ${images.map((imageUrl, index) => `\r\n//                     <div style=\"\r\n//                         position: relative;\r\n//                         overflow: hidden;\r\n//                         border-radius: ${styles.borderRadius || '8px'};\r\n//                         aspect-ratio: 1 / 1;\r\n//                     \">\r\n//                         <img\r\n//                             src=\"${imageUrl || 'https://via.placeholder.com/150'}\"\r\n//                             alt=\"Gallery ${index + 1}\"\r\n//                             style=\"\r\n//                                 width: 100%;\r\n//                                 height: 100%;\r\n//                                 object-fit: ${styles.objectFit || 'cover'};\r\n//                                 object-position: ${styles.objectPosition || 'center'};\r\n//                             \"\r\n//                             loading=\"lazy\"\r\n//                         />\r\n//                     </div>\r\n//                 `).join('')}\r\n//                 ${images.length === 0 ? `\r\n//                     <div style=\"\r\n//                         display: flex;\r\n//                         flex-direction: column;\r\n//                         align-items: center;\r\n//                         justify-content: center;\r\n//                         color: #9ca3af;\r\n//                         text-align: center;\r\n//                         grid-column: 1 / -1;\r\n//                     \">\r\n//                         <i class=\"fas fa-image\" style=\"font-size: 48px; margin-bottom: 8px;\"></i>\r\n//                         <p>Empty gallery</p>\r\n//                     </div>\r\n//                 ` : ''}\r\n//             </div>\r\n//         </div>\r\n//     `;\r\n// };\r\n//\r\n// /**\r\n//  * Render section v·ªõi children\r\n//  */\r\n// const renderSectionHTML = (section) => {\r\n//     const { id, componentData = {}, styles = {}, size = {}, position = {}, children = [] } = section;\r\n//\r\n//     // Render children\r\n//     const childrenHTML = children.map(child =>\r\n//         renderElementHTML(child, true)\r\n//     ).join('\\n');\r\n//\r\n//     return `\r\n//         <section\r\n//             id=\"${id}\"\r\n//             data-element-id=\"${id}\"\r\n//             class=\"lpb-section ladi-section\"\r\n//             style=\"\r\n//                 position: absolute;\r\n//                 top: ${position.desktop?.y || 0}px;\r\n//                 left: 50%;\r\n//                 transform: translateX(-50%);\r\n//                 width: 1200px;\r\n//                 height: ${size.height || 400}px;\r\n//             \"\r\n//         >\r\n//             <!-- Background -->\r\n//             <div class=\"ladi-section-background\" style=\"\r\n//                 position: absolute;\r\n//                 inset: 0;\r\n//                 z-index: 0;\r\n//                 background-color: ${componentData.backgroundColor || styles.backgroundColor || 'transparent'};\r\n//                 background-image: ${componentData.backgroundImage ? `url(${componentData.backgroundImage})` : 'none'};\r\n//                 background-size: cover;\r\n//                 background-position: center;\r\n//             \"></div>\r\n//\r\n//             <!-- Overlay -->\r\n//             <div class=\"ladi-overlay\" style=\"\r\n//                 position: absolute;\r\n//                 inset: 0;\r\n//                 z-index: 0;\r\n//                 background-color: ${componentData.overlayColor || 'transparent'};\r\n//                 opacity: ${componentData.overlayOpacity || 0};\r\n//             \"></div>\r\n//\r\n//             <!-- Container -->\r\n//             <div class=\"ladi-container\" style=\"\r\n//                 position: relative;\r\n//                 z-index: 1;\r\n//                 padding: ${componentData.padding || styles.padding || '20px'};\r\n//                 width: 100%;\r\n//                 height: 100%;\r\n//             \">\r\n//                 ${childrenHTML}\r\n//             </div>\r\n//         </section>\r\n//     `;\r\n// };\r\n//\r\n// /**\r\n//  * Generate CSS t·ª´ pageData\r\n//  */\r\n// const generateCSS = (pageData) => {\r\n//     let css = `\r\n//         * {\r\n//             box-sizing: border-box;\r\n//         }\r\n//\r\n//         body {\r\n//             margin: 0;\r\n//             padding: 0;\r\n//         }\r\n//\r\n//         .lpb-element {\r\n//             transition: all 0.3s ease;\r\n//         }\r\n//     `;\r\n//\r\n//     // Extract pseudo-classes v√† animations t·ª´ elements\r\n//     pageData.elements.forEach(element => {\r\n//         const { id, styles = {} } = element;\r\n//\r\n//         // Process hover states\r\n//         if (styles[':hover']) {\r\n//             css += `\\n#${id}:hover {`;\r\n//             Object.entries(styles[':hover']).forEach(([key, value]) => {\r\n//                 const kebabKey = key.replace(/[A-Z]/g, m => `-${m.toLowerCase()}`);\r\n//                 css += `${kebabKey}:${value};`;\r\n//             });\r\n//             css += `}`;\r\n//         }\r\n//\r\n//         // Process keyframes\r\n//         Object.entries(styles).forEach(([key, value]) => {\r\n//             if (key.startsWith('@keyframes')) {\r\n//                 css += `\\n${key} {`;\r\n//                 Object.entries(value).forEach(([frame, props]) => {\r\n//                     css += `${frame} {`;\r\n//                     Object.entries(props).forEach(([prop, val]) => {\r\n//                         const kebabProp = prop.replace(/[A-Z]/g, m => `-${m.toLowerCase()}`);\r\n//                         css += `${kebabProp}:${val};`;\r\n//                     });\r\n//                     css += `}`;\r\n//                 });\r\n//                 css += `}`;\r\n//             }\r\n//         });\r\n//\r\n//         // Process children\r\n//         if (element.children) {\r\n//             element.children.forEach(child => {\r\n//                 if (child.styles?.[':hover']) {\r\n//                     css += `\\n#${child.id}:hover {`;\r\n//                     Object.entries(child.styles[':hover']).forEach(([key, value]) => {\r\n//                         const kebabKey = key.replace(/[A-Z]/g, m => `-${m.toLowerCase()}`);\r\n//                         css += `${kebabKey}:${value};`;\r\n//                     });\r\n//                     css += `}`;\r\n//                 }\r\n//             });\r\n//         }\r\n//     });\r\n//\r\n//     return css;\r\n// };\r\n//\r\n// /**\r\n//  * Render to√†n b·ªô pageData th√†nh static HTML v·ªõi embedded runtime\r\n//  * @param {Object} pageData - Page data\r\n//  * @returns {string} - Complete HTML document\r\n//  */\r\n// export const renderStaticHTML = (pageData) => {\r\n//     // Extract components\r\n//     const popups = pageData.elements.filter(el => el.type === 'popup');\r\n//     const sections = pageData.elements.filter(el => el.type === 'section');\r\n//     const events = extractEvents(pageData);\r\n//\r\n//     // Generate HTML parts\r\n//     const sectionsHTML = sections.map(section => renderSectionHTML(section)).join('\\n');\r\n//     const popupsHTML = renderPopupsHTML(popups);\r\n//     const runtimeScript = generateEventRuntime(events, popups);\r\n//\r\n//     // Generate CSS\r\n//     const cssContent = generateCSS(pageData);\r\n//\r\n//     // Combine everything\r\n//     return `<!DOCTYPE html>\r\n// <html lang=\"vi\">\r\n// <head>\r\n//     <meta charset=\"UTF-8\">\r\n//     <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n//     <meta name=\"description\" content=\"${pageData.meta?.description || 'Landing page generated by LandingHub'}\">\r\n//     <title>${pageData.meta?.title || 'Landing Page'}</title>\r\n//\r\n//     <!-- Font Awesome -->\r\n//     <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css\" crossorigin=\"anonymous\" referrerpolicy=\"no-referrer\" />\r\n//\r\n//     <!-- Styles -->\r\n//     <style>\r\n//         ${cssContent}\r\n//\r\n//         /* Popup Styles */\r\n//         .lpb-popup {\r\n//             position: fixed;\r\n//             inset: 0;\r\n//             z-index: 9999;\r\n//             display: none;\r\n//             align-items: center;\r\n//             justify-content: center;\r\n//         }\r\n//\r\n//         .lpb-popup.lpb-popup-active {\r\n//             display: flex;\r\n//         }\r\n//\r\n//         .lpb-popup-overlay {\r\n//             position: absolute;\r\n//             inset: 0;\r\n//             background: rgba(0, 0, 0, 0.5);\r\n//             cursor: pointer;\r\n//         }\r\n//\r\n//         .lpb-popup-container {\r\n//             position: relative;\r\n//             z-index: 1;\r\n//             background: white;\r\n//             border-radius: 12px;\r\n//             max-height: 90vh;\r\n//             overflow-y: auto;\r\n//             box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);\r\n//         }\r\n//\r\n//         .lpb-popup-header {\r\n//             display: flex;\r\n//             justify-content: space-between;\r\n//             align-items: center;\r\n//             padding: 16px 20px;\r\n//             border-bottom: 1px solid #e5e7eb;\r\n//             background: linear-gradient(to bottom, #f9fafb, #ffffff);\r\n//         }\r\n//\r\n//         .lpb-popup-close {\r\n//             width: 28px;\r\n//             height: 28px;\r\n//             border: none;\r\n//             background: transparent;\r\n//             cursor: pointer;\r\n//             border-radius: 6px;\r\n//             display: flex;\r\n//             align-items: center;\r\n//             justify-content: center;\r\n//             transition: all 0.15s ease;\r\n//             color: #6b7280;\r\n//             font-size: 18px;\r\n//             font-weight: bold;\r\n//         }\r\n//\r\n//         .lpb-popup-close:hover {\r\n//             background: #f3f4f6;\r\n//             color: #111827;\r\n//         }\r\n//\r\n//         .lpb-popup-body {\r\n//             padding: 20px;\r\n//         }\r\n//\r\n//         /* Loading Spinner */\r\n//         .lpb-spinner {\r\n//             border: 3px solid #f3f3f3;\r\n//             border-top: 3px solid #3b82f6;\r\n//             border-radius: 50%;\r\n//             width: 40px;\r\n//             height: 40px;\r\n//             animation: spin 1s linear infinite;\r\n//             margin: 0 auto;\r\n//         }\r\n//\r\n//         @keyframes spin {\r\n//             0% { transform: rotate(0deg); }\r\n//             100% { transform: rotate(360deg); }\r\n//         }\r\n//\r\n//         /* Responsive */\r\n//         @media (max-width: 768px) {\r\n//             .lpb-section {\r\n//                 width: 100% !important;\r\n//             }\r\n//\r\n//             .lpb-popup-container {\r\n//                 width: 90% !important;\r\n//                 max-width: 90vw !important;\r\n//             }\r\n//         }\r\n//     </style>\r\n// </head>\r\n// <body style=\"margin: 0; padding: 0; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\">\r\n//     <!-- Canvas -->\r\n//     <div id=\"lpb-canvas\" style=\"\r\n//         position: relative;\r\n//         min-height: 100vh;\r\n//         background: ${pageData.canvas?.background || '#ffffff'};\r\n//     \">\r\n//         ${sectionsHTML}\r\n//     </div>\r\n//\r\n//     <!-- Popups -->\r\n//     ${popupsHTML}\r\n//\r\n//     <!-- Runtime Script -->\r\n//     <script>\r\n//         ${runtimeScript}\r\n//     </script>\r\n//\r\n//     <!-- Google Analytics (optional) -->\r\n//     ${pageData.analytics?.googleAnalyticsId ? `\r\n//     <script async src=\"https://www.googletagmanager.com/gtag/js?id=${pageData.analytics.googleAnalyticsId}\"></script>\r\n//     <script>\r\n//         window.dataLayer = window.dataLayer || [];\r\n//         function gtag(){dataLayer.push(arguments);}\r\n//         gtag('js', new Date());\r\n//         gtag('config', '${pageData.analytics.googleAnalyticsId}');\r\n//     </script>\r\n//     ` : ''}\r\n// </body>\r\n// </html>`;\r\n// };\r\n//\r\n// /**\r\n//  * Parse HTML string th√†nh pageData structure\r\n//  */\r\n// export const parseHTMLToPageData = (htmlString) => {\r\n//     const parser = new DOMParser();\r\n//     const doc = parser.parseFromString(htmlString, 'text/html');\r\n//\r\n//     const pageData = {\r\n//         canvas: {\r\n//             width: 1200,\r\n//             height: 'auto',\r\n//             background: '#ffffff'\r\n//         },\r\n//         elements: [],\r\n//         meta: {}\r\n//     };\r\n//\r\n//     try {\r\n//         // Parse canvas\r\n//         const canvasEl = doc.getElementById('lpb-canvas');\r\n//         if (canvasEl) {\r\n//             pageData.canvas.background = canvasEl.style.background || '#ffffff';\r\n//         }\r\n//\r\n//         // Parse meta\r\n//         const titleEl = doc.querySelector('title');\r\n//         if (titleEl) {\r\n//             pageData.meta.title = titleEl.textContent;\r\n//         }\r\n//\r\n//         const descEl = doc.querySelector('meta[name=\"description\"]');\r\n//         if (descEl) {\r\n//             pageData.meta.description = descEl.getAttribute('content');\r\n//         }\r\n//\r\n//         // Parse sections\r\n//         const sections = doc.querySelectorAll('.lpb-section');\r\n//         sections.forEach(sectionEl => {\r\n//             const section = parseSectionElement(sectionEl);\r\n//             if (section) {\r\n//                 pageData.elements.push(section);\r\n//             }\r\n//         });\r\n//\r\n//         // Parse popups\r\n//         const popups = doc.querySelectorAll('.lpb-popup');\r\n//         popups.forEach(popupEl => {\r\n//             const popup = parsePopupElement(popupEl);\r\n//             if (popup) {\r\n//                 pageData.elements.push(popup);\r\n//             }\r\n//         });\r\n//\r\n//         // Parse events t·ª´ script\r\n//         const scripts = doc.querySelectorAll('script');\r\n//         scripts.forEach(script => {\r\n//             const content = script.textContent || script.innerHTML;\r\n//             const eventsMatch = content.match(/const eventsConfig = (\\[[\\s\\S]*?\\]);/);\r\n//             if (eventsMatch) {\r\n//                 try {\r\n//                     const events = JSON.parse(eventsMatch[1]);\r\n//                     events.forEach(eventConfig => {\r\n//                         const element = findElementById(pageData.elements, eventConfig.elementId);\r\n//                         if (element) {\r\n//                             if (!element.componentData) {\r\n//                                 element.componentData = {};\r\n//                             }\r\n//                             element.componentData.events = eventConfig.events;\r\n//                         }\r\n//                     });\r\n//                 } catch (e) {\r\n//                     console.warn('Cannot parse events config:', e);\r\n//                 }\r\n//             }\r\n//         });\r\n//\r\n//         console.log('[parseHTMLToPageData] Parsed successfully:', pageData.elements.length, 'elements');\r\n//         return pageData;\r\n//\r\n//     } catch (error) {\r\n//         console.error('[parseHTMLToPageData] Parse error:', error);\r\n//         return {\r\n//             canvas: { width: 1200, height: 'auto', background: '#ffffff' },\r\n//             elements: [],\r\n//             meta: {}\r\n//         };\r\n//     }\r\n// };\r\n//\r\n// // ==================== HELPER FUNCTIONS ====================\r\n//\r\n// const parseSectionElement = (sectionEl) => {\r\n//     const id = sectionEl.id || `section-${Date.now()}`;\r\n//     const topMatch = sectionEl.style.top?.match(/(\\d+)px/);\r\n//     const top = topMatch ? parseInt(topMatch[1]) : 0;\r\n//     const widthMatch = sectionEl.style.width?.match(/(\\d+)px/);\r\n//     const heightMatch = sectionEl.style.height?.match(/(\\d+)px/);\r\n//     const width = widthMatch ? parseInt(widthMatch[1]) : 1200;\r\n//     const height = heightMatch ? parseInt(heightMatch[1]) : 400;\r\n//\r\n//     const bgEl = sectionEl.querySelector('.ladi-section-background');\r\n//     const overlayEl = sectionEl.querySelector('.ladi-overlay');\r\n//     const containerEl = sectionEl.querySelector('.ladi-container');\r\n//\r\n//     const componentData = { structure: 'ladi-standard' };\r\n//\r\n//     if (bgEl) {\r\n//         const bgStyle = bgEl.style;\r\n//         componentData.backgroundColor = bgStyle.backgroundColor || 'transparent';\r\n//         const bgImageMatch = bgStyle.backgroundImage?.match(/url\\(['\"]?(.+?)['\"]?\\)/);\r\n//         if (bgImageMatch) {\r\n//             componentData.backgroundImage = bgImageMatch[1];\r\n//             componentData.backgroundType = 'image';\r\n//         } else if (componentData.backgroundColor !== 'transparent') {\r\n//             componentData.backgroundType = 'color';\r\n//         }\r\n//         componentData.backgroundPosition = bgStyle.backgroundPosition || 'center';\r\n//     }\r\n//\r\n//     if (overlayEl) {\r\n//         componentData.overlayColor = overlayEl.style.backgroundColor || 'transparent';\r\n//         componentData.overlayOpacity = parseFloat(overlayEl.style.opacity) || 0;\r\n//     }\r\n//\r\n//     const styles = parseInlineStyles(sectionEl.style);\r\n//\r\n//     if (containerEl) {\r\n//         componentData.padding = containerEl.style.padding || '20px';\r\n//     }\r\n//\r\n//     const children = [];\r\n//     if (containerEl) {\r\n//         const childElements = containerEl.querySelectorAll('.lpb-element[data-element-id]');\r\n//         childElements.forEach(childEl => {\r\n//             if (childEl.parentElement === containerEl || childEl.parentElement?.parentElement === containerEl) {\r\n//                 const child = parseChildElement(childEl);\r\n//                 if (child) {\r\n//                     children.push(child);\r\n//                 }\r\n//             }\r\n//         });\r\n//     }\r\n//\r\n//     return {\r\n//         id,\r\n//         type: 'section',\r\n//         componentData,\r\n//         position: {\r\n//             desktop: { x: 0, y: top },\r\n//             tablet: { x: 0, y: top },\r\n//             mobile: { x: 0, y: top }\r\n//         },\r\n//         size: { width, height },\r\n//         styles,\r\n//         children,\r\n//         visible: true,\r\n//         locked: false\r\n//     };\r\n// };\r\n//\r\n// const parsePopupElement = (popupEl) => {\r\n//     const id = popupEl.id || `popup-${Date.now()}`;\r\n//     const containerEl = popupEl.querySelector('.lpb-popup-container');\r\n//     if (!containerEl) return null;\r\n//\r\n//     const widthMatch = containerEl.style.width?.match(/(\\d+)px/);\r\n//     const minHeightMatch = containerEl.style.minHeight?.match(/(\\d+)px/);\r\n//     const width = widthMatch ? parseInt(widthMatch[1]) : 600;\r\n//     const height = minHeightMatch ? parseInt(minHeightMatch[1]) : 400;\r\n//\r\n//     const headerEl = popupEl.querySelector('.lpb-popup-header h3');\r\n//     const bodyEl = popupEl.querySelector('.lpb-popup-body');\r\n//\r\n//     const componentData = {\r\n//         title: headerEl?.textContent || 'Popup',\r\n//         background: containerEl.style.background || 'rgba(255, 255, 255, 0.95)',\r\n//         borderRadius: containerEl.style.borderRadius || '12px',\r\n//         padding: bodyEl?.style.padding || '20px'\r\n//     };\r\n//\r\n//     const styles = parseInlineStyles(containerEl.style);\r\n//\r\n//     const children = [];\r\n//     if (bodyEl) {\r\n//         const childElements = bodyEl.querySelectorAll('.lpb-element[data-element-id]');\r\n//         childElements.forEach(childEl => {\r\n//             const child = parseChildElement(childEl);\r\n//             if (child) {\r\n//                 children.push(child);\r\n//             }\r\n//         });\r\n//     }\r\n//\r\n//     return {\r\n//         id,\r\n//         type: 'popup',\r\n//         componentData,\r\n//         position: {\r\n//             desktop: { x: 0, y: 0 },\r\n//             tablet: { x: 0, y: 0 },\r\n//             mobile: { x: 0, y: 0 }\r\n//         },\r\n//         size: { width, height },\r\n//         styles,\r\n//         children,\r\n//         visible: true,\r\n//         locked: false\r\n//     };\r\n// };\r\n//\r\n// const parseChildElement = (element) => {\r\n//     const id = element.id || element.getAttribute('data-element-id') || `element-${Date.now()}`;\r\n//     const type = element.getAttribute('data-type') || inferTypeFromElement(element);\r\n//\r\n//     const leftMatch = element.style.left?.match(/(\\d+)px/);\r\n//     const topMatch = element.style.top?.match(/(\\d+)px/);\r\n//     const left = leftMatch ? parseInt(leftMatch[1]) : 0;\r\n//     const top = topMatch ? parseInt(topMatch[1]) : 0;\r\n//\r\n//     const widthMatch = element.style.width?.match(/(\\d+)px/);\r\n//     const heightMatch = element.style.height?.match(/(\\d+)px/);\r\n//     const width = widthMatch ? parseInt(widthMatch[1]) : (type === 'icon' ? 50 : 200);\r\n//     const height = heightMatch ? parseInt(heightMatch[1]) : (type === 'icon' ? 50 : 50);\r\n//\r\n//     const styles = parseInlineStyles(element.style);\r\n//     const componentData = parseComponentData(element, type);\r\n//\r\n//     return {\r\n//         id,\r\n//         type,\r\n//         componentData,\r\n//         position: {\r\n//             desktop: { x: left, y: top },\r\n//             tablet: { x: left, y: top },\r\n//             mobile: { x: left, y: top }\r\n//         },\r\n//         size: { width, height },\r\n//         styles,\r\n//         children: [],\r\n//         visible: true,\r\n//         locked: false\r\n//     };\r\n// };\r\n//\r\n// const parseComponentData = (element, type) => {\r\n//     const componentData = {};\r\n//\r\n//     switch (type) {\r\n//         case 'button':\r\n//             componentData.content = element.textContent || 'Button';\r\n//             componentData.background = element.style.background;\r\n//             componentData.color = element.style.color;\r\n//             componentData.borderRadius = element.style.borderRadius;\r\n//             componentData.border = element.style.border;\r\n//             componentData.fontSize = element.style.fontSize;\r\n//             componentData.fontWeight = element.style.fontWeight;\r\n//             break;\r\n//\r\n//         case 'heading':\r\n//             componentData.content = element.textContent || 'Heading';\r\n//             componentData.level = element.tagName.toLowerCase();\r\n//             componentData.fontSize = element.style.fontSize;\r\n//             componentData.color = element.style.color;\r\n//             componentData.fontWeight = element.style.fontWeight;\r\n//             componentData.textAlign = element.style.textAlign;\r\n//             break;\r\n//\r\n//         case 'paragraph':\r\n//             componentData.content = element.textContent || 'Paragraph';\r\n//             componentData.fontSize = element.style.fontSize;\r\n//             componentData.color = element.style.color;\r\n//             componentData.fontWeight = element.style.fontWeight;\r\n//             componentData.lineHeight = element.style.lineHeight;\r\n//             componentData.textAlign = element.style.textAlign;\r\n//             break;\r\n//\r\n//         case 'image':\r\n//             componentData.src = element.getAttribute('src');\r\n//             componentData.alt = element.getAttribute('alt');\r\n//             componentData.imageUrl = element.getAttribute('src');\r\n//             break;\r\n//\r\n//         case 'icon':\r\n//             const img = element.querySelector('img');\r\n//             const iconEl = element.querySelector('i');\r\n//             const svgEl = element.querySelector('svg');\r\n//\r\n//             if (img) {\r\n//                 componentData.imageUrl = img.getAttribute('src');\r\n//             } else if (svgEl) {\r\n//                 componentData.icon = svgEl.outerHTML;\r\n//             } else if (iconEl) {\r\n//                 componentData.icon = iconEl.className;\r\n//             }\r\n//             componentData.title = element.getAttribute('title') || '';\r\n//             break;\r\n//\r\n//         case 'gallery':\r\n//             const images = Array.from(element.querySelectorAll('img')).map(img => img.src);\r\n//             componentData.images = images;\r\n//             break;\r\n//\r\n//         default:\r\n//             componentData.content = element.textContent || '';\r\n//             break;\r\n//     }\r\n//\r\n//     return componentData;\r\n// };\r\n//\r\n// const parseInlineStyles = (styleObj) => {\r\n//     const styles = {};\r\n//     const importantProps = [\r\n//         'background', 'backgroundColor', 'backgroundImage', 'backgroundSize', 'backgroundPosition',\r\n//         'color', 'fontSize', 'fontWeight', 'fontFamily',\r\n//         'border', 'borderRadius', 'boxShadow', 'textShadow',\r\n//         'padding', 'margin',\r\n//         'display', 'alignItems', 'justifyContent', 'flexDirection', 'gap',\r\n//         'textAlign', 'lineHeight', 'textTransform',\r\n//         'cursor', 'transition', 'animation',\r\n//         'zIndex', 'opacity'\r\n//     ];\r\n//\r\n//     importantProps.forEach(prop => {\r\n//         if (styleObj[prop]) {\r\n//             styles[prop] = styleObj[prop];\r\n//         }\r\n//     });\r\n//\r\n//     return styles;\r\n// };\r\n//\r\n// const inferTypeFromElement = (element) => {\r\n//     const tagName = element.tagName.toLowerCase();\r\n//     const classList = element.classList;\r\n//\r\n//     if (classList.contains('lpb-button') || tagName === 'button') return 'button';\r\n//     if (classList.contains('lpb-icon')) return 'icon';\r\n//     if (classList.contains('lpb-gallery')) return 'gallery';\r\n//     if (classList.contains('lpb-section')) return 'section';\r\n//     if (classList.contains('lpb-popup')) return 'popup';\r\n//\r\n//     if (tagName.match(/^h[1-6]$/)) return 'heading';\r\n//     if (tagName === 'p') return 'paragraph';\r\n//     if (tagName === 'img') return 'image';\r\n//     if (tagName === 'hr') return 'divider';\r\n//     if (tagName === 'form') return 'form';\r\n//     if (tagName === 'ul' || tagName === 'ol') return 'list';\r\n//\r\n//     return 'container';\r\n// };\r\n//\r\n// const findElementById = (elements, id) => {\r\n//     for (const element of elements) {\r\n//         if (element.id === id) return element;\r\n//\r\n//         if (element.children && element.children.length > 0) {\r\n//             const found = findElementById(element.children, id);\r\n//             if (found) return found;\r\n//         }\r\n//     }\r\n//     return null;\r\n// };\r\n/**\r\n * Parse HTML string th√†nh pageData structure\r\n * PRIORITY 1: Extract embedded pageData t·ª´ <script id=\"lpb-page-data\">\r\n * PRIORITY 2: Parse DOM structure (fallback)\r\n */\r\nexport const parseHTMLToPageData = (htmlString) => {\r\n    console.log('üîç parseHTMLToPageData called, HTML length:', htmlString?.length);\r\n\r\n    if (!htmlString || typeof htmlString !== 'string') {\r\n        console.warn('‚ö†Ô∏è Invalid HTML input');\r\n        return getDefaultPageData();\r\n    }\r\n\r\n    // ==================== PRIORITY 1: EXTRACT EMBEDDED pageData ====================\r\n    try {\r\n        const pageDataMatch = htmlString.match(\r\n            /<script type=\"application\\/json\" id=\"lpb-page-data\">\\s*([\\s\\S]*?)\\s*<\\/script>/\r\n        );\r\n\r\n        if (pageDataMatch && pageDataMatch[1]) {\r\n            console.log('‚úÖ Found embedded pageData script tag');\r\n\r\n            try {\r\n                const embeddedPageData = JSON.parse(pageDataMatch[1]);\r\n\r\n                // Validate structure\r\n                if (embeddedPageData &&\r\n                    embeddedPageData.canvas &&\r\n                    Array.isArray(embeddedPageData.elements)) {\r\n\r\n                    console.log('‚úÖ Valid embedded pageData structure:', {\r\n                        elementsCount: embeddedPageData.elements.length,\r\n                        canvasWidth: embeddedPageData.canvas.width,\r\n                        metaTitle: embeddedPageData.meta?.title\r\n                    });\r\n\r\n                    // Normalize ƒë·ªÉ ƒë·∫£m b·∫£o t∆∞∆°ng th√≠ch v·ªõi Canvas\r\n                    const normalizedPageData = {\r\n                        canvas: {\r\n                            width: embeddedPageData.canvas.width || 1200,\r\n                            height: embeddedPageData.canvas.height || 'auto',\r\n                            background: embeddedPageData.canvas.background || '#ffffff'\r\n                        },\r\n                        elements: embeddedPageData.elements.map(normalizeElement),\r\n                        meta: {\r\n                            title: embeddedPageData.meta?.title || 'Untitled Page',\r\n                            description: embeddedPageData.meta?.description || '',\r\n                            keywords: embeddedPageData.meta?.keywords || [],\r\n                            created_at: embeddedPageData.meta?.created_at || new Date().toISOString(),\r\n                            updated_at: embeddedPageData.meta?.updated_at || new Date().toISOString()\r\n                        },\r\n                        analytics: embeddedPageData.analytics || {}\r\n                    };\r\n\r\n                    console.log('‚úÖ Normalized pageData ready for Canvas:', {\r\n                        elementsCount: normalizedPageData.elements.length,\r\n                        firstElement: normalizedPageData.elements[0]\r\n                    });\r\n\r\n                    return normalizedPageData;\r\n                } else {\r\n                    console.warn('‚ö†Ô∏è Invalid embedded pageData structure:', {\r\n                        hasCanvas: !!embeddedPageData?.canvas,\r\n                        hasElements: Array.isArray(embeddedPageData?.elements),\r\n                        elementsType: typeof embeddedPageData?.elements\r\n                    });\r\n                }\r\n            } catch (parseError) {\r\n                console.error('‚ùå Failed to parse embedded pageData JSON:', parseError.message);\r\n                console.error('JSON content preview:', pageDataMatch[1].substring(0, 200));\r\n            }\r\n        } else {\r\n            console.log('‚ö†Ô∏è No embedded pageData found in HTML, trying DOM parsing...');\r\n        }\r\n    } catch (error) {\r\n        console.error('‚ùå Error extracting embedded pageData:', error);\r\n    }\r\n\r\n    // ==================== PRIORITY 2: PARSE DOM STRUCTURE ====================\r\n    console.log('‚öôÔ∏è Parsing HTML DOM structure as fallback...');\r\n\r\n    const parser = new DOMParser();\r\n    const doc = parser.parseFromString(htmlString, 'text/html');\r\n\r\n    const pageData = {\r\n        canvas: {\r\n            width: 1200,\r\n            height: 'auto',\r\n            background: '#ffffff'\r\n        },\r\n        elements: [],\r\n        meta: {\r\n            title: 'Untitled Page',\r\n            description: '',\r\n            keywords: []\r\n        }\r\n    };\r\n\r\n    try {\r\n        // Parse canvas background\r\n        const canvasEl = doc.getElementById('lpb-canvas');\r\n        if (canvasEl) {\r\n            pageData.canvas.background = canvasEl.style.background || '#ffffff';\r\n        }\r\n\r\n        // Parse meta tags\r\n        const titleEl = doc.querySelector('title');\r\n        if (titleEl) {\r\n            pageData.meta.title = titleEl.textContent;\r\n        }\r\n\r\n        const descEl = doc.querySelector('meta[name=\"description\"]');\r\n        if (descEl) {\r\n            pageData.meta.description = descEl.getAttribute('content');\r\n        }\r\n\r\n        // Parse sections\r\n        const sections = doc.querySelectorAll('.lpb-section, section.ladi-section, section');\r\n        console.log(`üì¶ Found ${sections.length} sections in DOM`);\r\n\r\n        sections.forEach((sectionEl, index) => {\r\n            const section = parseSectionElementFromDOM(sectionEl, index);\r\n            if (section) {\r\n                pageData.elements.push(section);\r\n            }\r\n        });\r\n\r\n        // Parse popups\r\n        const popups = doc.querySelectorAll('.lpb-popup');\r\n        console.log(`ü™ü Found ${popups.length} popups in DOM`);\r\n\r\n        popups.forEach(popupEl => {\r\n            const popup = parsePopupElementFromDOM(popupEl);\r\n            if (popup) {\r\n                pageData.elements.push(popup);\r\n            }\r\n        });\r\n\r\n        console.log(`‚úÖ DOM parsing completed: ${pageData.elements.length} elements`);\r\n        return pageData;\r\n\r\n    } catch (error) {\r\n        console.error('‚ùå DOM parse error:', error);\r\n        return getDefaultPageData();\r\n    }\r\n};\r\n\r\n/**\r\n * Get default empty pageData structure\r\n */\r\nconst getDefaultPageData = (title = 'Untitled Page', description = '') => {\r\n    return {\r\n        canvas: {\r\n            width: 1200,\r\n            height: 'auto',\r\n            background: '#ffffff'\r\n        },\r\n        elements: [],\r\n        meta: {\r\n            title,\r\n            description,\r\n            keywords: [],\r\n            created_at: new Date().toISOString(),\r\n            updated_at: new Date().toISOString()\r\n        }\r\n    };\r\n};\r\n\r\n/**\r\n * Normalize element structure ƒë·ªÉ ƒë·∫£m b·∫£o t∆∞∆°ng th√≠ch v·ªõi Canvas\r\n */\r\nconst normalizeElement = (element) => {\r\n    const normalized = {\r\n        id: element.id || `element-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`,\r\n        type: element.type || 'container',\r\n        componentData: element.componentData || {},\r\n        position: normalizePosition(element.position),\r\n        size: {\r\n            width: element.size?.width || (element.type === 'section' ? 1200 : 200),\r\n            height: element.size?.height || (element.type === 'section' ? 400 : 50)\r\n        },\r\n        styles: element.styles || {},\r\n        children: Array.isArray(element.children)\r\n            ? element.children.map(normalizeElement)\r\n            : [],\r\n        visible: element.visible !== false,\r\n        locked: element.locked || false\r\n    };\r\n\r\n    return normalized;\r\n};\r\n\r\n/**\r\n * Normalize position ƒë·ªÉ ƒë·∫£m b·∫£o c√≥ ƒë·∫ßy ƒë·ªß c√°c viewMode\r\n */\r\nconst normalizePosition = (position) => {\r\n    if (!position) {\r\n        return {\r\n            desktop: { x: 0, y: 0 },\r\n            tablet: { x: 0, y: 0 },\r\n            mobile: { x: 0, y: 0 }\r\n        };\r\n    }\r\n\r\n    const desktop = position.desktop || position.default || { x: 0, y: 0 };\r\n    const tablet = position.tablet || desktop;\r\n    const mobile = position.mobile || desktop;\r\n\r\n    return {\r\n        desktop: { x: desktop.x || 0, y: desktop.y || 0 },\r\n        tablet: { x: tablet.x || 0, y: tablet.y || 0 },\r\n        mobile: { x: mobile.x || 0, y: mobile.y || 0 }\r\n    };\r\n};\r\n\r\n/**\r\n * Parse section element t·ª´ DOM (RENAMED ƒë·ªÉ tr√°nh conflict)\r\n */\r\nconst parseSectionElementFromDOM = (sectionEl, index = 0) => {\r\n    const id = sectionEl.id || sectionEl.getAttribute('data-element-id') || `section-${Date.now()}-${index}`;\r\n\r\n    // Parse position\r\n    const topMatch = sectionEl.style.top?.match(/(-?\\d+)px/);\r\n    const top = topMatch ? parseInt(topMatch[1]) : (index * 400);\r\n\r\n    // Parse size\r\n    const widthMatch = sectionEl.style.width?.match(/(\\d+)px/);\r\n    const heightMatch = sectionEl.style.height?.match(/(\\d+)px/);\r\n    const width = widthMatch ? parseInt(widthMatch[1]) : 1200;\r\n    const height = heightMatch ? parseInt(heightMatch[1]) : 400;\r\n\r\n    // Parse structure elements\r\n    const bgEl = sectionEl.querySelector('.ladi-section-background, .lpb-section-background');\r\n    const overlayEl = sectionEl.querySelector('.ladi-overlay, .lpb-overlay');\r\n    const containerEl = sectionEl.querySelector('.ladi-container, .lpb-container');\r\n\r\n    const componentData = {\r\n        structure: 'ladi-standard',\r\n        backgroundColor: 'transparent',\r\n        backgroundType: 'color'\r\n    };\r\n\r\n    if (bgEl) {\r\n        const bgStyle = bgEl.style;\r\n        componentData.backgroundColor = bgStyle.backgroundColor || 'transparent';\r\n\r\n        const bgImageMatch = bgStyle.backgroundImage?.match(/url\\(['\"]?(.+?)['\"]?\\)/);\r\n        if (bgImageMatch) {\r\n            componentData.backgroundImage = bgImageMatch[1];\r\n            componentData.backgroundType = 'image';\r\n        }\r\n\r\n        componentData.backgroundPosition = bgStyle.backgroundPosition || 'center';\r\n        componentData.backgroundSize = bgStyle.backgroundSize || 'cover';\r\n    }\r\n\r\n    if (overlayEl) {\r\n        componentData.overlayColor = overlayEl.style.backgroundColor || 'transparent';\r\n        componentData.overlayOpacity = parseFloat(overlayEl.style.opacity) || 0;\r\n    }\r\n\r\n    const styles = parseInlineStylesFromDOM(sectionEl.style);\r\n\r\n    if (containerEl) {\r\n        componentData.padding = containerEl.style.padding || '20px';\r\n    }\r\n\r\n    // Parse children\r\n    const children = [];\r\n    if (containerEl) {\r\n        const childElements = containerEl.querySelectorAll('.lpb-element[data-element-id]');\r\n        childElements.forEach(childEl => {\r\n            if (childEl.parentElement === containerEl ||\r\n                childEl.parentElement?.parentElement === containerEl) {\r\n                const child = parseChildElementFromDOM(childEl);\r\n                if (child) {\r\n                    children.push(child);\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    console.log(`üì¶ Parsed section ${id}:`, {\r\n        position: { y: top },\r\n        size: { width, height },\r\n        childrenCount: children.length\r\n    });\r\n\r\n    return {\r\n        id,\r\n        type: 'section',\r\n        componentData,\r\n        position: {\r\n            desktop: { x: 0, y: top },\r\n            tablet: { x: 0, y: top },\r\n            mobile: { x: 0, y: top }\r\n        },\r\n        size: { width, height },\r\n        styles,\r\n        children,\r\n        visible: true,\r\n        locked: false\r\n    };\r\n};\r\n\r\n/**\r\n * Parse popup element t·ª´ DOM (RENAMED)\r\n */\r\nconst parsePopupElementFromDOM = (popupEl) => {\r\n    const id = popupEl.id || `popup-${Date.now()}`;\r\n    const containerEl = popupEl.querySelector('.lpb-popup-container');\r\n\r\n    if (!containerEl) {\r\n        console.warn('‚ö†Ô∏è Popup container not found for:', id);\r\n        return null;\r\n    }\r\n\r\n    const widthMatch = containerEl.style.width?.match(/(\\d+)px/);\r\n    const minHeightMatch = containerEl.style.minHeight?.match(/(\\d+)px/);\r\n    const width = widthMatch ? parseInt(widthMatch[1]) : 600;\r\n    const height = minHeightMatch ? parseInt(minHeightMatch[1]) : 400;\r\n\r\n    const headerEl = popupEl.querySelector('.lpb-popup-header h3, .lpb-popup-header h2');\r\n    const bodyEl = popupEl.querySelector('.lpb-popup-body');\r\n\r\n    const componentData = {\r\n        title: headerEl?.textContent?.trim() || 'Popup',\r\n        background: containerEl.style.background || 'rgba(255, 255, 255, 0.95)',\r\n        borderRadius: containerEl.style.borderRadius || '12px',\r\n        padding: bodyEl?.style.padding || '20px'\r\n    };\r\n\r\n    const styles = parseInlineStylesFromDOM(containerEl.style);\r\n\r\n    const children = [];\r\n    if (bodyEl) {\r\n        const childElements = bodyEl.querySelectorAll('.lpb-element[data-element-id]');\r\n        childElements.forEach(childEl => {\r\n            const child = parseChildElementFromDOM(childEl);\r\n            if (child) {\r\n                children.push(child);\r\n            }\r\n        });\r\n    }\r\n\r\n    return {\r\n        id,\r\n        type: 'popup',\r\n        componentData,\r\n        position: {\r\n            desktop: { x: 100, y: 100 },\r\n            tablet: { x: 100, y: 100 },\r\n            mobile: { x: 50, y: 50 }\r\n        },\r\n        size: { width, height },\r\n        styles,\r\n        children,\r\n        visible: true,\r\n        locked: false\r\n    };\r\n};\r\n\r\n/**\r\n * Parse child element t·ª´ DOM (RENAMED)\r\n */\r\nconst parseChildElementFromDOM = (element) => {\r\n    const id = element.id || element.getAttribute('data-element-id') || `element-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;\r\n    const type = element.getAttribute('data-type') || inferTypeFromElementDOM(element);\r\n\r\n    const leftMatch = element.style.left?.match(/(-?\\d+)px/);\r\n    const topMatch = element.style.top?.match(/(-?\\d+)px/);\r\n    const left = leftMatch ? parseInt(leftMatch[1]) : 0;\r\n    const top = topMatch ? parseInt(topMatch[1]) : 0;\r\n\r\n    const widthMatch = element.style.width?.match(/(\\d+)px/);\r\n    const heightMatch = element.style.height?.match(/(\\d+)px/);\r\n    const width = widthMatch ? parseInt(widthMatch[1]) : (type === 'icon' ? 50 : 200);\r\n    const height = heightMatch ? parseInt(heightMatch[1]) : (type === 'icon' ? 50 : 50);\r\n\r\n    const styles = parseInlineStylesFromDOM(element.style);\r\n    const componentData = parseComponentDataFromDOM(element, type);\r\n\r\n    return {\r\n        id,\r\n        type,\r\n        componentData,\r\n        position: {\r\n            desktop: { x: left, y: top },\r\n            tablet: { x: left, y: top },\r\n            mobile: { x: left, y: top }\r\n        },\r\n        size: { width, height },\r\n        styles,\r\n        children: [],\r\n        visible: element.style.display !== 'none',\r\n        locked: false\r\n    };\r\n};\r\n\r\n/**\r\n * Parse component data t·ª´ DOM element (RENAMED)\r\n */\r\nconst parseComponentDataFromDOM = (element, type) => {\r\n    const componentData = {};\r\n\r\n    switch (type) {\r\n        case 'button':\r\n            componentData.content = element.textContent?.trim() || 'Button';\r\n            break;\r\n\r\n        case 'heading':\r\n            componentData.content = element.textContent?.trim() || 'Heading';\r\n            componentData.level = element.tagName?.toLowerCase() || 'h2';\r\n            break;\r\n\r\n        case 'paragraph':\r\n            componentData.content = element.textContent?.trim() || 'Paragraph';\r\n            break;\r\n\r\n        case 'image':\r\n            componentData.src = element.getAttribute('src') || '';\r\n            componentData.alt = element.getAttribute('alt') || '';\r\n            componentData.imageUrl = element.getAttribute('src') || '';\r\n            break;\r\n\r\n        case 'icon':\r\n            const img = element.querySelector('img');\r\n            const iconEl = element.querySelector('i');\r\n            const svgEl = element.querySelector('svg');\r\n\r\n            if (img) {\r\n                componentData.imageUrl = img.getAttribute('src');\r\n                componentData.type = 'image';\r\n            } else if (svgEl) {\r\n                componentData.icon = svgEl.outerHTML;\r\n                componentData.type = 'svg';\r\n            } else if (iconEl) {\r\n                componentData.icon = iconEl.className;\r\n                componentData.type = 'fontawesome';\r\n            } else {\r\n                componentData.icon = 'fas fa-star';\r\n                componentData.type = 'fontawesome';\r\n            }\r\n\r\n            componentData.title = element.getAttribute('title') || '';\r\n            break;\r\n\r\n        case 'gallery':\r\n            const images = Array.from(element.querySelectorAll('img'))\r\n                .map(img => img.src)\r\n                .filter(src => src && !src.includes('placeholder'));\r\n            componentData.images = images;\r\n            componentData.layout = 'grid';\r\n            break;\r\n\r\n        default:\r\n            componentData.content = element.textContent?.trim() || '';\r\n            break;\r\n    }\r\n\r\n    return componentData;\r\n};\r\n\r\n/**\r\n * Parse inline styles t·ª´ CSSStyleDeclaration (RENAMED)\r\n */\r\nconst parseInlineStylesFromDOM = (styleObj) => {\r\n    const styles = {};\r\n    const importantProps = [\r\n        'background', 'backgroundColor', 'backgroundImage', 'backgroundSize', 'backgroundPosition',\r\n        'color', 'fontSize', 'fontWeight', 'fontFamily',\r\n        'border', 'borderRadius', 'boxShadow', 'textShadow',\r\n        'padding', 'margin',\r\n        'display', 'alignItems', 'justifyContent', 'flexDirection', 'gap',\r\n        'textAlign', 'lineHeight', 'textTransform', 'letterSpacing',\r\n        'cursor', 'transition', 'animation', 'transform',\r\n        'zIndex', 'opacity', 'overflow'\r\n    ];\r\n\r\n    importantProps.forEach(prop => {\r\n        if (styleObj[prop]) {\r\n            styles[prop] = styleObj[prop];\r\n        }\r\n    });\r\n\r\n    return styles;\r\n};\r\n\r\n/**\r\n * Infer element type t·ª´ DOM element (RENAMED)\r\n */\r\nconst inferTypeFromElementDOM = (element) => {\r\n    const tagName = element.tagName?.toLowerCase();\r\n    const classList = element.classList;\r\n\r\n    if (classList.contains('lpb-button') || classList.contains('ladi-button')) return 'button';\r\n    if (classList.contains('lpb-icon') || classList.contains('ladi-icon')) return 'icon';\r\n    if (classList.contains('lpb-gallery') || classList.contains('ladi-gallery')) return 'gallery';\r\n    if (classList.contains('lpb-section') || classList.contains('ladi-section')) return 'section';\r\n    if (classList.contains('lpb-popup')) return 'popup';\r\n\r\n    if (tagName === 'button') return 'button';\r\n    if (tagName?.match(/^h[1-6]$/)) return 'heading';\r\n    if (tagName === 'p') return 'paragraph';\r\n    if (tagName === 'img') return 'image';\r\n    if (tagName === 'svg' || element.querySelector('svg')) return 'icon';\r\n    if (tagName === 'i' && element.className.includes('fa')) return 'icon';\r\n\r\n    if (element.querySelector('i.fa') || element.querySelector('svg')) {\r\n        return 'icon';\r\n    }\r\n\r\n    return 'container';\r\n};"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}