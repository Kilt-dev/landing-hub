{"ast":null,"code":"import { toast } from \"react-toastify\";\nclass EventController {\n  constructor() {\n    this.subscribers = {}; // { eventName: [callbacks] }\n    this.cache = new Map(); // For future API cache\n  }\n\n  // Subscribe to an event\n  subscribe(eventName, callback) {\n    if (!this.subscribers[eventName]) {\n      this.subscribers[eventName] = [];\n    }\n    this.subscribers[eventName].push(callback);\n    return () => this.unsubscribe(eventName, callback); // Return unsubscribe function\n  }\n\n  // Unsubscribe from an event\n  unsubscribe(eventName, callback) {\n    if (this.subscribers[eventName]) {\n      this.subscribers[eventName] = this.subscribers[eventName].filter(cb => cb !== callback);\n    }\n  }\n\n  // Dispatch an event with payload\n  dispatch(eventName, payload = {}) {\n    if (this.subscribers[eventName]) {\n      this.subscribers[eventName].forEach(callback => {\n        try {\n          callback(payload);\n        } catch (error) {\n          console.error(`Error in ${eventName} callback:`, error);\n          toast.error(`Error handling ${eventName}: ${error.message}`);\n        }\n      });\n    }\n  }\n\n  // Handle specific event types (frontend only: popup, navigate, scrollToSection, etc.)\n  handleEvent(config, elementId, isCanvas = false) {\n    const {\n      type,\n      popupId,\n      url,\n      newTab,\n      sectionId,\n      smooth,\n      apiUrl,\n      method\n    } = config;\n    switch (type) {\n      case \"openPopup\":\n        if (!popupId) {\n          toast.error(\"No popup ID specified!\");\n          return;\n        }\n        this.dispatch(\"popup-open\", {\n          popupId,\n          elementId\n        });\n        if (isCanvas) {\n          toast.info(`Simulating: Opening popup \"${popupId}\"`, {\n            position: \"bottom-right\",\n            autoClose: 2000\n          });\n        }\n        break;\n      case \"closePopup\":\n        const targetPopupId = popupId || elementId;\n        if (!targetPopupId) {\n          toast.error(\"No popup ID specified for closing!\");\n          return;\n        }\n        this.dispatch(\"popup-close\", {\n          popupId: targetPopupId,\n          elementId\n        });\n        if (isCanvas) {\n          toast.info(`Simulating: Closing popup \"${targetPopupId}\"`, {\n            position: \"bottom-right\",\n            autoClose: 2000\n          });\n        }\n        break;\n      case \"navigate\":\n        if (!url) {\n          toast.error(\"No URL specified for navigation!\");\n          return;\n        }\n        if (isCanvas) {\n          toast.info(`Simulating: Navigating to ${url}`, {\n            position: \"bottom-right\",\n            autoClose: 2000\n          });\n        } else {\n          try {\n            window.open(url, newTab ? \"_blank\" : \"_self\");\n          } catch (error) {\n            console.error(\"Navigation error:\", error);\n            toast.error(`Failed to navigate: ${error.message}`);\n          }\n        }\n        break;\n      case \"scrollToSection\":\n        if (!sectionId) {\n          toast.error(\"No section ID specified!\");\n          return;\n        }\n        const sectionElement = document.querySelector(`[data-element-id=\"${sectionId}\"]`);\n        if (sectionElement) {\n          try {\n            sectionElement.scrollIntoView({\n              behavior: smooth !== false ? \"smooth\" : \"auto\",\n              block: \"start\"\n            });\n            if (isCanvas) {\n              toast.info(`Simulating: Scrolling to section \"${sectionId}\"`, {\n                position: \"bottom-right\",\n                autoClose: 2000\n              });\n            }\n          } catch (error) {\n            console.error(\"Scroll error:\", error);\n            toast.error(`Failed to scroll to section: ${error.message}`);\n          }\n        } else {\n          toast.error(\"Section not found!\");\n        }\n        break;\n      case \"submitForm\":\n      case \"triggerApi\":\n        if (!apiUrl) {\n          toast.error(\"No API URL specified!\");\n          return;\n        }\n        if (isCanvas) {\n          toast.info(`Simulating: ${type === \"submitForm\" ? \"Submitting form\" : \"Triggering API\"} to ${apiUrl} (${method || \"POST\"})`, {\n            position: \"bottom-right\",\n            autoClose: 2000\n          });\n        } else {\n          // Placeholder for actual API call (not implemented yet)\n          console.log(`Would call API: ${method || \"POST\"} ${apiUrl}`);\n          toast.info(`API call to ${apiUrl} not implemented in this version.`);\n        }\n        break;\n      case \"none\":\n        // No action\n        break;\n      default:\n        console.warn(`Unhandled event type: ${type}`);\n        toast.warn(`Event type \"${type}\" not supported.`);\n        break;\n    }\n  }\n\n  // Prefetch popup content (placeholder for dynamic loading)\n  prefetch(config) {\n    if (config.type === \"openPopup\" && config.popupId) {\n      // In the future, this could fetch popup content from an API\n      console.log(`Prefetching popup content for: ${config.popupId}`);\n      this.dispatch(\"popup-prefetch\", {\n        popupId: config.popupId\n      });\n    } else if (config.type === \"triggerApi\" && config.apiUrl) {\n      // Placeholder for prefetching API data\n      console.log(`Prefetching API data for: ${config.apiUrl}`);\n    }\n  }\n\n  // Load popup content (placeholder for dynamic loading)\n  loadPopup(popupId) {\n    // For now, assume popup is already in pageData.elements\n    // In the future, this could fetch popup content from an API\n    this.dispatch(\"popup-load\", {\n      popupId\n    });\n    console.log(`Loading popup: ${popupId}`);\n    return true; // Return true to indicate successful \"loading\"\n  }\n}\n\n// Singleton instance\nconst eventController = new EventController();\nexport default eventController;","map":{"version":3,"names":["toast","EventController","constructor","subscribers","cache","Map","subscribe","eventName","callback","push","unsubscribe","filter","cb","dispatch","payload","forEach","error","console","message","handleEvent","config","elementId","isCanvas","type","popupId","url","newTab","sectionId","smooth","apiUrl","method","info","position","autoClose","targetPopupId","window","open","sectionElement","document","querySelector","scrollIntoView","behavior","block","log","warn","prefetch","loadPopup","eventController"],"sources":["F:/landinghub-iconic/apps/web/src/utils/EventController.js"],"sourcesContent":["import { toast } from \"react-toastify\";\r\n\r\nclass EventController {\r\n    constructor() {\r\n        this.subscribers = {}; // { eventName: [callbacks] }\r\n        this.cache = new Map(); // For future API cache\r\n    }\r\n\r\n    // Subscribe to an event\r\n    subscribe(eventName, callback) {\r\n        if (!this.subscribers[eventName]) {\r\n            this.subscribers[eventName] = [];\r\n        }\r\n        this.subscribers[eventName].push(callback);\r\n        return () => this.unsubscribe(eventName, callback); // Return unsubscribe function\r\n    }\r\n\r\n    // Unsubscribe from an event\r\n    unsubscribe(eventName, callback) {\r\n        if (this.subscribers[eventName]) {\r\n            this.subscribers[eventName] = this.subscribers[eventName].filter(\r\n                (cb) => cb !== callback\r\n            );\r\n        }\r\n    }\r\n\r\n    // Dispatch an event with payload\r\n    dispatch(eventName, payload = {}) {\r\n        if (this.subscribers[eventName]) {\r\n            this.subscribers[eventName].forEach((callback) => {\r\n                try {\r\n                    callback(payload);\r\n                } catch (error) {\r\n                    console.error(`Error in ${eventName} callback:`, error);\r\n                    toast.error(`Error handling ${eventName}: ${error.message}`);\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    // Handle specific event types (frontend only: popup, navigate, scrollToSection, etc.)\r\n    handleEvent(config, elementId, isCanvas = false) {\r\n        const { type, popupId, url, newTab, sectionId, smooth, apiUrl, method } = config;\r\n\r\n        switch (type) {\r\n            case \"openPopup\":\r\n                if (!popupId) {\r\n                    toast.error(\"No popup ID specified!\");\r\n                    return;\r\n                }\r\n                this.dispatch(\"popup-open\", { popupId, elementId });\r\n                if (isCanvas) {\r\n                    toast.info(`Simulating: Opening popup \"${popupId}\"`, {\r\n                        position: \"bottom-right\",\r\n                        autoClose: 2000,\r\n                    });\r\n                }\r\n                break;\r\n\r\n            case \"closePopup\":\r\n                const targetPopupId = popupId || elementId;\r\n                if (!targetPopupId) {\r\n                    toast.error(\"No popup ID specified for closing!\");\r\n                    return;\r\n                }\r\n                this.dispatch(\"popup-close\", { popupId: targetPopupId, elementId });\r\n                if (isCanvas) {\r\n                    toast.info(`Simulating: Closing popup \"${targetPopupId}\"`, {\r\n                        position: \"bottom-right\",\r\n                        autoClose: 2000,\r\n                    });\r\n                }\r\n                break;\r\n\r\n            case \"navigate\":\r\n                if (!url) {\r\n                    toast.error(\"No URL specified for navigation!\");\r\n                    return;\r\n                }\r\n                if (isCanvas) {\r\n                    toast.info(`Simulating: Navigating to ${url}`, {\r\n                        position: \"bottom-right\",\r\n                        autoClose: 2000,\r\n                    });\r\n                } else {\r\n                    try {\r\n                        window.open(url, newTab ? \"_blank\" : \"_self\");\r\n                    } catch (error) {\r\n                        console.error(\"Navigation error:\", error);\r\n                        toast.error(`Failed to navigate: ${error.message}`);\r\n                    }\r\n                }\r\n                break;\r\n\r\n            case \"scrollToSection\":\r\n                if (!sectionId) {\r\n                    toast.error(\"No section ID specified!\");\r\n                    return;\r\n                }\r\n                const sectionElement = document.querySelector(\r\n                    `[data-element-id=\"${sectionId}\"]`\r\n                );\r\n                if (sectionElement) {\r\n                    try {\r\n                        sectionElement.scrollIntoView({\r\n                            behavior: smooth !== false ? \"smooth\" : \"auto\",\r\n                            block: \"start\",\r\n                        });\r\n                        if (isCanvas) {\r\n                            toast.info(`Simulating: Scrolling to section \"${sectionId}\"`, {\r\n                                position: \"bottom-right\",\r\n                                autoClose: 2000,\r\n                            });\r\n                        }\r\n                    } catch (error) {\r\n                        console.error(\"Scroll error:\", error);\r\n                        toast.error(`Failed to scroll to section: ${error.message}`);\r\n                    }\r\n                } else {\r\n                    toast.error(\"Section not found!\");\r\n                }\r\n                break;\r\n\r\n            case \"submitForm\":\r\n            case \"triggerApi\":\r\n                if (!apiUrl) {\r\n                    toast.error(\"No API URL specified!\");\r\n                    return;\r\n                }\r\n                if (isCanvas) {\r\n                    toast.info(\r\n                        `Simulating: ${type === \"submitForm\" ? \"Submitting form\" : \"Triggering API\"} to ${apiUrl} (${method || \"POST\"})`,\r\n                        { position: \"bottom-right\", autoClose: 2000 }\r\n                    );\r\n                } else {\r\n                    // Placeholder for actual API call (not implemented yet)\r\n                    console.log(`Would call API: ${method || \"POST\"} ${apiUrl}`);\r\n                    toast.info(`API call to ${apiUrl} not implemented in this version.`);\r\n                }\r\n                break;\r\n\r\n            case \"none\":\r\n                // No action\r\n                break;\r\n\r\n            default:\r\n                console.warn(`Unhandled event type: ${type}`);\r\n                toast.warn(`Event type \"${type}\" not supported.`);\r\n                break;\r\n        }\r\n    }\r\n\r\n    // Prefetch popup content (placeholder for dynamic loading)\r\n    prefetch(config) {\r\n        if (config.type === \"openPopup\" && config.popupId) {\r\n            // In the future, this could fetch popup content from an API\r\n            console.log(`Prefetching popup content for: ${config.popupId}`);\r\n            this.dispatch(\"popup-prefetch\", { popupId: config.popupId });\r\n        } else if (config.type === \"triggerApi\" && config.apiUrl) {\r\n            // Placeholder for prefetching API data\r\n            console.log(`Prefetching API data for: ${config.apiUrl}`);\r\n        }\r\n    }\r\n\r\n    // Load popup content (placeholder for dynamic loading)\r\n    loadPopup(popupId) {\r\n        // For now, assume popup is already in pageData.elements\r\n        // In the future, this could fetch popup content from an API\r\n        this.dispatch(\"popup-load\", { popupId });\r\n        console.log(`Loading popup: ${popupId}`);\r\n        return true; // Return true to indicate successful \"loading\"\r\n    }\r\n}\r\n\r\n// Singleton instance\r\nconst eventController = new EventController();\r\nexport default eventController;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}