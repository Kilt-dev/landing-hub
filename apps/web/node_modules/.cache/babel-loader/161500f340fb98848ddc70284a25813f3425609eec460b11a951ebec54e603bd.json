{"ast":null,"code":"import axios from 'axios';\n\n// Create Axios instance with base URL and timeout\nconst axiosInstance = axios.create({\n  baseURL: process.env.REACT_APP_API_URL || 'http://localhost:3000',\n  // Fallback for development\n  timeout: 10000 // Set a timeout for requests\n});\n\n// Add Authorization header with Bearer token if available\naxiosInstance.interceptors.request.use(config => {\n  const token = localStorage.getItem('token');\n  if (token) {\n    config.headers.Authorization = `Bearer ${token}`;\n  }\n  return config;\n}, error => Promise.reject(error));\n\n// Add response interceptor for consistent error handling\naxiosInstance.interceptors.response.use(response => response.data,\n// Return response.data directly\nerror => {\n  console.error('API request failed:', error.response?.data || error.message);\n  return Promise.reject(error.response?.data || {\n    error: 'Lỗi kết nối server'\n  });\n});\n\n// API methods\nconst api = {\n  // Save landing page (maps to backend's savePage endpoint)\n  savePage: async data => {\n    try {\n      const response = await axiosInstance.post('/api/pages/save', data);\n      return response; // Backend returns the Page object or { error: string }\n    } catch (error) {\n      throw error; // Handled by response interceptor\n    }\n  },\n  // Deploy landing page (maps to backend's publishPage endpoint)\n  deployLandingPage: async pageId => {\n    try {\n      const response = await axiosInstance.post(`/api/pages/${pageId}/publish`);\n      return response; // Backend returns the Page object with url, cloudfrontDomain, etc.\n    } catch (error) {\n      throw error;\n    }\n  },\n  // Get all pages for the user (maps to backend's getPages endpoint)\n  getPages: async () => {\n    try {\n      const response = await axiosInstance.get('/api/pages');\n      return response; // Backend returns an array of pages\n    } catch (error) {\n      throw error;\n    }\n  },\n  // Update an existing page (maps to backend's updatePage endpoint)\n  updatePage: async (pageId, data) => {\n    try {\n      const response = await axiosInstance.put(`/api/pages/${pageId}`, data);\n      return response; // Backend returns the updated Page object\n    } catch (error) {\n      throw error;\n    }\n  },\n  // Delete a page (maps to backend's deletePage endpoint)\n  deletePage: async pageId => {\n    try {\n      const response = await axiosInstance.delete(`/api/pages/${pageId}`);\n      return response; // Backend returns { success: true } or { error: string }\n    } catch (error) {\n      throw error;\n    }\n  },\n  // Get page content (maps to backend's getPageContent endpoint)\n  getPageContent: async pageId => {\n    try {\n      const response = await axiosInstance.get(`/api/pages/${pageId}/content`);\n      return response; // Backend returns { html: string, css: string }\n    } catch (error) {\n      throw error;\n    }\n  },\n  // Auto-save draft (maps to backend's autoSave endpoint)\n  autoSave: async data => {\n    try {\n      const response = await axiosInstance.post('/api/pages/autosave', data);\n      return response; // Backend returns { success: true, savedAt: string, message: string }\n    } catch (error) {\n      throw error;\n    }\n  },\n  // AI refactor (maps to backend's aiRefactor endpoint)\n  aiRefactor: async data => {\n    try {\n      const response = await axiosInstance.post('/api/pages/refactor', data);\n      return response; // Backend returns { html: string, thumbnail: string, improvements: string[], isValid: boolean, metadata: object }\n    } catch (error) {\n      throw error;\n    }\n  }\n};\nexport default api;","map":{"version":3,"names":["axios","axiosInstance","create","baseURL","process","env","REACT_APP_API_URL","timeout","interceptors","request","use","config","token","localStorage","getItem","headers","Authorization","error","Promise","reject","response","data","console","message","api","savePage","post","deployLandingPage","pageId","getPages","get","updatePage","put","deletePage","delete","getPageContent","autoSave","aiRefactor"],"sources":["F:/landinghub-iconic/packages/api/utils/api.js"],"sourcesContent":["import axios from 'axios';\r\n\r\n// Create Axios instance with base URL and timeout\r\nconst axiosInstance = axios.create({\r\n    baseURL: process.env.REACT_APP_API_URL || 'http://localhost:3000', // Fallback for development\r\n    timeout: 10000, // Set a timeout for requests\r\n});\r\n\r\n// Add Authorization header with Bearer token if available\r\naxiosInstance.interceptors.request.use(\r\n    (config) => {\r\n        const token = localStorage.getItem('token');\r\n        if (token) {\r\n            config.headers.Authorization = `Bearer ${token}`;\r\n        }\r\n        return config;\r\n    },\r\n    (error) => Promise.reject(error)\r\n);\r\n\r\n// Add response interceptor for consistent error handling\r\naxiosInstance.interceptors.response.use(\r\n    (response) => response.data, // Return response.data directly\r\n    (error) => {\r\n        console.error('API request failed:', error.response?.data || error.message);\r\n        return Promise.reject(error.response?.data || { error: 'Lỗi kết nối server' });\r\n    }\r\n);\r\n\r\n// API methods\r\nconst api = {\r\n    // Save landing page (maps to backend's savePage endpoint)\r\n    savePage: async (data) => {\r\n        try {\r\n            const response = await axiosInstance.post('/api/pages/save', data);\r\n            return response; // Backend returns the Page object or { error: string }\r\n        } catch (error) {\r\n            throw error; // Handled by response interceptor\r\n        }\r\n    },\r\n\r\n    // Deploy landing page (maps to backend's publishPage endpoint)\r\n    deployLandingPage: async (pageId) => {\r\n        try {\r\n            const response = await axiosInstance.post(`/api/pages/${pageId}/publish`);\r\n            return response; // Backend returns the Page object with url, cloudfrontDomain, etc.\r\n        } catch (error) {\r\n            throw error;\r\n        }\r\n    },\r\n\r\n    // Get all pages for the user (maps to backend's getPages endpoint)\r\n    getPages: async () => {\r\n        try {\r\n            const response = await axiosInstance.get('/api/pages');\r\n            return response; // Backend returns an array of pages\r\n        } catch (error) {\r\n            throw error;\r\n        }\r\n    },\r\n\r\n    // Update an existing page (maps to backend's updatePage endpoint)\r\n    updatePage: async (pageId, data) => {\r\n        try {\r\n            const response = await axiosInstance.put(`/api/pages/${pageId}`, data);\r\n            return response; // Backend returns the updated Page object\r\n        } catch (error) {\r\n            throw error;\r\n        }\r\n    },\r\n\r\n    // Delete a page (maps to backend's deletePage endpoint)\r\n    deletePage: async (pageId) => {\r\n        try {\r\n            const response = await axiosInstance.delete(`/api/pages/${pageId}`);\r\n            return response; // Backend returns { success: true } or { error: string }\r\n        } catch (error) {\r\n            throw error;\r\n        }\r\n    },\r\n\r\n    // Get page content (maps to backend's getPageContent endpoint)\r\n    getPageContent: async (pageId) => {\r\n        try {\r\n            const response = await axiosInstance.get(`/api/pages/${pageId}/content`);\r\n            return response; // Backend returns { html: string, css: string }\r\n        } catch (error) {\r\n            throw error;\r\n        }\r\n    },\r\n\r\n    // Auto-save draft (maps to backend's autoSave endpoint)\r\n    autoSave: async (data) => {\r\n        try {\r\n            const response = await axiosInstance.post('/api/pages/autosave', data);\r\n            return response; // Backend returns { success: true, savedAt: string, message: string }\r\n        } catch (error) {\r\n            throw error;\r\n        }\r\n    },\r\n\r\n    // AI refactor (maps to backend's aiRefactor endpoint)\r\n    aiRefactor: async (data) => {\r\n        try {\r\n            const response = await axiosInstance.post('/api/pages/refactor', data);\r\n            return response; // Backend returns { html: string, thumbnail: string, improvements: string[], isValid: boolean, metadata: object }\r\n        } catch (error) {\r\n            throw error;\r\n        }\r\n    },\r\n};\r\n\r\nexport default api;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}