{"ast":null,"code":"// ==================== EVENT RUNTIME GENERATOR ====================\n\n/**\r\n * Generate runtime script ƒë·ªÉ x·ª≠ l√Ω events trong HTML tƒ©nh\r\n * @param {Array} events - Danh s√°ch events t·ª´ pageData\r\n * @param {Array} popups - Danh s√°ch popup elements\r\n * @returns {string} - JavaScript code\r\n */\nconst generateEventRuntime = (events, popups) => {\n  return `\n    // Landing Page Builder Runtime v1.0\n    (function() {\n        'use strict';\n        \n        window.LPB = window.LPB || {};\n        \n        // ========== POPUP MANAGER ==========\n        LPB.popups = {\n            active: new Set(),\n            \n            open: function(popupId, data) {\n                const popup = document.getElementById(popupId);\n                if (!popup) {\n                    console.error('[LPB] Popup not found:', popupId);\n                    return;\n                }\n                \n                // Update content n·∫øu c√≥ data\n                if (data && data.html) {\n                    const content = popup.querySelector('.lpb-popup-body');\n                    if (content) content.innerHTML = data.html;\n                }\n                \n                // Show popup\n                popup.classList.add('lpb-popup-active');\n                document.body.style.overflow = 'hidden';\n                this.active.add(popupId);\n                \n                // Analytics tracking\n                if (window.gtag) {\n                    gtag('event', 'popup_open', {\n                        event_category: 'Engagement',\n                        event_label: popupId\n                    });\n                }\n            },\n            \n            close: function(popupId) {\n                const popup = document.getElementById(popupId);\n                if (popup) {\n                    popup.classList.remove('lpb-popup-active');\n                    this.active.delete(popupId);\n                    \n                    // Restore scroll n·∫øu kh√¥ng c√≤n popup n√†o\n                    if (this.active.size === 0) {\n                        document.body.style.overflow = '';\n                    }\n                }\n            },\n            \n            closeAll: function() {\n                this.active.forEach(id => this.close(id));\n            }\n        };\n        \n        // ========== API MANAGER ==========\n        LPB.api = {\n            cache: new Map(),\n            \n            getCacheKey: function(endpoint, params) {\n                return endpoint + JSON.stringify(params || {});\n            },\n            \n            fetch: async function(endpoint, options = {}) {\n                const cacheKey = this.getCacheKey(endpoint, options.params);\n                \n                // Check cache\n                if (this.cache.has(cacheKey)) {\n                    const cached = this.cache.get(cacheKey);\n                    const now = Date.now();\n                    const TTL = options.ttl || 5 * 60 * 1000; // 5 ph√∫t default\n                    \n                    if (now - cached.timestamp < TTL) {\n                        console.log('[LPB] Cache hit:', endpoint);\n                        return cached.data;\n                    }\n                }\n                \n                // Fetch m·ªõi\n                try {\n                    console.log('[LPB] Fetching:', endpoint);\n                    const response = await fetch(endpoint, {\n                        method: options.method || 'GET',\n                        headers: {\n                            'Content-Type': 'application/json',\n                            ...options.headers\n                        },\n                        body: options.data ? JSON.stringify(options.data) : undefined\n                    });\n                    \n                    if (!response.ok) {\n                        throw new Error(\\`HTTP \\${response.status}: \\${response.statusText}\\`);\n                    }\n                    \n                    const data = await response.json();\n                    \n                    // Cache result\n                    this.cache.set(cacheKey, {\n                        data: data,\n                        timestamp: Date.now()\n                    });\n                    \n                    return data;\n                } catch (error) {\n                    console.error('[LPB] API Error:', error);\n                    throw error;\n                }\n            },\n            \n            clearCache: function(endpoint) {\n                if (endpoint) {\n                    for (let key of this.cache.keys()) {\n                        if (key.startsWith(endpoint)) {\n                            this.cache.delete(key);\n                        }\n                    }\n                } else {\n                    this.cache.clear();\n                }\n            }\n        };\n        \n        // ========== EVENT HANDLER ==========\n        LPB.handleEvent = async function(config) {\n            const { type } = config;\n            \n            try {\n                switch(type) {\n                    case 'openPopup':\n                        if (!config.popupId) {\n                            console.error('[LPB] Missing popupId');\n                            return;\n                        }\n                        this.popups.open(config.popupId, config.data);\n                        break;\n                        \n                    case 'closePopup':\n                        const targetPopupId = config.popupId || config.elementId;\n                        if (!targetPopupId) {\n                            console.error('[LPB] Missing popupId');\n                            return;\n                        }\n                        this.popups.close(targetPopupId);\n                        break;\n                        \n                    case 'triggerApi':\n                        if (!config.apiUrl) {\n                            console.error('[LPB] Missing apiUrl');\n                            return;\n                        }\n                        const data = await this.api.fetch(config.apiUrl, {\n                            method: config.method || 'GET',\n                            params: config.params,\n                            data: config.data\n                        });\n                        \n                        // Update target n·∫øu c√≥\n                        if (config.updateTarget) {\n                            const target = document.getElementById(config.updateTarget);\n                            if (target && data.html) {\n                                target.innerHTML = data.html;\n                            }\n                        }\n                        break;\n                        \n                    case 'both':\n                        // Open popup immediately v·ªõi loading\n                        this.popups.open(config.popupId, { \n                            html: '<div style=\"text-align:center;padding:40px;\"><div class=\"lpb-spinner\"></div><p>ƒêang t·∫£i...</p></div>' \n                        });\n                        \n                        // Fetch API in background\n                        const apiData = await this.api.fetch(config.apiUrl, {\n                            method: config.method || 'GET',\n                            params: config.params\n                        });\n                        \n                        // Update popup content\n                        this.popups.open(config.popupId, { html: apiData.html || JSON.stringify(apiData) });\n                        break;\n                        \n                    case 'navigate':\n                        if (!config.url) {\n                            console.error('[LPB] Missing url');\n                            return;\n                        }\n                        if (config.newTab) {\n                            window.open(config.url, '_blank');\n                        } else {\n                            window.location.href = config.url;\n                        }\n                        break;\n                        \n                    case 'scrollToSection':\n                        if (!config.sectionId) {\n                            console.error('[LPB] Missing sectionId');\n                            return;\n                        }\n                        const section = document.querySelector(\\`[data-element-id=\"\\${config.sectionId}\"]\\`);\n                        if (section) {\n                            section.scrollIntoView({ \n                                behavior: config.smooth !== false ? 'smooth' : 'auto',\n                                block: 'start'\n                            });\n                        } else {\n                            console.error('[LPB] Section not found:', config.sectionId);\n                        }\n                        break;\n                        \n                    case 'submitForm':\n                        if (!config.apiUrl) {\n                            console.error('[LPB] Missing apiUrl');\n                            return;\n                        }\n                        console.log('[LPB] Form submit to:', config.apiUrl);\n                        break;\n                        \n                    default:\n                        console.warn('[LPB] Unknown event type:', type);\n                }\n            } catch (error) {\n                console.error('[LPB] Event handling error:', error);\n                alert('C√≥ l·ªói x·∫£y ra: ' + error.message);\n            }\n        };\n        \n        // ========== AUTO-BIND EVENTS ==========\n        const eventsConfig = ${JSON.stringify(events)};\n        \n        document.addEventListener('DOMContentLoaded', function() {\n            console.log('[LPB] Initializing events...', eventsConfig.length);\n            \n            eventsConfig.forEach(config => {\n                const element = document.getElementById(config.elementId);\n                if (!element) {\n                    console.warn('[LPB] Element not found:', config.elementId);\n                    return;\n                }\n                \n                // Bind onClick\n                if (config.events.onClick && config.events.onClick.type !== 'none') {\n                    element.addEventListener('click', function(e) {\n                        e.preventDefault();\n                        e.stopPropagation();\n                        LPB.handleEvent(config.events.onClick);\n                    });\n                    \n                    element.style.cursor = 'pointer';\n                }\n                \n                // Bind hover prefetch\n                if (config.events.onClick?.params?.apiConfig?.preload) {\n                    element.addEventListener('mouseenter', function() {\n                        LPB.api.fetch(\n                            config.events.onClick.params.apiConfig.endpoint,\n                            config.events.onClick.params.apiConfig\n                        ).catch(() => {}); // Silent prefetch\n                    }, { once: true });\n                }\n                \n                // Bind onHover effects\n                if (config.events.onHover) {\n                    const hoverClass = config.events.onHover.className;\n                    if (hoverClass) {\n                        element.addEventListener('mouseenter', function() {\n                            this.classList.add(hoverClass);\n                        });\n                        element.addEventListener('mouseleave', function() {\n                            this.classList.remove(hoverClass);\n                        });\n                    }\n                }\n            });\n            \n            console.log('[LPB] Events initialized!');\n        });\n        \n        // ========== ESC TO CLOSE POPUP ==========\n        document.addEventListener('keydown', function(e) {\n            if (e.key === 'Escape') {\n                LPB.popups.closeAll();\n            }\n        });\n\n        // ========== RESPONSIVE POSITIONING HANDLER ==========\n        LPB.responsive = {\n            currentBreakpoint: 'desktop',\n\n            getBreakpoint: function() {\n                const width = window.innerWidth;\n                if (width <= 480) return 'mobile';\n                if (width <= 768) return 'tablet';\n                return 'desktop';\n            },\n\n            updateElementPositions: function() {\n                const breakpoint = this.getBreakpoint();\n                if (breakpoint === this.currentBreakpoint) return;\n\n                this.currentBreakpoint = breakpoint;\n                console.log('[LPB] Breakpoint changed to:', breakpoint);\n\n                // Update sections\n                const sections = document.querySelectorAll('.lpb-section[data-mobile-y]');\n                sections.forEach(section => {\n                    const y = section.getAttribute(\\`data-\\${breakpoint}-y\\`) || section.getAttribute('data-desktop-y') || 0;\n                    if (breakpoint !== 'desktop') {\n                        section.style.setProperty('top', \\`\\${y}px\\`, 'important');\n                    }\n                });\n\n                // Update child elements\n                const elements = document.querySelectorAll('.lpb-element[data-mobile-x]');\n                elements.forEach(element => {\n                    const x = element.getAttribute(\\`data-\\${breakpoint}-x\\`) || element.getAttribute('data-desktop-x') || 0;\n                    const y = element.getAttribute(\\`data-\\${breakpoint}-y\\`) || element.getAttribute('data-desktop-y') || 0;\n\n                    if (breakpoint === 'mobile' || breakpoint === 'tablet') {\n                        element.style.setProperty('left', \\`\\${x}px\\`, 'important');\n                        element.style.setProperty('top', \\`\\${y}px\\`, 'important');\n                    }\n                });\n            }\n        };\n\n        // Initialize responsive positions on load\n        document.addEventListener('DOMContentLoaded', function() {\n            LPB.responsive.updateElementPositions();\n        });\n\n        // Update on window resize (debounced)\n        let resizeTimeout;\n        window.addEventListener('resize', function() {\n            clearTimeout(resizeTimeout);\n            resizeTimeout = setTimeout(function() {\n                LPB.responsive.updateElementPositions();\n            }, 150);\n        });\n\n        console.log('[LPB] Runtime loaded');\n    })();\n    `;\n};\n\n/**\r\n * Extract t·∫•t c·∫£ events t·ª´ pageData elements\r\n * @param {Object} pageData - Page data object\r\n * @returns {Array} - Array of event configs\r\n */\nconst extractEvents = pageData => {\n  const events = [];\n  const processElement = (element, parentId = null) => {\n    var _element$componentDat;\n    const elementId = element.id;\n\n    // Check element events\n    if ((_element$componentDat = element.componentData) !== null && _element$componentDat !== void 0 && _element$componentDat.events) {\n      events.push({\n        elementId: elementId,\n        events: element.componentData.events,\n        type: element.type,\n        parentId: parentId\n      });\n    }\n\n    // Check children events\n    if (Array.isArray(element.children)) {\n      element.children.forEach(child => {\n        var _child$componentData;\n        if ((_child$componentData = child.componentData) !== null && _child$componentData !== void 0 && _child$componentData.events) {\n          events.push({\n            elementId: child.id,\n            events: child.componentData.events,\n            type: child.type,\n            parentId: elementId\n          });\n        }\n\n        // Recursive cho nested children\n        if (Array.isArray(child.children)) {\n          processElement(child, child.id);\n        }\n      });\n    }\n  };\n  pageData.elements.forEach(element => {\n    processElement(element);\n  });\n  return events;\n};\n\n/**\r\n * Render t·∫•t c·∫£ popups th√†nh HTML\r\n * @param {Array} popups - Array of popup elements\r\n * @returns {string} - HTML string\r\n */\nconst renderPopupsHTML = popups => {\n  return popups.map(popup => {\n    const {\n      id,\n      componentData = {},\n      styles = {},\n      size = {},\n      children = []\n    } = popup;\n\n    // Render children content\n    const childrenHTML = children.map(child => renderElementHTML(child, true)).join('');\n    return `\n            <div \n                id=\"${id}\" \n                class=\"lpb-popup\" \n                data-element-id=\"${id}\"\n                style=\"display:none;\"\n            >\n                <!-- Overlay -->\n                <div \n                    class=\"lpb-popup-overlay\" \n                    onclick=\"LPB.popups.close('${id}')\"\n                ></div>\n                \n                <!-- Popup Container -->\n                <div \n                    class=\"lpb-popup-container\"\n                    style=\"\n                        width: ${size.width || 600}px;\n                        max-width: 90vw;\n                        min-height: ${size.height || 400}px;\n                        background: ${styles.background || componentData.background || 'rgba(255, 255, 255, 0.95)'};\n                        border-radius: ${styles.borderRadius || componentData.borderRadius || '12px'};\n                        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.25);\n                    \"\n                >\n                    <!-- Header -->\n                    <div class=\"lpb-popup-header\">\n                        <h3 style=\"margin:0; font-size:16px; font-weight:600; color:#111827;\">\n                            ${componentData.title || 'Popup Title'}\n                        </h3>\n                        <button \n                            class=\"lpb-popup-close\" \n                            onclick=\"LPB.popups.close('${id}')\"\n                            aria-label=\"Close popup\"\n                        >\n                            ‚úï\n                        </button>\n                    </div>\n                    \n                    <!-- Body -->\n                    <div class=\"lpb-popup-body\" style=\"padding: ${componentData.padding || '20px'};\">\n                        ${childrenHTML || `<p style=\"color:#6b7280;\">${componentData.content || 'Popup content'}</p>`}\n                    </div>\n                </div>\n            </div>\n        `;\n  }).join('\\n');\n};\n\n/**\r\n * Render m·ªôt element th√†nh HTML v·ªõi proper ID\r\n * @param {Object} element - Element object\r\n * @param {boolean} isChild - Whether this is a child element\r\n * @returns {string} - HTML string\r\n */\nconst renderElementHTML = (element, isChild = false) => {\n  var _position$desktop, _position$desktop2, _position$tablet, _position$desktop3, _position$tablet2, _position$desktop4, _position$mobile, _position$desktop5, _position$mobile2, _position$desktop6, _position$desktop7, _position$desktop8, _componentData$icon;\n  const {\n    id,\n    type,\n    componentData = {},\n    styles = {},\n    size = {},\n    position = {},\n    children = []\n  } = element;\n\n  // Convert styles object to inline CSS\n  const inlineStyles = Object.entries(styles).filter(([key]) => !key.startsWith(':') && !key.startsWith('@')).map(([key, value]) => {\n    const kebabKey = key.replace(/[A-Z]/g, m => `-${m.toLowerCase()}`);\n    return `${kebabKey}:${value}`;\n  }).join(';');\n\n  // Position data attributes for responsive positioning\n  const positionDataAttrs = isChild ? `\n        data-desktop-x=\"${((_position$desktop = position.desktop) === null || _position$desktop === void 0 ? void 0 : _position$desktop.x) || 0}\"\n        data-desktop-y=\"${((_position$desktop2 = position.desktop) === null || _position$desktop2 === void 0 ? void 0 : _position$desktop2.y) || 0}\"\n        data-tablet-x=\"${((_position$tablet = position.tablet) === null || _position$tablet === void 0 ? void 0 : _position$tablet.x) || ((_position$desktop3 = position.desktop) === null || _position$desktop3 === void 0 ? void 0 : _position$desktop3.x) || 0}\"\n        data-tablet-y=\"${((_position$tablet2 = position.tablet) === null || _position$tablet2 === void 0 ? void 0 : _position$tablet2.y) || ((_position$desktop4 = position.desktop) === null || _position$desktop4 === void 0 ? void 0 : _position$desktop4.y) || 0}\"\n        data-mobile-x=\"${((_position$mobile = position.mobile) === null || _position$mobile === void 0 ? void 0 : _position$mobile.x) || ((_position$desktop5 = position.desktop) === null || _position$desktop5 === void 0 ? void 0 : _position$desktop5.x) || 0}\"\n        data-mobile-y=\"${((_position$mobile2 = position.mobile) === null || _position$mobile2 === void 0 ? void 0 : _position$mobile2.y) || ((_position$desktop6 = position.desktop) === null || _position$desktop6 === void 0 ? void 0 : _position$desktop6.y) || 0}\"\n    ` : '';\n\n  // Base attributes\n  const baseAttrs = `\n        id=\"${id}\"\n        data-element-id=\"${id}\"\n        data-type=\"${type}\"\n        class=\"lpb-element lpb-${type}\"\n        ${positionDataAttrs}\n    `;\n\n  // Position styles cho child elements\n  const positionStyles = isChild ? `\n        position: absolute;\n        left: ${((_position$desktop7 = position.desktop) === null || _position$desktop7 === void 0 ? void 0 : _position$desktop7.x) || 0}px;\n        top: ${((_position$desktop8 = position.desktop) === null || _position$desktop8 === void 0 ? void 0 : _position$desktop8.y) || 0}px;\n        width: ${size.width || 200}px;\n        height: ${size.height || 50}px;\n    ` : '';\n\n  // Render based on type\n  switch (type) {\n    case 'section':\n      return renderSectionHTML(element);\n    case 'button':\n      return `\n                <button\n                    ${baseAttrs}\n                    style=\"${inlineStyles}; ${positionStyles}\"\n                >\n                    ${componentData.content || componentData.text || 'Button'}\n                </button>\n            `;\n    case 'heading':\n      const HeadingTag = componentData.level || 'h2';\n      return `\n                <${HeadingTag}\n                    ${baseAttrs}\n                    style=\"${inlineStyles}; ${positionStyles}\"\n                >\n                    ${componentData.content || componentData.text || 'Heading'}\n                </${HeadingTag}>\n            `;\n    case 'paragraph':\n      return `\n                <p\n                    ${baseAttrs}\n                    style=\"${inlineStyles}; ${positionStyles}\"\n                >\n                    ${componentData.content || componentData.text || 'Paragraph'}\n                </p>\n            `;\n    case 'image':\n      return `\n                <img\n                    ${baseAttrs}\n                    src=\"${componentData.src || componentData.imageUrl || 'https://via.placeholder.com/150'}\"\n                    alt=\"${componentData.alt || 'Image'}\"\n                    style=\"${inlineStyles}; ${positionStyles}\"\n                />\n            `;\n    case 'icon':\n      const isSvg = (_componentData$icon = componentData.icon) === null || _componentData$icon === void 0 ? void 0 : _componentData$icon.startsWith('<svg');\n      return `\n                <div\n                    ${baseAttrs}\n                    style=\"${inlineStyles}; ${positionStyles}\"\n                    title=\"${componentData.title || ''}\"\n                >\n                    ${componentData.imageUrl ? `<img src=\"${componentData.imageUrl}\" alt=\"${componentData.title || 'Icon'}\" style=\"width:100%;height:100%;object-fit:contain;\" />` : isSvg ? componentData.icon : componentData.icon ? `<i class=\"${componentData.icon}\"></i>` : 'üì¶'}\n                </div>\n            `;\n    case 'gallery':\n      return renderGalleryHTML(element, isChild);\n    case 'video':\n      return `\n                <video\n                    ${baseAttrs}\n                    src=\"${componentData.src || componentData.videoUrl || ''}\"\n                    controls=\"${componentData.controls !== false}\"\n                    autoplay=\"${componentData.autoplay === true}\"\n                    loop=\"${componentData.loop === true}\"\n                    muted=\"${componentData.muted === true}\"\n                    style=\"${inlineStyles}; ${positionStyles}\"\n                >\n                    ${componentData.fallbackText || 'Your browser does not support the video tag.'}\n                </video>\n            `;\n    case 'divider':\n    case 'hr':\n      return `\n                <hr\n                    ${baseAttrs}\n                    style=\"${inlineStyles}; ${positionStyles}; border:none; height:${componentData.thickness || '2px'}; background:${componentData.color || '#e5e7eb'};\"\n                />\n            `;\n    case 'link':\n    case 'anchor':\n      return `\n                <a\n                    ${baseAttrs}\n                    href=\"${componentData.href || componentData.url || '#'}\"\n                    target=\"${componentData.newTab || componentData.target === '_blank' ? '_blank' : '_self'}\"\n                    rel=\"${componentData.newTab || componentData.target === '_blank' ? 'noopener noreferrer' : ''}\"\n                    style=\"${inlineStyles}; ${positionStyles}\"\n                >\n                    ${componentData.content || componentData.text || 'Link'}\n                </a>\n            `;\n    case 'form':\n      const formChildren = children.map(child => renderElementHTML(child, true)).join('\\n');\n      return `\n                <form\n                    ${baseAttrs}\n                    action=\"${componentData.action || '#'}\"\n                    method=\"${componentData.method || 'POST'}\"\n                    style=\"${inlineStyles}; ${positionStyles}\"\n                >\n                    ${formChildren || '<p>Empty form</p>'}\n                </form>\n            `;\n    case 'input':\n      return `\n                <input\n                    ${baseAttrs}\n                    type=\"${componentData.inputType || 'text'}\"\n                    name=\"${componentData.name || id}\"\n                    placeholder=\"${componentData.placeholder || ''}\"\n                    value=\"${componentData.value || ''}\"\n                    required=\"${componentData.required === true}\"\n                    style=\"${inlineStyles}; ${positionStyles}\"\n                />\n            `;\n    case 'textarea':\n      return `\n                <textarea\n                    ${baseAttrs}\n                    name=\"${componentData.name || id}\"\n                    placeholder=\"${componentData.placeholder || ''}\"\n                    rows=\"${componentData.rows || 4}\"\n                    required=\"${componentData.required === true}\"\n                    style=\"${inlineStyles}; ${positionStyles}\"\n                >${componentData.value || ''}</textarea>\n            `;\n    case 'container':\n    case 'div':\n      const containerChildren = children.map(child => renderElementHTML(child, true)).join('\\n');\n      return `\n                <div\n                    ${baseAttrs}\n                    style=\"${inlineStyles}; ${positionStyles}\"\n                >\n                    ${containerChildren || componentData.content || ''}\n                </div>\n            `;\n    default:\n      // Default fallback for unknown element types\n      const defaultChildren = children.length > 0 ? children.map(child => renderElementHTML(child, true)).join('\\n') : componentData.content || componentData.text || `[${type}]`;\n      return `\n                <div\n                    ${baseAttrs}\n                    style=\"${inlineStyles}; ${positionStyles}\"\n                >\n                    ${defaultChildren}\n                </div>\n            `;\n  }\n};\n\n/**\r\n * Render gallery element\r\n */\nconst renderGalleryHTML = (element, isChild) => {\n  var _position$desktop9, _position$desktop0;\n  const {\n    id,\n    componentData = {},\n    styles = {},\n    size = {},\n    position = {}\n  } = element;\n  const positionStyles = isChild ? `\n        position: absolute;\n        left: ${((_position$desktop9 = position.desktop) === null || _position$desktop9 === void 0 ? void 0 : _position$desktop9.x) || 0}px;\n        top: ${((_position$desktop0 = position.desktop) === null || _position$desktop0 === void 0 ? void 0 : _position$desktop0.y) || 0}px;\n    ` : '';\n  const images = componentData.images || [];\n  return `\n        <div \n            id=\"${id}\"\n            data-element-id=\"${id}\"\n            data-type=\"gallery\"\n            class=\"lpb-element lpb-gallery\"\n            style=\"${positionStyles} width: ${size.width || 380}px; height: ${size.height || 300}px;\"\n        >\n            <div style=\"\n                display: ${styles.display || 'grid'};\n                grid-template-columns: ${styles.gridTemplateColumns || 'repeat(auto-fill, minmax(150px, 1fr))'};\n                gap: ${styles.gap || '10px'};\n                width: 100%;\n                height: 100%;\n            \">\n                ${images.map((imageUrl, index) => `\n                    <div style=\"\n                        position: relative;\n                        overflow: hidden;\n                        border-radius: ${styles.borderRadius || '8px'};\n                        aspect-ratio: 1 / 1;\n                    \">\n                        <img\n                            src=\"${imageUrl || 'https://via.placeholder.com/150'}\"\n                            alt=\"Gallery ${index + 1}\"\n                            style=\"\n                                width: 100%;\n                                height: 100%;\n                                object-fit: ${styles.objectFit || 'cover'};\n                                object-position: ${styles.objectPosition || 'center'};\n                            \"\n                            loading=\"lazy\"\n                        />\n                    </div>\n                `).join('')}\n                ${images.length === 0 ? `\n                    <div style=\"\n                        display: flex;\n                        flex-direction: column;\n                        align-items: center;\n                        justify-content: center;\n                        color: #9ca3af;\n                        text-align: center;\n                        grid-column: 1 / -1;\n                    \">\n                        <i class=\"fas fa-image\" style=\"font-size: 48px; margin-bottom: 8px;\"></i>\n                        <p>Empty gallery</p>\n                    </div>\n                ` : ''}\n            </div>\n        </div>\n    `;\n};\n\n/**\r\n * Render section v·ªõi children\r\n */\nconst renderSectionHTML = section => {\n  var _position$desktop1, _position$tablet3, _position$desktop10, _position$mobile3, _position$desktop11, _position$desktop12;\n  const {\n    id,\n    componentData = {},\n    styles = {},\n    size = {},\n    position = {},\n    children = []\n  } = section;\n\n  // Render children\n  const childrenHTML = children.map(child => renderElementHTML(child, true)).join('\\n');\n  return `\n        <section\n            id=\"${id}\"\n            data-element-id=\"${id}\"\n            class=\"lpb-section ladi-section\"\n            data-desktop-y=\"${((_position$desktop1 = position.desktop) === null || _position$desktop1 === void 0 ? void 0 : _position$desktop1.y) || 0}\"\n            data-tablet-y=\"${((_position$tablet3 = position.tablet) === null || _position$tablet3 === void 0 ? void 0 : _position$tablet3.y) || ((_position$desktop10 = position.desktop) === null || _position$desktop10 === void 0 ? void 0 : _position$desktop10.y) || 0}\"\n            data-mobile-y=\"${((_position$mobile3 = position.mobile) === null || _position$mobile3 === void 0 ? void 0 : _position$mobile3.y) || ((_position$desktop11 = position.desktop) === null || _position$desktop11 === void 0 ? void 0 : _position$desktop11.y) || 0}\"\n            style=\"\n                position: absolute;\n                top: ${((_position$desktop12 = position.desktop) === null || _position$desktop12 === void 0 ? void 0 : _position$desktop12.y) || 0}px;\n                left: 50%;\n                transform: translateX(-50%);\n                width: 1200px;\n                height: ${size.height || 400}px;\n            \"\n        >\n            <!-- Background -->\n            <div class=\"ladi-section-background\" style=\"\n                position: absolute;\n                inset: 0;\n                z-index: 0;\n                background-color: ${componentData.backgroundColor || styles.backgroundColor || 'transparent'};\n                background-image: ${componentData.backgroundImage ? `url(${componentData.backgroundImage})` : 'none'};\n                background-size: cover;\n                background-position: center;\n            \"></div>\n\n            <!-- Overlay -->\n            <div class=\"ladi-overlay\" style=\"\n                position: absolute;\n                inset: 0;\n                z-index: 0;\n                background-color: ${componentData.overlayColor || 'transparent'};\n                opacity: ${componentData.overlayOpacity || 0};\n            \"></div>\n\n            <!-- Container -->\n            <div class=\"ladi-container\" style=\"\n                position: relative;\n                z-index: 1;\n                padding: ${componentData.padding || styles.padding || '20px'};\n                width: 100%;\n                height: 100%;\n            \">\n                ${childrenHTML}\n            </div>\n        </section>\n    `;\n};\n\n/**\r\n * Generate CSS t·ª´ pageData\r\n */\nconst generateCSS = pageData => {\n  let css = `\n        * {\n            box-sizing: border-box;\n        }\n\n        body {\n            margin: 0;\n            padding: 0;\n            overflow-x: hidden;\n        }\n\n        .lpb-element {\n            transition: all 0.3s ease;\n        }\n\n        /* Base responsive images */\n        .lpb-element img {\n            max-width: 100%;\n            height: auto;\n        }\n    `;\n\n  // Extract pseudo-classes v√† animations t·ª´ elements\n  pageData.elements.forEach(element => {\n    const {\n      id,\n      styles = {}\n    } = element;\n\n    // Process hover states\n    if (styles[':hover']) {\n      css += `\\n#${id}:hover {`;\n      Object.entries(styles[':hover']).forEach(([key, value]) => {\n        const kebabKey = key.replace(/[A-Z]/g, m => `-${m.toLowerCase()}`);\n        css += `${kebabKey}:${value};`;\n      });\n      css += `}`;\n    }\n\n    // Process keyframes\n    Object.entries(styles).forEach(([key, value]) => {\n      if (key.startsWith('@keyframes')) {\n        css += `\\n${key} {`;\n        Object.entries(value).forEach(([frame, props]) => {\n          css += `${frame} {`;\n          Object.entries(props).forEach(([prop, val]) => {\n            const kebabProp = prop.replace(/[A-Z]/g, m => `-${m.toLowerCase()}`);\n            css += `${kebabProp}:${val};`;\n          });\n          css += `}`;\n        });\n        css += `}`;\n      }\n    });\n\n    // Process children\n    if (element.children) {\n      element.children.forEach(child => {\n        var _child$styles;\n        if ((_child$styles = child.styles) !== null && _child$styles !== void 0 && _child$styles[':hover']) {\n          css += `\\n#${child.id}:hover {`;\n          Object.entries(child.styles[':hover']).forEach(([key, value]) => {\n            const kebabKey = key.replace(/[A-Z]/g, m => `-${m.toLowerCase()}`);\n            css += `${kebabKey}:${value};`;\n          });\n          css += `}`;\n        }\n      });\n    }\n  });\n\n  // Generate responsive positioning CSS for all elements with data attributes\n  css += `\\n\\n/* Responsive Tablet (‚â§768px) */`;\n  css += `\\n@media (max-width: 768px) {`;\n  pageData.elements.forEach(element => {\n    if (element.type === 'section') {\n      var _element$position, _element$position$tab, _element$position2, _element$position2$de;\n      css += `\\n    #${element.id} { top: var(--tablet-y-${element.id}, ${((_element$position = element.position) === null || _element$position === void 0 ? void 0 : (_element$position$tab = _element$position.tablet) === null || _element$position$tab === void 0 ? void 0 : _element$position$tab.y) || ((_element$position2 = element.position) === null || _element$position2 === void 0 ? void 0 : (_element$position2$de = _element$position2.desktop) === null || _element$position2$de === void 0 ? void 0 : _element$position2$de.y) || 0}px); }`;\n\n      // Process children positioning\n      if (element.children) {\n        element.children.forEach(child => {\n          var _child$position, _child$position$table, _child$position2, _child$position2$desk, _child$position3, _child$position3$tabl, _child$position4, _child$position4$desk;\n          const tabletX = ((_child$position = child.position) === null || _child$position === void 0 ? void 0 : (_child$position$table = _child$position.tablet) === null || _child$position$table === void 0 ? void 0 : _child$position$table.x) || ((_child$position2 = child.position) === null || _child$position2 === void 0 ? void 0 : (_child$position2$desk = _child$position2.desktop) === null || _child$position2$desk === void 0 ? void 0 : _child$position2$desk.x) || 0;\n          const tabletY = ((_child$position3 = child.position) === null || _child$position3 === void 0 ? void 0 : (_child$position3$tabl = _child$position3.tablet) === null || _child$position3$tabl === void 0 ? void 0 : _child$position3$tabl.y) || ((_child$position4 = child.position) === null || _child$position4 === void 0 ? void 0 : (_child$position4$desk = _child$position4.desktop) === null || _child$position4$desk === void 0 ? void 0 : _child$position4$desk.y) || 0;\n          css += `\\n    #${child.id} { left: ${tabletX}px; top: ${tabletY}px; }`;\n        });\n      }\n    }\n  });\n  css += `\\n}`;\n\n  // Generate responsive positioning CSS for mobile\n  css += `\\n\\n/* Responsive Mobile (‚â§480px) */`;\n  css += `\\n@media (max-width: 480px) {`;\n  pageData.elements.forEach(element => {\n    if (element.type === 'section') {\n      var _element$position3, _element$position3$mo, _element$position4, _element$position4$de;\n      css += `\\n    #${element.id} { top: var(--mobile-y-${element.id}, ${((_element$position3 = element.position) === null || _element$position3 === void 0 ? void 0 : (_element$position3$mo = _element$position3.mobile) === null || _element$position3$mo === void 0 ? void 0 : _element$position3$mo.y) || ((_element$position4 = element.position) === null || _element$position4 === void 0 ? void 0 : (_element$position4$de = _element$position4.desktop) === null || _element$position4$de === void 0 ? void 0 : _element$position4$de.y) || 0}px); }`;\n\n      // Process children positioning\n      if (element.children) {\n        element.children.forEach(child => {\n          var _child$position5, _child$position5$mobi, _child$position6, _child$position6$desk, _child$position7, _child$position7$mobi, _child$position8, _child$position8$desk;\n          const mobileX = ((_child$position5 = child.position) === null || _child$position5 === void 0 ? void 0 : (_child$position5$mobi = _child$position5.mobile) === null || _child$position5$mobi === void 0 ? void 0 : _child$position5$mobi.x) || ((_child$position6 = child.position) === null || _child$position6 === void 0 ? void 0 : (_child$position6$desk = _child$position6.desktop) === null || _child$position6$desk === void 0 ? void 0 : _child$position6$desk.x) || 0;\n          const mobileY = ((_child$position7 = child.position) === null || _child$position7 === void 0 ? void 0 : (_child$position7$mobi = _child$position7.mobile) === null || _child$position7$mobi === void 0 ? void 0 : _child$position7$mobi.y) || ((_child$position8 = child.position) === null || _child$position8 === void 0 ? void 0 : (_child$position8$desk = _child$position8.desktop) === null || _child$position8$desk === void 0 ? void 0 : _child$position8$desk.y) || 0;\n          css += `\\n    #${child.id} { left: ${mobileX}px; top: ${mobileY}px; }`;\n        });\n      }\n    }\n  });\n  css += `\\n}`;\n\n  // Generate responsive CSS for very small screens (‚â§360px)\n  css += `\\n\\n/* Responsive Very Small Screens (‚â§360px) */`;\n  css += `\\n@media (max-width: 360px) {`;\n  css += `\\n    /* Scale down font sizes for very small screens */`;\n  css += `\\n    .lpb-heading, h1, h2, h3, h4, h5, h6 { font-size: 85% !important; }`;\n  css += `\\n    .lpb-paragraph, p { font-size: 90% !important; line-height: 1.4 !important; }`;\n  css += `\\n    .lpb-button { font-size: 85% !important; padding: 8px 16px !important; }`;\n  css += `\\n    .ladi-container { padding: 12px !important; }`;\n  css += `\\n}`;\n  return css;\n};\n\n/**\r\n * Render to√†n b·ªô pageData th√†nh static HTML v·ªõi embedded runtime\r\n * @param {Object} pageData - Page data\r\n * @returns {string} - Complete HTML document\r\n */\nexport const renderStaticHTML = pageData => {\n  var _pageData$meta, _pageData$meta2, _pageData$canvas, _pageData$analytics;\n  // Extract components\n  const popups = pageData.elements.filter(el => el.type === 'popup');\n  const sections = pageData.elements.filter(el => el.type === 'section');\n  const events = extractEvents(pageData);\n\n  // Generate HTML parts\n  const sectionsHTML = sections.map(section => renderSectionHTML(section)).join('\\n');\n  const popupsHTML = renderPopupsHTML(popups);\n  const runtimeScript = generateEventRuntime(events, popups);\n\n  // Generate CSS\n  const cssContent = generateCSS(pageData);\n\n  // Combine everything\n  return `<!DOCTYPE html>\n<html lang=\"vi\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <meta name=\"description\" content=\"${((_pageData$meta = pageData.meta) === null || _pageData$meta === void 0 ? void 0 : _pageData$meta.description) || 'Landing page generated by LandingHub'}\">\n    <title>${((_pageData$meta2 = pageData.meta) === null || _pageData$meta2 === void 0 ? void 0 : _pageData$meta2.title) || 'Landing Page'}</title>\n    \n    <!-- Font Awesome -->\n    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css\" crossorigin=\"anonymous\" referrerpolicy=\"no-referrer\" />\n    \n    <!-- Styles -->\n    <style>\n        ${cssContent}\n        \n        /* Popup Styles */\n        .lpb-popup {\n            position: fixed;\n            inset: 0;\n            z-index: 9999;\n            display: none;\n            align-items: center;\n            justify-content: center;\n        }\n        \n        .lpb-popup.lpb-popup-active {\n            display: flex;\n        }\n        \n        .lpb-popup-overlay {\n            position: absolute;\n            inset: 0;\n            background: rgba(0, 0, 0, 0.5);\n            cursor: pointer;\n        }\n        \n        .lpb-popup-container {\n            position: relative;\n            z-index: 1;\n            background: white;\n            border-radius: 12px;\n            max-height: 90vh;\n            overflow-y: auto;\n            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);\n        }\n        \n        .lpb-popup-header {\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            padding: 16px 20px;\n            border-bottom: 1px solid #e5e7eb;\n            background: linear-gradient(to bottom, #f9fafb, #ffffff);\n        }\n        \n        .lpb-popup-close {\n            width: 28px;\n            height: 28px;\n            border: none;\n            background: transparent;\n            cursor: pointer;\n            border-radius: 6px;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            transition: all 0.15s ease;\n            color: #6b7280;\n            font-size: 18px;\n            font-weight: bold;\n        }\n        \n        .lpb-popup-close:hover {\n            background: #f3f4f6;\n            color: #111827;\n        }\n        \n        .lpb-popup-body {\n            padding: 20px;\n        }\n        \n        /* Loading Spinner */\n        .lpb-spinner {\n            border: 3px solid #f3f3f3;\n            border-top: 3px solid #3b82f6;\n            border-radius: 50%;\n            width: 40px;\n            height: 40px;\n            animation: spin 1s linear infinite;\n            margin: 0 auto;\n        }\n        \n        @keyframes spin {\n            0% { transform: rotate(0deg); }\n            100% { transform: rotate(360deg); }\n        }\n        \n        /* ========== RESPONSIVE STYLES ========== */\n\n        /* Tablet (‚â§1024px) */\n        @media (max-width: 1024px) {\n            .lpb-section {\n                width: 95% !important;\n                max-width: 768px !important;\n            }\n\n            .ladi-container {\n                padding: 16px !important;\n            }\n        }\n\n        /* Mobile (‚â§768px) */\n        @media (max-width: 768px) {\n            .lpb-section {\n                width: 100% !important;\n                max-width: 100% !important;\n                left: 0 !important;\n                transform: none !important;\n            }\n\n            .ladi-container {\n                padding: 16px !important;\n            }\n\n            .lpb-popup-container {\n                width: 90% !important;\n                max-width: 90vw !important;\n                min-height: auto !important;\n            }\n\n            .lpb-popup-body {\n                padding: 16px !important;\n            }\n\n            /* Scale down typography */\n            .lpb-heading, h1 {\n                font-size: clamp(24px, 5vw, 32px) !important;\n            }\n\n            .lpb-heading, h2 {\n                font-size: clamp(20px, 4.5vw, 28px) !important;\n            }\n\n            .lpb-heading, h3 {\n                font-size: clamp(18px, 4vw, 24px) !important;\n            }\n\n            .lpb-paragraph, p {\n                font-size: clamp(14px, 3.5vw, 16px) !important;\n                line-height: 1.6 !important;\n            }\n\n            .lpb-button {\n                font-size: clamp(14px, 3.5vw, 16px) !important;\n                padding: 10px 20px !important;\n            }\n\n            /* Responsive images and galleries */\n            .lpb-gallery {\n                width: 100% !important;\n                height: auto !important;\n            }\n\n            .lpb-image, .lpb-element img {\n                max-width: 100% !important;\n                height: auto !important;\n            }\n        }\n\n        /* Small Mobile (‚â§480px) */\n        @media (max-width: 480px) {\n            .ladi-container {\n                padding: 12px !important;\n            }\n\n            .lpb-popup-body {\n                padding: 12px !important;\n            }\n\n            .lpb-heading, h1 {\n                font-size: clamp(20px, 5vw, 28px) !important;\n            }\n\n            .lpb-heading, h2 {\n                font-size: clamp(18px, 4.5vw, 24px) !important;\n            }\n\n            .lpb-heading, h3 {\n                font-size: clamp(16px, 4vw, 20px) !important;\n            }\n\n            .lpb-paragraph, p {\n                font-size: clamp(13px, 3.5vw, 15px) !important;\n            }\n\n            .lpb-button {\n                padding: 8px 16px !important;\n                min-height: 40px !important;\n            }\n        }\n\n        /* Very Small Screens (‚â§360px) */\n        @media (max-width: 360px) {\n            body {\n                font-size: 14px !important;\n            }\n\n            .ladi-container {\n                padding: 10px !important;\n            }\n\n            .lpb-popup-container {\n                width: 95% !important;\n                border-radius: 8px !important;\n            }\n\n            .lpb-popup-body {\n                padding: 10px !important;\n            }\n\n            .lpb-popup-header {\n                padding: 12px 16px !important;\n            }\n\n            .lpb-heading, h1 {\n                font-size: clamp(18px, 5vw, 24px) !important;\n            }\n\n            .lpb-heading, h2 {\n                font-size: clamp(16px, 4.5vw, 20px) !important;\n            }\n\n            .lpb-heading, h3, h4 {\n                font-size: clamp(15px, 4vw, 18px) !important;\n            }\n\n            .lpb-paragraph, p {\n                font-size: clamp(12px, 3.5vw, 14px) !important;\n                line-height: 1.5 !important;\n            }\n\n            .lpb-button {\n                font-size: 13px !important;\n                padding: 8px 12px !important;\n                min-height: 36px !important;\n            }\n\n            /* Reduce icon sizes */\n            .lpb-icon {\n                width: 80% !important;\n                height: 80% !important;\n            }\n        }\n    </style>\n</head>\n<body style=\"margin: 0; padding: 0; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\">\n    <!-- Canvas -->\n    <div id=\"lpb-canvas\" style=\"\n        position: relative;\n        min-height: 100vh;\n        background: ${((_pageData$canvas = pageData.canvas) === null || _pageData$canvas === void 0 ? void 0 : _pageData$canvas.background) || '#ffffff'};\n    \">\n        ${sectionsHTML}\n    </div>\n    \n    <!-- Popups -->\n    ${popupsHTML}\n    \n    <!-- Runtime Script -->\n    <script>\n        ${runtimeScript}\n    </script>\n\n    <!-- Embedded PageData for easy import -->\n    <script type=\"application/json\" id=\"lpb-page-data\">\n${JSON.stringify(pageData, null, 2)}\n    </script>\n\n    <!-- Google Analytics (optional) -->\n    ${(_pageData$analytics = pageData.analytics) !== null && _pageData$analytics !== void 0 && _pageData$analytics.googleAnalyticsId ? `\n    <script async src=\"https://www.googletagmanager.com/gtag/js?id=${pageData.analytics.googleAnalyticsId}\"></script>\n    <script>\n        window.dataLayer = window.dataLayer || [];\n        function gtag(){dataLayer.push(arguments);}\n        gtag('js', new Date());\n        gtag('config', '${pageData.analytics.googleAnalyticsId}');\n    </script>\n    ` : ''}\n</body>\n</html>`;\n};\nconst findElementById = (elements, id) => {\n  for (const element of elements) {\n    if (element.id === id) return element;\n    if (element.children && element.children.length > 0) {\n      const found = findElementById(element.children, id);\n      if (found) return found;\n    }\n  }\n  return null;\n};\n/**\r\n * Parse HTML string th√†nh pageData structure ƒë·∫ßy ƒë·ªß\r\n * @param {string} htmlString - HTML content t·ª´ S3\r\n * @returns {Object} pageData v·ªõi c·∫•u tr√∫c { canvas, elements, meta }\r\n */\nexport const parseHTMLToPageData = htmlString => {\n  const pageData = {\n    canvas: {\n      width: 1200,\n      height: 'auto',\n      background: '#ffffff'\n    },\n    elements: [],\n    meta: {\n      title: 'Untitled',\n      description: '',\n      keywords: [],\n      created_at: new Date().toISOString(),\n      updated_at: new Date().toISOString()\n    },\n    analytics: {}\n  };\n  try {\n    const parser = new DOMParser();\n    const doc = parser.parseFromString(htmlString, 'text/html');\n\n    // ========== PARSE META ==========\n    const titleEl = doc.querySelector('title');\n    if (titleEl) {\n      pageData.meta.title = titleEl.textContent.trim() || 'Untitled';\n    }\n    const descEl = doc.querySelector('meta[name=\"description\"]');\n    if (descEl) {\n      pageData.meta.description = descEl.getAttribute('content') || '';\n    }\n    const keywordsEl = doc.querySelector('meta[name=\"keywords\"]');\n    if (keywordsEl) {\n      var _keywordsEl$getAttrib;\n      pageData.meta.keywords = ((_keywordsEl$getAttrib = keywordsEl.getAttribute('content')) === null || _keywordsEl$getAttrib === void 0 ? void 0 : _keywordsEl$getAttrib.split(',').map(k => k.trim())) || [];\n    }\n    const analyticsScript = doc.querySelector('script[src*=\"googletagmanager\"]');\n    if (analyticsScript) {\n      const gaId = analyticsScript.src.match(/id=([A-Za-z0-9-_]+)/);\n      if (gaId) {\n        pageData.analytics.googleAnalyticsId = gaId[1];\n      }\n    }\n\n    // ========== TRY 1: PARSE EMBEDDED pageData (∆ØU TI√äN) ==========\n    const pageDataScript = doc.querySelector('script[type=\"application/json\"][id=\"lpb-page-data\"]');\n    if (pageDataScript) {\n      try {\n        const embeddedData = JSON.parse(pageDataScript.textContent || pageDataScript.innerHTML);\n        console.log('‚úÖ Found embedded pageData in <script id=\"lpb-page-data\">');\n\n        // Validate v√† normalize embedded pageData\n        if (embeddedData.canvas && Array.isArray(embeddedData.elements) && embeddedData.meta) {\n          pageData.canvas = {\n            width: embeddedData.canvas.width || 1200,\n            height: embeddedData.canvas.height || 'auto',\n            background: embeddedData.canvas.background || '#ffffff'\n          };\n          pageData.elements = normalizeElements(embeddedData.elements);\n          pageData.meta = {\n            title: embeddedData.meta.title || pageData.meta.title,\n            description: embeddedData.meta.description || pageData.meta.description,\n            keywords: embeddedData.meta.keywords || pageData.meta.keywords,\n            created_at: embeddedData.meta.created_at || pageData.meta.created_at,\n            updated_at: embeddedData.meta.updated_at || pageData.meta.updated_at\n          };\n          pageData.analytics = embeddedData.analytics || pageData.analytics;\n          return pageData; // Tr·∫£ v·ªÅ ngay n·∫øu embedded pageData h·ª£p l·ªá\n        } else {\n          console.warn('‚ö†Ô∏è Embedded pageData kh√¥ng h·ª£p l·ªá, fallback parse HTML');\n        }\n      } catch (parseError) {\n        console.warn('‚ö†Ô∏è Failed to parse embedded pageData JSON:', parseError.message);\n      }\n    }\n\n    // ========== TRY 2: PARSE HTML STRUCTURE ==========\n    console.log('üîç Parsing HTML structure...');\n\n    // Parse canvas t·ª´ #lpb-canvas\n    const canvasEl = doc.getElementById('lpb-canvas');\n    if (canvasEl) {\n      const canvasStyle = canvasEl.style;\n      pageData.canvas = {\n        width: parseInt(canvasStyle.width) || 1200,\n        height: canvasStyle.height || 'auto',\n        background: canvasStyle.background || canvasStyle.backgroundColor || '#ffffff',\n        minHeight: canvasStyle.minHeight || '100vh'\n      };\n    }\n\n    // Parse sections\n    const sections = doc.querySelectorAll('section.lpb-section, section.ladi-section, section[data-element-id]');\n    sections.forEach((sectionEl, index) => {\n      const section = parseSectionElement(sectionEl, index);\n      if (section) {\n        pageData.elements.push(section);\n      }\n    });\n\n    // Parse popups\n    const popups = doc.querySelectorAll('div.lpb-popup, div[data-type=\"popup\"]');\n    popups.forEach((popupEl, index) => {\n      const popup = parsePopupElement(popupEl, index);\n      if (popup) {\n        pageData.elements.push(popup);\n      }\n    });\n\n    // Parse standalone elements\n    const standaloneElements = doc.querySelectorAll('div.lpb-element:not(section):not(.lpb-popup):not(.lpb-child-element), [data-element-id]:not(.lpb-section):not(.lpb-popup)');\n    standaloneElements.forEach((el, index) => {\n      if (!el.closest('section.lpb-section, div.lpb-popup')) {\n        const element = parseStandaloneElement(el, index);\n        if (element) {\n          pageData.elements.push(element);\n        }\n      }\n    });\n\n    // Parse events t·ª´ runtime script\n    const runtimeScripts = doc.querySelectorAll('script');\n    runtimeScripts.forEach(script => {\n      const content = script.textContent || script.innerHTML;\n      const eventsConfig = extractEventsFromScript(content);\n      if (eventsConfig.length > 0) {\n        mapEventsToElements(pageData.elements, eventsConfig);\n      }\n    });\n\n    // Parse animations v√† keyframes t·ª´ <style>\n    const styleElements = doc.querySelectorAll('style');\n    styleElements.forEach(styleEl => {\n      const cssContent = styleEl.textContent || styleEl.innerHTML;\n      const animations = extractAnimationsFromCSS(cssContent);\n      mapAnimationsToElements(pageData.elements, animations);\n    });\n\n    // T√≠nh canvas height d·ª±a tr√™n elements\n    const maxHeight = Math.max(...pageData.elements.map(el => {\n      var _el$position, _el$position$desktop, _el$size;\n      const elTop = ((_el$position = el.position) === null || _el$position === void 0 ? void 0 : (_el$position$desktop = _el$position.desktop) === null || _el$position$desktop === void 0 ? void 0 : _el$position$desktop.y) || 0;\n      const elHeight = ((_el$size = el.size) === null || _el$size === void 0 ? void 0 : _el$size.height) || 400;\n      return elTop + elHeight;\n    }), 1648);\n    pageData.canvas.height = maxHeight;\n    console.log('‚úÖ HTML parsed successfully:', {\n      elementsCount: pageData.elements.length,\n      sections: pageData.elements.filter(el => el.type === 'section').length,\n      popups: pageData.elements.filter(el => el.type === 'popup').length,\n      standalone: pageData.elements.filter(el => el.type !== 'section' && el.type !== 'popup').length\n    });\n    return pageData;\n  } catch (error) {\n    console.error('‚ùå parseHTMLToPageData error:', error);\n    return pageData; // Fallback tr·∫£ v·ªÅ pageData m·∫∑c ƒë·ªãnh\n  }\n};\n\n// ==================== HELPER FUNCTIONS ====================\n\n/**\r\n * Normalize elements ƒë·ªÉ ƒë·∫£m b·∫£o c·∫•u tr√∫c h·ª£p l·ªá\r\n * @param {Array} elements - Array of elements\r\n * @returns {Array} Normalized elements\r\n */\nconst normalizeElements = elements => {\n  return elements.map(el => {\n    var _el$position2, _el$position3, _el$position4, _el$position5, _el$position6;\n    return {\n      id: el.id || `element-${Date.now()}-${Math.random().toString(36).slice(2)}`,\n      type: el.type || 'section',\n      componentData: el.componentData || {},\n      position: {\n        desktop: ((_el$position2 = el.position) === null || _el$position2 === void 0 ? void 0 : _el$position2.desktop) || {\n          x: 0,\n          y: 0,\n          z: 1\n        },\n        tablet: ((_el$position3 = el.position) === null || _el$position3 === void 0 ? void 0 : _el$position3.tablet) || ((_el$position4 = el.position) === null || _el$position4 === void 0 ? void 0 : _el$position4.desktop) || {\n          x: 0,\n          y: 0,\n          z: 1\n        },\n        mobile: ((_el$position5 = el.position) === null || _el$position5 === void 0 ? void 0 : _el$position5.mobile) || ((_el$position6 = el.position) === null || _el$position6 === void 0 ? void 0 : _el$position6.desktop) || {\n          x: 0,\n          y: 0,\n          z: 1\n        }\n      },\n      size: el.size || {\n        width: el.type === 'popup' ? 600 : 1200,\n        height: 400\n      },\n      styles: el.styles || {},\n      children: Array.isArray(el.children) ? normalizeElements(el.children) : [],\n      visible: el.visible !== false,\n      locked: !!el.locked\n    };\n  });\n};\n\n/**\r\n * Parse section element t·ª´ HTML\r\n * @param {HTMLElement} sectionEl - Section element\r\n * @param {number} index - Index c·ªßa section\r\n * @returns {Object|null} Section object\r\n */\nconst parseSectionElement = (sectionEl, index) => {\n  var _style$top, _style$width, _style$height;\n  const id = sectionEl.id || sectionEl.getAttribute('data-element-id') || `section-${Date.now()}-${index}`;\n  const style = sectionEl.style;\n  const topMatch = ((_style$top = style.top) === null || _style$top === void 0 ? void 0 : _style$top.match(/(\\d+)px/)) || ['0'];\n  const top = parseInt(topMatch[1]) || 0;\n  const widthMatch = ((_style$width = style.width) === null || _style$width === void 0 ? void 0 : _style$width.match(/(\\d+)px/)) || ['1200'];\n  const heightMatch = ((_style$height = style.height) === null || _style$height === void 0 ? void 0 : _style$height.match(/(\\d+)px/)) || ['400'];\n  const width = parseInt(widthMatch[1]) || 1200;\n  const height = parseInt(heightMatch[1]) || 400;\n  const bgEl = sectionEl.querySelector('.ladi-section-background');\n  const overlayEl = sectionEl.querySelector('.ladi-overlay');\n  const containerEl = sectionEl.querySelector('.ladi-container');\n  const componentData = {\n    structure: sectionEl.classList.contains('ladi-section') ? 'ladi-standard' : 'standard'\n  };\n  if (bgEl) {\n    var _bgStyle$backgroundIm;\n    const bgStyle = bgEl.style;\n    componentData.backgroundColor = bgStyle.backgroundColor || 'transparent';\n    const bgImageMatch = (_bgStyle$backgroundIm = bgStyle.backgroundImage) === null || _bgStyle$backgroundIm === void 0 ? void 0 : _bgStyle$backgroundIm.match(/url\\(['\"]?(.+?)['\"]?\\)/);\n    if (bgImageMatch) {\n      componentData.backgroundImage = bgImageMatch[1];\n      componentData.backgroundType = 'image';\n    } else if (componentData.backgroundColor !== 'transparent') {\n      componentData.backgroundType = 'color';\n    }\n    componentData.backgroundPosition = bgStyle.backgroundPosition || 'center';\n    componentData.backgroundSize = bgStyle.backgroundSize || 'cover';\n  }\n  if (overlayEl) {\n    componentData.overlayColor = overlayEl.style.backgroundColor || 'transparent';\n    componentData.overlayOpacity = parseFloat(overlayEl.style.opacity) || 0;\n  }\n  const styles = parseInlineStyles(style, sectionEl);\n  if (containerEl) {\n    componentData.padding = containerEl.style.padding || '20px';\n  }\n  const children = [];\n  if (containerEl) {\n    const childElements = containerEl.querySelectorAll('.lpb-element[data-element-id], .lpb-child-element');\n    childElements.forEach(childEl => {\n      if (childEl.closest('.ladi-container') === containerEl) {\n        const child = parseChildElement(childEl, id);\n        if (child) {\n          children.push(child);\n        }\n      }\n    });\n  }\n  return {\n    id,\n    type: 'section',\n    componentData,\n    position: {\n      desktop: {\n        x: 0,\n        y: top,\n        z: parseInt(style.zIndex) || index + 1\n      },\n      tablet: {\n        x: 0,\n        y: top,\n        z: parseInt(style.zIndex) || index + 1\n      },\n      mobile: {\n        x: 0,\n        y: top,\n        z: parseInt(style.zIndex) || index + 1\n      }\n    },\n    size: {\n      width,\n      height\n    },\n    styles,\n    children,\n    visible: style.display !== 'none',\n    locked: sectionEl.classList.contains('lpb-element-locked')\n  };\n};\n\n/**\r\n * Parse popup element t·ª´ HTML\r\n * @param {HTMLElement} popupEl - Popup element\r\n * @param {number} index - Index c·ªßa popup\r\n * @returns {Object|null} Popup object\r\n */\nconst parsePopupElement = (popupEl, index) => {\n  var _containerEl$style$wi, _containerEl$style$mi;\n  const id = popupEl.id || popupEl.getAttribute('data-element-id') || `popup-${Date.now()}-${index}`;\n  const containerEl = popupEl.querySelector('.lpb-popup-container');\n  if (!containerEl) return null;\n  const widthMatch = ((_containerEl$style$wi = containerEl.style.width) === null || _containerEl$style$wi === void 0 ? void 0 : _containerEl$style$wi.match(/(\\d+)px/)) || ['600'];\n  const minHeightMatch = ((_containerEl$style$mi = containerEl.style.minHeight) === null || _containerEl$style$mi === void 0 ? void 0 : _containerEl$style$mi.match(/(\\d+)px/)) || ['400'];\n  const width = parseInt(widthMatch[1]) || 600;\n  const height = parseInt(minHeightMatch[1]) || 400;\n  const headerEl = popupEl.querySelector('.lpb-popup-header h3');\n  const bodyEl = popupEl.querySelector('.lpb-popup-body');\n  const componentData = {\n    title: (headerEl === null || headerEl === void 0 ? void 0 : headerEl.textContent.trim()) || 'Popup',\n    background: containerEl.style.background || 'rgba(255, 255, 255, 0.95)',\n    borderRadius: containerEl.style.borderRadius || '12px',\n    padding: (bodyEl === null || bodyEl === void 0 ? void 0 : bodyEl.style.padding) || '20px'\n  };\n  const styles = parseInlineStyles(containerEl.style, popupEl);\n  const children = [];\n  if (bodyEl) {\n    const childElements = bodyEl.querySelectorAll('.lpb-element[data-element-id], .lpb-child-element');\n    childElements.forEach(childEl => {\n      if (childEl.closest('.lpb-popup-body') === bodyEl) {\n        const child = parseChildElement(childEl, id);\n        if (child) {\n          children.push(child);\n        }\n      }\n    });\n  }\n  return {\n    id,\n    type: 'popup',\n    componentData,\n    position: {\n      desktop: {\n        x: 0,\n        y: 0,\n        z: parseInt(containerEl.style.zIndex) || 1001\n      },\n      tablet: {\n        x: 0,\n        y: 0,\n        z: parseInt(containerEl.style.zIndex) || 1001\n      },\n      mobile: {\n        x: 0,\n        y: 0,\n        z: parseInt(containerEl.style.zIndex) || 1001\n      }\n    },\n    size: {\n      width,\n      height\n    },\n    styles,\n    children,\n    visible: popupEl.classList.contains('lpb-popup-active') || popupEl.style.display !== 'none',\n    locked: popupEl.classList.contains('lpb-element-locked')\n  };\n};\n\n/**\r\n * Parse standalone element t·ª´ HTML\r\n * @param {HTMLElement} element - Standalone element\r\n * @param {number} index - Index c·ªßa element\r\n * @returns {Object|null} Element object\r\n */\nconst parseStandaloneElement = (element, index) => {\n  var _style$left, _style$top2, _style$width2, _style$height2;\n  const id = element.id || element.getAttribute('data-element-id') || `element-${Date.now()}-${index}`;\n  const type = element.getAttribute('data-type') || inferTypeFromElement(element);\n  const style = element.style;\n  const leftMatch = ((_style$left = style.left) === null || _style$left === void 0 ? void 0 : _style$left.match(/(\\d+)px/)) || ['0'];\n  const topMatch = ((_style$top2 = style.top) === null || _style$top2 === void 0 ? void 0 : _style$top2.match(/(\\d+)px/)) || ['0'];\n  const widthMatch = ((_style$width2 = style.width) === null || _style$width2 === void 0 ? void 0 : _style$width2.match(/(\\d+)px/)) || [type === 'gallery' ? '380' : '200'];\n  const heightMatch = ((_style$height2 = style.height) === null || _style$height2 === void 0 ? void 0 : _style$height2.match(/(\\d+)px/)) || [type === 'gallery' ? '300' : '50'];\n  const left = parseInt(leftMatch[1]) || 0;\n  const top = parseInt(topMatch[1]) || 0;\n  const width = parseInt(widthMatch[1]) || (type === 'gallery' ? 380 : type === 'icon' ? 50 : 200);\n  const height = parseInt(heightMatch[1]) || (type === 'gallery' ? 300 : type === 'icon' ? 50 : 50);\n  const styles = parseInlineStyles(style, element);\n  const componentData = parseComponentData(element, type);\n  return {\n    id,\n    type,\n    componentData,\n    position: {\n      desktop: {\n        x: left,\n        y: top,\n        z: parseInt(style.zIndex) || index + 1\n      },\n      tablet: {\n        x: left,\n        y: top,\n        z: parseInt(style.zIndex) || index + 1\n      },\n      mobile: {\n        x: left,\n        y: top,\n        z: parseInt(style.zIndex) || index + 1\n      }\n    },\n    size: {\n      width,\n      height\n    },\n    styles,\n    children: [],\n    visible: style.display !== 'none',\n    locked: element.classList.contains('lpb-element-locked')\n  };\n};\n\n/**\r\n * Parse child element t·ª´ HTML\r\n * @param {HTMLElement} element - Child element\r\n * @param {string} parentId - ID c·ªßa parent (section/popup)\r\n * @returns {Object|null} Child element object\r\n */\nconst parseChildElement = (element, parentId) => {\n  var _style$left2, _style$top3, _style$width3, _style$height3;\n  const id = element.id || element.getAttribute('data-element-id') || `child-${Date.now()}-${Math.random().toString(36).slice(2)}`;\n  const type = element.getAttribute('data-type') || inferTypeFromElement(element);\n  const style = element.style;\n  const leftMatch = ((_style$left2 = style.left) === null || _style$left2 === void 0 ? void 0 : _style$left2.match(/(\\d+)px/)) || ['0'];\n  const topMatch = ((_style$top3 = style.top) === null || _style$top3 === void 0 ? void 0 : _style$top3.match(/(\\d+)px/)) || ['0'];\n  const widthMatch = ((_style$width3 = style.width) === null || _style$width3 === void 0 ? void 0 : _style$width3.match(/(\\d+)px/)) || [type === 'gallery' ? '380' : '200'];\n  const heightMatch = ((_style$height3 = style.height) === null || _style$height3 === void 0 ? void 0 : _style$height3.match(/(\\d+)px/)) || [type === 'gallery' ? '300' : '50'];\n  const left = parseInt(leftMatch[1]) || 0;\n  const top = parseInt(topMatch[1]) || 0;\n  const width = parseInt(widthMatch[1]) || (type === 'gallery' ? 380 : type === 'icon' ? 50 : 200);\n  const height = parseInt(heightMatch[1]) || (type === 'gallery' ? 300 : type === 'icon' ? 50 : 50);\n  const styles = parseInlineStyles(style, element);\n  const componentData = parseComponentData(element, type);\n  return {\n    id,\n    type,\n    componentData,\n    position: {\n      desktop: {\n        x: left,\n        y: top,\n        z: parseInt(style.zIndex) || 10\n      },\n      tablet: {\n        x: left,\n        y: top,\n        z: parseInt(style.zIndex) || 10\n      },\n      mobile: {\n        x: left,\n        y: top,\n        z: parseInt(style.zIndex) || 10\n      }\n    },\n    size: {\n      width,\n      height\n    },\n    styles,\n    children: [],\n    visible: style.display !== 'none',\n    locked: element.classList.contains('lpb-element-locked'),\n    parentId\n  };\n};\n\n/**\r\n * Parse componentData d·ª±a tr√™n type\r\n * @param {HTMLElement} element - Element\r\n * @param {string} type - Type c·ªßa element\r\n * @returns {Object} componentData\r\n */\nconst parseComponentData = (element, type) => {\n  const componentData = {};\n  switch (type) {\n    case 'button':\n      componentData.content = element.textContent.trim() || 'Button';\n      componentData.text = componentData.content;\n      componentData.background = element.style.background || element.style.backgroundColor;\n      componentData.color = element.style.color;\n      componentData.borderRadius = element.style.borderRadius;\n      componentData.border = element.style.border;\n      componentData.fontSize = element.style.fontSize;\n      componentData.fontWeight = element.style.fontWeight;\n      break;\n    case 'heading':\n      componentData.content = element.textContent.trim() || 'Heading';\n      componentData.text = componentData.content;\n      componentData.level = element.tagName.toLowerCase();\n      componentData.fontSize = element.style.fontSize;\n      componentData.color = element.style.color;\n      componentData.fontWeight = element.style.fontWeight;\n      componentData.textAlign = element.style.textAlign;\n      break;\n    case 'paragraph':\n      componentData.content = element.textContent.trim() || 'Paragraph';\n      componentData.text = componentData.content;\n      componentData.fontSize = element.style.fontSize;\n      componentData.color = element.style.color;\n      componentData.fontWeight = element.style.fontWeight;\n      componentData.lineHeight = element.style.lineHeight;\n      componentData.textAlign = element.style.textAlign;\n      break;\n    case 'image':\n      componentData.src = element.getAttribute('src') || 'https://via.placeholder.com/150';\n      componentData.alt = element.getAttribute('alt') || 'Image';\n      componentData.imageUrl = componentData.src;\n      break;\n    case 'icon':\n      const img = element.querySelector('img');\n      const iconEl = element.querySelector('i');\n      const svgEl = element.querySelector('svg');\n      if (img) {\n        componentData.imageUrl = img.getAttribute('src');\n        componentData.alt = img.getAttribute('alt') || 'Icon';\n      } else if (svgEl) {\n        componentData.icon = svgEl.outerHTML;\n      } else if (iconEl) {\n        componentData.icon = iconEl.className;\n      }\n      componentData.title = element.getAttribute('title') || '';\n      break;\n    case 'gallery':\n      const images = Array.from(element.querySelectorAll('img')).map(img => img.getAttribute('src') || 'https://via.placeholder.com/150');\n      componentData.images = images;\n      componentData.display = element.style.display || 'grid';\n      componentData.gridTemplateColumns = element.style.gridTemplateColumns || 'repeat(auto-fill, minmax(150px, 1fr))';\n      componentData.gap = element.style.gap || '10px';\n      break;\n    case 'video':\n      componentData.src = element.getAttribute('src') || '';\n      componentData.videoUrl = componentData.src;\n      componentData.controls = element.hasAttribute('controls');\n      componentData.autoplay = element.hasAttribute('autoplay');\n      componentData.loop = element.hasAttribute('loop');\n      componentData.muted = element.hasAttribute('muted');\n      componentData.fallbackText = element.textContent.trim();\n      break;\n    case 'divider':\n    case 'hr':\n      componentData.thickness = element.style.height || '2px';\n      componentData.color = element.style.background || element.style.backgroundColor || '#e5e7eb';\n      break;\n    case 'link':\n    case 'anchor':\n      componentData.content = element.textContent.trim() || 'Link';\n      componentData.text = componentData.content;\n      componentData.href = element.getAttribute('href') || '#';\n      componentData.url = componentData.href;\n      componentData.target = element.getAttribute('target');\n      componentData.newTab = componentData.target === '_blank';\n      break;\n    case 'form':\n      componentData.action = element.getAttribute('action') || '#';\n      componentData.method = element.getAttribute('method') || 'POST';\n      break;\n    case 'input':\n      componentData.inputType = element.getAttribute('type') || 'text';\n      componentData.name = element.getAttribute('name') || '';\n      componentData.placeholder = element.getAttribute('placeholder') || '';\n      componentData.value = element.getAttribute('value') || '';\n      componentData.required = element.hasAttribute('required');\n      break;\n    case 'textarea':\n      componentData.name = element.getAttribute('name') || '';\n      componentData.placeholder = element.getAttribute('placeholder') || '';\n      componentData.value = element.textContent.trim();\n      componentData.rows = element.getAttribute('rows') || 4;\n      componentData.required = element.hasAttribute('required');\n      break;\n    case 'container':\n    case 'div':\n      componentData.content = element.innerHTML || '';\n      break;\n    default:\n      componentData.content = element.textContent.trim() || '';\n      componentData.text = componentData.content;\n      break;\n  }\n\n  // Parse animation n·∫øu c√≥\n  if (element.style.animation) {\n    const animationMatch = element.style.animation.match(/(\\S+)\\s*(\\d+\\.?\\d*ms)\\s*(\\w+)\\s*(\\d+\\.?\\d*ms)?\\s*(infinite)?/);\n    if (animationMatch) {\n      componentData.animation = {\n        type: animationMatch[1],\n        duration: parseFloat(animationMatch[2]) || 1000,\n        timing: animationMatch[3] || 'ease',\n        delay: parseFloat(animationMatch[4]) || 0,\n        repeat: !!animationMatch[5]\n      };\n    }\n  }\n  return componentData;\n};\n\n/**\r\n * Parse inline styles v√† pseudo-classes t·ª´ element\r\n * @param {CSSStyleDeclaration} styleObj - Style object\r\n * @param {HTMLElement} element - HTML element\r\n * @returns {Object} styles\r\n */\nconst parseInlineStyles = (styleObj, element) => {\n  const styles = {};\n  const importantProps = ['background', 'backgroundColor', 'backgroundImage', 'backgroundSize', 'backgroundPosition', 'color', 'fontSize', 'fontWeight', 'fontFamily', 'border', 'borderRadius', 'boxShadow', 'textShadow', 'padding', 'margin', 'paddingTop', 'paddingRight', 'paddingBottom', 'paddingLeft', 'marginTop', 'marginRight', 'marginBottom', 'marginLeft', 'display', 'alignItems', 'justifyContent', 'flexDirection', 'gap', 'gridTemplateColumns', 'gridTemplateRows', 'gridGap', 'textAlign', 'lineHeight', 'textTransform', 'cursor', 'transition', 'animation', 'filter', 'zIndex', 'opacity', 'transform', 'transformOrigin', 'width', 'height', 'minWidth', 'minHeight', 'maxWidth', 'maxHeight'];\n  importantProps.forEach(prop => {\n    if (styleObj[prop]) {\n      styles[prop] = styleObj[prop];\n    }\n  });\n\n  // Parse pseudo-classes t·ª´ <style> li√™n quan ƒë·∫øn element\n  const styleElements = element.ownerDocument.querySelectorAll('style');\n  styleElements.forEach(styleEl => {\n    const cssContent = styleEl.textContent || styleEl.innerHTML;\n    const hoverRegex = new RegExp(`#${element.id}:hover\\\\s*{([\\\\s\\\\S]*?)}`);\n    const hoverMatch = cssContent.match(hoverRegex);\n    if (hoverMatch) {\n      const hoverStyles = {};\n      hoverMatch[1].split(';').forEach(rule => {\n        const [key, value] = rule.split(':').map(s => s.trim());\n        if (key && value) {\n          const camelKey = key.replace(/-([a-z])/g, (_, letter) => letter.toUpperCase());\n          hoverStyles[camelKey] = value;\n        }\n      });\n      if (Object.keys(hoverStyles).length > 0) {\n        styles[':hover'] = hoverStyles;\n      }\n    }\n  });\n  return styles;\n};\n\n/**\r\n * Extract events t·ª´ runtime script\r\n * @param {string} scriptContent - Script content\r\n * @returns {Array} Array of event configs\r\n */\nconst extractEventsFromScript = scriptContent => {\n  const eventsMatch = scriptContent.match(/const eventsConfig = (\\[[\\s\\S]*?\\]);/);\n  if (eventsMatch) {\n    try {\n      return JSON.parse(eventsMatch[1]);\n    } catch (e) {\n      console.warn('‚ö†Ô∏è Cannot parse events config:', e.message);\n      return [];\n    }\n  }\n  return [];\n};\n\n/**\r\n * √Ånh x·∫° events v√†o elements\r\n * @param {Array} elements - Array of elements\r\n * @param {Array} eventsConfig - Array of event configs\r\n */\nconst mapEventsToElements = (elements, eventsConfig) => {\n  eventsConfig.forEach(eventConfig => {\n    const element = findElementById(elements, eventConfig.elementId);\n    if (element) {\n      if (!element.componentData) {\n        element.componentData = {};\n      }\n      element.componentData.events = eventConfig.events || {};\n    }\n  });\n};\n\n/**\r\n * Extract animations t·ª´ CSS\r\n * @param {string} cssContent - CSS content\r\n * @returns {Object} Animations object\r\n */\nconst extractAnimationsFromCSS = cssContent => {\n  const animations = {};\n  const keyframesRegex = /@keyframes\\s+(\\S+)\\s*{([\\s\\S]*?)}/g;\n  let match;\n  while (match = keyframesRegex.exec(cssContent)) {\n    const keyframeName = match[1];\n    const framesContent = match[2];\n    const frames = {};\n    const frameRegex = /(\\d+%|from|to)\\s*{([\\s\\S]*?)}/g;\n    let frameMatch;\n    while (frameMatch = frameRegex.exec(framesContent)) {\n      const frameKey = frameMatch[1];\n      const props = {};\n      frameMatch[2].split(';').forEach(rule => {\n        const [key, value] = rule.split(':').map(s => s.trim());\n        if (key && value) {\n          const camelKey = key.replace(/-([a-z])/g, (_, letter) => letter.toUpperCase());\n          props[camelKey] = value;\n        }\n      });\n      frames[frameKey] = props;\n    }\n    animations[`@keyframes ${keyframeName}`] = frames;\n  }\n  return animations;\n};\n\n/**\r\n * √Ånh x·∫° animations v√†o elements\r\n * @param {Array} elements - Array of elements\r\n * @param {Object} animations - Animations object\r\n */\nconst mapAnimationsToElements = (elements, animations) => {\n  elements.forEach(element => {\n    var _element$styles, _element$children;\n    if ((_element$styles = element.styles) !== null && _element$styles !== void 0 && _element$styles.animation) {\n      const animationMatch = element.styles.animation.match(/(\\S+)\\s*(\\d+\\.?\\d*ms)\\s*(\\w+)\\s*(\\d+\\.?\\d*ms)?\\s*(infinite)?/);\n      if (animationMatch) {\n        element.componentData.animation = {\n          type: animationMatch[1],\n          duration: parseFloat(animationMatch[2]) || 1000,\n          timing: animationMatch[3] || 'ease',\n          delay: parseFloat(animationMatch[4]) || 0,\n          repeat: !!animationMatch[5]\n        };\n      }\n    }\n    if (element.styles && animations[`@keyframes ${element.styles.animationName}`]) {\n      element.styles[`@keyframes ${element.styles.animationName}`] = animations[`@keyframes ${element.styles.animationName}`];\n    }\n    if (((_element$children = element.children) === null || _element$children === void 0 ? void 0 : _element$children.length) > 0) {\n      mapAnimationsToElements(element.children, animations);\n    }\n  });\n};\n\n/**\r\n * Suy ra type t·ª´ element HTML\r\n * @param {HTMLElement} element - HTML element\r\n * @returns {string} Element type\r\n */\nconst inferTypeFromElement = element => {\n  const tagName = element.tagName.toLowerCase();\n  const classList = element.classList;\n\n  // Check by class first (more specific)\n  if (classList.contains('lpb-button')) return 'button';\n  if (classList.contains('lpb-icon')) return 'icon';\n  if (classList.contains('lpb-gallery')) return 'gallery';\n  if (classList.contains('lpb-section') || classList.contains('ladi-section')) return 'section';\n  if (classList.contains('lpb-popup')) return 'popup';\n  if (classList.contains('lpb-video')) return 'video';\n  if (classList.contains('lpb-divider')) return 'divider';\n  if (classList.contains('lpb-link')) return 'link';\n  if (classList.contains('lpb-container')) return 'container';\n  if (classList.contains('lpb-form')) return 'form';\n  if (classList.contains('lpb-input')) return 'input';\n  if (classList.contains('lpb-textarea')) return 'textarea';\n\n  // Then check by tag name\n  if (tagName === 'button') return 'button';\n  if (tagName.match(/^h[1-6]$/)) return 'heading';\n  if (tagName === 'p') return 'paragraph';\n  if (tagName === 'img') return 'image';\n  if (tagName === 'hr') return 'divider';\n  if (tagName === 'video') return 'video';\n  if (tagName === 'a') return 'link';\n  if (tagName === 'form') return 'form';\n  if (tagName === 'input') return 'input';\n  if (tagName === 'textarea') return 'textarea';\n  if (tagName === 'ul' || tagName === 'ol') return 'list';\n\n  // Default\n  return 'container';\n};","map":{"version":3,"names":["generateEventRuntime","events","popups","JSON","stringify","extractEvents","pageData","processElement","element","parentId","_element$componentDat","elementId","id","componentData","push","type","Array","isArray","children","forEach","child","_child$componentData","elements","renderPopupsHTML","map","popup","styles","size","childrenHTML","renderElementHTML","join","width","height","background","borderRadius","title","padding","content","isChild","_position$desktop","_position$desktop2","_position$tablet","_position$desktop3","_position$tablet2","_position$desktop4","_position$mobile","_position$desktop5","_position$mobile2","_position$desktop6","_position$desktop7","_position$desktop8","_componentData$icon","position","inlineStyles","Object","entries","filter","key","startsWith","value","kebabKey","replace","m","toLowerCase","positionDataAttrs","desktop","x","y","tablet","mobile","baseAttrs","positionStyles","renderSectionHTML","text","HeadingTag","level","src","imageUrl","alt","isSvg","icon","renderGalleryHTML","videoUrl","controls","autoplay","loop","muted","fallbackText","thickness","color","href","url","newTab","target","formChildren","action","method","inputType","name","placeholder","required","rows","containerChildren","defaultChildren","length","_position$desktop9","_position$desktop0","images","display","gridTemplateColumns","gap","index","objectFit","objectPosition","section","_position$desktop1","_position$tablet3","_position$desktop10","_position$mobile3","_position$desktop11","_position$desktop12","backgroundColor","backgroundImage","overlayColor","overlayOpacity","generateCSS","css","frame","props","prop","val","kebabProp","_child$styles","_element$position","_element$position$tab","_element$position2","_element$position2$de","_child$position","_child$position$table","_child$position2","_child$position2$desk","_child$position3","_child$position3$tabl","_child$position4","_child$position4$desk","tabletX","tabletY","_element$position3","_element$position3$mo","_element$position4","_element$position4$de","_child$position5","_child$position5$mobi","_child$position6","_child$position6$desk","_child$position7","_child$position7$mobi","_child$position8","_child$position8$desk","mobileX","mobileY","renderStaticHTML","_pageData$meta","_pageData$meta2","_pageData$canvas","_pageData$analytics","el","sections","sectionsHTML","popupsHTML","runtimeScript","cssContent","meta","description","canvas","analytics","googleAnalyticsId","findElementById","found","parseHTMLToPageData","htmlString","keywords","created_at","Date","toISOString","updated_at","parser","DOMParser","doc","parseFromString","titleEl","querySelector","textContent","trim","descEl","getAttribute","keywordsEl","_keywordsEl$getAttrib","split","k","analyticsScript","gaId","match","pageDataScript","embeddedData","parse","innerHTML","console","log","normalizeElements","warn","parseError","message","canvasEl","getElementById","canvasStyle","style","parseInt","minHeight","querySelectorAll","sectionEl","parseSectionElement","popupEl","parsePopupElement","standaloneElements","closest","parseStandaloneElement","runtimeScripts","script","eventsConfig","extractEventsFromScript","mapEventsToElements","styleElements","styleEl","animations","extractAnimationsFromCSS","mapAnimationsToElements","maxHeight","Math","max","_el$position","_el$position$desktop","_el$size","elTop","elHeight","elementsCount","standalone","error","_el$position2","_el$position3","_el$position4","_el$position5","_el$position6","now","random","toString","slice","z","visible","locked","_style$top","_style$width","_style$height","topMatch","top","widthMatch","heightMatch","bgEl","overlayEl","containerEl","structure","classList","contains","_bgStyle$backgroundIm","bgStyle","bgImageMatch","backgroundType","backgroundPosition","backgroundSize","parseFloat","opacity","parseInlineStyles","childElements","childEl","parseChildElement","zIndex","_containerEl$style$wi","_containerEl$style$mi","minHeightMatch","headerEl","bodyEl","_style$left","_style$top2","_style$width2","_style$height2","inferTypeFromElement","leftMatch","left","parseComponentData","_style$left2","_style$top3","_style$width3","_style$height3","border","fontSize","fontWeight","tagName","textAlign","lineHeight","img","iconEl","svgEl","outerHTML","className","from","hasAttribute","animation","animationMatch","duration","timing","delay","repeat","styleObj","importantProps","ownerDocument","hoverRegex","RegExp","hoverMatch","hoverStyles","rule","s","camelKey","_","letter","toUpperCase","keys","scriptContent","eventsMatch","e","eventConfig","keyframesRegex","exec","keyframeName","framesContent","frames","frameRegex","frameMatch","frameKey","_element$styles","_element$children","animationName"],"sources":["F:/landinghub-iconic/apps/web/src/utils/pageUtils.js"],"sourcesContent":["// ==================== EVENT RUNTIME GENERATOR ====================\r\n\r\n/**\r\n * Generate runtime script ƒë·ªÉ x·ª≠ l√Ω events trong HTML tƒ©nh\r\n * @param {Array} events - Danh s√°ch events t·ª´ pageData\r\n * @param {Array} popups - Danh s√°ch popup elements\r\n * @returns {string} - JavaScript code\r\n */\r\nconst generateEventRuntime = (events, popups) => {\r\n    return `\r\n    // Landing Page Builder Runtime v1.0\r\n    (function() {\r\n        'use strict';\r\n        \r\n        window.LPB = window.LPB || {};\r\n        \r\n        // ========== POPUP MANAGER ==========\r\n        LPB.popups = {\r\n            active: new Set(),\r\n            \r\n            open: function(popupId, data) {\r\n                const popup = document.getElementById(popupId);\r\n                if (!popup) {\r\n                    console.error('[LPB] Popup not found:', popupId);\r\n                    return;\r\n                }\r\n                \r\n                // Update content n·∫øu c√≥ data\r\n                if (data && data.html) {\r\n                    const content = popup.querySelector('.lpb-popup-body');\r\n                    if (content) content.innerHTML = data.html;\r\n                }\r\n                \r\n                // Show popup\r\n                popup.classList.add('lpb-popup-active');\r\n                document.body.style.overflow = 'hidden';\r\n                this.active.add(popupId);\r\n                \r\n                // Analytics tracking\r\n                if (window.gtag) {\r\n                    gtag('event', 'popup_open', {\r\n                        event_category: 'Engagement',\r\n                        event_label: popupId\r\n                    });\r\n                }\r\n            },\r\n            \r\n            close: function(popupId) {\r\n                const popup = document.getElementById(popupId);\r\n                if (popup) {\r\n                    popup.classList.remove('lpb-popup-active');\r\n                    this.active.delete(popupId);\r\n                    \r\n                    // Restore scroll n·∫øu kh√¥ng c√≤n popup n√†o\r\n                    if (this.active.size === 0) {\r\n                        document.body.style.overflow = '';\r\n                    }\r\n                }\r\n            },\r\n            \r\n            closeAll: function() {\r\n                this.active.forEach(id => this.close(id));\r\n            }\r\n        };\r\n        \r\n        // ========== API MANAGER ==========\r\n        LPB.api = {\r\n            cache: new Map(),\r\n            \r\n            getCacheKey: function(endpoint, params) {\r\n                return endpoint + JSON.stringify(params || {});\r\n            },\r\n            \r\n            fetch: async function(endpoint, options = {}) {\r\n                const cacheKey = this.getCacheKey(endpoint, options.params);\r\n                \r\n                // Check cache\r\n                if (this.cache.has(cacheKey)) {\r\n                    const cached = this.cache.get(cacheKey);\r\n                    const now = Date.now();\r\n                    const TTL = options.ttl || 5 * 60 * 1000; // 5 ph√∫t default\r\n                    \r\n                    if (now - cached.timestamp < TTL) {\r\n                        console.log('[LPB] Cache hit:', endpoint);\r\n                        return cached.data;\r\n                    }\r\n                }\r\n                \r\n                // Fetch m·ªõi\r\n                try {\r\n                    console.log('[LPB] Fetching:', endpoint);\r\n                    const response = await fetch(endpoint, {\r\n                        method: options.method || 'GET',\r\n                        headers: {\r\n                            'Content-Type': 'application/json',\r\n                            ...options.headers\r\n                        },\r\n                        body: options.data ? JSON.stringify(options.data) : undefined\r\n                    });\r\n                    \r\n                    if (!response.ok) {\r\n                        throw new Error(\\`HTTP \\${response.status}: \\${response.statusText}\\`);\r\n                    }\r\n                    \r\n                    const data = await response.json();\r\n                    \r\n                    // Cache result\r\n                    this.cache.set(cacheKey, {\r\n                        data: data,\r\n                        timestamp: Date.now()\r\n                    });\r\n                    \r\n                    return data;\r\n                } catch (error) {\r\n                    console.error('[LPB] API Error:', error);\r\n                    throw error;\r\n                }\r\n            },\r\n            \r\n            clearCache: function(endpoint) {\r\n                if (endpoint) {\r\n                    for (let key of this.cache.keys()) {\r\n                        if (key.startsWith(endpoint)) {\r\n                            this.cache.delete(key);\r\n                        }\r\n                    }\r\n                } else {\r\n                    this.cache.clear();\r\n                }\r\n            }\r\n        };\r\n        \r\n        // ========== EVENT HANDLER ==========\r\n        LPB.handleEvent = async function(config) {\r\n            const { type } = config;\r\n            \r\n            try {\r\n                switch(type) {\r\n                    case 'openPopup':\r\n                        if (!config.popupId) {\r\n                            console.error('[LPB] Missing popupId');\r\n                            return;\r\n                        }\r\n                        this.popups.open(config.popupId, config.data);\r\n                        break;\r\n                        \r\n                    case 'closePopup':\r\n                        const targetPopupId = config.popupId || config.elementId;\r\n                        if (!targetPopupId) {\r\n                            console.error('[LPB] Missing popupId');\r\n                            return;\r\n                        }\r\n                        this.popups.close(targetPopupId);\r\n                        break;\r\n                        \r\n                    case 'triggerApi':\r\n                        if (!config.apiUrl) {\r\n                            console.error('[LPB] Missing apiUrl');\r\n                            return;\r\n                        }\r\n                        const data = await this.api.fetch(config.apiUrl, {\r\n                            method: config.method || 'GET',\r\n                            params: config.params,\r\n                            data: config.data\r\n                        });\r\n                        \r\n                        // Update target n·∫øu c√≥\r\n                        if (config.updateTarget) {\r\n                            const target = document.getElementById(config.updateTarget);\r\n                            if (target && data.html) {\r\n                                target.innerHTML = data.html;\r\n                            }\r\n                        }\r\n                        break;\r\n                        \r\n                    case 'both':\r\n                        // Open popup immediately v·ªõi loading\r\n                        this.popups.open(config.popupId, { \r\n                            html: '<div style=\"text-align:center;padding:40px;\"><div class=\"lpb-spinner\"></div><p>ƒêang t·∫£i...</p></div>' \r\n                        });\r\n                        \r\n                        // Fetch API in background\r\n                        const apiData = await this.api.fetch(config.apiUrl, {\r\n                            method: config.method || 'GET',\r\n                            params: config.params\r\n                        });\r\n                        \r\n                        // Update popup content\r\n                        this.popups.open(config.popupId, { html: apiData.html || JSON.stringify(apiData) });\r\n                        break;\r\n                        \r\n                    case 'navigate':\r\n                        if (!config.url) {\r\n                            console.error('[LPB] Missing url');\r\n                            return;\r\n                        }\r\n                        if (config.newTab) {\r\n                            window.open(config.url, '_blank');\r\n                        } else {\r\n                            window.location.href = config.url;\r\n                        }\r\n                        break;\r\n                        \r\n                    case 'scrollToSection':\r\n                        if (!config.sectionId) {\r\n                            console.error('[LPB] Missing sectionId');\r\n                            return;\r\n                        }\r\n                        const section = document.querySelector(\\`[data-element-id=\"\\${config.sectionId}\"]\\`);\r\n                        if (section) {\r\n                            section.scrollIntoView({ \r\n                                behavior: config.smooth !== false ? 'smooth' : 'auto',\r\n                                block: 'start'\r\n                            });\r\n                        } else {\r\n                            console.error('[LPB] Section not found:', config.sectionId);\r\n                        }\r\n                        break;\r\n                        \r\n                    case 'submitForm':\r\n                        if (!config.apiUrl) {\r\n                            console.error('[LPB] Missing apiUrl');\r\n                            return;\r\n                        }\r\n                        console.log('[LPB] Form submit to:', config.apiUrl);\r\n                        break;\r\n                        \r\n                    default:\r\n                        console.warn('[LPB] Unknown event type:', type);\r\n                }\r\n            } catch (error) {\r\n                console.error('[LPB] Event handling error:', error);\r\n                alert('C√≥ l·ªói x·∫£y ra: ' + error.message);\r\n            }\r\n        };\r\n        \r\n        // ========== AUTO-BIND EVENTS ==========\r\n        const eventsConfig = ${JSON.stringify(events)};\r\n        \r\n        document.addEventListener('DOMContentLoaded', function() {\r\n            console.log('[LPB] Initializing events...', eventsConfig.length);\r\n            \r\n            eventsConfig.forEach(config => {\r\n                const element = document.getElementById(config.elementId);\r\n                if (!element) {\r\n                    console.warn('[LPB] Element not found:', config.elementId);\r\n                    return;\r\n                }\r\n                \r\n                // Bind onClick\r\n                if (config.events.onClick && config.events.onClick.type !== 'none') {\r\n                    element.addEventListener('click', function(e) {\r\n                        e.preventDefault();\r\n                        e.stopPropagation();\r\n                        LPB.handleEvent(config.events.onClick);\r\n                    });\r\n                    \r\n                    element.style.cursor = 'pointer';\r\n                }\r\n                \r\n                // Bind hover prefetch\r\n                if (config.events.onClick?.params?.apiConfig?.preload) {\r\n                    element.addEventListener('mouseenter', function() {\r\n                        LPB.api.fetch(\r\n                            config.events.onClick.params.apiConfig.endpoint,\r\n                            config.events.onClick.params.apiConfig\r\n                        ).catch(() => {}); // Silent prefetch\r\n                    }, { once: true });\r\n                }\r\n                \r\n                // Bind onHover effects\r\n                if (config.events.onHover) {\r\n                    const hoverClass = config.events.onHover.className;\r\n                    if (hoverClass) {\r\n                        element.addEventListener('mouseenter', function() {\r\n                            this.classList.add(hoverClass);\r\n                        });\r\n                        element.addEventListener('mouseleave', function() {\r\n                            this.classList.remove(hoverClass);\r\n                        });\r\n                    }\r\n                }\r\n            });\r\n            \r\n            console.log('[LPB] Events initialized!');\r\n        });\r\n        \r\n        // ========== ESC TO CLOSE POPUP ==========\r\n        document.addEventListener('keydown', function(e) {\r\n            if (e.key === 'Escape') {\r\n                LPB.popups.closeAll();\r\n            }\r\n        });\r\n\r\n        // ========== RESPONSIVE POSITIONING HANDLER ==========\r\n        LPB.responsive = {\r\n            currentBreakpoint: 'desktop',\r\n\r\n            getBreakpoint: function() {\r\n                const width = window.innerWidth;\r\n                if (width <= 480) return 'mobile';\r\n                if (width <= 768) return 'tablet';\r\n                return 'desktop';\r\n            },\r\n\r\n            updateElementPositions: function() {\r\n                const breakpoint = this.getBreakpoint();\r\n                if (breakpoint === this.currentBreakpoint) return;\r\n\r\n                this.currentBreakpoint = breakpoint;\r\n                console.log('[LPB] Breakpoint changed to:', breakpoint);\r\n\r\n                // Update sections\r\n                const sections = document.querySelectorAll('.lpb-section[data-mobile-y]');\r\n                sections.forEach(section => {\r\n                    const y = section.getAttribute(\\`data-\\${breakpoint}-y\\`) || section.getAttribute('data-desktop-y') || 0;\r\n                    if (breakpoint !== 'desktop') {\r\n                        section.style.setProperty('top', \\`\\${y}px\\`, 'important');\r\n                    }\r\n                });\r\n\r\n                // Update child elements\r\n                const elements = document.querySelectorAll('.lpb-element[data-mobile-x]');\r\n                elements.forEach(element => {\r\n                    const x = element.getAttribute(\\`data-\\${breakpoint}-x\\`) || element.getAttribute('data-desktop-x') || 0;\r\n                    const y = element.getAttribute(\\`data-\\${breakpoint}-y\\`) || element.getAttribute('data-desktop-y') || 0;\r\n\r\n                    if (breakpoint === 'mobile' || breakpoint === 'tablet') {\r\n                        element.style.setProperty('left', \\`\\${x}px\\`, 'important');\r\n                        element.style.setProperty('top', \\`\\${y}px\\`, 'important');\r\n                    }\r\n                });\r\n            }\r\n        };\r\n\r\n        // Initialize responsive positions on load\r\n        document.addEventListener('DOMContentLoaded', function() {\r\n            LPB.responsive.updateElementPositions();\r\n        });\r\n\r\n        // Update on window resize (debounced)\r\n        let resizeTimeout;\r\n        window.addEventListener('resize', function() {\r\n            clearTimeout(resizeTimeout);\r\n            resizeTimeout = setTimeout(function() {\r\n                LPB.responsive.updateElementPositions();\r\n            }, 150);\r\n        });\r\n\r\n        console.log('[LPB] Runtime loaded');\r\n    })();\r\n    `;\r\n};\r\n\r\n/**\r\n * Extract t·∫•t c·∫£ events t·ª´ pageData elements\r\n * @param {Object} pageData - Page data object\r\n * @returns {Array} - Array of event configs\r\n */\r\nconst extractEvents = (pageData) => {\r\n    const events = [];\r\n\r\n    const processElement = (element, parentId = null) => {\r\n        const elementId = element.id;\r\n\r\n        // Check element events\r\n        if (element.componentData?.events) {\r\n            events.push({\r\n                elementId: elementId,\r\n                events: element.componentData.events,\r\n                type: element.type,\r\n                parentId: parentId\r\n            });\r\n        }\r\n\r\n        // Check children events\r\n        if (Array.isArray(element.children)) {\r\n            element.children.forEach(child => {\r\n                if (child.componentData?.events) {\r\n                    events.push({\r\n                        elementId: child.id,\r\n                        events: child.componentData.events,\r\n                        type: child.type,\r\n                        parentId: elementId\r\n                    });\r\n                }\r\n\r\n                // Recursive cho nested children\r\n                if (Array.isArray(child.children)) {\r\n                    processElement(child, child.id);\r\n                }\r\n            });\r\n        }\r\n    };\r\n\r\n    pageData.elements.forEach(element => {\r\n        processElement(element);\r\n    });\r\n\r\n    return events;\r\n};\r\n\r\n/**\r\n * Render t·∫•t c·∫£ popups th√†nh HTML\r\n * @param {Array} popups - Array of popup elements\r\n * @returns {string} - HTML string\r\n */\r\nconst renderPopupsHTML = (popups) => {\r\n    return popups.map(popup => {\r\n        const { id, componentData = {}, styles = {}, size = {}, children = [] } = popup;\r\n\r\n        // Render children content\r\n        const childrenHTML = children.map(child =>\r\n            renderElementHTML(child, true)\r\n        ).join('');\r\n\r\n        return `\r\n            <div \r\n                id=\"${id}\" \r\n                class=\"lpb-popup\" \r\n                data-element-id=\"${id}\"\r\n                style=\"display:none;\"\r\n            >\r\n                <!-- Overlay -->\r\n                <div \r\n                    class=\"lpb-popup-overlay\" \r\n                    onclick=\"LPB.popups.close('${id}')\"\r\n                ></div>\r\n                \r\n                <!-- Popup Container -->\r\n                <div \r\n                    class=\"lpb-popup-container\"\r\n                    style=\"\r\n                        width: ${size.width || 600}px;\r\n                        max-width: 90vw;\r\n                        min-height: ${size.height || 400}px;\r\n                        background: ${styles.background || componentData.background || 'rgba(255, 255, 255, 0.95)'};\r\n                        border-radius: ${styles.borderRadius || componentData.borderRadius || '12px'};\r\n                        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.25);\r\n                    \"\r\n                >\r\n                    <!-- Header -->\r\n                    <div class=\"lpb-popup-header\">\r\n                        <h3 style=\"margin:0; font-size:16px; font-weight:600; color:#111827;\">\r\n                            ${componentData.title || 'Popup Title'}\r\n                        </h3>\r\n                        <button \r\n                            class=\"lpb-popup-close\" \r\n                            onclick=\"LPB.popups.close('${id}')\"\r\n                            aria-label=\"Close popup\"\r\n                        >\r\n                            ‚úï\r\n                        </button>\r\n                    </div>\r\n                    \r\n                    <!-- Body -->\r\n                    <div class=\"lpb-popup-body\" style=\"padding: ${componentData.padding || '20px'};\">\r\n                        ${childrenHTML || `<p style=\"color:#6b7280;\">${componentData.content || 'Popup content'}</p>`}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        `;\r\n    }).join('\\n');\r\n};\r\n\r\n/**\r\n * Render m·ªôt element th√†nh HTML v·ªõi proper ID\r\n * @param {Object} element - Element object\r\n * @param {boolean} isChild - Whether this is a child element\r\n * @returns {string} - HTML string\r\n */\r\nconst renderElementHTML = (element, isChild = false) => {\r\n    const { id, type, componentData = {}, styles = {}, size = {}, position = {}, children = [] } = element;\r\n\r\n    // Convert styles object to inline CSS\r\n    const inlineStyles = Object.entries(styles)\r\n        .filter(([key]) => !key.startsWith(':') && !key.startsWith('@'))\r\n        .map(([key, value]) => {\r\n            const kebabKey = key.replace(/[A-Z]/g, m => `-${m.toLowerCase()}`);\r\n            return `${kebabKey}:${value}`;\r\n        })\r\n        .join(';');\r\n\r\n    // Position data attributes for responsive positioning\r\n    const positionDataAttrs = isChild ? `\r\n        data-desktop-x=\"${position.desktop?.x || 0}\"\r\n        data-desktop-y=\"${position.desktop?.y || 0}\"\r\n        data-tablet-x=\"${position.tablet?.x || position.desktop?.x || 0}\"\r\n        data-tablet-y=\"${position.tablet?.y || position.desktop?.y || 0}\"\r\n        data-mobile-x=\"${position.mobile?.x || position.desktop?.x || 0}\"\r\n        data-mobile-y=\"${position.mobile?.y || position.desktop?.y || 0}\"\r\n    ` : '';\r\n\r\n    // Base attributes\r\n    const baseAttrs = `\r\n        id=\"${id}\"\r\n        data-element-id=\"${id}\"\r\n        data-type=\"${type}\"\r\n        class=\"lpb-element lpb-${type}\"\r\n        ${positionDataAttrs}\r\n    `;\r\n\r\n    // Position styles cho child elements\r\n    const positionStyles = isChild ? `\r\n        position: absolute;\r\n        left: ${position.desktop?.x || 0}px;\r\n        top: ${position.desktop?.y || 0}px;\r\n        width: ${size.width || 200}px;\r\n        height: ${size.height || 50}px;\r\n    ` : '';\r\n\r\n    // Render based on type\r\n    switch(type) {\r\n        case 'section':\r\n            return renderSectionHTML(element);\r\n\r\n        case 'button':\r\n            return `\r\n                <button\r\n                    ${baseAttrs}\r\n                    style=\"${inlineStyles}; ${positionStyles}\"\r\n                >\r\n                    ${componentData.content || componentData.text || 'Button'}\r\n                </button>\r\n            `;\r\n\r\n        case 'heading':\r\n            const HeadingTag = componentData.level || 'h2';\r\n            return `\r\n                <${HeadingTag}\r\n                    ${baseAttrs}\r\n                    style=\"${inlineStyles}; ${positionStyles}\"\r\n                >\r\n                    ${componentData.content || componentData.text || 'Heading'}\r\n                </${HeadingTag}>\r\n            `;\r\n\r\n        case 'paragraph':\r\n            return `\r\n                <p\r\n                    ${baseAttrs}\r\n                    style=\"${inlineStyles}; ${positionStyles}\"\r\n                >\r\n                    ${componentData.content || componentData.text || 'Paragraph'}\r\n                </p>\r\n            `;\r\n\r\n        case 'image':\r\n            return `\r\n                <img\r\n                    ${baseAttrs}\r\n                    src=\"${componentData.src || componentData.imageUrl || 'https://via.placeholder.com/150'}\"\r\n                    alt=\"${componentData.alt || 'Image'}\"\r\n                    style=\"${inlineStyles}; ${positionStyles}\"\r\n                />\r\n            `;\r\n\r\n        case 'icon':\r\n            const isSvg = componentData.icon?.startsWith('<svg');\r\n            return `\r\n                <div\r\n                    ${baseAttrs}\r\n                    style=\"${inlineStyles}; ${positionStyles}\"\r\n                    title=\"${componentData.title || ''}\"\r\n                >\r\n                    ${componentData.imageUrl\r\n                ? `<img src=\"${componentData.imageUrl}\" alt=\"${componentData.title || 'Icon'}\" style=\"width:100%;height:100%;object-fit:contain;\" />`\r\n                : isSvg\r\n                    ? componentData.icon\r\n                    : componentData.icon\r\n                        ? `<i class=\"${componentData.icon}\"></i>`\r\n                        : 'üì¶'\r\n            }\r\n                </div>\r\n            `;\r\n\r\n        case 'gallery':\r\n            return renderGalleryHTML(element, isChild);\r\n\r\n        case 'video':\r\n            return `\r\n                <video\r\n                    ${baseAttrs}\r\n                    src=\"${componentData.src || componentData.videoUrl || ''}\"\r\n                    controls=\"${componentData.controls !== false}\"\r\n                    autoplay=\"${componentData.autoplay === true}\"\r\n                    loop=\"${componentData.loop === true}\"\r\n                    muted=\"${componentData.muted === true}\"\r\n                    style=\"${inlineStyles}; ${positionStyles}\"\r\n                >\r\n                    ${componentData.fallbackText || 'Your browser does not support the video tag.'}\r\n                </video>\r\n            `;\r\n\r\n        case 'divider':\r\n        case 'hr':\r\n            return `\r\n                <hr\r\n                    ${baseAttrs}\r\n                    style=\"${inlineStyles}; ${positionStyles}; border:none; height:${componentData.thickness || '2px'}; background:${componentData.color || '#e5e7eb'};\"\r\n                />\r\n            `;\r\n\r\n        case 'link':\r\n        case 'anchor':\r\n            return `\r\n                <a\r\n                    ${baseAttrs}\r\n                    href=\"${componentData.href || componentData.url || '#'}\"\r\n                    target=\"${componentData.newTab || componentData.target === '_blank' ? '_blank' : '_self'}\"\r\n                    rel=\"${componentData.newTab || componentData.target === '_blank' ? 'noopener noreferrer' : ''}\"\r\n                    style=\"${inlineStyles}; ${positionStyles}\"\r\n                >\r\n                    ${componentData.content || componentData.text || 'Link'}\r\n                </a>\r\n            `;\r\n\r\n        case 'form':\r\n            const formChildren = children.map(child => renderElementHTML(child, true)).join('\\n');\r\n            return `\r\n                <form\r\n                    ${baseAttrs}\r\n                    action=\"${componentData.action || '#'}\"\r\n                    method=\"${componentData.method || 'POST'}\"\r\n                    style=\"${inlineStyles}; ${positionStyles}\"\r\n                >\r\n                    ${formChildren || '<p>Empty form</p>'}\r\n                </form>\r\n            `;\r\n\r\n        case 'input':\r\n            return `\r\n                <input\r\n                    ${baseAttrs}\r\n                    type=\"${componentData.inputType || 'text'}\"\r\n                    name=\"${componentData.name || id}\"\r\n                    placeholder=\"${componentData.placeholder || ''}\"\r\n                    value=\"${componentData.value || ''}\"\r\n                    required=\"${componentData.required === true}\"\r\n                    style=\"${inlineStyles}; ${positionStyles}\"\r\n                />\r\n            `;\r\n\r\n        case 'textarea':\r\n            return `\r\n                <textarea\r\n                    ${baseAttrs}\r\n                    name=\"${componentData.name || id}\"\r\n                    placeholder=\"${componentData.placeholder || ''}\"\r\n                    rows=\"${componentData.rows || 4}\"\r\n                    required=\"${componentData.required === true}\"\r\n                    style=\"${inlineStyles}; ${positionStyles}\"\r\n                >${componentData.value || ''}</textarea>\r\n            `;\r\n\r\n        case 'container':\r\n        case 'div':\r\n            const containerChildren = children.map(child => renderElementHTML(child, true)).join('\\n');\r\n            return `\r\n                <div\r\n                    ${baseAttrs}\r\n                    style=\"${inlineStyles}; ${positionStyles}\"\r\n                >\r\n                    ${containerChildren || componentData.content || ''}\r\n                </div>\r\n            `;\r\n\r\n        default:\r\n            // Default fallback for unknown element types\r\n            const defaultChildren = children.length > 0\r\n                ? children.map(child => renderElementHTML(child, true)).join('\\n')\r\n                : (componentData.content || componentData.text || `[${type}]`);\r\n            return `\r\n                <div\r\n                    ${baseAttrs}\r\n                    style=\"${inlineStyles}; ${positionStyles}\"\r\n                >\r\n                    ${defaultChildren}\r\n                </div>\r\n            `;\r\n    }\r\n};\r\n\r\n/**\r\n * Render gallery element\r\n */\r\nconst renderGalleryHTML = (element, isChild) => {\r\n    const { id, componentData = {}, styles = {}, size = {}, position = {} } = element;\r\n\r\n    const positionStyles = isChild ? `\r\n        position: absolute;\r\n        left: ${position.desktop?.x || 0}px;\r\n        top: ${position.desktop?.y || 0}px;\r\n    ` : '';\r\n\r\n    const images = componentData.images || [];\r\n\r\n    return `\r\n        <div \r\n            id=\"${id}\"\r\n            data-element-id=\"${id}\"\r\n            data-type=\"gallery\"\r\n            class=\"lpb-element lpb-gallery\"\r\n            style=\"${positionStyles} width: ${size.width || 380}px; height: ${size.height || 300}px;\"\r\n        >\r\n            <div style=\"\r\n                display: ${styles.display || 'grid'};\r\n                grid-template-columns: ${styles.gridTemplateColumns || 'repeat(auto-fill, minmax(150px, 1fr))'};\r\n                gap: ${styles.gap || '10px'};\r\n                width: 100%;\r\n                height: 100%;\r\n            \">\r\n                ${images.map((imageUrl, index) => `\r\n                    <div style=\"\r\n                        position: relative;\r\n                        overflow: hidden;\r\n                        border-radius: ${styles.borderRadius || '8px'};\r\n                        aspect-ratio: 1 / 1;\r\n                    \">\r\n                        <img\r\n                            src=\"${imageUrl || 'https://via.placeholder.com/150'}\"\r\n                            alt=\"Gallery ${index + 1}\"\r\n                            style=\"\r\n                                width: 100%;\r\n                                height: 100%;\r\n                                object-fit: ${styles.objectFit || 'cover'};\r\n                                object-position: ${styles.objectPosition || 'center'};\r\n                            \"\r\n                            loading=\"lazy\"\r\n                        />\r\n                    </div>\r\n                `).join('')}\r\n                ${images.length === 0 ? `\r\n                    <div style=\"\r\n                        display: flex;\r\n                        flex-direction: column;\r\n                        align-items: center;\r\n                        justify-content: center;\r\n                        color: #9ca3af;\r\n                        text-align: center;\r\n                        grid-column: 1 / -1;\r\n                    \">\r\n                        <i class=\"fas fa-image\" style=\"font-size: 48px; margin-bottom: 8px;\"></i>\r\n                        <p>Empty gallery</p>\r\n                    </div>\r\n                ` : ''}\r\n            </div>\r\n        </div>\r\n    `;\r\n};\r\n\r\n/**\r\n * Render section v·ªõi children\r\n */\r\nconst renderSectionHTML = (section) => {\r\n    const { id, componentData = {}, styles = {}, size = {}, position = {}, children = [] } = section;\r\n\r\n    // Render children\r\n    const childrenHTML = children.map(child =>\r\n        renderElementHTML(child, true)\r\n    ).join('\\n');\r\n\r\n    return `\r\n        <section\r\n            id=\"${id}\"\r\n            data-element-id=\"${id}\"\r\n            class=\"lpb-section ladi-section\"\r\n            data-desktop-y=\"${position.desktop?.y || 0}\"\r\n            data-tablet-y=\"${position.tablet?.y || position.desktop?.y || 0}\"\r\n            data-mobile-y=\"${position.mobile?.y || position.desktop?.y || 0}\"\r\n            style=\"\r\n                position: absolute;\r\n                top: ${position.desktop?.y || 0}px;\r\n                left: 50%;\r\n                transform: translateX(-50%);\r\n                width: 1200px;\r\n                height: ${size.height || 400}px;\r\n            \"\r\n        >\r\n            <!-- Background -->\r\n            <div class=\"ladi-section-background\" style=\"\r\n                position: absolute;\r\n                inset: 0;\r\n                z-index: 0;\r\n                background-color: ${componentData.backgroundColor || styles.backgroundColor || 'transparent'};\r\n                background-image: ${componentData.backgroundImage ? `url(${componentData.backgroundImage})` : 'none'};\r\n                background-size: cover;\r\n                background-position: center;\r\n            \"></div>\r\n\r\n            <!-- Overlay -->\r\n            <div class=\"ladi-overlay\" style=\"\r\n                position: absolute;\r\n                inset: 0;\r\n                z-index: 0;\r\n                background-color: ${componentData.overlayColor || 'transparent'};\r\n                opacity: ${componentData.overlayOpacity || 0};\r\n            \"></div>\r\n\r\n            <!-- Container -->\r\n            <div class=\"ladi-container\" style=\"\r\n                position: relative;\r\n                z-index: 1;\r\n                padding: ${componentData.padding || styles.padding || '20px'};\r\n                width: 100%;\r\n                height: 100%;\r\n            \">\r\n                ${childrenHTML}\r\n            </div>\r\n        </section>\r\n    `;\r\n};\r\n\r\n/**\r\n * Generate CSS t·ª´ pageData\r\n */\r\nconst generateCSS = (pageData) => {\r\n    let css = `\r\n        * {\r\n            box-sizing: border-box;\r\n        }\r\n\r\n        body {\r\n            margin: 0;\r\n            padding: 0;\r\n            overflow-x: hidden;\r\n        }\r\n\r\n        .lpb-element {\r\n            transition: all 0.3s ease;\r\n        }\r\n\r\n        /* Base responsive images */\r\n        .lpb-element img {\r\n            max-width: 100%;\r\n            height: auto;\r\n        }\r\n    `;\r\n\r\n    // Extract pseudo-classes v√† animations t·ª´ elements\r\n    pageData.elements.forEach(element => {\r\n        const { id, styles = {} } = element;\r\n\r\n        // Process hover states\r\n        if (styles[':hover']) {\r\n            css += `\\n#${id}:hover {`;\r\n            Object.entries(styles[':hover']).forEach(([key, value]) => {\r\n                const kebabKey = key.replace(/[A-Z]/g, m => `-${m.toLowerCase()}`);\r\n                css += `${kebabKey}:${value};`;\r\n            });\r\n            css += `}`;\r\n        }\r\n\r\n        // Process keyframes\r\n        Object.entries(styles).forEach(([key, value]) => {\r\n            if (key.startsWith('@keyframes')) {\r\n                css += `\\n${key} {`;\r\n                Object.entries(value).forEach(([frame, props]) => {\r\n                    css += `${frame} {`;\r\n                    Object.entries(props).forEach(([prop, val]) => {\r\n                        const kebabProp = prop.replace(/[A-Z]/g, m => `-${m.toLowerCase()}`);\r\n                        css += `${kebabProp}:${val};`;\r\n                    });\r\n                    css += `}`;\r\n                });\r\n                css += `}`;\r\n            }\r\n        });\r\n\r\n        // Process children\r\n        if (element.children) {\r\n            element.children.forEach(child => {\r\n                if (child.styles?.[':hover']) {\r\n                    css += `\\n#${child.id}:hover {`;\r\n                    Object.entries(child.styles[':hover']).forEach(([key, value]) => {\r\n                        const kebabKey = key.replace(/[A-Z]/g, m => `-${m.toLowerCase()}`);\r\n                        css += `${kebabKey}:${value};`;\r\n                    });\r\n                    css += `}`;\r\n                }\r\n            });\r\n        }\r\n    });\r\n\r\n    // Generate responsive positioning CSS for all elements with data attributes\r\n    css += `\\n\\n/* Responsive Tablet (‚â§768px) */`;\r\n    css += `\\n@media (max-width: 768px) {`;\r\n\r\n    pageData.elements.forEach(element => {\r\n        if (element.type === 'section') {\r\n            css += `\\n    #${element.id} { top: var(--tablet-y-${element.id}, ${element.position?.tablet?.y || element.position?.desktop?.y || 0}px); }`;\r\n\r\n            // Process children positioning\r\n            if (element.children) {\r\n                element.children.forEach(child => {\r\n                    const tabletX = child.position?.tablet?.x || child.position?.desktop?.x || 0;\r\n                    const tabletY = child.position?.tablet?.y || child.position?.desktop?.y || 0;\r\n                    css += `\\n    #${child.id} { left: ${tabletX}px; top: ${tabletY}px; }`;\r\n                });\r\n            }\r\n        }\r\n    });\r\n\r\n    css += `\\n}`;\r\n\r\n    // Generate responsive positioning CSS for mobile\r\n    css += `\\n\\n/* Responsive Mobile (‚â§480px) */`;\r\n    css += `\\n@media (max-width: 480px) {`;\r\n\r\n    pageData.elements.forEach(element => {\r\n        if (element.type === 'section') {\r\n            css += `\\n    #${element.id} { top: var(--mobile-y-${element.id}, ${element.position?.mobile?.y || element.position?.desktop?.y || 0}px); }`;\r\n\r\n            // Process children positioning\r\n            if (element.children) {\r\n                element.children.forEach(child => {\r\n                    const mobileX = child.position?.mobile?.x || child.position?.desktop?.x || 0;\r\n                    const mobileY = child.position?.mobile?.y || child.position?.desktop?.y || 0;\r\n                    css += `\\n    #${child.id} { left: ${mobileX}px; top: ${mobileY}px; }`;\r\n                });\r\n            }\r\n        }\r\n    });\r\n\r\n    css += `\\n}`;\r\n\r\n    // Generate responsive CSS for very small screens (‚â§360px)\r\n    css += `\\n\\n/* Responsive Very Small Screens (‚â§360px) */`;\r\n    css += `\\n@media (max-width: 360px) {`;\r\n    css += `\\n    /* Scale down font sizes for very small screens */`;\r\n    css += `\\n    .lpb-heading, h1, h2, h3, h4, h5, h6 { font-size: 85% !important; }`;\r\n    css += `\\n    .lpb-paragraph, p { font-size: 90% !important; line-height: 1.4 !important; }`;\r\n    css += `\\n    .lpb-button { font-size: 85% !important; padding: 8px 16px !important; }`;\r\n    css += `\\n    .ladi-container { padding: 12px !important; }`;\r\n    css += `\\n}`;\r\n\r\n    return css;\r\n};\r\n\r\n/**\r\n * Render to√†n b·ªô pageData th√†nh static HTML v·ªõi embedded runtime\r\n * @param {Object} pageData - Page data\r\n * @returns {string} - Complete HTML document\r\n */\r\nexport const renderStaticHTML = (pageData) => {\r\n    // Extract components\r\n    const popups = pageData.elements.filter(el => el.type === 'popup');\r\n    const sections = pageData.elements.filter(el => el.type === 'section');\r\n    const events = extractEvents(pageData);\r\n\r\n    // Generate HTML parts\r\n    const sectionsHTML = sections.map(section => renderSectionHTML(section)).join('\\n');\r\n    const popupsHTML = renderPopupsHTML(popups);\r\n    const runtimeScript = generateEventRuntime(events, popups);\r\n\r\n    // Generate CSS\r\n    const cssContent = generateCSS(pageData);\r\n\r\n    // Combine everything\r\n    return `<!DOCTYPE html>\r\n<html lang=\"vi\">\r\n<head>\r\n    <meta charset=\"UTF-8\">\r\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n    <meta name=\"description\" content=\"${pageData.meta?.description || 'Landing page generated by LandingHub'}\">\r\n    <title>${pageData.meta?.title || 'Landing Page'}</title>\r\n    \r\n    <!-- Font Awesome -->\r\n    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css\" crossorigin=\"anonymous\" referrerpolicy=\"no-referrer\" />\r\n    \r\n    <!-- Styles -->\r\n    <style>\r\n        ${cssContent}\r\n        \r\n        /* Popup Styles */\r\n        .lpb-popup {\r\n            position: fixed;\r\n            inset: 0;\r\n            z-index: 9999;\r\n            display: none;\r\n            align-items: center;\r\n            justify-content: center;\r\n        }\r\n        \r\n        .lpb-popup.lpb-popup-active {\r\n            display: flex;\r\n        }\r\n        \r\n        .lpb-popup-overlay {\r\n            position: absolute;\r\n            inset: 0;\r\n            background: rgba(0, 0, 0, 0.5);\r\n            cursor: pointer;\r\n        }\r\n        \r\n        .lpb-popup-container {\r\n            position: relative;\r\n            z-index: 1;\r\n            background: white;\r\n            border-radius: 12px;\r\n            max-height: 90vh;\r\n            overflow-y: auto;\r\n            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);\r\n        }\r\n        \r\n        .lpb-popup-header {\r\n            display: flex;\r\n            justify-content: space-between;\r\n            align-items: center;\r\n            padding: 16px 20px;\r\n            border-bottom: 1px solid #e5e7eb;\r\n            background: linear-gradient(to bottom, #f9fafb, #ffffff);\r\n        }\r\n        \r\n        .lpb-popup-close {\r\n            width: 28px;\r\n            height: 28px;\r\n            border: none;\r\n            background: transparent;\r\n            cursor: pointer;\r\n            border-radius: 6px;\r\n            display: flex;\r\n            align-items: center;\r\n            justify-content: center;\r\n            transition: all 0.15s ease;\r\n            color: #6b7280;\r\n            font-size: 18px;\r\n            font-weight: bold;\r\n        }\r\n        \r\n        .lpb-popup-close:hover {\r\n            background: #f3f4f6;\r\n            color: #111827;\r\n        }\r\n        \r\n        .lpb-popup-body {\r\n            padding: 20px;\r\n        }\r\n        \r\n        /* Loading Spinner */\r\n        .lpb-spinner {\r\n            border: 3px solid #f3f3f3;\r\n            border-top: 3px solid #3b82f6;\r\n            border-radius: 50%;\r\n            width: 40px;\r\n            height: 40px;\r\n            animation: spin 1s linear infinite;\r\n            margin: 0 auto;\r\n        }\r\n        \r\n        @keyframes spin {\r\n            0% { transform: rotate(0deg); }\r\n            100% { transform: rotate(360deg); }\r\n        }\r\n        \r\n        /* ========== RESPONSIVE STYLES ========== */\r\n\r\n        /* Tablet (‚â§1024px) */\r\n        @media (max-width: 1024px) {\r\n            .lpb-section {\r\n                width: 95% !important;\r\n                max-width: 768px !important;\r\n            }\r\n\r\n            .ladi-container {\r\n                padding: 16px !important;\r\n            }\r\n        }\r\n\r\n        /* Mobile (‚â§768px) */\r\n        @media (max-width: 768px) {\r\n            .lpb-section {\r\n                width: 100% !important;\r\n                max-width: 100% !important;\r\n                left: 0 !important;\r\n                transform: none !important;\r\n            }\r\n\r\n            .ladi-container {\r\n                padding: 16px !important;\r\n            }\r\n\r\n            .lpb-popup-container {\r\n                width: 90% !important;\r\n                max-width: 90vw !important;\r\n                min-height: auto !important;\r\n            }\r\n\r\n            .lpb-popup-body {\r\n                padding: 16px !important;\r\n            }\r\n\r\n            /* Scale down typography */\r\n            .lpb-heading, h1 {\r\n                font-size: clamp(24px, 5vw, 32px) !important;\r\n            }\r\n\r\n            .lpb-heading, h2 {\r\n                font-size: clamp(20px, 4.5vw, 28px) !important;\r\n            }\r\n\r\n            .lpb-heading, h3 {\r\n                font-size: clamp(18px, 4vw, 24px) !important;\r\n            }\r\n\r\n            .lpb-paragraph, p {\r\n                font-size: clamp(14px, 3.5vw, 16px) !important;\r\n                line-height: 1.6 !important;\r\n            }\r\n\r\n            .lpb-button {\r\n                font-size: clamp(14px, 3.5vw, 16px) !important;\r\n                padding: 10px 20px !important;\r\n            }\r\n\r\n            /* Responsive images and galleries */\r\n            .lpb-gallery {\r\n                width: 100% !important;\r\n                height: auto !important;\r\n            }\r\n\r\n            .lpb-image, .lpb-element img {\r\n                max-width: 100% !important;\r\n                height: auto !important;\r\n            }\r\n        }\r\n\r\n        /* Small Mobile (‚â§480px) */\r\n        @media (max-width: 480px) {\r\n            .ladi-container {\r\n                padding: 12px !important;\r\n            }\r\n\r\n            .lpb-popup-body {\r\n                padding: 12px !important;\r\n            }\r\n\r\n            .lpb-heading, h1 {\r\n                font-size: clamp(20px, 5vw, 28px) !important;\r\n            }\r\n\r\n            .lpb-heading, h2 {\r\n                font-size: clamp(18px, 4.5vw, 24px) !important;\r\n            }\r\n\r\n            .lpb-heading, h3 {\r\n                font-size: clamp(16px, 4vw, 20px) !important;\r\n            }\r\n\r\n            .lpb-paragraph, p {\r\n                font-size: clamp(13px, 3.5vw, 15px) !important;\r\n            }\r\n\r\n            .lpb-button {\r\n                padding: 8px 16px !important;\r\n                min-height: 40px !important;\r\n            }\r\n        }\r\n\r\n        /* Very Small Screens (‚â§360px) */\r\n        @media (max-width: 360px) {\r\n            body {\r\n                font-size: 14px !important;\r\n            }\r\n\r\n            .ladi-container {\r\n                padding: 10px !important;\r\n            }\r\n\r\n            .lpb-popup-container {\r\n                width: 95% !important;\r\n                border-radius: 8px !important;\r\n            }\r\n\r\n            .lpb-popup-body {\r\n                padding: 10px !important;\r\n            }\r\n\r\n            .lpb-popup-header {\r\n                padding: 12px 16px !important;\r\n            }\r\n\r\n            .lpb-heading, h1 {\r\n                font-size: clamp(18px, 5vw, 24px) !important;\r\n            }\r\n\r\n            .lpb-heading, h2 {\r\n                font-size: clamp(16px, 4.5vw, 20px) !important;\r\n            }\r\n\r\n            .lpb-heading, h3, h4 {\r\n                font-size: clamp(15px, 4vw, 18px) !important;\r\n            }\r\n\r\n            .lpb-paragraph, p {\r\n                font-size: clamp(12px, 3.5vw, 14px) !important;\r\n                line-height: 1.5 !important;\r\n            }\r\n\r\n            .lpb-button {\r\n                font-size: 13px !important;\r\n                padding: 8px 12px !important;\r\n                min-height: 36px !important;\r\n            }\r\n\r\n            /* Reduce icon sizes */\r\n            .lpb-icon {\r\n                width: 80% !important;\r\n                height: 80% !important;\r\n            }\r\n        }\r\n    </style>\r\n</head>\r\n<body style=\"margin: 0; padding: 0; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\">\r\n    <!-- Canvas -->\r\n    <div id=\"lpb-canvas\" style=\"\r\n        position: relative;\r\n        min-height: 100vh;\r\n        background: ${pageData.canvas?.background || '#ffffff'};\r\n    \">\r\n        ${sectionsHTML}\r\n    </div>\r\n    \r\n    <!-- Popups -->\r\n    ${popupsHTML}\r\n    \r\n    <!-- Runtime Script -->\r\n    <script>\r\n        ${runtimeScript}\r\n    </script>\r\n\r\n    <!-- Embedded PageData for easy import -->\r\n    <script type=\"application/json\" id=\"lpb-page-data\">\r\n${JSON.stringify(pageData, null, 2)}\r\n    </script>\r\n\r\n    <!-- Google Analytics (optional) -->\r\n    ${pageData.analytics?.googleAnalyticsId ? `\r\n    <script async src=\"https://www.googletagmanager.com/gtag/js?id=${pageData.analytics.googleAnalyticsId}\"></script>\r\n    <script>\r\n        window.dataLayer = window.dataLayer || [];\r\n        function gtag(){dataLayer.push(arguments);}\r\n        gtag('js', new Date());\r\n        gtag('config', '${pageData.analytics.googleAnalyticsId}');\r\n    </script>\r\n    ` : ''}\r\n</body>\r\n</html>`;\r\n};\r\nconst findElementById = (elements, id) => {\r\n    for (const element of elements) {\r\n        if (element.id === id) return element;\r\n\r\n        if (element.children && element.children.length > 0) {\r\n            const found = findElementById(element.children, id);\r\n            if (found) return found;\r\n        }\r\n    }\r\n    return null;\r\n};\r\n/**\r\n * Parse HTML string th√†nh pageData structure ƒë·∫ßy ƒë·ªß\r\n * @param {string} htmlString - HTML content t·ª´ S3\r\n * @returns {Object} pageData v·ªõi c·∫•u tr√∫c { canvas, elements, meta }\r\n */\r\nexport const parseHTMLToPageData = (htmlString) => {\r\n    const pageData = {\r\n        canvas: {\r\n            width: 1200,\r\n            height: 'auto',\r\n            background: '#ffffff'\r\n        },\r\n        elements: [],\r\n        meta: {\r\n            title: 'Untitled',\r\n            description: '',\r\n            keywords: [],\r\n            created_at: new Date().toISOString(),\r\n            updated_at: new Date().toISOString()\r\n        },\r\n        analytics: {}\r\n    };\r\n\r\n    try {\r\n        const parser = new DOMParser();\r\n        const doc = parser.parseFromString(htmlString, 'text/html');\r\n\r\n        // ========== PARSE META ==========\r\n        const titleEl = doc.querySelector('title');\r\n        if (titleEl) {\r\n            pageData.meta.title = titleEl.textContent.trim() || 'Untitled';\r\n        }\r\n\r\n        const descEl = doc.querySelector('meta[name=\"description\"]');\r\n        if (descEl) {\r\n            pageData.meta.description = descEl.getAttribute('content') || '';\r\n        }\r\n\r\n        const keywordsEl = doc.querySelector('meta[name=\"keywords\"]');\r\n        if (keywordsEl) {\r\n            pageData.meta.keywords = keywordsEl.getAttribute('content')?.split(',').map(k => k.trim()) || [];\r\n        }\r\n\r\n        const analyticsScript = doc.querySelector('script[src*=\"googletagmanager\"]');\r\n        if (analyticsScript) {\r\n            const gaId = analyticsScript.src.match(/id=([A-Za-z0-9-_]+)/);\r\n            if (gaId) {\r\n                pageData.analytics.googleAnalyticsId = gaId[1];\r\n            }\r\n        }\r\n\r\n        // ========== TRY 1: PARSE EMBEDDED pageData (∆ØU TI√äN) ==========\r\n        const pageDataScript = doc.querySelector('script[type=\"application/json\"][id=\"lpb-page-data\"]');\r\n        if (pageDataScript) {\r\n            try {\r\n                const embeddedData = JSON.parse(pageDataScript.textContent || pageDataScript.innerHTML);\r\n                console.log('‚úÖ Found embedded pageData in <script id=\"lpb-page-data\">');\r\n\r\n                // Validate v√† normalize embedded pageData\r\n                if (embeddedData.canvas && Array.isArray(embeddedData.elements) && embeddedData.meta) {\r\n                    pageData.canvas = {\r\n                        width: embeddedData.canvas.width || 1200,\r\n                        height: embeddedData.canvas.height || 'auto',\r\n                        background: embeddedData.canvas.background || '#ffffff'\r\n                    };\r\n                    pageData.elements = normalizeElements(embeddedData.elements);\r\n                    pageData.meta = {\r\n                        title: embeddedData.meta.title || pageData.meta.title,\r\n                        description: embeddedData.meta.description || pageData.meta.description,\r\n                        keywords: embeddedData.meta.keywords || pageData.meta.keywords,\r\n                        created_at: embeddedData.meta.created_at || pageData.meta.created_at,\r\n                        updated_at: embeddedData.meta.updated_at || pageData.meta.updated_at\r\n                    };\r\n                    pageData.analytics = embeddedData.analytics || pageData.analytics;\r\n                    return pageData; // Tr·∫£ v·ªÅ ngay n·∫øu embedded pageData h·ª£p l·ªá\r\n                } else {\r\n                    console.warn('‚ö†Ô∏è Embedded pageData kh√¥ng h·ª£p l·ªá, fallback parse HTML');\r\n                }\r\n            } catch (parseError) {\r\n                console.warn('‚ö†Ô∏è Failed to parse embedded pageData JSON:', parseError.message);\r\n            }\r\n        }\r\n\r\n        // ========== TRY 2: PARSE HTML STRUCTURE ==========\r\n        console.log('üîç Parsing HTML structure...');\r\n\r\n        // Parse canvas t·ª´ #lpb-canvas\r\n        const canvasEl = doc.getElementById('lpb-canvas');\r\n        if (canvasEl) {\r\n            const canvasStyle = canvasEl.style;\r\n            pageData.canvas = {\r\n                width: parseInt(canvasStyle.width) || 1200,\r\n                height: canvasStyle.height || 'auto',\r\n                background: canvasStyle.background || canvasStyle.backgroundColor || '#ffffff',\r\n                minHeight: canvasStyle.minHeight || '100vh'\r\n            };\r\n        }\r\n\r\n        // Parse sections\r\n        const sections = doc.querySelectorAll('section.lpb-section, section.ladi-section, section[data-element-id]');\r\n        sections.forEach((sectionEl, index) => {\r\n            const section = parseSectionElement(sectionEl, index);\r\n            if (section) {\r\n                pageData.elements.push(section);\r\n            }\r\n        });\r\n\r\n        // Parse popups\r\n        const popups = doc.querySelectorAll('div.lpb-popup, div[data-type=\"popup\"]');\r\n        popups.forEach((popupEl, index) => {\r\n            const popup = parsePopupElement(popupEl, index);\r\n            if (popup) {\r\n                pageData.elements.push(popup);\r\n            }\r\n        });\r\n\r\n        // Parse standalone elements\r\n        const standaloneElements = doc.querySelectorAll('div.lpb-element:not(section):not(.lpb-popup):not(.lpb-child-element), [data-element-id]:not(.lpb-section):not(.lpb-popup)');\r\n        standaloneElements.forEach((el, index) => {\r\n            if (!el.closest('section.lpb-section, div.lpb-popup')) {\r\n                const element = parseStandaloneElement(el, index);\r\n                if (element) {\r\n                    pageData.elements.push(element);\r\n                }\r\n            }\r\n        });\r\n\r\n        // Parse events t·ª´ runtime script\r\n        const runtimeScripts = doc.querySelectorAll('script');\r\n        runtimeScripts.forEach(script => {\r\n            const content = script.textContent || script.innerHTML;\r\n            const eventsConfig = extractEventsFromScript(content);\r\n            if (eventsConfig.length > 0) {\r\n                mapEventsToElements(pageData.elements, eventsConfig);\r\n            }\r\n        });\r\n\r\n        // Parse animations v√† keyframes t·ª´ <style>\r\n        const styleElements = doc.querySelectorAll('style');\r\n        styleElements.forEach(styleEl => {\r\n            const cssContent = styleEl.textContent || styleEl.innerHTML;\r\n            const animations = extractAnimationsFromCSS(cssContent);\r\n            mapAnimationsToElements(pageData.elements, animations);\r\n        });\r\n\r\n        // T√≠nh canvas height d·ª±a tr√™n elements\r\n        const maxHeight = Math.max(\r\n            ...pageData.elements.map(el => {\r\n                const elTop = el.position?.desktop?.y || 0;\r\n                const elHeight = el.size?.height || 400;\r\n                return elTop + elHeight;\r\n            }),\r\n            1648\r\n        );\r\n        pageData.canvas.height = maxHeight;\r\n\r\n        console.log('‚úÖ HTML parsed successfully:', {\r\n            elementsCount: pageData.elements.length,\r\n            sections: pageData.elements.filter(el => el.type === 'section').length,\r\n            popups: pageData.elements.filter(el => el.type === 'popup').length,\r\n            standalone: pageData.elements.filter(el => el.type !== 'section' && el.type !== 'popup').length\r\n        });\r\n\r\n        return pageData;\r\n\r\n    } catch (error) {\r\n        console.error('‚ùå parseHTMLToPageData error:', error);\r\n        return pageData; // Fallback tr·∫£ v·ªÅ pageData m·∫∑c ƒë·ªãnh\r\n    }\r\n};\r\n\r\n// ==================== HELPER FUNCTIONS ====================\r\n\r\n/**\r\n * Normalize elements ƒë·ªÉ ƒë·∫£m b·∫£o c·∫•u tr√∫c h·ª£p l·ªá\r\n * @param {Array} elements - Array of elements\r\n * @returns {Array} Normalized elements\r\n */\r\nconst normalizeElements = (elements) => {\r\n    return elements.map(el => ({\r\n        id: el.id || `element-${Date.now()}-${Math.random().toString(36).slice(2)}`,\r\n        type: el.type || 'section',\r\n        componentData: el.componentData || {},\r\n        position: {\r\n            desktop: el.position?.desktop || { x: 0, y: 0, z: 1 },\r\n            tablet: el.position?.tablet || el.position?.desktop || { x: 0, y: 0, z: 1 },\r\n            mobile: el.position?.mobile || el.position?.desktop || { x: 0, y: 0, z: 1 }\r\n        },\r\n        size: el.size || { width: el.type === 'popup' ? 600 : 1200, height: 400 },\r\n        styles: el.styles || {},\r\n        children: Array.isArray(el.children) ? normalizeElements(el.children) : [],\r\n        visible: el.visible !== false,\r\n        locked: !!el.locked\r\n    }));\r\n};\r\n\r\n/**\r\n * Parse section element t·ª´ HTML\r\n * @param {HTMLElement} sectionEl - Section element\r\n * @param {number} index - Index c·ªßa section\r\n * @returns {Object|null} Section object\r\n */\r\nconst parseSectionElement = (sectionEl, index) => {\r\n    const id = sectionEl.id || sectionEl.getAttribute('data-element-id') || `section-${Date.now()}-${index}`;\r\n    const style = sectionEl.style;\r\n\r\n    const topMatch = style.top?.match(/(\\d+)px/) || ['0'];\r\n    const top = parseInt(topMatch[1]) || 0;\r\n    const widthMatch = style.width?.match(/(\\d+)px/) || ['1200'];\r\n    const heightMatch = style.height?.match(/(\\d+)px/) || ['400'];\r\n    const width = parseInt(widthMatch[1]) || 1200;\r\n    const height = parseInt(heightMatch[1]) || 400;\r\n\r\n    const bgEl = sectionEl.querySelector('.ladi-section-background');\r\n    const overlayEl = sectionEl.querySelector('.ladi-overlay');\r\n    const containerEl = sectionEl.querySelector('.ladi-container');\r\n\r\n    const componentData = { structure: sectionEl.classList.contains('ladi-section') ? 'ladi-standard' : 'standard' };\r\n\r\n    if (bgEl) {\r\n        const bgStyle = bgEl.style;\r\n        componentData.backgroundColor = bgStyle.backgroundColor || 'transparent';\r\n        const bgImageMatch = bgStyle.backgroundImage?.match(/url\\(['\"]?(.+?)['\"]?\\)/);\r\n        if (bgImageMatch) {\r\n            componentData.backgroundImage = bgImageMatch[1];\r\n            componentData.backgroundType = 'image';\r\n        } else if (componentData.backgroundColor !== 'transparent') {\r\n            componentData.backgroundType = 'color';\r\n        }\r\n        componentData.backgroundPosition = bgStyle.backgroundPosition || 'center';\r\n        componentData.backgroundSize = bgStyle.backgroundSize || 'cover';\r\n    }\r\n\r\n    if (overlayEl) {\r\n        componentData.overlayColor = overlayEl.style.backgroundColor || 'transparent';\r\n        componentData.overlayOpacity = parseFloat(overlayEl.style.opacity) || 0;\r\n    }\r\n\r\n    const styles = parseInlineStyles(style, sectionEl);\r\n    if (containerEl) {\r\n        componentData.padding = containerEl.style.padding || '20px';\r\n    }\r\n\r\n    const children = [];\r\n    if (containerEl) {\r\n        const childElements = containerEl.querySelectorAll('.lpb-element[data-element-id], .lpb-child-element');\r\n        childElements.forEach(childEl => {\r\n            if (childEl.closest('.ladi-container') === containerEl) {\r\n                const child = parseChildElement(childEl, id);\r\n                if (child) {\r\n                    children.push(child);\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    return {\r\n        id,\r\n        type: 'section',\r\n        componentData,\r\n        position: {\r\n            desktop: { x: 0, y: top, z: parseInt(style.zIndex) || index + 1 },\r\n            tablet: { x: 0, y: top, z: parseInt(style.zIndex) || index + 1 },\r\n            mobile: { x: 0, y: top, z: parseInt(style.zIndex) || index + 1 }\r\n        },\r\n        size: { width, height },\r\n        styles,\r\n        children,\r\n        visible: style.display !== 'none',\r\n        locked: sectionEl.classList.contains('lpb-element-locked')\r\n    };\r\n};\r\n\r\n/**\r\n * Parse popup element t·ª´ HTML\r\n * @param {HTMLElement} popupEl - Popup element\r\n * @param {number} index - Index c·ªßa popup\r\n * @returns {Object|null} Popup object\r\n */\r\nconst parsePopupElement = (popupEl, index) => {\r\n    const id = popupEl.id || popupEl.getAttribute('data-element-id') || `popup-${Date.now()}-${index}`;\r\n    const containerEl = popupEl.querySelector('.lpb-popup-container');\r\n    if (!containerEl) return null;\r\n\r\n    const widthMatch = containerEl.style.width?.match(/(\\d+)px/) || ['600'];\r\n    const minHeightMatch = containerEl.style.minHeight?.match(/(\\d+)px/) || ['400'];\r\n    const width = parseInt(widthMatch[1]) || 600;\r\n    const height = parseInt(minHeightMatch[1]) || 400;\r\n\r\n    const headerEl = popupEl.querySelector('.lpb-popup-header h3');\r\n    const bodyEl = popupEl.querySelector('.lpb-popup-body');\r\n\r\n    const componentData = {\r\n        title: headerEl?.textContent.trim() || 'Popup',\r\n        background: containerEl.style.background || 'rgba(255, 255, 255, 0.95)',\r\n        borderRadius: containerEl.style.borderRadius || '12px',\r\n        padding: bodyEl?.style.padding || '20px'\r\n    };\r\n\r\n    const styles = parseInlineStyles(containerEl.style, popupEl);\r\n\r\n    const children = [];\r\n    if (bodyEl) {\r\n        const childElements = bodyEl.querySelectorAll('.lpb-element[data-element-id], .lpb-child-element');\r\n        childElements.forEach(childEl => {\r\n            if (childEl.closest('.lpb-popup-body') === bodyEl) {\r\n                const child = parseChildElement(childEl, id);\r\n                if (child) {\r\n                    children.push(child);\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    return {\r\n        id,\r\n        type: 'popup',\r\n        componentData,\r\n        position: {\r\n            desktop: { x: 0, y: 0, z: parseInt(containerEl.style.zIndex) || 1001 },\r\n            tablet: { x: 0, y: 0, z: parseInt(containerEl.style.zIndex) || 1001 },\r\n            mobile: { x: 0, y: 0, z: parseInt(containerEl.style.zIndex) || 1001 }\r\n        },\r\n        size: { width, height },\r\n        styles,\r\n        children,\r\n        visible: popupEl.classList.contains('lpb-popup-active') || popupEl.style.display !== 'none',\r\n        locked: popupEl.classList.contains('lpb-element-locked')\r\n    };\r\n};\r\n\r\n/**\r\n * Parse standalone element t·ª´ HTML\r\n * @param {HTMLElement} element - Standalone element\r\n * @param {number} index - Index c·ªßa element\r\n * @returns {Object|null} Element object\r\n */\r\nconst parseStandaloneElement = (element, index) => {\r\n    const id = element.id || element.getAttribute('data-element-id') || `element-${Date.now()}-${index}`;\r\n    const type = element.getAttribute('data-type') || inferTypeFromElement(element);\r\n    const style = element.style;\r\n\r\n    const leftMatch = style.left?.match(/(\\d+)px/) || ['0'];\r\n    const topMatch = style.top?.match(/(\\d+)px/) || ['0'];\r\n    const widthMatch = style.width?.match(/(\\d+)px/) || [type === 'gallery' ? '380' : '200'];\r\n    const heightMatch = style.height?.match(/(\\d+)px/) || [type === 'gallery' ? '300' : '50'];\r\n    const left = parseInt(leftMatch[1]) || 0;\r\n    const top = parseInt(topMatch[1]) || 0;\r\n    const width = parseInt(widthMatch[1]) || (type === 'gallery' ? 380 : type === 'icon' ? 50 : 200);\r\n    const height = parseInt(heightMatch[1]) || (type === 'gallery' ? 300 : type === 'icon' ? 50 : 50);\r\n\r\n    const styles = parseInlineStyles(style, element);\r\n    const componentData = parseComponentData(element, type);\r\n\r\n    return {\r\n        id,\r\n        type,\r\n        componentData,\r\n        position: {\r\n            desktop: { x: left, y: top, z: parseInt(style.zIndex) || index + 1 },\r\n            tablet: { x: left, y: top, z: parseInt(style.zIndex) || index + 1 },\r\n            mobile: { x: left, y: top, z: parseInt(style.zIndex) || index + 1 }\r\n        },\r\n        size: { width, height },\r\n        styles,\r\n        children: [],\r\n        visible: style.display !== 'none',\r\n        locked: element.classList.contains('lpb-element-locked')\r\n    };\r\n};\r\n\r\n/**\r\n * Parse child element t·ª´ HTML\r\n * @param {HTMLElement} element - Child element\r\n * @param {string} parentId - ID c·ªßa parent (section/popup)\r\n * @returns {Object|null} Child element object\r\n */\r\nconst parseChildElement = (element, parentId) => {\r\n    const id = element.id || element.getAttribute('data-element-id') || `child-${Date.now()}-${Math.random().toString(36).slice(2)}`;\r\n    const type = element.getAttribute('data-type') || inferTypeFromElement(element);\r\n    const style = element.style;\r\n\r\n    const leftMatch = style.left?.match(/(\\d+)px/) || ['0'];\r\n    const topMatch = style.top?.match(/(\\d+)px/) || ['0'];\r\n    const widthMatch = style.width?.match(/(\\d+)px/) || [type === 'gallery' ? '380' : '200'];\r\n    const heightMatch = style.height?.match(/(\\d+)px/) || [type === 'gallery' ? '300' : '50'];\r\n    const left = parseInt(leftMatch[1]) || 0;\r\n    const top = parseInt(topMatch[1]) || 0;\r\n    const width = parseInt(widthMatch[1]) || (type === 'gallery' ? 380 : type === 'icon' ? 50 : 200);\r\n    const height = parseInt(heightMatch[1]) || (type === 'gallery' ? 300 : type === 'icon' ? 50 : 50);\r\n\r\n    const styles = parseInlineStyles(style, element);\r\n    const componentData = parseComponentData(element, type);\r\n\r\n    return {\r\n        id,\r\n        type,\r\n        componentData,\r\n        position: {\r\n            desktop: { x: left, y: top, z: parseInt(style.zIndex) || 10 },\r\n            tablet: { x: left, y: top, z: parseInt(style.zIndex) || 10 },\r\n            mobile: { x: left, y: top, z: parseInt(style.zIndex) || 10 }\r\n        },\r\n        size: { width, height },\r\n        styles,\r\n        children: [],\r\n        visible: style.display !== 'none',\r\n        locked: element.classList.contains('lpb-element-locked'),\r\n        parentId\r\n    };\r\n};\r\n\r\n/**\r\n * Parse componentData d·ª±a tr√™n type\r\n * @param {HTMLElement} element - Element\r\n * @param {string} type - Type c·ªßa element\r\n * @returns {Object} componentData\r\n */\r\nconst parseComponentData = (element, type) => {\r\n    const componentData = {};\r\n\r\n    switch (type) {\r\n        case 'button':\r\n            componentData.content = element.textContent.trim() || 'Button';\r\n            componentData.text = componentData.content;\r\n            componentData.background = element.style.background || element.style.backgroundColor;\r\n            componentData.color = element.style.color;\r\n            componentData.borderRadius = element.style.borderRadius;\r\n            componentData.border = element.style.border;\r\n            componentData.fontSize = element.style.fontSize;\r\n            componentData.fontWeight = element.style.fontWeight;\r\n            break;\r\n\r\n        case 'heading':\r\n            componentData.content = element.textContent.trim() || 'Heading';\r\n            componentData.text = componentData.content;\r\n            componentData.level = element.tagName.toLowerCase();\r\n            componentData.fontSize = element.style.fontSize;\r\n            componentData.color = element.style.color;\r\n            componentData.fontWeight = element.style.fontWeight;\r\n            componentData.textAlign = element.style.textAlign;\r\n            break;\r\n\r\n        case 'paragraph':\r\n            componentData.content = element.textContent.trim() || 'Paragraph';\r\n            componentData.text = componentData.content;\r\n            componentData.fontSize = element.style.fontSize;\r\n            componentData.color = element.style.color;\r\n            componentData.fontWeight = element.style.fontWeight;\r\n            componentData.lineHeight = element.style.lineHeight;\r\n            componentData.textAlign = element.style.textAlign;\r\n            break;\r\n\r\n        case 'image':\r\n            componentData.src = element.getAttribute('src') || 'https://via.placeholder.com/150';\r\n            componentData.alt = element.getAttribute('alt') || 'Image';\r\n            componentData.imageUrl = componentData.src;\r\n            break;\r\n\r\n        case 'icon':\r\n            const img = element.querySelector('img');\r\n            const iconEl = element.querySelector('i');\r\n            const svgEl = element.querySelector('svg');\r\n            if (img) {\r\n                componentData.imageUrl = img.getAttribute('src');\r\n                componentData.alt = img.getAttribute('alt') || 'Icon';\r\n            } else if (svgEl) {\r\n                componentData.icon = svgEl.outerHTML;\r\n            } else if (iconEl) {\r\n                componentData.icon = iconEl.className;\r\n            }\r\n            componentData.title = element.getAttribute('title') || '';\r\n            break;\r\n\r\n        case 'gallery':\r\n            const images = Array.from(element.querySelectorAll('img')).map(img => img.getAttribute('src') || 'https://via.placeholder.com/150');\r\n            componentData.images = images;\r\n            componentData.display = element.style.display || 'grid';\r\n            componentData.gridTemplateColumns = element.style.gridTemplateColumns || 'repeat(auto-fill, minmax(150px, 1fr))';\r\n            componentData.gap = element.style.gap || '10px';\r\n            break;\r\n\r\n        case 'video':\r\n            componentData.src = element.getAttribute('src') || '';\r\n            componentData.videoUrl = componentData.src;\r\n            componentData.controls = element.hasAttribute('controls');\r\n            componentData.autoplay = element.hasAttribute('autoplay');\r\n            componentData.loop = element.hasAttribute('loop');\r\n            componentData.muted = element.hasAttribute('muted');\r\n            componentData.fallbackText = element.textContent.trim();\r\n            break;\r\n\r\n        case 'divider':\r\n        case 'hr':\r\n            componentData.thickness = element.style.height || '2px';\r\n            componentData.color = element.style.background || element.style.backgroundColor || '#e5e7eb';\r\n            break;\r\n\r\n        case 'link':\r\n        case 'anchor':\r\n            componentData.content = element.textContent.trim() || 'Link';\r\n            componentData.text = componentData.content;\r\n            componentData.href = element.getAttribute('href') || '#';\r\n            componentData.url = componentData.href;\r\n            componentData.target = element.getAttribute('target');\r\n            componentData.newTab = componentData.target === '_blank';\r\n            break;\r\n\r\n        case 'form':\r\n            componentData.action = element.getAttribute('action') || '#';\r\n            componentData.method = element.getAttribute('method') || 'POST';\r\n            break;\r\n\r\n        case 'input':\r\n            componentData.inputType = element.getAttribute('type') || 'text';\r\n            componentData.name = element.getAttribute('name') || '';\r\n            componentData.placeholder = element.getAttribute('placeholder') || '';\r\n            componentData.value = element.getAttribute('value') || '';\r\n            componentData.required = element.hasAttribute('required');\r\n            break;\r\n\r\n        case 'textarea':\r\n            componentData.name = element.getAttribute('name') || '';\r\n            componentData.placeholder = element.getAttribute('placeholder') || '';\r\n            componentData.value = element.textContent.trim();\r\n            componentData.rows = element.getAttribute('rows') || 4;\r\n            componentData.required = element.hasAttribute('required');\r\n            break;\r\n\r\n        case 'container':\r\n        case 'div':\r\n            componentData.content = element.innerHTML || '';\r\n            break;\r\n\r\n        default:\r\n            componentData.content = element.textContent.trim() || '';\r\n            componentData.text = componentData.content;\r\n            break;\r\n    }\r\n\r\n    // Parse animation n·∫øu c√≥\r\n    if (element.style.animation) {\r\n        const animationMatch = element.style.animation.match(/(\\S+)\\s*(\\d+\\.?\\d*ms)\\s*(\\w+)\\s*(\\d+\\.?\\d*ms)?\\s*(infinite)?/);\r\n        if (animationMatch) {\r\n            componentData.animation = {\r\n                type: animationMatch[1],\r\n                duration: parseFloat(animationMatch[2]) || 1000,\r\n                timing: animationMatch[3] || 'ease',\r\n                delay: parseFloat(animationMatch[4]) || 0,\r\n                repeat: !!animationMatch[5]\r\n            };\r\n        }\r\n    }\r\n\r\n    return componentData;\r\n};\r\n\r\n/**\r\n * Parse inline styles v√† pseudo-classes t·ª´ element\r\n * @param {CSSStyleDeclaration} styleObj - Style object\r\n * @param {HTMLElement} element - HTML element\r\n * @returns {Object} styles\r\n */\r\nconst parseInlineStyles = (styleObj, element) => {\r\n    const styles = {};\r\n    const importantProps = [\r\n        'background', 'backgroundColor', 'backgroundImage', 'backgroundSize', 'backgroundPosition',\r\n        'color', 'fontSize', 'fontWeight', 'fontFamily',\r\n        'border', 'borderRadius', 'boxShadow', 'textShadow',\r\n        'padding', 'margin', 'paddingTop', 'paddingRight', 'paddingBottom', 'paddingLeft',\r\n        'marginTop', 'marginRight', 'marginBottom', 'marginLeft',\r\n        'display', 'alignItems', 'justifyContent', 'flexDirection', 'gap',\r\n        'gridTemplateColumns', 'gridTemplateRows', 'gridGap',\r\n        'textAlign', 'lineHeight', 'textTransform',\r\n        'cursor', 'transition', 'animation', 'filter',\r\n        'zIndex', 'opacity', 'transform', 'transformOrigin',\r\n        'width', 'height', 'minWidth', 'minHeight', 'maxWidth', 'maxHeight'\r\n    ];\r\n\r\n    importantProps.forEach(prop => {\r\n        if (styleObj[prop]) {\r\n            styles[prop] = styleObj[prop];\r\n        }\r\n    });\r\n\r\n    // Parse pseudo-classes t·ª´ <style> li√™n quan ƒë·∫øn element\r\n    const styleElements = element.ownerDocument.querySelectorAll('style');\r\n    styleElements.forEach(styleEl => {\r\n        const cssContent = styleEl.textContent || styleEl.innerHTML;\r\n        const hoverRegex = new RegExp(`#${element.id}:hover\\\\s*{([\\\\s\\\\S]*?)}`);\r\n        const hoverMatch = cssContent.match(hoverRegex);\r\n        if (hoverMatch) {\r\n            const hoverStyles = {};\r\n            hoverMatch[1].split(';').forEach(rule => {\r\n                const [key, value] = rule.split(':').map(s => s.trim());\r\n                if (key && value) {\r\n                    const camelKey = key.replace(/-([a-z])/g, (_, letter) => letter.toUpperCase());\r\n                    hoverStyles[camelKey] = value;\r\n                }\r\n            });\r\n            if (Object.keys(hoverStyles).length > 0) {\r\n                styles[':hover'] = hoverStyles;\r\n            }\r\n        }\r\n    });\r\n\r\n    return styles;\r\n};\r\n\r\n/**\r\n * Extract events t·ª´ runtime script\r\n * @param {string} scriptContent - Script content\r\n * @returns {Array} Array of event configs\r\n */\r\nconst extractEventsFromScript = (scriptContent) => {\r\n    const eventsMatch = scriptContent.match(/const eventsConfig = (\\[[\\s\\S]*?\\]);/);\r\n    if (eventsMatch) {\r\n        try {\r\n            return JSON.parse(eventsMatch[1]);\r\n        } catch (e) {\r\n            console.warn('‚ö†Ô∏è Cannot parse events config:', e.message);\r\n            return [];\r\n        }\r\n    }\r\n    return [];\r\n};\r\n\r\n/**\r\n * √Ånh x·∫° events v√†o elements\r\n * @param {Array} elements - Array of elements\r\n * @param {Array} eventsConfig - Array of event configs\r\n */\r\nconst mapEventsToElements = (elements, eventsConfig) => {\r\n    eventsConfig.forEach(eventConfig => {\r\n        const element = findElementById(elements, eventConfig.elementId);\r\n        if (element) {\r\n            if (!element.componentData) {\r\n                element.componentData = {};\r\n            }\r\n            element.componentData.events = eventConfig.events || {};\r\n        }\r\n    });\r\n};\r\n\r\n/**\r\n * Extract animations t·ª´ CSS\r\n * @param {string} cssContent - CSS content\r\n * @returns {Object} Animations object\r\n */\r\nconst extractAnimationsFromCSS = (cssContent) => {\r\n    const animations = {};\r\n    const keyframesRegex = /@keyframes\\s+(\\S+)\\s*{([\\s\\S]*?)}/g;\r\n    let match;\r\n    while ((match = keyframesRegex.exec(cssContent))) {\r\n        const keyframeName = match[1];\r\n        const framesContent = match[2];\r\n        const frames = {};\r\n        const frameRegex = /(\\d+%|from|to)\\s*{([\\s\\S]*?)}/g;\r\n        let frameMatch;\r\n        while ((frameMatch = frameRegex.exec(framesContent))) {\r\n            const frameKey = frameMatch[1];\r\n            const props = {};\r\n            frameMatch[2].split(';').forEach(rule => {\r\n                const [key, value] = rule.split(':').map(s => s.trim());\r\n                if (key && value) {\r\n                    const camelKey = key.replace(/-([a-z])/g, (_, letter) => letter.toUpperCase());\r\n                    props[camelKey] = value;\r\n                }\r\n            });\r\n            frames[frameKey] = props;\r\n        }\r\n        animations[`@keyframes ${keyframeName}`] = frames;\r\n    }\r\n    return animations;\r\n};\r\n\r\n/**\r\n * √Ånh x·∫° animations v√†o elements\r\n * @param {Array} elements - Array of elements\r\n * @param {Object} animations - Animations object\r\n */\r\nconst mapAnimationsToElements = (elements, animations) => {\r\n    elements.forEach(element => {\r\n        if (element.styles?.animation) {\r\n            const animationMatch = element.styles.animation.match(/(\\S+)\\s*(\\d+\\.?\\d*ms)\\s*(\\w+)\\s*(\\d+\\.?\\d*ms)?\\s*(infinite)?/);\r\n            if (animationMatch) {\r\n                element.componentData.animation = {\r\n                    type: animationMatch[1],\r\n                    duration: parseFloat(animationMatch[2]) || 1000,\r\n                    timing: animationMatch[3] || 'ease',\r\n                    delay: parseFloat(animationMatch[4]) || 0,\r\n                    repeat: !!animationMatch[5]\r\n                };\r\n            }\r\n        }\r\n        if (element.styles && animations[`@keyframes ${element.styles.animationName}`]) {\r\n            element.styles[`@keyframes ${element.styles.animationName}`] = animations[`@keyframes ${element.styles.animationName}`];\r\n        }\r\n        if (element.children?.length > 0) {\r\n            mapAnimationsToElements(element.children, animations);\r\n        }\r\n    });\r\n};\r\n\r\n\r\n\r\n\r\n/**\r\n * Suy ra type t·ª´ element HTML\r\n * @param {HTMLElement} element - HTML element\r\n * @returns {string} Element type\r\n */\r\nconst inferTypeFromElement = (element) => {\r\n    const tagName = element.tagName.toLowerCase();\r\n    const classList = element.classList;\r\n\r\n    // Check by class first (more specific)\r\n    if (classList.contains('lpb-button')) return 'button';\r\n    if (classList.contains('lpb-icon')) return 'icon';\r\n    if (classList.contains('lpb-gallery')) return 'gallery';\r\n    if (classList.contains('lpb-section') || classList.contains('ladi-section')) return 'section';\r\n    if (classList.contains('lpb-popup')) return 'popup';\r\n    if (classList.contains('lpb-video')) return 'video';\r\n    if (classList.contains('lpb-divider')) return 'divider';\r\n    if (classList.contains('lpb-link')) return 'link';\r\n    if (classList.contains('lpb-container')) return 'container';\r\n    if (classList.contains('lpb-form')) return 'form';\r\n    if (classList.contains('lpb-input')) return 'input';\r\n    if (classList.contains('lpb-textarea')) return 'textarea';\r\n\r\n    // Then check by tag name\r\n    if (tagName === 'button') return 'button';\r\n    if (tagName.match(/^h[1-6]$/)) return 'heading';\r\n    if (tagName === 'p') return 'paragraph';\r\n    if (tagName === 'img') return 'image';\r\n    if (tagName === 'hr') return 'divider';\r\n    if (tagName === 'video') return 'video';\r\n    if (tagName === 'a') return 'link';\r\n    if (tagName === 'form') return 'form';\r\n    if (tagName === 'input') return 'input';\r\n    if (tagName === 'textarea') return 'textarea';\r\n    if (tagName === 'ul' || tagName === 'ol') return 'list';\r\n\r\n    // Default\r\n    return 'container';\r\n};"],"mappings":"AAAA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,MAAMA,oBAAoB,GAAGA,CAACC,MAAM,EAAEC,MAAM,KAAK;EAC7C,OAAO;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+BC,IAAI,CAACC,SAAS,CAACH,MAAM,CAAC;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA,MAAMI,aAAa,GAAIC,QAAQ,IAAK;EAChC,MAAML,MAAM,GAAG,EAAE;EAEjB,MAAMM,cAAc,GAAGA,CAACC,OAAO,EAAEC,QAAQ,GAAG,IAAI,KAAK;IAAA,IAAAC,qBAAA;IACjD,MAAMC,SAAS,GAAGH,OAAO,CAACI,EAAE;;IAE5B;IACA,KAAAF,qBAAA,GAAIF,OAAO,CAACK,aAAa,cAAAH,qBAAA,eAArBA,qBAAA,CAAuBT,MAAM,EAAE;MAC/BA,MAAM,CAACa,IAAI,CAAC;QACRH,SAAS,EAAEA,SAAS;QACpBV,MAAM,EAAEO,OAAO,CAACK,aAAa,CAACZ,MAAM;QACpCc,IAAI,EAAEP,OAAO,CAACO,IAAI;QAClBN,QAAQ,EAAEA;MACd,CAAC,CAAC;IACN;;IAEA;IACA,IAAIO,KAAK,CAACC,OAAO,CAACT,OAAO,CAACU,QAAQ,CAAC,EAAE;MACjCV,OAAO,CAACU,QAAQ,CAACC,OAAO,CAACC,KAAK,IAAI;QAAA,IAAAC,oBAAA;QAC9B,KAAAA,oBAAA,GAAID,KAAK,CAACP,aAAa,cAAAQ,oBAAA,eAAnBA,oBAAA,CAAqBpB,MAAM,EAAE;UAC7BA,MAAM,CAACa,IAAI,CAAC;YACRH,SAAS,EAAES,KAAK,CAACR,EAAE;YACnBX,MAAM,EAAEmB,KAAK,CAACP,aAAa,CAACZ,MAAM;YAClCc,IAAI,EAAEK,KAAK,CAACL,IAAI;YAChBN,QAAQ,EAAEE;UACd,CAAC,CAAC;QACN;;QAEA;QACA,IAAIK,KAAK,CAACC,OAAO,CAACG,KAAK,CAACF,QAAQ,CAAC,EAAE;UAC/BX,cAAc,CAACa,KAAK,EAAEA,KAAK,CAACR,EAAE,CAAC;QACnC;MACJ,CAAC,CAAC;IACN;EACJ,CAAC;EAEDN,QAAQ,CAACgB,QAAQ,CAACH,OAAO,CAACX,OAAO,IAAI;IACjCD,cAAc,CAACC,OAAO,CAAC;EAC3B,CAAC,CAAC;EAEF,OAAOP,MAAM;AACjB,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA,MAAMsB,gBAAgB,GAAIrB,MAAM,IAAK;EACjC,OAAOA,MAAM,CAACsB,GAAG,CAACC,KAAK,IAAI;IACvB,MAAM;MAAEb,EAAE;MAAEC,aAAa,GAAG,CAAC,CAAC;MAAEa,MAAM,GAAG,CAAC,CAAC;MAAEC,IAAI,GAAG,CAAC,CAAC;MAAET,QAAQ,GAAG;IAAG,CAAC,GAAGO,KAAK;;IAE/E;IACA,MAAMG,YAAY,GAAGV,QAAQ,CAACM,GAAG,CAACJ,KAAK,IACnCS,iBAAiB,CAACT,KAAK,EAAE,IAAI,CACjC,CAAC,CAACU,IAAI,CAAC,EAAE,CAAC;IAEV,OAAO;AACf;AACA,sBAAsBlB,EAAE;AACxB;AACA,mCAAmCA,EAAE;AACrC;AACA;AACA;AACA;AACA;AACA,iDAAiDA,EAAE;AACnD;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiCe,IAAI,CAACI,KAAK,IAAI,GAAG;AAClD;AACA,sCAAsCJ,IAAI,CAACK,MAAM,IAAI,GAAG;AACxD,sCAAsCN,MAAM,CAACO,UAAU,IAAIpB,aAAa,CAACoB,UAAU,IAAI,2BAA2B;AAClH,yCAAyCP,MAAM,CAACQ,YAAY,IAAIrB,aAAa,CAACqB,YAAY,IAAI,MAAM;AACpG;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8BrB,aAAa,CAACsB,KAAK,IAAI,aAAa;AAClE;AACA;AACA;AACA,yDAAyDvB,EAAE;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kEAAkEC,aAAa,CAACuB,OAAO,IAAI,MAAM;AACjG,0BAA0BR,YAAY,IAAI,6BAA6Bf,aAAa,CAACwB,OAAO,IAAI,eAAe,MAAM;AACrH;AACA;AACA;AACA,SAAS;EACL,CAAC,CAAC,CAACP,IAAI,CAAC,IAAI,CAAC;AACjB,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA,MAAMD,iBAAiB,GAAGA,CAACrB,OAAO,EAAE8B,OAAO,GAAG,KAAK,KAAK;EAAA,IAAAC,iBAAA,EAAAC,kBAAA,EAAAC,gBAAA,EAAAC,kBAAA,EAAAC,iBAAA,EAAAC,kBAAA,EAAAC,gBAAA,EAAAC,kBAAA,EAAAC,iBAAA,EAAAC,kBAAA,EAAAC,kBAAA,EAAAC,kBAAA,EAAAC,mBAAA;EACpD,MAAM;IAAEvC,EAAE;IAAEG,IAAI;IAAEF,aAAa,GAAG,CAAC,CAAC;IAAEa,MAAM,GAAG,CAAC,CAAC;IAAEC,IAAI,GAAG,CAAC,CAAC;IAAEyB,QAAQ,GAAG,CAAC,CAAC;IAAElC,QAAQ,GAAG;EAAG,CAAC,GAAGV,OAAO;;EAEtG;EACA,MAAM6C,YAAY,GAAGC,MAAM,CAACC,OAAO,CAAC7B,MAAM,CAAC,CACtC8B,MAAM,CAAC,CAAC,CAACC,GAAG,CAAC,KAAK,CAACA,GAAG,CAACC,UAAU,CAAC,GAAG,CAAC,IAAI,CAACD,GAAG,CAACC,UAAU,CAAC,GAAG,CAAC,CAAC,CAC/DlC,GAAG,CAAC,CAAC,CAACiC,GAAG,EAAEE,KAAK,CAAC,KAAK;IACnB,MAAMC,QAAQ,GAAGH,GAAG,CAACI,OAAO,CAAC,QAAQ,EAAEC,CAAC,IAAI,IAAIA,CAAC,CAACC,WAAW,CAAC,CAAC,EAAE,CAAC;IAClE,OAAO,GAAGH,QAAQ,IAAID,KAAK,EAAE;EACjC,CAAC,CAAC,CACD7B,IAAI,CAAC,GAAG,CAAC;;EAEd;EACA,MAAMkC,iBAAiB,GAAG1B,OAAO,GAAG;AACxC,0BAA0B,EAAAC,iBAAA,GAAAa,QAAQ,CAACa,OAAO,cAAA1B,iBAAA,uBAAhBA,iBAAA,CAAkB2B,CAAC,KAAI,CAAC;AAClD,0BAA0B,EAAA1B,kBAAA,GAAAY,QAAQ,CAACa,OAAO,cAAAzB,kBAAA,uBAAhBA,kBAAA,CAAkB2B,CAAC,KAAI,CAAC;AAClD,yBAAyB,EAAA1B,gBAAA,GAAAW,QAAQ,CAACgB,MAAM,cAAA3B,gBAAA,uBAAfA,gBAAA,CAAiByB,CAAC,OAAAxB,kBAAA,GAAIU,QAAQ,CAACa,OAAO,cAAAvB,kBAAA,uBAAhBA,kBAAA,CAAkBwB,CAAC,KAAI,CAAC;AACvE,yBAAyB,EAAAvB,iBAAA,GAAAS,QAAQ,CAACgB,MAAM,cAAAzB,iBAAA,uBAAfA,iBAAA,CAAiBwB,CAAC,OAAAvB,kBAAA,GAAIQ,QAAQ,CAACa,OAAO,cAAArB,kBAAA,uBAAhBA,kBAAA,CAAkBuB,CAAC,KAAI,CAAC;AACvE,yBAAyB,EAAAtB,gBAAA,GAAAO,QAAQ,CAACiB,MAAM,cAAAxB,gBAAA,uBAAfA,gBAAA,CAAiBqB,CAAC,OAAApB,kBAAA,GAAIM,QAAQ,CAACa,OAAO,cAAAnB,kBAAA,uBAAhBA,kBAAA,CAAkBoB,CAAC,KAAI,CAAC;AACvE,yBAAyB,EAAAnB,iBAAA,GAAAK,QAAQ,CAACiB,MAAM,cAAAtB,iBAAA,uBAAfA,iBAAA,CAAiBoB,CAAC,OAAAnB,kBAAA,GAAII,QAAQ,CAACa,OAAO,cAAAjB,kBAAA,uBAAhBA,kBAAA,CAAkBmB,CAAC,KAAI,CAAC;AACvE,KAAK,GAAG,EAAE;;EAEN;EACA,MAAMG,SAAS,GAAG;AACtB,cAAc1D,EAAE;AAChB,2BAA2BA,EAAE;AAC7B,qBAAqBG,IAAI;AACzB,iCAAiCA,IAAI;AACrC,UAAUiD,iBAAiB;AAC3B,KAAK;;EAED;EACA,MAAMO,cAAc,GAAGjC,OAAO,GAAG;AACrC;AACA,gBAAgB,EAAAW,kBAAA,GAAAG,QAAQ,CAACa,OAAO,cAAAhB,kBAAA,uBAAhBA,kBAAA,CAAkBiB,CAAC,KAAI,CAAC;AACxC,eAAe,EAAAhB,kBAAA,GAAAE,QAAQ,CAACa,OAAO,cAAAf,kBAAA,uBAAhBA,kBAAA,CAAkBiB,CAAC,KAAI,CAAC;AACvC,iBAAiBxC,IAAI,CAACI,KAAK,IAAI,GAAG;AAClC,kBAAkBJ,IAAI,CAACK,MAAM,IAAI,EAAE;AACnC,KAAK,GAAG,EAAE;;EAEN;EACA,QAAOjB,IAAI;IACP,KAAK,SAAS;MACV,OAAOyD,iBAAiB,CAAChE,OAAO,CAAC;IAErC,KAAK,QAAQ;MACT,OAAO;AACnB;AACA,sBAAsB8D,SAAS;AAC/B,6BAA6BjB,YAAY,KAAKkB,cAAc;AAC5D;AACA,sBAAsB1D,aAAa,CAACwB,OAAO,IAAIxB,aAAa,CAAC4D,IAAI,IAAI,QAAQ;AAC7E;AACA,aAAa;IAEL,KAAK,SAAS;MACV,MAAMC,UAAU,GAAG7D,aAAa,CAAC8D,KAAK,IAAI,IAAI;MAC9C,OAAO;AACnB,mBAAmBD,UAAU;AAC7B,sBAAsBJ,SAAS;AAC/B,6BAA6BjB,YAAY,KAAKkB,cAAc;AAC5D;AACA,sBAAsB1D,aAAa,CAACwB,OAAO,IAAIxB,aAAa,CAAC4D,IAAI,IAAI,SAAS;AAC9E,oBAAoBC,UAAU;AAC9B,aAAa;IAEL,KAAK,WAAW;MACZ,OAAO;AACnB;AACA,sBAAsBJ,SAAS;AAC/B,6BAA6BjB,YAAY,KAAKkB,cAAc;AAC5D;AACA,sBAAsB1D,aAAa,CAACwB,OAAO,IAAIxB,aAAa,CAAC4D,IAAI,IAAI,WAAW;AAChF;AACA,aAAa;IAEL,KAAK,OAAO;MACR,OAAO;AACnB;AACA,sBAAsBH,SAAS;AAC/B,2BAA2BzD,aAAa,CAAC+D,GAAG,IAAI/D,aAAa,CAACgE,QAAQ,IAAI,iCAAiC;AAC3G,2BAA2BhE,aAAa,CAACiE,GAAG,IAAI,OAAO;AACvD,6BAA6BzB,YAAY,KAAKkB,cAAc;AAC5D;AACA,aAAa;IAEL,KAAK,MAAM;MACP,MAAMQ,KAAK,IAAA5B,mBAAA,GAAGtC,aAAa,CAACmE,IAAI,cAAA7B,mBAAA,uBAAlBA,mBAAA,CAAoBO,UAAU,CAAC,MAAM,CAAC;MACpD,OAAO;AACnB;AACA,sBAAsBY,SAAS;AAC/B,6BAA6BjB,YAAY,KAAKkB,cAAc;AAC5D,6BAA6B1D,aAAa,CAACsB,KAAK,IAAI,EAAE;AACtD;AACA,sBAAsBtB,aAAa,CAACgE,QAAQ,GAC1B,aAAahE,aAAa,CAACgE,QAAQ,UAAUhE,aAAa,CAACsB,KAAK,IAAI,MAAM,yDAAyD,GACnI4C,KAAK,GACDlE,aAAa,CAACmE,IAAI,GAClBnE,aAAa,CAACmE,IAAI,GACd,aAAanE,aAAa,CAACmE,IAAI,QAAQ,GACvC,IAAI;AAC9B;AACA,aACa;IAEL,KAAK,SAAS;MACV,OAAOC,iBAAiB,CAACzE,OAAO,EAAE8B,OAAO,CAAC;IAE9C,KAAK,OAAO;MACR,OAAO;AACnB;AACA,sBAAsBgC,SAAS;AAC/B,2BAA2BzD,aAAa,CAAC+D,GAAG,IAAI/D,aAAa,CAACqE,QAAQ,IAAI,EAAE;AAC5E,gCAAgCrE,aAAa,CAACsE,QAAQ,KAAK,KAAK;AAChE,gCAAgCtE,aAAa,CAACuE,QAAQ,KAAK,IAAI;AAC/D,4BAA4BvE,aAAa,CAACwE,IAAI,KAAK,IAAI;AACvD,6BAA6BxE,aAAa,CAACyE,KAAK,KAAK,IAAI;AACzD,6BAA6BjC,YAAY,KAAKkB,cAAc;AAC5D;AACA,sBAAsB1D,aAAa,CAAC0E,YAAY,IAAI,8CAA8C;AAClG;AACA,aAAa;IAEL,KAAK,SAAS;IACd,KAAK,IAAI;MACL,OAAO;AACnB;AACA,sBAAsBjB,SAAS;AAC/B,6BAA6BjB,YAAY,KAAKkB,cAAc,yBAAyB1D,aAAa,CAAC2E,SAAS,IAAI,KAAK,gBAAgB3E,aAAa,CAAC4E,KAAK,IAAI,SAAS;AACrK;AACA,aAAa;IAEL,KAAK,MAAM;IACX,KAAK,QAAQ;MACT,OAAO;AACnB;AACA,sBAAsBnB,SAAS;AAC/B,4BAA4BzD,aAAa,CAAC6E,IAAI,IAAI7E,aAAa,CAAC8E,GAAG,IAAI,GAAG;AAC1E,8BAA8B9E,aAAa,CAAC+E,MAAM,IAAI/E,aAAa,CAACgF,MAAM,KAAK,QAAQ,GAAG,QAAQ,GAAG,OAAO;AAC5G,2BAA2BhF,aAAa,CAAC+E,MAAM,IAAI/E,aAAa,CAACgF,MAAM,KAAK,QAAQ,GAAG,qBAAqB,GAAG,EAAE;AACjH,6BAA6BxC,YAAY,KAAKkB,cAAc;AAC5D;AACA,sBAAsB1D,aAAa,CAACwB,OAAO,IAAIxB,aAAa,CAAC4D,IAAI,IAAI,MAAM;AAC3E;AACA,aAAa;IAEL,KAAK,MAAM;MACP,MAAMqB,YAAY,GAAG5E,QAAQ,CAACM,GAAG,CAACJ,KAAK,IAAIS,iBAAiB,CAACT,KAAK,EAAE,IAAI,CAAC,CAAC,CAACU,IAAI,CAAC,IAAI,CAAC;MACrF,OAAO;AACnB;AACA,sBAAsBwC,SAAS;AAC/B,8BAA8BzD,aAAa,CAACkF,MAAM,IAAI,GAAG;AACzD,8BAA8BlF,aAAa,CAACmF,MAAM,IAAI,MAAM;AAC5D,6BAA6B3C,YAAY,KAAKkB,cAAc;AAC5D;AACA,sBAAsBuB,YAAY,IAAI,mBAAmB;AACzD;AACA,aAAa;IAEL,KAAK,OAAO;MACR,OAAO;AACnB;AACA,sBAAsBxB,SAAS;AAC/B,4BAA4BzD,aAAa,CAACoF,SAAS,IAAI,MAAM;AAC7D,4BAA4BpF,aAAa,CAACqF,IAAI,IAAItF,EAAE;AACpD,mCAAmCC,aAAa,CAACsF,WAAW,IAAI,EAAE;AAClE,6BAA6BtF,aAAa,CAAC8C,KAAK,IAAI,EAAE;AACtD,gCAAgC9C,aAAa,CAACuF,QAAQ,KAAK,IAAI;AAC/D,6BAA6B/C,YAAY,KAAKkB,cAAc;AAC5D;AACA,aAAa;IAEL,KAAK,UAAU;MACX,OAAO;AACnB;AACA,sBAAsBD,SAAS;AAC/B,4BAA4BzD,aAAa,CAACqF,IAAI,IAAItF,EAAE;AACpD,mCAAmCC,aAAa,CAACsF,WAAW,IAAI,EAAE;AAClE,4BAA4BtF,aAAa,CAACwF,IAAI,IAAI,CAAC;AACnD,gCAAgCxF,aAAa,CAACuF,QAAQ,KAAK,IAAI;AAC/D,6BAA6B/C,YAAY,KAAKkB,cAAc;AAC5D,mBAAmB1D,aAAa,CAAC8C,KAAK,IAAI,EAAE;AAC5C,aAAa;IAEL,KAAK,WAAW;IAChB,KAAK,KAAK;MACN,MAAM2C,iBAAiB,GAAGpF,QAAQ,CAACM,GAAG,CAACJ,KAAK,IAAIS,iBAAiB,CAACT,KAAK,EAAE,IAAI,CAAC,CAAC,CAACU,IAAI,CAAC,IAAI,CAAC;MAC1F,OAAO;AACnB;AACA,sBAAsBwC,SAAS;AAC/B,6BAA6BjB,YAAY,KAAKkB,cAAc;AAC5D;AACA,sBAAsB+B,iBAAiB,IAAIzF,aAAa,CAACwB,OAAO,IAAI,EAAE;AACtE;AACA,aAAa;IAEL;MACI;MACA,MAAMkE,eAAe,GAAGrF,QAAQ,CAACsF,MAAM,GAAG,CAAC,GACrCtF,QAAQ,CAACM,GAAG,CAACJ,KAAK,IAAIS,iBAAiB,CAACT,KAAK,EAAE,IAAI,CAAC,CAAC,CAACU,IAAI,CAAC,IAAI,CAAC,GAC/DjB,aAAa,CAACwB,OAAO,IAAIxB,aAAa,CAAC4D,IAAI,IAAI,IAAI1D,IAAI,GAAI;MAClE,OAAO;AACnB;AACA,sBAAsBuD,SAAS;AAC/B,6BAA6BjB,YAAY,KAAKkB,cAAc;AAC5D;AACA,sBAAsBgC,eAAe;AACrC;AACA,aAAa;EACT;AACJ,CAAC;;AAED;AACA;AACA;AACA,MAAMtB,iBAAiB,GAAGA,CAACzE,OAAO,EAAE8B,OAAO,KAAK;EAAA,IAAAmE,kBAAA,EAAAC,kBAAA;EAC5C,MAAM;IAAE9F,EAAE;IAAEC,aAAa,GAAG,CAAC,CAAC;IAAEa,MAAM,GAAG,CAAC,CAAC;IAAEC,IAAI,GAAG,CAAC,CAAC;IAAEyB,QAAQ,GAAG,CAAC;EAAE,CAAC,GAAG5C,OAAO;EAEjF,MAAM+D,cAAc,GAAGjC,OAAO,GAAG;AACrC;AACA,gBAAgB,EAAAmE,kBAAA,GAAArD,QAAQ,CAACa,OAAO,cAAAwC,kBAAA,uBAAhBA,kBAAA,CAAkBvC,CAAC,KAAI,CAAC;AACxC,eAAe,EAAAwC,kBAAA,GAAAtD,QAAQ,CAACa,OAAO,cAAAyC,kBAAA,uBAAhBA,kBAAA,CAAkBvC,CAAC,KAAI,CAAC;AACvC,KAAK,GAAG,EAAE;EAEN,MAAMwC,MAAM,GAAG9F,aAAa,CAAC8F,MAAM,IAAI,EAAE;EAEzC,OAAO;AACX;AACA,kBAAkB/F,EAAE;AACpB,+BAA+BA,EAAE;AACjC;AACA;AACA,qBAAqB2D,cAAc,WAAW5C,IAAI,CAACI,KAAK,IAAI,GAAG,eAAeJ,IAAI,CAACK,MAAM,IAAI,GAAG;AAChG;AACA;AACA,2BAA2BN,MAAM,CAACkF,OAAO,IAAI,MAAM;AACnD,yCAAyClF,MAAM,CAACmF,mBAAmB,IAAI,uCAAuC;AAC9G,uBAAuBnF,MAAM,CAACoF,GAAG,IAAI,MAAM;AAC3C;AACA;AACA;AACA,kBAAkBH,MAAM,CAACnF,GAAG,CAAC,CAACqD,QAAQ,EAAEkC,KAAK,KAAK;AAClD;AACA;AACA;AACA,yCAAyCrF,MAAM,CAACQ,YAAY,IAAI,KAAK;AACrE;AACA;AACA;AACA,mCAAmC2C,QAAQ,IAAI,iCAAiC;AAChF,2CAA2CkC,KAAK,GAAG,CAAC;AACpD;AACA;AACA;AACA,8CAA8CrF,MAAM,CAACsF,SAAS,IAAI,OAAO;AACzE,mDAAmDtF,MAAM,CAACuF,cAAc,IAAI,QAAQ;AACpF;AACA;AACA;AACA;AACA,iBAAiB,CAAC,CAACnF,IAAI,CAAC,EAAE,CAAC;AAC3B,kBAAkB6E,MAAM,CAACH,MAAM,KAAK,CAAC,GAAG;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,GAAG,EAAE;AACtB;AACA;AACA,KAAK;AACL,CAAC;;AAED;AACA;AACA;AACA,MAAMhC,iBAAiB,GAAI0C,OAAO,IAAK;EAAA,IAAAC,kBAAA,EAAAC,iBAAA,EAAAC,mBAAA,EAAAC,iBAAA,EAAAC,mBAAA,EAAAC,mBAAA;EACnC,MAAM;IAAE5G,EAAE;IAAEC,aAAa,GAAG,CAAC,CAAC;IAAEa,MAAM,GAAG,CAAC,CAAC;IAAEC,IAAI,GAAG,CAAC,CAAC;IAAEyB,QAAQ,GAAG,CAAC,CAAC;IAAElC,QAAQ,GAAG;EAAG,CAAC,GAAGgG,OAAO;;EAEhG;EACA,MAAMtF,YAAY,GAAGV,QAAQ,CAACM,GAAG,CAACJ,KAAK,IACnCS,iBAAiB,CAACT,KAAK,EAAE,IAAI,CACjC,CAAC,CAACU,IAAI,CAAC,IAAI,CAAC;EAEZ,OAAO;AACX;AACA,kBAAkBlB,EAAE;AACpB,+BAA+BA,EAAE;AACjC;AACA,8BAA8B,EAAAuG,kBAAA,GAAA/D,QAAQ,CAACa,OAAO,cAAAkD,kBAAA,uBAAhBA,kBAAA,CAAkBhD,CAAC,KAAI,CAAC;AACtD,6BAA6B,EAAAiD,iBAAA,GAAAhE,QAAQ,CAACgB,MAAM,cAAAgD,iBAAA,uBAAfA,iBAAA,CAAiBjD,CAAC,OAAAkD,mBAAA,GAAIjE,QAAQ,CAACa,OAAO,cAAAoD,mBAAA,uBAAhBA,mBAAA,CAAkBlD,CAAC,KAAI,CAAC;AAC3E,6BAA6B,EAAAmD,iBAAA,GAAAlE,QAAQ,CAACiB,MAAM,cAAAiD,iBAAA,uBAAfA,iBAAA,CAAiBnD,CAAC,OAAAoD,mBAAA,GAAInE,QAAQ,CAACa,OAAO,cAAAsD,mBAAA,uBAAhBA,mBAAA,CAAkBpD,CAAC,KAAI,CAAC;AAC3E;AACA;AACA,uBAAuB,EAAAqD,mBAAA,GAAApE,QAAQ,CAACa,OAAO,cAAAuD,mBAAA,uBAAhBA,mBAAA,CAAkBrD,CAAC,KAAI,CAAC;AAC/C;AACA;AACA;AACA,0BAA0BxC,IAAI,CAACK,MAAM,IAAI,GAAG;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoCnB,aAAa,CAAC4G,eAAe,IAAI/F,MAAM,CAAC+F,eAAe,IAAI,aAAa;AAC5G,oCAAoC5G,aAAa,CAAC6G,eAAe,GAAG,OAAO7G,aAAa,CAAC6G,eAAe,GAAG,GAAG,MAAM;AACpH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC7G,aAAa,CAAC8G,YAAY,IAAI,aAAa;AAC/E,2BAA2B9G,aAAa,CAAC+G,cAAc,IAAI,CAAC;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B/G,aAAa,CAACuB,OAAO,IAAIV,MAAM,CAACU,OAAO,IAAI,MAAM;AAC5E;AACA;AACA;AACA,kBAAkBR,YAAY;AAC9B;AACA;AACA,KAAK;AACL,CAAC;;AAED;AACA;AACA;AACA,MAAMiG,WAAW,GAAIvH,QAAQ,IAAK;EAC9B,IAAIwH,GAAG,GAAG;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;EAED;EACAxH,QAAQ,CAACgB,QAAQ,CAACH,OAAO,CAACX,OAAO,IAAI;IACjC,MAAM;MAAEI,EAAE;MAAEc,MAAM,GAAG,CAAC;IAAE,CAAC,GAAGlB,OAAO;;IAEnC;IACA,IAAIkB,MAAM,CAAC,QAAQ,CAAC,EAAE;MAClBoG,GAAG,IAAI,MAAMlH,EAAE,UAAU;MACzB0C,MAAM,CAACC,OAAO,CAAC7B,MAAM,CAAC,QAAQ,CAAC,CAAC,CAACP,OAAO,CAAC,CAAC,CAACsC,GAAG,EAAEE,KAAK,CAAC,KAAK;QACvD,MAAMC,QAAQ,GAAGH,GAAG,CAACI,OAAO,CAAC,QAAQ,EAAEC,CAAC,IAAI,IAAIA,CAAC,CAACC,WAAW,CAAC,CAAC,EAAE,CAAC;QAClE+D,GAAG,IAAI,GAAGlE,QAAQ,IAAID,KAAK,GAAG;MAClC,CAAC,CAAC;MACFmE,GAAG,IAAI,GAAG;IACd;;IAEA;IACAxE,MAAM,CAACC,OAAO,CAAC7B,MAAM,CAAC,CAACP,OAAO,CAAC,CAAC,CAACsC,GAAG,EAAEE,KAAK,CAAC,KAAK;MAC7C,IAAIF,GAAG,CAACC,UAAU,CAAC,YAAY,CAAC,EAAE;QAC9BoE,GAAG,IAAI,KAAKrE,GAAG,IAAI;QACnBH,MAAM,CAACC,OAAO,CAACI,KAAK,CAAC,CAACxC,OAAO,CAAC,CAAC,CAAC4G,KAAK,EAAEC,KAAK,CAAC,KAAK;UAC9CF,GAAG,IAAI,GAAGC,KAAK,IAAI;UACnBzE,MAAM,CAACC,OAAO,CAACyE,KAAK,CAAC,CAAC7G,OAAO,CAAC,CAAC,CAAC8G,IAAI,EAAEC,GAAG,CAAC,KAAK;YAC3C,MAAMC,SAAS,GAAGF,IAAI,CAACpE,OAAO,CAAC,QAAQ,EAAEC,CAAC,IAAI,IAAIA,CAAC,CAACC,WAAW,CAAC,CAAC,EAAE,CAAC;YACpE+D,GAAG,IAAI,GAAGK,SAAS,IAAID,GAAG,GAAG;UACjC,CAAC,CAAC;UACFJ,GAAG,IAAI,GAAG;QACd,CAAC,CAAC;QACFA,GAAG,IAAI,GAAG;MACd;IACJ,CAAC,CAAC;;IAEF;IACA,IAAItH,OAAO,CAACU,QAAQ,EAAE;MAClBV,OAAO,CAACU,QAAQ,CAACC,OAAO,CAACC,KAAK,IAAI;QAAA,IAAAgH,aAAA;QAC9B,KAAAA,aAAA,GAAIhH,KAAK,CAACM,MAAM,cAAA0G,aAAA,eAAZA,aAAA,CAAe,QAAQ,CAAC,EAAE;UAC1BN,GAAG,IAAI,MAAM1G,KAAK,CAACR,EAAE,UAAU;UAC/B0C,MAAM,CAACC,OAAO,CAACnC,KAAK,CAACM,MAAM,CAAC,QAAQ,CAAC,CAAC,CAACP,OAAO,CAAC,CAAC,CAACsC,GAAG,EAAEE,KAAK,CAAC,KAAK;YAC7D,MAAMC,QAAQ,GAAGH,GAAG,CAACI,OAAO,CAAC,QAAQ,EAAEC,CAAC,IAAI,IAAIA,CAAC,CAACC,WAAW,CAAC,CAAC,EAAE,CAAC;YAClE+D,GAAG,IAAI,GAAGlE,QAAQ,IAAID,KAAK,GAAG;UAClC,CAAC,CAAC;UACFmE,GAAG,IAAI,GAAG;QACd;MACJ,CAAC,CAAC;IACN;EACJ,CAAC,CAAC;;EAEF;EACAA,GAAG,IAAI,sCAAsC;EAC7CA,GAAG,IAAI,+BAA+B;EAEtCxH,QAAQ,CAACgB,QAAQ,CAACH,OAAO,CAACX,OAAO,IAAI;IACjC,IAAIA,OAAO,CAACO,IAAI,KAAK,SAAS,EAAE;MAAA,IAAAsH,iBAAA,EAAAC,qBAAA,EAAAC,kBAAA,EAAAC,qBAAA;MAC5BV,GAAG,IAAI,UAAUtH,OAAO,CAACI,EAAE,0BAA0BJ,OAAO,CAACI,EAAE,KAAK,EAAAyH,iBAAA,GAAA7H,OAAO,CAAC4C,QAAQ,cAAAiF,iBAAA,wBAAAC,qBAAA,GAAhBD,iBAAA,CAAkBjE,MAAM,cAAAkE,qBAAA,uBAAxBA,qBAAA,CAA0BnE,CAAC,OAAAoE,kBAAA,GAAI/H,OAAO,CAAC4C,QAAQ,cAAAmF,kBAAA,wBAAAC,qBAAA,GAAhBD,kBAAA,CAAkBtE,OAAO,cAAAuE,qBAAA,uBAAzBA,qBAAA,CAA2BrE,CAAC,KAAI,CAAC,QAAQ;;MAE5I;MACA,IAAI3D,OAAO,CAACU,QAAQ,EAAE;QAClBV,OAAO,CAACU,QAAQ,CAACC,OAAO,CAACC,KAAK,IAAI;UAAA,IAAAqH,eAAA,EAAAC,qBAAA,EAAAC,gBAAA,EAAAC,qBAAA,EAAAC,gBAAA,EAAAC,qBAAA,EAAAC,gBAAA,EAAAC,qBAAA;UAC9B,MAAMC,OAAO,GAAG,EAAAR,eAAA,GAAArH,KAAK,CAACgC,QAAQ,cAAAqF,eAAA,wBAAAC,qBAAA,GAAdD,eAAA,CAAgBrE,MAAM,cAAAsE,qBAAA,uBAAtBA,qBAAA,CAAwBxE,CAAC,OAAAyE,gBAAA,GAAIvH,KAAK,CAACgC,QAAQ,cAAAuF,gBAAA,wBAAAC,qBAAA,GAAdD,gBAAA,CAAgB1E,OAAO,cAAA2E,qBAAA,uBAAvBA,qBAAA,CAAyB1E,CAAC,KAAI,CAAC;UAC5E,MAAMgF,OAAO,GAAG,EAAAL,gBAAA,GAAAzH,KAAK,CAACgC,QAAQ,cAAAyF,gBAAA,wBAAAC,qBAAA,GAAdD,gBAAA,CAAgBzE,MAAM,cAAA0E,qBAAA,uBAAtBA,qBAAA,CAAwB3E,CAAC,OAAA4E,gBAAA,GAAI3H,KAAK,CAACgC,QAAQ,cAAA2F,gBAAA,wBAAAC,qBAAA,GAAdD,gBAAA,CAAgB9E,OAAO,cAAA+E,qBAAA,uBAAvBA,qBAAA,CAAyB7E,CAAC,KAAI,CAAC;UAC5E2D,GAAG,IAAI,UAAU1G,KAAK,CAACR,EAAE,YAAYqI,OAAO,YAAYC,OAAO,OAAO;QAC1E,CAAC,CAAC;MACN;IACJ;EACJ,CAAC,CAAC;EAEFpB,GAAG,IAAI,KAAK;;EAEZ;EACAA,GAAG,IAAI,sCAAsC;EAC7CA,GAAG,IAAI,+BAA+B;EAEtCxH,QAAQ,CAACgB,QAAQ,CAACH,OAAO,CAACX,OAAO,IAAI;IACjC,IAAIA,OAAO,CAACO,IAAI,KAAK,SAAS,EAAE;MAAA,IAAAoI,kBAAA,EAAAC,qBAAA,EAAAC,kBAAA,EAAAC,qBAAA;MAC5BxB,GAAG,IAAI,UAAUtH,OAAO,CAACI,EAAE,0BAA0BJ,OAAO,CAACI,EAAE,KAAK,EAAAuI,kBAAA,GAAA3I,OAAO,CAAC4C,QAAQ,cAAA+F,kBAAA,wBAAAC,qBAAA,GAAhBD,kBAAA,CAAkB9E,MAAM,cAAA+E,qBAAA,uBAAxBA,qBAAA,CAA0BjF,CAAC,OAAAkF,kBAAA,GAAI7I,OAAO,CAAC4C,QAAQ,cAAAiG,kBAAA,wBAAAC,qBAAA,GAAhBD,kBAAA,CAAkBpF,OAAO,cAAAqF,qBAAA,uBAAzBA,qBAAA,CAA2BnF,CAAC,KAAI,CAAC,QAAQ;;MAE5I;MACA,IAAI3D,OAAO,CAACU,QAAQ,EAAE;QAClBV,OAAO,CAACU,QAAQ,CAACC,OAAO,CAACC,KAAK,IAAI;UAAA,IAAAmI,gBAAA,EAAAC,qBAAA,EAAAC,gBAAA,EAAAC,qBAAA,EAAAC,gBAAA,EAAAC,qBAAA,EAAAC,gBAAA,EAAAC,qBAAA;UAC9B,MAAMC,OAAO,GAAG,EAAAR,gBAAA,GAAAnI,KAAK,CAACgC,QAAQ,cAAAmG,gBAAA,wBAAAC,qBAAA,GAAdD,gBAAA,CAAgBlF,MAAM,cAAAmF,qBAAA,uBAAtBA,qBAAA,CAAwBtF,CAAC,OAAAuF,gBAAA,GAAIrI,KAAK,CAACgC,QAAQ,cAAAqG,gBAAA,wBAAAC,qBAAA,GAAdD,gBAAA,CAAgBxF,OAAO,cAAAyF,qBAAA,uBAAvBA,qBAAA,CAAyBxF,CAAC,KAAI,CAAC;UAC5E,MAAM8F,OAAO,GAAG,EAAAL,gBAAA,GAAAvI,KAAK,CAACgC,QAAQ,cAAAuG,gBAAA,wBAAAC,qBAAA,GAAdD,gBAAA,CAAgBtF,MAAM,cAAAuF,qBAAA,uBAAtBA,qBAAA,CAAwBzF,CAAC,OAAA0F,gBAAA,GAAIzI,KAAK,CAACgC,QAAQ,cAAAyG,gBAAA,wBAAAC,qBAAA,GAAdD,gBAAA,CAAgB5F,OAAO,cAAA6F,qBAAA,uBAAvBA,qBAAA,CAAyB3F,CAAC,KAAI,CAAC;UAC5E2D,GAAG,IAAI,UAAU1G,KAAK,CAACR,EAAE,YAAYmJ,OAAO,YAAYC,OAAO,OAAO;QAC1E,CAAC,CAAC;MACN;IACJ;EACJ,CAAC,CAAC;EAEFlC,GAAG,IAAI,KAAK;;EAEZ;EACAA,GAAG,IAAI,kDAAkD;EACzDA,GAAG,IAAI,+BAA+B;EACtCA,GAAG,IAAI,0DAA0D;EACjEA,GAAG,IAAI,2EAA2E;EAClFA,GAAG,IAAI,qFAAqF;EAC5FA,GAAG,IAAI,gFAAgF;EACvFA,GAAG,IAAI,qDAAqD;EAC5DA,GAAG,IAAI,KAAK;EAEZ,OAAOA,GAAG;AACd,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA,OAAO,MAAMmC,gBAAgB,GAAI3J,QAAQ,IAAK;EAAA,IAAA4J,cAAA,EAAAC,eAAA,EAAAC,gBAAA,EAAAC,mBAAA;EAC1C;EACA,MAAMnK,MAAM,GAAGI,QAAQ,CAACgB,QAAQ,CAACkC,MAAM,CAAC8G,EAAE,IAAIA,EAAE,CAACvJ,IAAI,KAAK,OAAO,CAAC;EAClE,MAAMwJ,QAAQ,GAAGjK,QAAQ,CAACgB,QAAQ,CAACkC,MAAM,CAAC8G,EAAE,IAAIA,EAAE,CAACvJ,IAAI,KAAK,SAAS,CAAC;EACtE,MAAMd,MAAM,GAAGI,aAAa,CAACC,QAAQ,CAAC;;EAEtC;EACA,MAAMkK,YAAY,GAAGD,QAAQ,CAAC/I,GAAG,CAAC0F,OAAO,IAAI1C,iBAAiB,CAAC0C,OAAO,CAAC,CAAC,CAACpF,IAAI,CAAC,IAAI,CAAC;EACnF,MAAM2I,UAAU,GAAGlJ,gBAAgB,CAACrB,MAAM,CAAC;EAC3C,MAAMwK,aAAa,GAAG1K,oBAAoB,CAACC,MAAM,EAAEC,MAAM,CAAC;;EAE1D;EACA,MAAMyK,UAAU,GAAG9C,WAAW,CAACvH,QAAQ,CAAC;;EAExC;EACA,OAAO;AACX;AACA;AACA;AACA;AACA,wCAAwC,EAAA4J,cAAA,GAAA5J,QAAQ,CAACsK,IAAI,cAAAV,cAAA,uBAAbA,cAAA,CAAeW,WAAW,KAAI,sCAAsC;AAC5G,aAAa,EAAAV,eAAA,GAAA7J,QAAQ,CAACsK,IAAI,cAAAT,eAAA,uBAAbA,eAAA,CAAehI,KAAK,KAAI,cAAc;AACnD;AACA;AACA;AACA;AACA;AACA;AACA,UAAUwI,UAAU;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,EAAAP,gBAAA,GAAA9J,QAAQ,CAACwK,MAAM,cAAAV,gBAAA,uBAAfA,gBAAA,CAAiBnI,UAAU,KAAI,SAAS;AAC9D;AACA,UAAUuI,YAAY;AACtB;AACA;AACA;AACA,MAAMC,UAAU;AAChB;AACA;AACA;AACA,UAAUC,aAAa;AACvB;AACA;AACA;AACA;AACA,EAAEvK,IAAI,CAACC,SAAS,CAACE,QAAQ,EAAE,IAAI,EAAE,CAAC,CAAC;AACnC;AACA;AACA;AACA,MAAM,CAAA+J,mBAAA,GAAA/J,QAAQ,CAACyK,SAAS,cAAAV,mBAAA,eAAlBA,mBAAA,CAAoBW,iBAAiB,GAAG;AAC9C,qEAAqE1K,QAAQ,CAACyK,SAAS,CAACC,iBAAiB;AACzG;AACA;AACA;AACA;AACA,0BAA0B1K,QAAQ,CAACyK,SAAS,CAACC,iBAAiB;AAC9D;AACA,KAAK,GAAG,EAAE;AACV;AACA,QAAQ;AACR,CAAC;AACD,MAAMC,eAAe,GAAGA,CAAC3J,QAAQ,EAAEV,EAAE,KAAK;EACtC,KAAK,MAAMJ,OAAO,IAAIc,QAAQ,EAAE;IAC5B,IAAId,OAAO,CAACI,EAAE,KAAKA,EAAE,EAAE,OAAOJ,OAAO;IAErC,IAAIA,OAAO,CAACU,QAAQ,IAAIV,OAAO,CAACU,QAAQ,CAACsF,MAAM,GAAG,CAAC,EAAE;MACjD,MAAM0E,KAAK,GAAGD,eAAe,CAACzK,OAAO,CAACU,QAAQ,EAAEN,EAAE,CAAC;MACnD,IAAIsK,KAAK,EAAE,OAAOA,KAAK;IAC3B;EACJ;EACA,OAAO,IAAI;AACf,CAAC;AACD;AACA;AACA;AACA;AACA;AACA,OAAO,MAAMC,mBAAmB,GAAIC,UAAU,IAAK;EAC/C,MAAM9K,QAAQ,GAAG;IACbwK,MAAM,EAAE;MACJ/I,KAAK,EAAE,IAAI;MACXC,MAAM,EAAE,MAAM;MACdC,UAAU,EAAE;IAChB,CAAC;IACDX,QAAQ,EAAE,EAAE;IACZsJ,IAAI,EAAE;MACFzI,KAAK,EAAE,UAAU;MACjB0I,WAAW,EAAE,EAAE;MACfQ,QAAQ,EAAE,EAAE;MACZC,UAAU,EAAE,IAAIC,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC;MACpCC,UAAU,EAAE,IAAIF,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC;IACvC,CAAC;IACDT,SAAS,EAAE,CAAC;EAChB,CAAC;EAED,IAAI;IACA,MAAMW,MAAM,GAAG,IAAIC,SAAS,CAAC,CAAC;IAC9B,MAAMC,GAAG,GAAGF,MAAM,CAACG,eAAe,CAACT,UAAU,EAAE,WAAW,CAAC;;IAE3D;IACA,MAAMU,OAAO,GAAGF,GAAG,CAACG,aAAa,CAAC,OAAO,CAAC;IAC1C,IAAID,OAAO,EAAE;MACTxL,QAAQ,CAACsK,IAAI,CAACzI,KAAK,GAAG2J,OAAO,CAACE,WAAW,CAACC,IAAI,CAAC,CAAC,IAAI,UAAU;IAClE;IAEA,MAAMC,MAAM,GAAGN,GAAG,CAACG,aAAa,CAAC,0BAA0B,CAAC;IAC5D,IAAIG,MAAM,EAAE;MACR5L,QAAQ,CAACsK,IAAI,CAACC,WAAW,GAAGqB,MAAM,CAACC,YAAY,CAAC,SAAS,CAAC,IAAI,EAAE;IACpE;IAEA,MAAMC,UAAU,GAAGR,GAAG,CAACG,aAAa,CAAC,uBAAuB,CAAC;IAC7D,IAAIK,UAAU,EAAE;MAAA,IAAAC,qBAAA;MACZ/L,QAAQ,CAACsK,IAAI,CAACS,QAAQ,GAAG,EAAAgB,qBAAA,GAAAD,UAAU,CAACD,YAAY,CAAC,SAAS,CAAC,cAAAE,qBAAA,uBAAlCA,qBAAA,CAAoCC,KAAK,CAAC,GAAG,CAAC,CAAC9K,GAAG,CAAC+K,CAAC,IAAIA,CAAC,CAACN,IAAI,CAAC,CAAC,CAAC,KAAI,EAAE;IACpG;IAEA,MAAMO,eAAe,GAAGZ,GAAG,CAACG,aAAa,CAAC,iCAAiC,CAAC;IAC5E,IAAIS,eAAe,EAAE;MACjB,MAAMC,IAAI,GAAGD,eAAe,CAAC5H,GAAG,CAAC8H,KAAK,CAAC,qBAAqB,CAAC;MAC7D,IAAID,IAAI,EAAE;QACNnM,QAAQ,CAACyK,SAAS,CAACC,iBAAiB,GAAGyB,IAAI,CAAC,CAAC,CAAC;MAClD;IACJ;;IAEA;IACA,MAAME,cAAc,GAAGf,GAAG,CAACG,aAAa,CAAC,qDAAqD,CAAC;IAC/F,IAAIY,cAAc,EAAE;MAChB,IAAI;QACA,MAAMC,YAAY,GAAGzM,IAAI,CAAC0M,KAAK,CAACF,cAAc,CAACX,WAAW,IAAIW,cAAc,CAACG,SAAS,CAAC;QACvFC,OAAO,CAACC,GAAG,CAAC,0DAA0D,CAAC;;QAEvE;QACA,IAAIJ,YAAY,CAAC9B,MAAM,IAAI9J,KAAK,CAACC,OAAO,CAAC2L,YAAY,CAACtL,QAAQ,CAAC,IAAIsL,YAAY,CAAChC,IAAI,EAAE;UAClFtK,QAAQ,CAACwK,MAAM,GAAG;YACd/I,KAAK,EAAE6K,YAAY,CAAC9B,MAAM,CAAC/I,KAAK,IAAI,IAAI;YACxCC,MAAM,EAAE4K,YAAY,CAAC9B,MAAM,CAAC9I,MAAM,IAAI,MAAM;YAC5CC,UAAU,EAAE2K,YAAY,CAAC9B,MAAM,CAAC7I,UAAU,IAAI;UAClD,CAAC;UACD3B,QAAQ,CAACgB,QAAQ,GAAG2L,iBAAiB,CAACL,YAAY,CAACtL,QAAQ,CAAC;UAC5DhB,QAAQ,CAACsK,IAAI,GAAG;YACZzI,KAAK,EAAEyK,YAAY,CAAChC,IAAI,CAACzI,KAAK,IAAI7B,QAAQ,CAACsK,IAAI,CAACzI,KAAK;YACrD0I,WAAW,EAAE+B,YAAY,CAAChC,IAAI,CAACC,WAAW,IAAIvK,QAAQ,CAACsK,IAAI,CAACC,WAAW;YACvEQ,QAAQ,EAAEuB,YAAY,CAAChC,IAAI,CAACS,QAAQ,IAAI/K,QAAQ,CAACsK,IAAI,CAACS,QAAQ;YAC9DC,UAAU,EAAEsB,YAAY,CAAChC,IAAI,CAACU,UAAU,IAAIhL,QAAQ,CAACsK,IAAI,CAACU,UAAU;YACpEG,UAAU,EAAEmB,YAAY,CAAChC,IAAI,CAACa,UAAU,IAAInL,QAAQ,CAACsK,IAAI,CAACa;UAC9D,CAAC;UACDnL,QAAQ,CAACyK,SAAS,GAAG6B,YAAY,CAAC7B,SAAS,IAAIzK,QAAQ,CAACyK,SAAS;UACjE,OAAOzK,QAAQ,CAAC,CAAC;QACrB,CAAC,MAAM;UACHyM,OAAO,CAACG,IAAI,CAAC,wDAAwD,CAAC;QAC1E;MACJ,CAAC,CAAC,OAAOC,UAAU,EAAE;QACjBJ,OAAO,CAACG,IAAI,CAAC,4CAA4C,EAAEC,UAAU,CAACC,OAAO,CAAC;MAClF;IACJ;;IAEA;IACAL,OAAO,CAACC,GAAG,CAAC,8BAA8B,CAAC;;IAE3C;IACA,MAAMK,QAAQ,GAAGzB,GAAG,CAAC0B,cAAc,CAAC,YAAY,CAAC;IACjD,IAAID,QAAQ,EAAE;MACV,MAAME,WAAW,GAAGF,QAAQ,CAACG,KAAK;MAClClN,QAAQ,CAACwK,MAAM,GAAG;QACd/I,KAAK,EAAE0L,QAAQ,CAACF,WAAW,CAACxL,KAAK,CAAC,IAAI,IAAI;QAC1CC,MAAM,EAAEuL,WAAW,CAACvL,MAAM,IAAI,MAAM;QACpCC,UAAU,EAAEsL,WAAW,CAACtL,UAAU,IAAIsL,WAAW,CAAC9F,eAAe,IAAI,SAAS;QAC9EiG,SAAS,EAAEH,WAAW,CAACG,SAAS,IAAI;MACxC,CAAC;IACL;;IAEA;IACA,MAAMnD,QAAQ,GAAGqB,GAAG,CAAC+B,gBAAgB,CAAC,qEAAqE,CAAC;IAC5GpD,QAAQ,CAACpJ,OAAO,CAAC,CAACyM,SAAS,EAAE7G,KAAK,KAAK;MACnC,MAAMG,OAAO,GAAG2G,mBAAmB,CAACD,SAAS,EAAE7G,KAAK,CAAC;MACrD,IAAIG,OAAO,EAAE;QACT5G,QAAQ,CAACgB,QAAQ,CAACR,IAAI,CAACoG,OAAO,CAAC;MACnC;IACJ,CAAC,CAAC;;IAEF;IACA,MAAMhH,MAAM,GAAG0L,GAAG,CAAC+B,gBAAgB,CAAC,uCAAuC,CAAC;IAC5EzN,MAAM,CAACiB,OAAO,CAAC,CAAC2M,OAAO,EAAE/G,KAAK,KAAK;MAC/B,MAAMtF,KAAK,GAAGsM,iBAAiB,CAACD,OAAO,EAAE/G,KAAK,CAAC;MAC/C,IAAItF,KAAK,EAAE;QACPnB,QAAQ,CAACgB,QAAQ,CAACR,IAAI,CAACW,KAAK,CAAC;MACjC;IACJ,CAAC,CAAC;;IAEF;IACA,MAAMuM,kBAAkB,GAAGpC,GAAG,CAAC+B,gBAAgB,CAAC,2HAA2H,CAAC;IAC5KK,kBAAkB,CAAC7M,OAAO,CAAC,CAACmJ,EAAE,EAAEvD,KAAK,KAAK;MACtC,IAAI,CAACuD,EAAE,CAAC2D,OAAO,CAAC,oCAAoC,CAAC,EAAE;QACnD,MAAMzN,OAAO,GAAG0N,sBAAsB,CAAC5D,EAAE,EAAEvD,KAAK,CAAC;QACjD,IAAIvG,OAAO,EAAE;UACTF,QAAQ,CAACgB,QAAQ,CAACR,IAAI,CAACN,OAAO,CAAC;QACnC;MACJ;IACJ,CAAC,CAAC;;IAEF;IACA,MAAM2N,cAAc,GAAGvC,GAAG,CAAC+B,gBAAgB,CAAC,QAAQ,CAAC;IACrDQ,cAAc,CAAChN,OAAO,CAACiN,MAAM,IAAI;MAC7B,MAAM/L,OAAO,GAAG+L,MAAM,CAACpC,WAAW,IAAIoC,MAAM,CAACtB,SAAS;MACtD,MAAMuB,YAAY,GAAGC,uBAAuB,CAACjM,OAAO,CAAC;MACrD,IAAIgM,YAAY,CAAC7H,MAAM,GAAG,CAAC,EAAE;QACzB+H,mBAAmB,CAACjO,QAAQ,CAACgB,QAAQ,EAAE+M,YAAY,CAAC;MACxD;IACJ,CAAC,CAAC;;IAEF;IACA,MAAMG,aAAa,GAAG5C,GAAG,CAAC+B,gBAAgB,CAAC,OAAO,CAAC;IACnDa,aAAa,CAACrN,OAAO,CAACsN,OAAO,IAAI;MAC7B,MAAM9D,UAAU,GAAG8D,OAAO,CAACzC,WAAW,IAAIyC,OAAO,CAAC3B,SAAS;MAC3D,MAAM4B,UAAU,GAAGC,wBAAwB,CAAChE,UAAU,CAAC;MACvDiE,uBAAuB,CAACtO,QAAQ,CAACgB,QAAQ,EAAEoN,UAAU,CAAC;IAC1D,CAAC,CAAC;;IAEF;IACA,MAAMG,SAAS,GAAGC,IAAI,CAACC,GAAG,CACtB,GAAGzO,QAAQ,CAACgB,QAAQ,CAACE,GAAG,CAAC8I,EAAE,IAAI;MAAA,IAAA0E,YAAA,EAAAC,oBAAA,EAAAC,QAAA;MAC3B,MAAMC,KAAK,GAAG,EAAAH,YAAA,GAAA1E,EAAE,CAAClH,QAAQ,cAAA4L,YAAA,wBAAAC,oBAAA,GAAXD,YAAA,CAAa/K,OAAO,cAAAgL,oBAAA,uBAApBA,oBAAA,CAAsB9K,CAAC,KAAI,CAAC;MAC1C,MAAMiL,QAAQ,GAAG,EAAAF,QAAA,GAAA5E,EAAE,CAAC3I,IAAI,cAAAuN,QAAA,uBAAPA,QAAA,CAASlN,MAAM,KAAI,GAAG;MACvC,OAAOmN,KAAK,GAAGC,QAAQ;IAC3B,CAAC,CAAC,EACF,IACJ,CAAC;IACD9O,QAAQ,CAACwK,MAAM,CAAC9I,MAAM,GAAG6M,SAAS;IAElC9B,OAAO,CAACC,GAAG,CAAC,6BAA6B,EAAE;MACvCqC,aAAa,EAAE/O,QAAQ,CAACgB,QAAQ,CAACkF,MAAM;MACvC+D,QAAQ,EAAEjK,QAAQ,CAACgB,QAAQ,CAACkC,MAAM,CAAC8G,EAAE,IAAIA,EAAE,CAACvJ,IAAI,KAAK,SAAS,CAAC,CAACyF,MAAM;MACtEtG,MAAM,EAAEI,QAAQ,CAACgB,QAAQ,CAACkC,MAAM,CAAC8G,EAAE,IAAIA,EAAE,CAACvJ,IAAI,KAAK,OAAO,CAAC,CAACyF,MAAM;MAClE8I,UAAU,EAAEhP,QAAQ,CAACgB,QAAQ,CAACkC,MAAM,CAAC8G,EAAE,IAAIA,EAAE,CAACvJ,IAAI,KAAK,SAAS,IAAIuJ,EAAE,CAACvJ,IAAI,KAAK,OAAO,CAAC,CAACyF;IAC7F,CAAC,CAAC;IAEF,OAAOlG,QAAQ;EAEnB,CAAC,CAAC,OAAOiP,KAAK,EAAE;IACZxC,OAAO,CAACwC,KAAK,CAAC,8BAA8B,EAAEA,KAAK,CAAC;IACpD,OAAOjP,QAAQ,CAAC,CAAC;EACrB;AACJ,CAAC;;AAED;;AAEA;AACA;AACA;AACA;AACA;AACA,MAAM2M,iBAAiB,GAAI3L,QAAQ,IAAK;EACpC,OAAOA,QAAQ,CAACE,GAAG,CAAC8I,EAAE;IAAA,IAAAkF,aAAA,EAAAC,aAAA,EAAAC,aAAA,EAAAC,aAAA,EAAAC,aAAA;IAAA,OAAK;MACvBhP,EAAE,EAAE0J,EAAE,CAAC1J,EAAE,IAAI,WAAW2K,IAAI,CAACsE,GAAG,CAAC,CAAC,IAAIf,IAAI,CAACgB,MAAM,CAAC,CAAC,CAACC,QAAQ,CAAC,EAAE,CAAC,CAACC,KAAK,CAAC,CAAC,CAAC,EAAE;MAC3EjP,IAAI,EAAEuJ,EAAE,CAACvJ,IAAI,IAAI,SAAS;MAC1BF,aAAa,EAAEyJ,EAAE,CAACzJ,aAAa,IAAI,CAAC,CAAC;MACrCuC,QAAQ,EAAE;QACNa,OAAO,EAAE,EAAAuL,aAAA,GAAAlF,EAAE,CAAClH,QAAQ,cAAAoM,aAAA,uBAAXA,aAAA,CAAavL,OAAO,KAAI;UAAEC,CAAC,EAAE,CAAC;UAAEC,CAAC,EAAE,CAAC;UAAE8L,CAAC,EAAE;QAAE,CAAC;QACrD7L,MAAM,EAAE,EAAAqL,aAAA,GAAAnF,EAAE,CAAClH,QAAQ,cAAAqM,aAAA,uBAAXA,aAAA,CAAarL,MAAM,OAAAsL,aAAA,GAAIpF,EAAE,CAAClH,QAAQ,cAAAsM,aAAA,uBAAXA,aAAA,CAAazL,OAAO,KAAI;UAAEC,CAAC,EAAE,CAAC;UAAEC,CAAC,EAAE,CAAC;UAAE8L,CAAC,EAAE;QAAE,CAAC;QAC3E5L,MAAM,EAAE,EAAAsL,aAAA,GAAArF,EAAE,CAAClH,QAAQ,cAAAuM,aAAA,uBAAXA,aAAA,CAAatL,MAAM,OAAAuL,aAAA,GAAItF,EAAE,CAAClH,QAAQ,cAAAwM,aAAA,uBAAXA,aAAA,CAAa3L,OAAO,KAAI;UAAEC,CAAC,EAAE,CAAC;UAAEC,CAAC,EAAE,CAAC;UAAE8L,CAAC,EAAE;QAAE;MAC9E,CAAC;MACDtO,IAAI,EAAE2I,EAAE,CAAC3I,IAAI,IAAI;QAAEI,KAAK,EAAEuI,EAAE,CAACvJ,IAAI,KAAK,OAAO,GAAG,GAAG,GAAG,IAAI;QAAEiB,MAAM,EAAE;MAAI,CAAC;MACzEN,MAAM,EAAE4I,EAAE,CAAC5I,MAAM,IAAI,CAAC,CAAC;MACvBR,QAAQ,EAAEF,KAAK,CAACC,OAAO,CAACqJ,EAAE,CAACpJ,QAAQ,CAAC,GAAG+L,iBAAiB,CAAC3C,EAAE,CAACpJ,QAAQ,CAAC,GAAG,EAAE;MAC1EgP,OAAO,EAAE5F,EAAE,CAAC4F,OAAO,KAAK,KAAK;MAC7BC,MAAM,EAAE,CAAC,CAAC7F,EAAE,CAAC6F;IACjB,CAAC;EAAA,CAAC,CAAC;AACP,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA,MAAMtC,mBAAmB,GAAGA,CAACD,SAAS,EAAE7G,KAAK,KAAK;EAAA,IAAAqJ,UAAA,EAAAC,YAAA,EAAAC,aAAA;EAC9C,MAAM1P,EAAE,GAAGgN,SAAS,CAAChN,EAAE,IAAIgN,SAAS,CAACzB,YAAY,CAAC,iBAAiB,CAAC,IAAI,WAAWZ,IAAI,CAACsE,GAAG,CAAC,CAAC,IAAI9I,KAAK,EAAE;EACxG,MAAMyG,KAAK,GAAGI,SAAS,CAACJ,KAAK;EAE7B,MAAM+C,QAAQ,GAAG,EAAAH,UAAA,GAAA5C,KAAK,CAACgD,GAAG,cAAAJ,UAAA,uBAATA,UAAA,CAAW1D,KAAK,CAAC,SAAS,CAAC,KAAI,CAAC,GAAG,CAAC;EACrD,MAAM8D,GAAG,GAAG/C,QAAQ,CAAC8C,QAAQ,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC;EACtC,MAAME,UAAU,GAAG,EAAAJ,YAAA,GAAA7C,KAAK,CAACzL,KAAK,cAAAsO,YAAA,uBAAXA,YAAA,CAAa3D,KAAK,CAAC,SAAS,CAAC,KAAI,CAAC,MAAM,CAAC;EAC5D,MAAMgE,WAAW,GAAG,EAAAJ,aAAA,GAAA9C,KAAK,CAACxL,MAAM,cAAAsO,aAAA,uBAAZA,aAAA,CAAc5D,KAAK,CAAC,SAAS,CAAC,KAAI,CAAC,KAAK,CAAC;EAC7D,MAAM3K,KAAK,GAAG0L,QAAQ,CAACgD,UAAU,CAAC,CAAC,CAAC,CAAC,IAAI,IAAI;EAC7C,MAAMzO,MAAM,GAAGyL,QAAQ,CAACiD,WAAW,CAAC,CAAC,CAAC,CAAC,IAAI,GAAG;EAE9C,MAAMC,IAAI,GAAG/C,SAAS,CAAC7B,aAAa,CAAC,0BAA0B,CAAC;EAChE,MAAM6E,SAAS,GAAGhD,SAAS,CAAC7B,aAAa,CAAC,eAAe,CAAC;EAC1D,MAAM8E,WAAW,GAAGjD,SAAS,CAAC7B,aAAa,CAAC,iBAAiB,CAAC;EAE9D,MAAMlL,aAAa,GAAG;IAAEiQ,SAAS,EAAElD,SAAS,CAACmD,SAAS,CAACC,QAAQ,CAAC,cAAc,CAAC,GAAG,eAAe,GAAG;EAAW,CAAC;EAEhH,IAAIL,IAAI,EAAE;IAAA,IAAAM,qBAAA;IACN,MAAMC,OAAO,GAAGP,IAAI,CAACnD,KAAK;IAC1B3M,aAAa,CAAC4G,eAAe,GAAGyJ,OAAO,CAACzJ,eAAe,IAAI,aAAa;IACxE,MAAM0J,YAAY,IAAAF,qBAAA,GAAGC,OAAO,CAACxJ,eAAe,cAAAuJ,qBAAA,uBAAvBA,qBAAA,CAAyBvE,KAAK,CAAC,wBAAwB,CAAC;IAC7E,IAAIyE,YAAY,EAAE;MACdtQ,aAAa,CAAC6G,eAAe,GAAGyJ,YAAY,CAAC,CAAC,CAAC;MAC/CtQ,aAAa,CAACuQ,cAAc,GAAG,OAAO;IAC1C,CAAC,MAAM,IAAIvQ,aAAa,CAAC4G,eAAe,KAAK,aAAa,EAAE;MACxD5G,aAAa,CAACuQ,cAAc,GAAG,OAAO;IAC1C;IACAvQ,aAAa,CAACwQ,kBAAkB,GAAGH,OAAO,CAACG,kBAAkB,IAAI,QAAQ;IACzExQ,aAAa,CAACyQ,cAAc,GAAGJ,OAAO,CAACI,cAAc,IAAI,OAAO;EACpE;EAEA,IAAIV,SAAS,EAAE;IACX/P,aAAa,CAAC8G,YAAY,GAAGiJ,SAAS,CAACpD,KAAK,CAAC/F,eAAe,IAAI,aAAa;IAC7E5G,aAAa,CAAC+G,cAAc,GAAG2J,UAAU,CAACX,SAAS,CAACpD,KAAK,CAACgE,OAAO,CAAC,IAAI,CAAC;EAC3E;EAEA,MAAM9P,MAAM,GAAG+P,iBAAiB,CAACjE,KAAK,EAAEI,SAAS,CAAC;EAClD,IAAIiD,WAAW,EAAE;IACbhQ,aAAa,CAACuB,OAAO,GAAGyO,WAAW,CAACrD,KAAK,CAACpL,OAAO,IAAI,MAAM;EAC/D;EAEA,MAAMlB,QAAQ,GAAG,EAAE;EACnB,IAAI2P,WAAW,EAAE;IACb,MAAMa,aAAa,GAAGb,WAAW,CAAClD,gBAAgB,CAAC,mDAAmD,CAAC;IACvG+D,aAAa,CAACvQ,OAAO,CAACwQ,OAAO,IAAI;MAC7B,IAAIA,OAAO,CAAC1D,OAAO,CAAC,iBAAiB,CAAC,KAAK4C,WAAW,EAAE;QACpD,MAAMzP,KAAK,GAAGwQ,iBAAiB,CAACD,OAAO,EAAE/Q,EAAE,CAAC;QAC5C,IAAIQ,KAAK,EAAE;UACPF,QAAQ,CAACJ,IAAI,CAACM,KAAK,CAAC;QACxB;MACJ;IACJ,CAAC,CAAC;EACN;EAEA,OAAO;IACHR,EAAE;IACFG,IAAI,EAAE,SAAS;IACfF,aAAa;IACbuC,QAAQ,EAAE;MACNa,OAAO,EAAE;QAAEC,CAAC,EAAE,CAAC;QAAEC,CAAC,EAAEqM,GAAG;QAAEP,CAAC,EAAExC,QAAQ,CAACD,KAAK,CAACqE,MAAM,CAAC,IAAI9K,KAAK,GAAG;MAAE,CAAC;MACjE3C,MAAM,EAAE;QAAEF,CAAC,EAAE,CAAC;QAAEC,CAAC,EAAEqM,GAAG;QAAEP,CAAC,EAAExC,QAAQ,CAACD,KAAK,CAACqE,MAAM,CAAC,IAAI9K,KAAK,GAAG;MAAE,CAAC;MAChE1C,MAAM,EAAE;QAAEH,CAAC,EAAE,CAAC;QAAEC,CAAC,EAAEqM,GAAG;QAAEP,CAAC,EAAExC,QAAQ,CAACD,KAAK,CAACqE,MAAM,CAAC,IAAI9K,KAAK,GAAG;MAAE;IACnE,CAAC;IACDpF,IAAI,EAAE;MAAEI,KAAK;MAAEC;IAAO,CAAC;IACvBN,MAAM;IACNR,QAAQ;IACRgP,OAAO,EAAE1C,KAAK,CAAC5G,OAAO,KAAK,MAAM;IACjCuJ,MAAM,EAAEvC,SAAS,CAACmD,SAAS,CAACC,QAAQ,CAAC,oBAAoB;EAC7D,CAAC;AACL,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA,MAAMjD,iBAAiB,GAAGA,CAACD,OAAO,EAAE/G,KAAK,KAAK;EAAA,IAAA+K,qBAAA,EAAAC,qBAAA;EAC1C,MAAMnR,EAAE,GAAGkN,OAAO,CAAClN,EAAE,IAAIkN,OAAO,CAAC3B,YAAY,CAAC,iBAAiB,CAAC,IAAI,SAASZ,IAAI,CAACsE,GAAG,CAAC,CAAC,IAAI9I,KAAK,EAAE;EAClG,MAAM8J,WAAW,GAAG/C,OAAO,CAAC/B,aAAa,CAAC,sBAAsB,CAAC;EACjE,IAAI,CAAC8E,WAAW,EAAE,OAAO,IAAI;EAE7B,MAAMJ,UAAU,GAAG,EAAAqB,qBAAA,GAAAjB,WAAW,CAACrD,KAAK,CAACzL,KAAK,cAAA+P,qBAAA,uBAAvBA,qBAAA,CAAyBpF,KAAK,CAAC,SAAS,CAAC,KAAI,CAAC,KAAK,CAAC;EACvE,MAAMsF,cAAc,GAAG,EAAAD,qBAAA,GAAAlB,WAAW,CAACrD,KAAK,CAACE,SAAS,cAAAqE,qBAAA,uBAA3BA,qBAAA,CAA6BrF,KAAK,CAAC,SAAS,CAAC,KAAI,CAAC,KAAK,CAAC;EAC/E,MAAM3K,KAAK,GAAG0L,QAAQ,CAACgD,UAAU,CAAC,CAAC,CAAC,CAAC,IAAI,GAAG;EAC5C,MAAMzO,MAAM,GAAGyL,QAAQ,CAACuE,cAAc,CAAC,CAAC,CAAC,CAAC,IAAI,GAAG;EAEjD,MAAMC,QAAQ,GAAGnE,OAAO,CAAC/B,aAAa,CAAC,sBAAsB,CAAC;EAC9D,MAAMmG,MAAM,GAAGpE,OAAO,CAAC/B,aAAa,CAAC,iBAAiB,CAAC;EAEvD,MAAMlL,aAAa,GAAG;IAClBsB,KAAK,EAAE,CAAA8P,QAAQ,aAARA,QAAQ,uBAARA,QAAQ,CAAEjG,WAAW,CAACC,IAAI,CAAC,CAAC,KAAI,OAAO;IAC9ChK,UAAU,EAAE4O,WAAW,CAACrD,KAAK,CAACvL,UAAU,IAAI,2BAA2B;IACvEC,YAAY,EAAE2O,WAAW,CAACrD,KAAK,CAACtL,YAAY,IAAI,MAAM;IACtDE,OAAO,EAAE,CAAA8P,MAAM,aAANA,MAAM,uBAANA,MAAM,CAAE1E,KAAK,CAACpL,OAAO,KAAI;EACtC,CAAC;EAED,MAAMV,MAAM,GAAG+P,iBAAiB,CAACZ,WAAW,CAACrD,KAAK,EAAEM,OAAO,CAAC;EAE5D,MAAM5M,QAAQ,GAAG,EAAE;EACnB,IAAIgR,MAAM,EAAE;IACR,MAAMR,aAAa,GAAGQ,MAAM,CAACvE,gBAAgB,CAAC,mDAAmD,CAAC;IAClG+D,aAAa,CAACvQ,OAAO,CAACwQ,OAAO,IAAI;MAC7B,IAAIA,OAAO,CAAC1D,OAAO,CAAC,iBAAiB,CAAC,KAAKiE,MAAM,EAAE;QAC/C,MAAM9Q,KAAK,GAAGwQ,iBAAiB,CAACD,OAAO,EAAE/Q,EAAE,CAAC;QAC5C,IAAIQ,KAAK,EAAE;UACPF,QAAQ,CAACJ,IAAI,CAACM,KAAK,CAAC;QACxB;MACJ;IACJ,CAAC,CAAC;EACN;EAEA,OAAO;IACHR,EAAE;IACFG,IAAI,EAAE,OAAO;IACbF,aAAa;IACbuC,QAAQ,EAAE;MACNa,OAAO,EAAE;QAAEC,CAAC,EAAE,CAAC;QAAEC,CAAC,EAAE,CAAC;QAAE8L,CAAC,EAAExC,QAAQ,CAACoD,WAAW,CAACrD,KAAK,CAACqE,MAAM,CAAC,IAAI;MAAK,CAAC;MACtEzN,MAAM,EAAE;QAAEF,CAAC,EAAE,CAAC;QAAEC,CAAC,EAAE,CAAC;QAAE8L,CAAC,EAAExC,QAAQ,CAACoD,WAAW,CAACrD,KAAK,CAACqE,MAAM,CAAC,IAAI;MAAK,CAAC;MACrExN,MAAM,EAAE;QAAEH,CAAC,EAAE,CAAC;QAAEC,CAAC,EAAE,CAAC;QAAE8L,CAAC,EAAExC,QAAQ,CAACoD,WAAW,CAACrD,KAAK,CAACqE,MAAM,CAAC,IAAI;MAAK;IACxE,CAAC;IACDlQ,IAAI,EAAE;MAAEI,KAAK;MAAEC;IAAO,CAAC;IACvBN,MAAM;IACNR,QAAQ;IACRgP,OAAO,EAAEpC,OAAO,CAACiD,SAAS,CAACC,QAAQ,CAAC,kBAAkB,CAAC,IAAIlD,OAAO,CAACN,KAAK,CAAC5G,OAAO,KAAK,MAAM;IAC3FuJ,MAAM,EAAErC,OAAO,CAACiD,SAAS,CAACC,QAAQ,CAAC,oBAAoB;EAC3D,CAAC;AACL,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA,MAAM9C,sBAAsB,GAAGA,CAAC1N,OAAO,EAAEuG,KAAK,KAAK;EAAA,IAAAoL,WAAA,EAAAC,WAAA,EAAAC,aAAA,EAAAC,cAAA;EAC/C,MAAM1R,EAAE,GAAGJ,OAAO,CAACI,EAAE,IAAIJ,OAAO,CAAC2L,YAAY,CAAC,iBAAiB,CAAC,IAAI,WAAWZ,IAAI,CAACsE,GAAG,CAAC,CAAC,IAAI9I,KAAK,EAAE;EACpG,MAAMhG,IAAI,GAAGP,OAAO,CAAC2L,YAAY,CAAC,WAAW,CAAC,IAAIoG,oBAAoB,CAAC/R,OAAO,CAAC;EAC/E,MAAMgN,KAAK,GAAGhN,OAAO,CAACgN,KAAK;EAE3B,MAAMgF,SAAS,GAAG,EAAAL,WAAA,GAAA3E,KAAK,CAACiF,IAAI,cAAAN,WAAA,uBAAVA,WAAA,CAAYzF,KAAK,CAAC,SAAS,CAAC,KAAI,CAAC,GAAG,CAAC;EACvD,MAAM6D,QAAQ,GAAG,EAAA6B,WAAA,GAAA5E,KAAK,CAACgD,GAAG,cAAA4B,WAAA,uBAATA,WAAA,CAAW1F,KAAK,CAAC,SAAS,CAAC,KAAI,CAAC,GAAG,CAAC;EACrD,MAAM+D,UAAU,GAAG,EAAA4B,aAAA,GAAA7E,KAAK,CAACzL,KAAK,cAAAsQ,aAAA,uBAAXA,aAAA,CAAa3F,KAAK,CAAC,SAAS,CAAC,KAAI,CAAC3L,IAAI,KAAK,SAAS,GAAG,KAAK,GAAG,KAAK,CAAC;EACxF,MAAM2P,WAAW,GAAG,EAAA4B,cAAA,GAAA9E,KAAK,CAACxL,MAAM,cAAAsQ,cAAA,uBAAZA,cAAA,CAAc5F,KAAK,CAAC,SAAS,CAAC,KAAI,CAAC3L,IAAI,KAAK,SAAS,GAAG,KAAK,GAAG,IAAI,CAAC;EACzF,MAAM0R,IAAI,GAAGhF,QAAQ,CAAC+E,SAAS,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC;EACxC,MAAMhC,GAAG,GAAG/C,QAAQ,CAAC8C,QAAQ,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC;EACtC,MAAMxO,KAAK,GAAG0L,QAAQ,CAACgD,UAAU,CAAC,CAAC,CAAC,CAAC,KAAK1P,IAAI,KAAK,SAAS,GAAG,GAAG,GAAGA,IAAI,KAAK,MAAM,GAAG,EAAE,GAAG,GAAG,CAAC;EAChG,MAAMiB,MAAM,GAAGyL,QAAQ,CAACiD,WAAW,CAAC,CAAC,CAAC,CAAC,KAAK3P,IAAI,KAAK,SAAS,GAAG,GAAG,GAAGA,IAAI,KAAK,MAAM,GAAG,EAAE,GAAG,EAAE,CAAC;EAEjG,MAAMW,MAAM,GAAG+P,iBAAiB,CAACjE,KAAK,EAAEhN,OAAO,CAAC;EAChD,MAAMK,aAAa,GAAG6R,kBAAkB,CAAClS,OAAO,EAAEO,IAAI,CAAC;EAEvD,OAAO;IACHH,EAAE;IACFG,IAAI;IACJF,aAAa;IACbuC,QAAQ,EAAE;MACNa,OAAO,EAAE;QAAEC,CAAC,EAAEuO,IAAI;QAAEtO,CAAC,EAAEqM,GAAG;QAAEP,CAAC,EAAExC,QAAQ,CAACD,KAAK,CAACqE,MAAM,CAAC,IAAI9K,KAAK,GAAG;MAAE,CAAC;MACpE3C,MAAM,EAAE;QAAEF,CAAC,EAAEuO,IAAI;QAAEtO,CAAC,EAAEqM,GAAG;QAAEP,CAAC,EAAExC,QAAQ,CAACD,KAAK,CAACqE,MAAM,CAAC,IAAI9K,KAAK,GAAG;MAAE,CAAC;MACnE1C,MAAM,EAAE;QAAEH,CAAC,EAAEuO,IAAI;QAAEtO,CAAC,EAAEqM,GAAG;QAAEP,CAAC,EAAExC,QAAQ,CAACD,KAAK,CAACqE,MAAM,CAAC,IAAI9K,KAAK,GAAG;MAAE;IACtE,CAAC;IACDpF,IAAI,EAAE;MAAEI,KAAK;MAAEC;IAAO,CAAC;IACvBN,MAAM;IACNR,QAAQ,EAAE,EAAE;IACZgP,OAAO,EAAE1C,KAAK,CAAC5G,OAAO,KAAK,MAAM;IACjCuJ,MAAM,EAAE3P,OAAO,CAACuQ,SAAS,CAACC,QAAQ,CAAC,oBAAoB;EAC3D,CAAC;AACL,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA,MAAMY,iBAAiB,GAAGA,CAACpR,OAAO,EAAEC,QAAQ,KAAK;EAAA,IAAAkS,YAAA,EAAAC,WAAA,EAAAC,aAAA,EAAAC,cAAA;EAC7C,MAAMlS,EAAE,GAAGJ,OAAO,CAACI,EAAE,IAAIJ,OAAO,CAAC2L,YAAY,CAAC,iBAAiB,CAAC,IAAI,SAASZ,IAAI,CAACsE,GAAG,CAAC,CAAC,IAAIf,IAAI,CAACgB,MAAM,CAAC,CAAC,CAACC,QAAQ,CAAC,EAAE,CAAC,CAACC,KAAK,CAAC,CAAC,CAAC,EAAE;EAChI,MAAMjP,IAAI,GAAGP,OAAO,CAAC2L,YAAY,CAAC,WAAW,CAAC,IAAIoG,oBAAoB,CAAC/R,OAAO,CAAC;EAC/E,MAAMgN,KAAK,GAAGhN,OAAO,CAACgN,KAAK;EAE3B,MAAMgF,SAAS,GAAG,EAAAG,YAAA,GAAAnF,KAAK,CAACiF,IAAI,cAAAE,YAAA,uBAAVA,YAAA,CAAYjG,KAAK,CAAC,SAAS,CAAC,KAAI,CAAC,GAAG,CAAC;EACvD,MAAM6D,QAAQ,GAAG,EAAAqC,WAAA,GAAApF,KAAK,CAACgD,GAAG,cAAAoC,WAAA,uBAATA,WAAA,CAAWlG,KAAK,CAAC,SAAS,CAAC,KAAI,CAAC,GAAG,CAAC;EACrD,MAAM+D,UAAU,GAAG,EAAAoC,aAAA,GAAArF,KAAK,CAACzL,KAAK,cAAA8Q,aAAA,uBAAXA,aAAA,CAAanG,KAAK,CAAC,SAAS,CAAC,KAAI,CAAC3L,IAAI,KAAK,SAAS,GAAG,KAAK,GAAG,KAAK,CAAC;EACxF,MAAM2P,WAAW,GAAG,EAAAoC,cAAA,GAAAtF,KAAK,CAACxL,MAAM,cAAA8Q,cAAA,uBAAZA,cAAA,CAAcpG,KAAK,CAAC,SAAS,CAAC,KAAI,CAAC3L,IAAI,KAAK,SAAS,GAAG,KAAK,GAAG,IAAI,CAAC;EACzF,MAAM0R,IAAI,GAAGhF,QAAQ,CAAC+E,SAAS,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC;EACxC,MAAMhC,GAAG,GAAG/C,QAAQ,CAAC8C,QAAQ,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC;EACtC,MAAMxO,KAAK,GAAG0L,QAAQ,CAACgD,UAAU,CAAC,CAAC,CAAC,CAAC,KAAK1P,IAAI,KAAK,SAAS,GAAG,GAAG,GAAGA,IAAI,KAAK,MAAM,GAAG,EAAE,GAAG,GAAG,CAAC;EAChG,MAAMiB,MAAM,GAAGyL,QAAQ,CAACiD,WAAW,CAAC,CAAC,CAAC,CAAC,KAAK3P,IAAI,KAAK,SAAS,GAAG,GAAG,GAAGA,IAAI,KAAK,MAAM,GAAG,EAAE,GAAG,EAAE,CAAC;EAEjG,MAAMW,MAAM,GAAG+P,iBAAiB,CAACjE,KAAK,EAAEhN,OAAO,CAAC;EAChD,MAAMK,aAAa,GAAG6R,kBAAkB,CAAClS,OAAO,EAAEO,IAAI,CAAC;EAEvD,OAAO;IACHH,EAAE;IACFG,IAAI;IACJF,aAAa;IACbuC,QAAQ,EAAE;MACNa,OAAO,EAAE;QAAEC,CAAC,EAAEuO,IAAI;QAAEtO,CAAC,EAAEqM,GAAG;QAAEP,CAAC,EAAExC,QAAQ,CAACD,KAAK,CAACqE,MAAM,CAAC,IAAI;MAAG,CAAC;MAC7DzN,MAAM,EAAE;QAAEF,CAAC,EAAEuO,IAAI;QAAEtO,CAAC,EAAEqM,GAAG;QAAEP,CAAC,EAAExC,QAAQ,CAACD,KAAK,CAACqE,MAAM,CAAC,IAAI;MAAG,CAAC;MAC5DxN,MAAM,EAAE;QAAEH,CAAC,EAAEuO,IAAI;QAAEtO,CAAC,EAAEqM,GAAG;QAAEP,CAAC,EAAExC,QAAQ,CAACD,KAAK,CAACqE,MAAM,CAAC,IAAI;MAAG;IAC/D,CAAC;IACDlQ,IAAI,EAAE;MAAEI,KAAK;MAAEC;IAAO,CAAC;IACvBN,MAAM;IACNR,QAAQ,EAAE,EAAE;IACZgP,OAAO,EAAE1C,KAAK,CAAC5G,OAAO,KAAK,MAAM;IACjCuJ,MAAM,EAAE3P,OAAO,CAACuQ,SAAS,CAACC,QAAQ,CAAC,oBAAoB,CAAC;IACxDvQ;EACJ,CAAC;AACL,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA,MAAMiS,kBAAkB,GAAGA,CAAClS,OAAO,EAAEO,IAAI,KAAK;EAC1C,MAAMF,aAAa,GAAG,CAAC,CAAC;EAExB,QAAQE,IAAI;IACR,KAAK,QAAQ;MACTF,aAAa,CAACwB,OAAO,GAAG7B,OAAO,CAACwL,WAAW,CAACC,IAAI,CAAC,CAAC,IAAI,QAAQ;MAC9DpL,aAAa,CAAC4D,IAAI,GAAG5D,aAAa,CAACwB,OAAO;MAC1CxB,aAAa,CAACoB,UAAU,GAAGzB,OAAO,CAACgN,KAAK,CAACvL,UAAU,IAAIzB,OAAO,CAACgN,KAAK,CAAC/F,eAAe;MACpF5G,aAAa,CAAC4E,KAAK,GAAGjF,OAAO,CAACgN,KAAK,CAAC/H,KAAK;MACzC5E,aAAa,CAACqB,YAAY,GAAG1B,OAAO,CAACgN,KAAK,CAACtL,YAAY;MACvDrB,aAAa,CAACkS,MAAM,GAAGvS,OAAO,CAACgN,KAAK,CAACuF,MAAM;MAC3ClS,aAAa,CAACmS,QAAQ,GAAGxS,OAAO,CAACgN,KAAK,CAACwF,QAAQ;MAC/CnS,aAAa,CAACoS,UAAU,GAAGzS,OAAO,CAACgN,KAAK,CAACyF,UAAU;MACnD;IAEJ,KAAK,SAAS;MACVpS,aAAa,CAACwB,OAAO,GAAG7B,OAAO,CAACwL,WAAW,CAACC,IAAI,CAAC,CAAC,IAAI,SAAS;MAC/DpL,aAAa,CAAC4D,IAAI,GAAG5D,aAAa,CAACwB,OAAO;MAC1CxB,aAAa,CAAC8D,KAAK,GAAGnE,OAAO,CAAC0S,OAAO,CAACnP,WAAW,CAAC,CAAC;MACnDlD,aAAa,CAACmS,QAAQ,GAAGxS,OAAO,CAACgN,KAAK,CAACwF,QAAQ;MAC/CnS,aAAa,CAAC4E,KAAK,GAAGjF,OAAO,CAACgN,KAAK,CAAC/H,KAAK;MACzC5E,aAAa,CAACoS,UAAU,GAAGzS,OAAO,CAACgN,KAAK,CAACyF,UAAU;MACnDpS,aAAa,CAACsS,SAAS,GAAG3S,OAAO,CAACgN,KAAK,CAAC2F,SAAS;MACjD;IAEJ,KAAK,WAAW;MACZtS,aAAa,CAACwB,OAAO,GAAG7B,OAAO,CAACwL,WAAW,CAACC,IAAI,CAAC,CAAC,IAAI,WAAW;MACjEpL,aAAa,CAAC4D,IAAI,GAAG5D,aAAa,CAACwB,OAAO;MAC1CxB,aAAa,CAACmS,QAAQ,GAAGxS,OAAO,CAACgN,KAAK,CAACwF,QAAQ;MAC/CnS,aAAa,CAAC4E,KAAK,GAAGjF,OAAO,CAACgN,KAAK,CAAC/H,KAAK;MACzC5E,aAAa,CAACoS,UAAU,GAAGzS,OAAO,CAACgN,KAAK,CAACyF,UAAU;MACnDpS,aAAa,CAACuS,UAAU,GAAG5S,OAAO,CAACgN,KAAK,CAAC4F,UAAU;MACnDvS,aAAa,CAACsS,SAAS,GAAG3S,OAAO,CAACgN,KAAK,CAAC2F,SAAS;MACjD;IAEJ,KAAK,OAAO;MACRtS,aAAa,CAAC+D,GAAG,GAAGpE,OAAO,CAAC2L,YAAY,CAAC,KAAK,CAAC,IAAI,iCAAiC;MACpFtL,aAAa,CAACiE,GAAG,GAAGtE,OAAO,CAAC2L,YAAY,CAAC,KAAK,CAAC,IAAI,OAAO;MAC1DtL,aAAa,CAACgE,QAAQ,GAAGhE,aAAa,CAAC+D,GAAG;MAC1C;IAEJ,KAAK,MAAM;MACP,MAAMyO,GAAG,GAAG7S,OAAO,CAACuL,aAAa,CAAC,KAAK,CAAC;MACxC,MAAMuH,MAAM,GAAG9S,OAAO,CAACuL,aAAa,CAAC,GAAG,CAAC;MACzC,MAAMwH,KAAK,GAAG/S,OAAO,CAACuL,aAAa,CAAC,KAAK,CAAC;MAC1C,IAAIsH,GAAG,EAAE;QACLxS,aAAa,CAACgE,QAAQ,GAAGwO,GAAG,CAAClH,YAAY,CAAC,KAAK,CAAC;QAChDtL,aAAa,CAACiE,GAAG,GAAGuO,GAAG,CAAClH,YAAY,CAAC,KAAK,CAAC,IAAI,MAAM;MACzD,CAAC,MAAM,IAAIoH,KAAK,EAAE;QACd1S,aAAa,CAACmE,IAAI,GAAGuO,KAAK,CAACC,SAAS;MACxC,CAAC,MAAM,IAAIF,MAAM,EAAE;QACfzS,aAAa,CAACmE,IAAI,GAAGsO,MAAM,CAACG,SAAS;MACzC;MACA5S,aAAa,CAACsB,KAAK,GAAG3B,OAAO,CAAC2L,YAAY,CAAC,OAAO,CAAC,IAAI,EAAE;MACzD;IAEJ,KAAK,SAAS;MACV,MAAMxF,MAAM,GAAG3F,KAAK,CAAC0S,IAAI,CAAClT,OAAO,CAACmN,gBAAgB,CAAC,KAAK,CAAC,CAAC,CAACnM,GAAG,CAAC6R,GAAG,IAAIA,GAAG,CAAClH,YAAY,CAAC,KAAK,CAAC,IAAI,iCAAiC,CAAC;MACnItL,aAAa,CAAC8F,MAAM,GAAGA,MAAM;MAC7B9F,aAAa,CAAC+F,OAAO,GAAGpG,OAAO,CAACgN,KAAK,CAAC5G,OAAO,IAAI,MAAM;MACvD/F,aAAa,CAACgG,mBAAmB,GAAGrG,OAAO,CAACgN,KAAK,CAAC3G,mBAAmB,IAAI,uCAAuC;MAChHhG,aAAa,CAACiG,GAAG,GAAGtG,OAAO,CAACgN,KAAK,CAAC1G,GAAG,IAAI,MAAM;MAC/C;IAEJ,KAAK,OAAO;MACRjG,aAAa,CAAC+D,GAAG,GAAGpE,OAAO,CAAC2L,YAAY,CAAC,KAAK,CAAC,IAAI,EAAE;MACrDtL,aAAa,CAACqE,QAAQ,GAAGrE,aAAa,CAAC+D,GAAG;MAC1C/D,aAAa,CAACsE,QAAQ,GAAG3E,OAAO,CAACmT,YAAY,CAAC,UAAU,CAAC;MACzD9S,aAAa,CAACuE,QAAQ,GAAG5E,OAAO,CAACmT,YAAY,CAAC,UAAU,CAAC;MACzD9S,aAAa,CAACwE,IAAI,GAAG7E,OAAO,CAACmT,YAAY,CAAC,MAAM,CAAC;MACjD9S,aAAa,CAACyE,KAAK,GAAG9E,OAAO,CAACmT,YAAY,CAAC,OAAO,CAAC;MACnD9S,aAAa,CAAC0E,YAAY,GAAG/E,OAAO,CAACwL,WAAW,CAACC,IAAI,CAAC,CAAC;MACvD;IAEJ,KAAK,SAAS;IACd,KAAK,IAAI;MACLpL,aAAa,CAAC2E,SAAS,GAAGhF,OAAO,CAACgN,KAAK,CAACxL,MAAM,IAAI,KAAK;MACvDnB,aAAa,CAAC4E,KAAK,GAAGjF,OAAO,CAACgN,KAAK,CAACvL,UAAU,IAAIzB,OAAO,CAACgN,KAAK,CAAC/F,eAAe,IAAI,SAAS;MAC5F;IAEJ,KAAK,MAAM;IACX,KAAK,QAAQ;MACT5G,aAAa,CAACwB,OAAO,GAAG7B,OAAO,CAACwL,WAAW,CAACC,IAAI,CAAC,CAAC,IAAI,MAAM;MAC5DpL,aAAa,CAAC4D,IAAI,GAAG5D,aAAa,CAACwB,OAAO;MAC1CxB,aAAa,CAAC6E,IAAI,GAAGlF,OAAO,CAAC2L,YAAY,CAAC,MAAM,CAAC,IAAI,GAAG;MACxDtL,aAAa,CAAC8E,GAAG,GAAG9E,aAAa,CAAC6E,IAAI;MACtC7E,aAAa,CAACgF,MAAM,GAAGrF,OAAO,CAAC2L,YAAY,CAAC,QAAQ,CAAC;MACrDtL,aAAa,CAAC+E,MAAM,GAAG/E,aAAa,CAACgF,MAAM,KAAK,QAAQ;MACxD;IAEJ,KAAK,MAAM;MACPhF,aAAa,CAACkF,MAAM,GAAGvF,OAAO,CAAC2L,YAAY,CAAC,QAAQ,CAAC,IAAI,GAAG;MAC5DtL,aAAa,CAACmF,MAAM,GAAGxF,OAAO,CAAC2L,YAAY,CAAC,QAAQ,CAAC,IAAI,MAAM;MAC/D;IAEJ,KAAK,OAAO;MACRtL,aAAa,CAACoF,SAAS,GAAGzF,OAAO,CAAC2L,YAAY,CAAC,MAAM,CAAC,IAAI,MAAM;MAChEtL,aAAa,CAACqF,IAAI,GAAG1F,OAAO,CAAC2L,YAAY,CAAC,MAAM,CAAC,IAAI,EAAE;MACvDtL,aAAa,CAACsF,WAAW,GAAG3F,OAAO,CAAC2L,YAAY,CAAC,aAAa,CAAC,IAAI,EAAE;MACrEtL,aAAa,CAAC8C,KAAK,GAAGnD,OAAO,CAAC2L,YAAY,CAAC,OAAO,CAAC,IAAI,EAAE;MACzDtL,aAAa,CAACuF,QAAQ,GAAG5F,OAAO,CAACmT,YAAY,CAAC,UAAU,CAAC;MACzD;IAEJ,KAAK,UAAU;MACX9S,aAAa,CAACqF,IAAI,GAAG1F,OAAO,CAAC2L,YAAY,CAAC,MAAM,CAAC,IAAI,EAAE;MACvDtL,aAAa,CAACsF,WAAW,GAAG3F,OAAO,CAAC2L,YAAY,CAAC,aAAa,CAAC,IAAI,EAAE;MACrEtL,aAAa,CAAC8C,KAAK,GAAGnD,OAAO,CAACwL,WAAW,CAACC,IAAI,CAAC,CAAC;MAChDpL,aAAa,CAACwF,IAAI,GAAG7F,OAAO,CAAC2L,YAAY,CAAC,MAAM,CAAC,IAAI,CAAC;MACtDtL,aAAa,CAACuF,QAAQ,GAAG5F,OAAO,CAACmT,YAAY,CAAC,UAAU,CAAC;MACzD;IAEJ,KAAK,WAAW;IAChB,KAAK,KAAK;MACN9S,aAAa,CAACwB,OAAO,GAAG7B,OAAO,CAACsM,SAAS,IAAI,EAAE;MAC/C;IAEJ;MACIjM,aAAa,CAACwB,OAAO,GAAG7B,OAAO,CAACwL,WAAW,CAACC,IAAI,CAAC,CAAC,IAAI,EAAE;MACxDpL,aAAa,CAAC4D,IAAI,GAAG5D,aAAa,CAACwB,OAAO;MAC1C;EACR;;EAEA;EACA,IAAI7B,OAAO,CAACgN,KAAK,CAACoG,SAAS,EAAE;IACzB,MAAMC,cAAc,GAAGrT,OAAO,CAACgN,KAAK,CAACoG,SAAS,CAAClH,KAAK,CAAC,8DAA8D,CAAC;IACpH,IAAImH,cAAc,EAAE;MAChBhT,aAAa,CAAC+S,SAAS,GAAG;QACtB7S,IAAI,EAAE8S,cAAc,CAAC,CAAC,CAAC;QACvBC,QAAQ,EAAEvC,UAAU,CAACsC,cAAc,CAAC,CAAC,CAAC,CAAC,IAAI,IAAI;QAC/CE,MAAM,EAAEF,cAAc,CAAC,CAAC,CAAC,IAAI,MAAM;QACnCG,KAAK,EAAEzC,UAAU,CAACsC,cAAc,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC;QACzCI,MAAM,EAAE,CAAC,CAACJ,cAAc,CAAC,CAAC;MAC9B,CAAC;IACL;EACJ;EAEA,OAAOhT,aAAa;AACxB,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA,MAAM4Q,iBAAiB,GAAGA,CAACyC,QAAQ,EAAE1T,OAAO,KAAK;EAC7C,MAAMkB,MAAM,GAAG,CAAC,CAAC;EACjB,MAAMyS,cAAc,GAAG,CACnB,YAAY,EAAE,iBAAiB,EAAE,iBAAiB,EAAE,gBAAgB,EAAE,oBAAoB,EAC1F,OAAO,EAAE,UAAU,EAAE,YAAY,EAAE,YAAY,EAC/C,QAAQ,EAAE,cAAc,EAAE,WAAW,EAAE,YAAY,EACnD,SAAS,EAAE,QAAQ,EAAE,YAAY,EAAE,cAAc,EAAE,eAAe,EAAE,aAAa,EACjF,WAAW,EAAE,aAAa,EAAE,cAAc,EAAE,YAAY,EACxD,SAAS,EAAE,YAAY,EAAE,gBAAgB,EAAE,eAAe,EAAE,KAAK,EACjE,qBAAqB,EAAE,kBAAkB,EAAE,SAAS,EACpD,WAAW,EAAE,YAAY,EAAE,eAAe,EAC1C,QAAQ,EAAE,YAAY,EAAE,WAAW,EAAE,QAAQ,EAC7C,QAAQ,EAAE,SAAS,EAAE,WAAW,EAAE,iBAAiB,EACnD,OAAO,EAAE,QAAQ,EAAE,UAAU,EAAE,WAAW,EAAE,UAAU,EAAE,WAAW,CACtE;EAEDA,cAAc,CAAChT,OAAO,CAAC8G,IAAI,IAAI;IAC3B,IAAIiM,QAAQ,CAACjM,IAAI,CAAC,EAAE;MAChBvG,MAAM,CAACuG,IAAI,CAAC,GAAGiM,QAAQ,CAACjM,IAAI,CAAC;IACjC;EACJ,CAAC,CAAC;;EAEF;EACA,MAAMuG,aAAa,GAAGhO,OAAO,CAAC4T,aAAa,CAACzG,gBAAgB,CAAC,OAAO,CAAC;EACrEa,aAAa,CAACrN,OAAO,CAACsN,OAAO,IAAI;IAC7B,MAAM9D,UAAU,GAAG8D,OAAO,CAACzC,WAAW,IAAIyC,OAAO,CAAC3B,SAAS;IAC3D,MAAMuH,UAAU,GAAG,IAAIC,MAAM,CAAC,IAAI9T,OAAO,CAACI,EAAE,0BAA0B,CAAC;IACvE,MAAM2T,UAAU,GAAG5J,UAAU,CAAC+B,KAAK,CAAC2H,UAAU,CAAC;IAC/C,IAAIE,UAAU,EAAE;MACZ,MAAMC,WAAW,GAAG,CAAC,CAAC;MACtBD,UAAU,CAAC,CAAC,CAAC,CAACjI,KAAK,CAAC,GAAG,CAAC,CAACnL,OAAO,CAACsT,IAAI,IAAI;QACrC,MAAM,CAAChR,GAAG,EAAEE,KAAK,CAAC,GAAG8Q,IAAI,CAACnI,KAAK,CAAC,GAAG,CAAC,CAAC9K,GAAG,CAACkT,CAAC,IAAIA,CAAC,CAACzI,IAAI,CAAC,CAAC,CAAC;QACvD,IAAIxI,GAAG,IAAIE,KAAK,EAAE;UACd,MAAMgR,QAAQ,GAAGlR,GAAG,CAACI,OAAO,CAAC,WAAW,EAAE,CAAC+Q,CAAC,EAAEC,MAAM,KAAKA,MAAM,CAACC,WAAW,CAAC,CAAC,CAAC;UAC9EN,WAAW,CAACG,QAAQ,CAAC,GAAGhR,KAAK;QACjC;MACJ,CAAC,CAAC;MACF,IAAIL,MAAM,CAACyR,IAAI,CAACP,WAAW,CAAC,CAAChO,MAAM,GAAG,CAAC,EAAE;QACrC9E,MAAM,CAAC,QAAQ,CAAC,GAAG8S,WAAW;MAClC;IACJ;EACJ,CAAC,CAAC;EAEF,OAAO9S,MAAM;AACjB,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA,MAAM4M,uBAAuB,GAAI0G,aAAa,IAAK;EAC/C,MAAMC,WAAW,GAAGD,aAAa,CAACtI,KAAK,CAAC,sCAAsC,CAAC;EAC/E,IAAIuI,WAAW,EAAE;IACb,IAAI;MACA,OAAO9U,IAAI,CAAC0M,KAAK,CAACoI,WAAW,CAAC,CAAC,CAAC,CAAC;IACrC,CAAC,CAAC,OAAOC,CAAC,EAAE;MACRnI,OAAO,CAACG,IAAI,CAAC,gCAAgC,EAAEgI,CAAC,CAAC9H,OAAO,CAAC;MACzD,OAAO,EAAE;IACb;EACJ;EACA,OAAO,EAAE;AACb,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA,MAAMmB,mBAAmB,GAAGA,CAACjN,QAAQ,EAAE+M,YAAY,KAAK;EACpDA,YAAY,CAAClN,OAAO,CAACgU,WAAW,IAAI;IAChC,MAAM3U,OAAO,GAAGyK,eAAe,CAAC3J,QAAQ,EAAE6T,WAAW,CAACxU,SAAS,CAAC;IAChE,IAAIH,OAAO,EAAE;MACT,IAAI,CAACA,OAAO,CAACK,aAAa,EAAE;QACxBL,OAAO,CAACK,aAAa,GAAG,CAAC,CAAC;MAC9B;MACAL,OAAO,CAACK,aAAa,CAACZ,MAAM,GAAGkV,WAAW,CAAClV,MAAM,IAAI,CAAC,CAAC;IAC3D;EACJ,CAAC,CAAC;AACN,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA,MAAM0O,wBAAwB,GAAIhE,UAAU,IAAK;EAC7C,MAAM+D,UAAU,GAAG,CAAC,CAAC;EACrB,MAAM0G,cAAc,GAAG,oCAAoC;EAC3D,IAAI1I,KAAK;EACT,OAAQA,KAAK,GAAG0I,cAAc,CAACC,IAAI,CAAC1K,UAAU,CAAC,EAAG;IAC9C,MAAM2K,YAAY,GAAG5I,KAAK,CAAC,CAAC,CAAC;IAC7B,MAAM6I,aAAa,GAAG7I,KAAK,CAAC,CAAC,CAAC;IAC9B,MAAM8I,MAAM,GAAG,CAAC,CAAC;IACjB,MAAMC,UAAU,GAAG,gCAAgC;IACnD,IAAIC,UAAU;IACd,OAAQA,UAAU,GAAGD,UAAU,CAACJ,IAAI,CAACE,aAAa,CAAC,EAAG;MAClD,MAAMI,QAAQ,GAAGD,UAAU,CAAC,CAAC,CAAC;MAC9B,MAAM1N,KAAK,GAAG,CAAC,CAAC;MAChB0N,UAAU,CAAC,CAAC,CAAC,CAACpJ,KAAK,CAAC,GAAG,CAAC,CAACnL,OAAO,CAACsT,IAAI,IAAI;QACrC,MAAM,CAAChR,GAAG,EAAEE,KAAK,CAAC,GAAG8Q,IAAI,CAACnI,KAAK,CAAC,GAAG,CAAC,CAAC9K,GAAG,CAACkT,CAAC,IAAIA,CAAC,CAACzI,IAAI,CAAC,CAAC,CAAC;QACvD,IAAIxI,GAAG,IAAIE,KAAK,EAAE;UACd,MAAMgR,QAAQ,GAAGlR,GAAG,CAACI,OAAO,CAAC,WAAW,EAAE,CAAC+Q,CAAC,EAAEC,MAAM,KAAKA,MAAM,CAACC,WAAW,CAAC,CAAC,CAAC;UAC9E9M,KAAK,CAAC2M,QAAQ,CAAC,GAAGhR,KAAK;QAC3B;MACJ,CAAC,CAAC;MACF6R,MAAM,CAACG,QAAQ,CAAC,GAAG3N,KAAK;IAC5B;IACA0G,UAAU,CAAC,cAAc4G,YAAY,EAAE,CAAC,GAAGE,MAAM;EACrD;EACA,OAAO9G,UAAU;AACrB,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA,MAAME,uBAAuB,GAAGA,CAACtN,QAAQ,EAAEoN,UAAU,KAAK;EACtDpN,QAAQ,CAACH,OAAO,CAACX,OAAO,IAAI;IAAA,IAAAoV,eAAA,EAAAC,iBAAA;IACxB,KAAAD,eAAA,GAAIpV,OAAO,CAACkB,MAAM,cAAAkU,eAAA,eAAdA,eAAA,CAAgBhC,SAAS,EAAE;MAC3B,MAAMC,cAAc,GAAGrT,OAAO,CAACkB,MAAM,CAACkS,SAAS,CAAClH,KAAK,CAAC,8DAA8D,CAAC;MACrH,IAAImH,cAAc,EAAE;QAChBrT,OAAO,CAACK,aAAa,CAAC+S,SAAS,GAAG;UAC9B7S,IAAI,EAAE8S,cAAc,CAAC,CAAC,CAAC;UACvBC,QAAQ,EAAEvC,UAAU,CAACsC,cAAc,CAAC,CAAC,CAAC,CAAC,IAAI,IAAI;UAC/CE,MAAM,EAAEF,cAAc,CAAC,CAAC,CAAC,IAAI,MAAM;UACnCG,KAAK,EAAEzC,UAAU,CAACsC,cAAc,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC;UACzCI,MAAM,EAAE,CAAC,CAACJ,cAAc,CAAC,CAAC;QAC9B,CAAC;MACL;IACJ;IACA,IAAIrT,OAAO,CAACkB,MAAM,IAAIgN,UAAU,CAAC,cAAclO,OAAO,CAACkB,MAAM,CAACoU,aAAa,EAAE,CAAC,EAAE;MAC5EtV,OAAO,CAACkB,MAAM,CAAC,cAAclB,OAAO,CAACkB,MAAM,CAACoU,aAAa,EAAE,CAAC,GAAGpH,UAAU,CAAC,cAAclO,OAAO,CAACkB,MAAM,CAACoU,aAAa,EAAE,CAAC;IAC3H;IACA,IAAI,EAAAD,iBAAA,GAAArV,OAAO,CAACU,QAAQ,cAAA2U,iBAAA,uBAAhBA,iBAAA,CAAkBrP,MAAM,IAAG,CAAC,EAAE;MAC9BoI,uBAAuB,CAACpO,OAAO,CAACU,QAAQ,EAAEwN,UAAU,CAAC;IACzD;EACJ,CAAC,CAAC;AACN,CAAC;;AAKD;AACA;AACA;AACA;AACA;AACA,MAAM6D,oBAAoB,GAAI/R,OAAO,IAAK;EACtC,MAAM0S,OAAO,GAAG1S,OAAO,CAAC0S,OAAO,CAACnP,WAAW,CAAC,CAAC;EAC7C,MAAMgN,SAAS,GAAGvQ,OAAO,CAACuQ,SAAS;;EAEnC;EACA,IAAIA,SAAS,CAACC,QAAQ,CAAC,YAAY,CAAC,EAAE,OAAO,QAAQ;EACrD,IAAID,SAAS,CAACC,QAAQ,CAAC,UAAU,CAAC,EAAE,OAAO,MAAM;EACjD,IAAID,SAAS,CAACC,QAAQ,CAAC,aAAa,CAAC,EAAE,OAAO,SAAS;EACvD,IAAID,SAAS,CAACC,QAAQ,CAAC,aAAa,CAAC,IAAID,SAAS,CAACC,QAAQ,CAAC,cAAc,CAAC,EAAE,OAAO,SAAS;EAC7F,IAAID,SAAS,CAACC,QAAQ,CAAC,WAAW,CAAC,EAAE,OAAO,OAAO;EACnD,IAAID,SAAS,CAACC,QAAQ,CAAC,WAAW,CAAC,EAAE,OAAO,OAAO;EACnD,IAAID,SAAS,CAACC,QAAQ,CAAC,aAAa,CAAC,EAAE,OAAO,SAAS;EACvD,IAAID,SAAS,CAACC,QAAQ,CAAC,UAAU,CAAC,EAAE,OAAO,MAAM;EACjD,IAAID,SAAS,CAACC,QAAQ,CAAC,eAAe,CAAC,EAAE,OAAO,WAAW;EAC3D,IAAID,SAAS,CAACC,QAAQ,CAAC,UAAU,CAAC,EAAE,OAAO,MAAM;EACjD,IAAID,SAAS,CAACC,QAAQ,CAAC,WAAW,CAAC,EAAE,OAAO,OAAO;EACnD,IAAID,SAAS,CAACC,QAAQ,CAAC,cAAc,CAAC,EAAE,OAAO,UAAU;;EAEzD;EACA,IAAIkC,OAAO,KAAK,QAAQ,EAAE,OAAO,QAAQ;EACzC,IAAIA,OAAO,CAACxG,KAAK,CAAC,UAAU,CAAC,EAAE,OAAO,SAAS;EAC/C,IAAIwG,OAAO,KAAK,GAAG,EAAE,OAAO,WAAW;EACvC,IAAIA,OAAO,KAAK,KAAK,EAAE,OAAO,OAAO;EACrC,IAAIA,OAAO,KAAK,IAAI,EAAE,OAAO,SAAS;EACtC,IAAIA,OAAO,KAAK,OAAO,EAAE,OAAO,OAAO;EACvC,IAAIA,OAAO,KAAK,GAAG,EAAE,OAAO,MAAM;EAClC,IAAIA,OAAO,KAAK,MAAM,EAAE,OAAO,MAAM;EACrC,IAAIA,OAAO,KAAK,OAAO,EAAE,OAAO,OAAO;EACvC,IAAIA,OAAO,KAAK,UAAU,EAAE,OAAO,UAAU;EAC7C,IAAIA,OAAO,KAAK,IAAI,IAAIA,OAAO,KAAK,IAAI,EAAE,OAAO,MAAM;;EAEvD;EACA,OAAO,WAAW;AACtB,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}