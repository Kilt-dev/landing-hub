{"ast":null,"code":"var _jsxFileName = \"F:\\\\landinghub-iconic\\\\apps\\\\web\\\\src\\\\components\\\\create-page\\\\Canvas.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$(),\n  _s3 = $RefreshSig$(),\n  _s4 = $RefreshSig$();\nimport React, { useRef, useCallback, useState, useEffect } from 'react';\nimport { useDrop } from 'react-dnd';\nimport { useHotkeys } from 'react-hotkeys-hook';\nimport { toast } from 'react-toastify';\nimport PropTypes from 'prop-types';\nimport Guidelines from './Guidelines';\nimport SelectionOverlay from './SelectionOverlay';\nimport { Element } from './Element';\nimport { ItemTypes, getCanvasPosition, snapToGrid, getElementBounds, renderComponentContent } from './helpers';\nimport AddSectionButton from './AddSectionButton';\nimport eventController from '../../utils/EventController';\n\n// Custom hook để quản lý drag-and-drop\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst useCanvasDrop = ({\n  pageData,\n  viewMode,\n  zoomLevel,\n  gridSize,\n  showGrid,\n  onAddElement,\n  onMoveChild,\n  updateCanvasHeight,\n  canvasRef\n}) => {\n  _s();\n  // Tính canvasBounds bên trong useCanvasDrop\n  const canvasBounds = {\n    width: canvasRef.current ? canvasRef.current.offsetWidth / (zoomLevel / 100) : viewMode === 'mobile' ? 375 : 1200,\n    height: canvasRef.current ? canvasRef.current.offsetHeight / (zoomLevel / 100) : 1000\n  };\n  const [{\n    isOver,\n    dragItem\n  }, drop] = useDrop({\n    accept: [ItemTypes.ELEMENT, ItemTypes.CHILD_ELEMENT],\n    hover: (item, monitor) => {\n      const clientOffset = monitor.getClientOffset();\n      if (!clientOffset || !canvasRef.current) {\n        setDragPreview(null);\n        return;\n      }\n      const pos = getCanvasPosition(clientOffset.x, clientOffset.y, canvasRef.current, zoomLevel);\n      const snapPoints = getSnapPoints(pageData.elements, canvasBounds, viewMode);\n      const snapped = snapToGrid(pos.x, pos.y, showGrid ? gridSize : Infinity, snapPoints);\n      if (monitor.getItemType() === ItemTypes.ELEMENT && item.json) {\n        setDragPreview({\n          id: 'preview',\n          x: snapped.x,\n          y: snapped.y,\n          size: item.json.size || {\n            width: viewMode === 'mobile' ? 375 : 1200,\n            height: 400\n          },\n          type: item.json.type,\n          componentData: item.json.componentData || {\n            structure: 'ladi-standard'\n          },\n          styles: item.json.styles || {},\n          children: item.json.children || []\n        });\n      } else if (monitor.getItemType() === ItemTypes.CHILD_ELEMENT) {\n        const sourceElement = pageData.elements.find(el => el.id === item.parentId);\n        const child = sourceElement === null || sourceElement === void 0 ? void 0 : sourceElement.children.find(c => c.id === item.childId);\n        if (child) {\n          setDragPreview({\n            id: item.childId,\n            x: snapped.x,\n            y: snapped.y,\n            size: item.size || {\n              width: 200,\n              height: 50\n            },\n            type: child.type,\n            componentData: child.componentData || {},\n            styles: child.styles || {},\n            children: []\n          });\n        }\n      }\n      const newGuidelines = calculateGuidelines(pageData.elements, snapped, viewMode, canvasBounds);\n      setGuidelines(newGuidelines);\n    },\n    drop: (item, monitor) => {\n      const clientOffset = monitor.getClientOffset();\n      if (!clientOffset || !canvasRef.current) {\n        toast.error('Không thể xác định vị trí thả!');\n        setDragPreview(null);\n        setGuidelines([]);\n        return {\n          moved: false\n        };\n      }\n      const pos = getCanvasPosition(clientOffset.x, clientOffset.y, canvasRef.current, zoomLevel);\n      const snapPoints = getSnapPoints(pageData.elements, canvasBounds, viewMode);\n      const snapped = snapToGrid(pos.x, pos.y, showGrid ? gridSize : Infinity, snapPoints);\n      if (monitor.getItemType() === ItemTypes.CHILD_ELEMENT) {\n        const sourceSection = pageData.elements.find(el => el.id === item.parentId);\n        if (!sourceSection) {\n          toast.error('Không tìm thấy section nguồn!');\n          setDragPreview(null);\n          setGuidelines([]);\n          return {\n            moved: false\n          };\n        }\n        onMoveChild(item.parentId, item.childId, null, snapped);\n        toast.success('Đã di chuyển thành phần con ra canvas!');\n        setDragPreview(null);\n        setGuidelines([]);\n        return {\n          moved: true,\n          newPosition: snapped\n        };\n      } else if (monitor.getItemType() === ItemTypes.ELEMENT) {\n        if (item.json.type !== 'section' && item.json.type !== 'popup' && item.json.type !== 'modal') {\n          toast.error('Chỉ có thể thả section, popup hoặc modal lên canvas!');\n          setDragPreview(null);\n          setGuidelines([]);\n          return {\n            moved: false\n          };\n        }\n        const lastSectionY = pageData.elements.filter(el => el.type === 'section').reduce((maxY, el) => {\n          var _el$position, _el$position$viewMode, _el$size;\n          return Math.max(maxY, (((_el$position = el.position) === null || _el$position === void 0 ? void 0 : (_el$position$viewMode = _el$position[viewMode]) === null || _el$position$viewMode === void 0 ? void 0 : _el$position$viewMode.y) || 0) + (((_el$size = el.size) === null || _el$size === void 0 ? void 0 : _el$size.height) || 400));\n        }, 0);\n        const newElement = {\n          id: `${item.json.type}-${Date.now()}`,\n          type: item.json.type,\n          componentData: JSON.parse(JSON.stringify(item.json.componentData || {\n            structure: item.json.type === 'section' ? 'ladi-standard' : undefined\n          })),\n          position: {\n            [viewMode]: {\n              x: item.json.type === 'section' ? 0 : snapped.x,\n              y: item.json.type === 'section' ? lastSectionY + 10 : snapped.y\n            },\n            desktop: {\n              x: item.json.type === 'section' ? 0 : snapped.x,\n              y: item.json.type === 'section' ? lastSectionY + 10 : snapped.y\n            },\n            tablet: {\n              x: item.json.type === 'section' ? 0 : snapped.x,\n              y: item.json.type === 'section' ? lastSectionY + 10 : snapped.y\n            },\n            mobile: {\n              x: item.json.type === 'section' ? 0 : snapped.x,\n              y: item.json.type === 'section' ? lastSectionY + 10 : snapped.y\n            }\n          },\n          size: {\n            ...item.json.size,\n            width: viewMode === 'mobile' ? 375 : item.json.type === 'section' ? 1200 : 600\n          },\n          styles: JSON.parse(JSON.stringify(item.json.styles || {})),\n          children: JSON.parse(JSON.stringify(item.json.children || [])),\n          visible: true,\n          locked: false,\n          meta: {\n            updated_at: new Date().toISOString()\n          }\n        };\n        onAddElement(newElement);\n        if (item.json.type === 'section') {\n          updateCanvasHeight();\n        }\n        toast.success(`Đã thêm ${item.json.type} mới!`);\n        setDragPreview(null);\n        setGuidelines([]);\n        return {\n          moved: true,\n          newPosition: {\n            x: item.json.type === 'section' ? 0 : snapped.x,\n            y: item.json.type === 'section' ? lastSectionY + 10 : snapped.y\n          }\n        };\n      }\n      setDragPreview(null);\n      setGuidelines([]);\n      return {\n        moved: false\n      };\n    },\n    collect: monitor => ({\n      isOver: monitor.isOver(),\n      dragItem: monitor.getItem()\n    })\n  }, [pageData.elements, viewMode, zoomLevel, gridSize, showGrid, canvasBounds, onAddElement, onMoveChild, updateCanvasHeight]);\n  return {\n    isOver,\n    dragItem,\n    drop,\n    canvasBounds\n  };\n};\n\n// Custom hook để quản lý guidelines\n_s(useCanvasDrop, \"x11ABS5oa+Txa7zAYeWrrleHuRQ=\", false, function () {\n  return [useDrop];\n});\nconst useGuidelines = (pageData, viewMode, canvasBounds) => {\n  _s2();\n  const [guidelines, setGuidelines] = useState([]);\n  return {\n    guidelines,\n    setGuidelines\n  };\n};\n\n// Custom hook để quản lý popups\n_s2(useGuidelines, \"7KlrYhT6fl/V+KO6x61fAAmTwhw=\");\nconst usePopupManager = (pageData, selectedIds, onSelectElement, handleSelectElement) => {\n  _s3();\n  const [visiblePopups, setVisiblePopups] = useState([]);\n  useEffect(() => {\n    const unsubscribeOpen = eventController.subscribe(\"popup-open\", payload => {\n      const popupElement = pageData.elements.find(el => el.id === payload.popupId);\n      if (!popupElement) {\n        toast.error(`Popup \"${payload.popupId}\" not found!`);\n        return;\n      }\n      setVisiblePopups(prev => [...new Set([...prev, payload.popupId])]);\n      onSelectElement([payload.popupId]);\n    });\n    const unsubscribeClose = eventController.subscribe(\"popup-close\", payload => {\n      setVisiblePopups(prev => prev.filter(popupId => popupId !== payload.popupId));\n      if (selectedIds.includes(payload.popupId)) {\n        handleSelectElement([]);\n      }\n    });\n    return () => {\n      unsubscribeOpen();\n      unsubscribeClose();\n    };\n  }, [pageData.elements, onSelectElement, selectedIds, handleSelectElement]);\n  return {\n    visiblePopups,\n    setVisiblePopups\n  };\n};\n\n// Hàm tính toán snap points\n_s3(usePopupManager, \"E62hIMvDYUBbPwwcJR0OtI7WkZ0=\");\nconst getSnapPoints = (elements, canvasBounds, viewMode) => {\n  const points = [{\n    x: 0,\n    y: 0\n  }, {\n    x: viewMode === 'mobile' ? 375 : 1200,\n    y: canvasBounds.height\n  }, {\n    x: (viewMode === 'mobile' ? 375 : 1200) / 2,\n    y: canvasBounds.height / 2\n  }];\n  elements.forEach(el => {\n    var _el$children;\n    const bounds = getElementBounds(el);\n    points.push({\n      x: bounds.left,\n      y: bounds.top\n    }, {\n      x: bounds.right,\n      y: bounds.bottom\n    }, {\n      x: bounds.centerX,\n      y: bounds.centerY\n    }, {\n      x: bounds.left,\n      y: bounds.centerY\n    }, {\n      x: bounds.right,\n      y: bounds.centerY\n    }, {\n      x: bounds.centerX,\n      y: bounds.top\n    }, {\n      x: bounds.centerX,\n      y: bounds.bottom\n    });\n    (_el$children = el.children) === null || _el$children === void 0 ? void 0 : _el$children.forEach(child => {\n      const childBounds = getElementBounds(child);\n      points.push({\n        x: childBounds.left,\n        y: childBounds.top\n      }, {\n        x: childBounds.right,\n        y: childBounds.bottom\n      }, {\n        x: childBounds.centerX,\n        y: childBounds.centerY\n      }, {\n        x: childBounds.left,\n        y: childBounds.centerY\n      }, {\n        x: childBounds.right,\n        y: childBounds.centerY\n      }, {\n        x: childBounds.centerX,\n        y: childBounds.top\n      }, {\n        x: childBounds.centerX,\n        y: childBounds.bottom\n      });\n    });\n  });\n  return points;\n};\n\n// Hàm tính toán guidelines\nconst calculateGuidelines = (elements, snapped, viewMode, canvasBounds) => {\n  const newGuidelines = [];\n  elements.forEach(el => {\n    var _el$children2;\n    const bounds = getElementBounds(el);\n    if (Math.abs(snapped.x - bounds.left) < 15) newGuidelines.push({\n      vertical: true,\n      position: bounds.left\n    });\n    if (Math.abs(snapped.x - bounds.right) < 15) newGuidelines.push({\n      vertical: true,\n      position: bounds.right\n    });\n    if (Math.abs(snapped.x - bounds.centerX) < 15) newGuidelines.push({\n      vertical: true,\n      position: bounds.centerX\n    });\n    if (Math.abs(snapped.y - bounds.top) < 15) newGuidelines.push({\n      vertical: false,\n      position: bounds.top\n    });\n    if (Math.abs(snapped.y - bounds.bottom) < 15) newGuidelines.push({\n      vertical: false,\n      position: bounds.bottom\n    });\n    if (Math.abs(snapped.y - bounds.centerY) < 15) newGuidelines.push({\n      vertical: false,\n      position: bounds.centerY\n    });\n    (_el$children2 = el.children) === null || _el$children2 === void 0 ? void 0 : _el$children2.forEach(child => {\n      const childBounds = getElementBounds(child);\n      if (Math.abs(snapped.x - childBounds.left) < 15) newGuidelines.push({\n        vertical: true,\n        position: childBounds.left\n      });\n      if (Math.abs(snapped.x - childBounds.right) < 15) newGuidelines.push({\n        vertical: true,\n        position: childBounds.right\n      });\n      if (Math.abs(snapped.x - childBounds.centerX) < 15) newGuidelines.push({\n        vertical: true,\n        position: childBounds.centerX\n      });\n      if (Math.abs(snapped.y - childBounds.top) < 15) newGuidelines.push({\n        vertical: false,\n        position: childBounds.top\n      });\n      if (Math.abs(snapped.y - childBounds.bottom) < 15) newGuidelines.push({\n        vertical: false,\n        position: childBounds.bottom\n      });\n      if (Math.abs(snapped.y - childBounds.centerY) < 15) newGuidelines.push({\n        vertical: false,\n        position: childBounds.centerY\n      });\n    });\n  });\n  if (Math.abs(snapped.x) < 15) newGuidelines.push({\n    vertical: true,\n    position: 0\n  });\n  if (Math.abs(snapped.x - (viewMode === 'mobile' ? 375 : 1200)) < 15) newGuidelines.push({\n    vertical: true,\n    position: viewMode === 'mobile' ? 375 : 1200\n  });\n  if (Math.abs(snapped.x - (viewMode === 'mobile' ? 375 : 1200) / 2) < 15) newGuidelines.push({\n    vertical: true,\n    position: (viewMode === 'mobile' ? 375 : 1200) / 2\n  });\n  if (Math.abs(snapped.y) < 15) newGuidelines.push({\n    vertical: false,\n    position: 0\n  });\n  if (Math.abs(snapped.y - canvasBounds.height) < 15) newGuidelines.push({\n    vertical: false,\n    position: canvasBounds.height\n  });\n  if (Math.abs(snapped.y - canvasBounds.height / 2) < 15) newGuidelines.push({\n    vertical: false,\n    position: canvasBounds.height / 2\n  });\n  return newGuidelines;\n};\nconst Canvas = /*#__PURE__*/_s4(/*#__PURE__*/React.memo(_c = _s4(({\n  pageData,\n  selectedIds,\n  onSelectElement,\n  onUpdatePosition,\n  onUpdateSize,\n  onDeleteElement,\n  onAddElement,\n  onGroupElements,\n  viewMode,\n  zoomLevel,\n  gridSize,\n  showGrid,\n  onEditElement,\n  onDuplicateElement,\n  onMoveElementUp,\n  onMoveElementDown,\n  onSelectChild,\n  selectedChildId,\n  onAddChild,\n  onUpdateChildPosition,\n  onMoveChild,\n  guideLine,\n  onShowAddSectionPopup,\n  onSaveTemplate,\n  onToggleVisibility,\n  onDeleteChild\n}) => {\n  _s4();\n  const canvasRef = useRef(null);\n  const [contextMenu, setContextMenu] = useState(null);\n  const [dragPreview, setDragPreview] = useState(null);\n  const [showPopup, setShowPopup] = useState(false);\n  const [guideLinePosition, setGuideLinePosition] = useState((guideLine === null || guideLine === void 0 ? void 0 : guideLine.y) || 0);\n  const {\n    guidelines,\n    setGuidelines\n  } = useGuidelines(pageData, viewMode, canvasBounds);\n  const {\n    visiblePopups,\n    setVisiblePopups\n  } = usePopupManager(pageData, selectedIds, onSelectElement, handleSelectElement);\n  const {\n    isOver,\n    dragItem,\n    drop,\n    canvasBounds\n  } = useCanvasDrop({\n    pageData,\n    viewMode,\n    zoomLevel,\n    gridSize,\n    showGrid,\n    onAddElement,\n    onMoveChild,\n    updateCanvasHeight,\n    canvasRef\n  });\n  const handleSelectElement = useCallback((ids, ctrlKey) => {\n    if (typeof onSelectElement !== 'function') {\n      console.error('onSelectElement is not a function');\n      return;\n    }\n    onSelectElement(ids, ctrlKey);\n    const selectedElements = pageData.elements.filter(el => ids.includes(el.id));\n    const popupIds = selectedElements.filter(el => el.type === 'popup' || el.type === 'modal').map(el => el.id);\n    setVisiblePopups(popupIds);\n  }, [onSelectElement, pageData.elements, setVisiblePopups]);\n  const updateCanvasHeight = useCallback(() => {\n    const lastSection = pageData.elements.filter(el => el.type === 'section').reduce((maxY, el) => {\n      var _el$position2, _el$position2$viewMod, _el$size2;\n      return Math.max(maxY, (((_el$position2 = el.position) === null || _el$position2 === void 0 ? void 0 : (_el$position2$viewMod = _el$position2[viewMode]) === null || _el$position2$viewMod === void 0 ? void 0 : _el$position2$viewMod.y) || 0) + (((_el$size2 = el.size) === null || _el$size2 === void 0 ? void 0 : _el$size2.height) || 400));\n    }, 0);\n    const newHeight = lastSection + 50;\n    setGuideLinePosition(lastSection + 10);\n    return newHeight;\n  }, [pageData.elements, viewMode]);\n  useEffect(() => {\n    updateCanvasHeight();\n  }, [updateCanvasHeight]);\n  const handleContextMenu = useCallback((id, position) => {\n    setContextMenu({\n      id,\n      position\n    });\n  }, []);\n  const handleCanvasClick = useCallback(e => {\n    e.stopPropagation();\n    if (e.target === canvasRef.current) {\n      handleSelectElement([]);\n      onSelectChild(null, null);\n      setContextMenu(null);\n      setDragPreview(null);\n      setVisiblePopups([]);\n    }\n  }, [handleSelectElement, onSelectChild]);\n  const handleKeyDown = useCallback(e => {\n    if (!selectedIds.length) return;\n    e.preventDefault();\n    e.stopPropagation();\n    const step = e.shiftKey ? 10 : 1;\n    selectedIds.forEach(id => {\n      var _element$position$vie5, _element$position$vie6;\n      const element = pageData.elements.find(el => el.id === id);\n      if (element && element.type !== 'section' && element.type !== 'popup' && element.type !== 'modal') {\n        var _element$position$vie, _element$position$vie2, _element$position$vie3, _element$position$vie4;\n        const newY = e.key === 'ArrowUp' ? Math.max(0, (((_element$position$vie = element.position[viewMode]) === null || _element$position$vie === void 0 ? void 0 : _element$position$vie.y) || 0) - step) : (((_element$position$vie2 = element.position[viewMode]) === null || _element$position$vie2 === void 0 ? void 0 : _element$position$vie2.y) || 0) + step;\n        const newX = e.key === 'ArrowLeft' ? Math.max(0, (((_element$position$vie3 = element.position[viewMode]) === null || _element$position$vie3 === void 0 ? void 0 : _element$position$vie3.x) || 0) - step) : (((_element$position$vie4 = element.position[viewMode]) === null || _element$position$vie4 === void 0 ? void 0 : _element$position$vie4.x) || 0) + step;\n        switch (e.key) {\n          case 'ArrowUp':\n          case 'ArrowDown':\n            onUpdatePosition(id, {\n              [viewMode]: {\n                x: ((_element$position$vie5 = element.position[viewMode]) === null || _element$position$vie5 === void 0 ? void 0 : _element$position$vie5.x) || 0,\n                y: newY\n              }\n            }, 'absolute');\n            break;\n          case 'ArrowLeft':\n          case 'ArrowRight':\n            onUpdatePosition(id, {\n              [viewMode]: {\n                x: newX,\n                y: ((_element$position$vie6 = element.position[viewMode]) === null || _element$position$vie6 === void 0 ? void 0 : _element$position$vie6.y) || 0\n              }\n            }, 'absolute');\n            break;\n          case 'Delete':\n          case 'Backspace':\n            onDeleteElement(id);\n            setVisiblePopups(prev => prev.filter(popupId => popupId !== id));\n            break;\n          case 'Escape':\n            handleSelectElement([]);\n            onSelectChild(null, null);\n            setContextMenu(null);\n            setDragPreview(null);\n            setVisiblePopups([]);\n            break;\n          default:\n            break;\n        }\n      }\n    });\n  }, [selectedIds, onUpdatePosition, onDeleteElement, handleSelectElement, onSelectChild, viewMode, pageData.elements]);\n  useHotkeys('ctrl+a', e => {\n    e.preventDefault();\n    handleSelectElement(pageData.elements.map(el => el.id));\n  }, [pageData.elements, handleSelectElement]);\n  useHotkeys('ctrl+g', e => {\n    e.preventDefault();\n    if (selectedIds.length > 1) {\n      onGroupElements(selectedIds);\n    }\n  }, [selectedIds, onGroupElements]);\n  useEffect(() => {\n    const handleClickOutside = () => {\n      setContextMenu(null);\n      setDragPreview(null);\n      setVisiblePopups([]);\n    };\n    if (contextMenu || visiblePopups.length > 0) {\n      document.addEventListener('click', handleClickOutside);\n      return () => document.removeEventListener('click', handleClickOutside);\n    }\n  }, [contextMenu, visiblePopups]);\n  const handleClosePopup = useCallback(id => {\n    setVisiblePopups(prev => prev.filter(popupId => popupId !== id));\n    handleSelectElement([]);\n  }, [handleSelectElement]);\n  const renderDragPreview = () => {\n    if (!dragPreview) return null;\n    const {\n      x,\n      y,\n      size,\n      type,\n      componentData,\n      styles,\n      children\n    } = dragPreview;\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"absolute border-2 border-dashed border-blue-500 bg-blue-100/50 pointer-events-none z-[1000] opacity-50\",\n      style: {\n        transform: `translate(${x}px, ${y}px)`,\n        width: size.width,\n        height: size.height,\n        ...styles\n      },\n      children: renderComponentContent(type, componentData || {}, styles || {}, children || [])\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 399,\n      columnNumber: 13\n    }, this);\n  };\n  const renderAddSectionButton = () => {\n    if (pageData.elements.length > 0) return null;\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"absolute left-1/2 top-1/2 transform -translate-x-1/2 -translate-y-1/2 z-[1000]\",\n      children: /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: e => {\n          e.stopPropagation();\n          setShowPopup(true);\n          if (typeof onShowAddSectionPopup === 'function') {\n            onShowAddSectionPopup();\n          }\n        },\n        className: \"px-6 py-3 bg-blue-600 text-white rounded-lg font-semibold cursor-pointer hover:bg-blue-700\",\n        children: \"Th\\xEAm Section\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 409,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 408,\n      columnNumber: 13\n    }, this);\n  };\n  const renderContextMenu = () => {\n    if (!contextMenu) return null;\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"fixed bg-white border border-gray-300 rounded shadow-lg min-w-[120px] z-[10000]\",\n      style: {\n        left: contextMenu.position.x,\n        top: contextMenu.position.y\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"px-3 py-2 cursor-pointer hover:bg-gray-100\",\n        onClick: () => {\n          onDeleteElement(contextMenu.id);\n          setContextMenu(null);\n          setVisiblePopups(prev => prev.filter(id => id !== contextMenu.id));\n        },\n        children: \"X\\xF3a\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 429,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"px-3 py-2 cursor-pointer hover:bg-gray-100\",\n        onClick: () => {\n          onGroupElements([contextMenu.id]);\n          setContextMenu(null);\n        },\n        children: \"Nh\\xF3m\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 432,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"px-3 py-2 cursor-pointer hover:bg-gray-100\",\n        onClick: () => {\n          onToggleVisibility(contextMenu.id);\n          setContextMenu(null);\n        },\n        children: \"\\u1EA8n/Hi\\u1EC7n\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 435,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 428,\n      columnNumber: 13\n    }, this);\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"relative w-full h-screen overflow-y-auto focus:outline-none\",\n    onKeyDown: handleKeyDown,\n    tabIndex: 0,\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      ref: node => {\n        canvasRef.current = node;\n        drop(node);\n      },\n      className: `relative mx-auto ${viewMode === 'mobile' ? 'w-[375px]' : viewMode === 'tablet' ? 'w-[768px]' : 'w-[1200px]'}`,\n      onClick: handleCanvasClick,\n      style: {\n        height: pageData.canvas.height ? `${pageData.canvas.height}px` : 'auto',\n        background: pageData.canvas.background,\n        transform: `scale(${zoomLevel / 100})`,\n        transformOrigin: 'top center'\n      },\n      children: [/*#__PURE__*/_jsxDEV(Guidelines, {\n        guidelines: guidelines,\n        zoomLevel: zoomLevel\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 458,\n        columnNumber: 17\n      }, this), pageData.elements.map(element => /*#__PURE__*/_jsxDEV(Element, {\n        element: element,\n        isSelected: selectedIds.includes(element.id),\n        onSelectElement: handleSelectElement,\n        onUpdatePosition: onUpdatePosition,\n        viewMode: viewMode,\n        zoomLevel: zoomLevel,\n        gridSize: gridSize,\n        onContextMenu: handleContextMenu,\n        canvasBounds: canvasBounds,\n        canvasRef: canvasRef,\n        onSelectChild: onSelectChild,\n        selectedChildId: selectedChildId,\n        onAddChild: onAddChild,\n        onUpdateChildPosition: onUpdateChildPosition,\n        onMoveChild: onMoveChild,\n        showGrid: showGrid,\n        setDragPreview: setDragPreview,\n        visiblePopups: visiblePopups,\n        onClosePopup: handleClosePopup,\n        onSaveTemplate: onSaveTemplate,\n        onToggleVisibility: onToggleVisibility,\n        onEditElement: onEditElement,\n        onDuplicateElement: onDuplicateElement,\n        onMoveElementUp: onMoveElementUp,\n        onMoveElementDown: onMoveElementDown,\n        onDeleteElement: onDeleteElement,\n        onDeleteChild: onDeleteChild\n      }, element.id, false, {\n        fileName: _jsxFileName,\n        lineNumber: 460,\n        columnNumber: 21\n      }, this)), renderDragPreview(), (guideLine === null || guideLine === void 0 ? void 0 : guideLine.show) && /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"absolute left-1/2 transform -translate-x-1/2 w-full h-px bg-blue-500 opacity-50 z-[1001]\",\n          style: {\n            top: guideLinePosition\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 494,\n          columnNumber: 25\n        }, this), pageData.elements.length > 0 && /*#__PURE__*/_jsxDEV(AddSectionButton, {\n          guideLinePosition: guideLinePosition,\n          setShowPopup: setShowPopup,\n          onShowAddSectionPopup: onShowAddSectionPopup\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 496,\n          columnNumber: 29\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"absolute top-0 w-px h-full bg-blue-500 opacity-50 z-[1001]\",\n          style: {\n            left: viewMode === 'mobile' ? 'calc(50% - 187.5px)' : 'calc(50% - 600px)'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 498,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"absolute top-0 w-px h-full bg-blue-500 opacity-50 z-[1001]\",\n          style: {\n            left: viewMode === 'mobile' ? 'calc(50% + 187.5px)' : 'calc(50% + 600px)'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 499,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true), /*#__PURE__*/_jsxDEV(SelectionOverlay, {\n        selectedElements: pageData.elements.filter(el => selectedIds.includes(el.id)),\n        onResize: onUpdateSize,\n        zoomLevel: zoomLevel\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 502,\n        columnNumber: 17\n      }, this), renderContextMenu(), renderAddSectionButton()]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 444,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 443,\n    columnNumber: 9\n  }, this);\n}, \"Pi8jr0LTJhtNr1O/bKbENHYMcWQ=\", false, function () {\n  return [useGuidelines, usePopupManager, useCanvasDrop, useHotkeys, useHotkeys];\n})), \"Pi8jr0LTJhtNr1O/bKbENHYMcWQ=\", false, function () {\n  return [useGuidelines, usePopupManager, useCanvasDrop, useHotkeys, useHotkeys];\n});\n_c2 = Canvas;\nCanvas.propTypes = {\n  pageData: PropTypes.shape({\n    canvas: PropTypes.shape({\n      width: PropTypes.number,\n      height: PropTypes.oneOfType([PropTypes.number, PropTypes.string]),\n      background: PropTypes.string\n    }).isRequired,\n    elements: PropTypes.arrayOf(PropTypes.shape({\n      id: PropTypes.string.isRequired,\n      type: PropTypes.string.isRequired,\n      position: PropTypes.object,\n      size: PropTypes.shape({\n        width: PropTypes.number,\n        height: PropTypes.number\n      }),\n      styles: PropTypes.object,\n      children: PropTypes.array,\n      visible: PropTypes.bool,\n      locked: PropTypes.bool,\n      meta: PropTypes.shape({\n        created_at: PropTypes.string,\n        updated_at: PropTypes.string\n      })\n    })).isRequired,\n    meta: PropTypes.shape({\n      created_at: PropTypes.string,\n      updated_at: PropTypes.string\n    })\n  }).isRequired,\n  selectedIds: PropTypes.arrayOf(PropTypes.string).isRequired,\n  onSelectElement: PropTypes.func.isRequired,\n  onUpdatePosition: PropTypes.func.isRequired,\n  onUpdateSize: PropTypes.func.isRequired,\n  onDeleteElement: PropTypes.func.isRequired,\n  onAddElement: PropTypes.func.isRequired,\n  onGroupElements: PropTypes.func.isRequired,\n  viewMode: PropTypes.oneOf(['desktop', 'tablet', 'mobile']).isRequired,\n  zoomLevel: PropTypes.number.isRequired,\n  gridSize: PropTypes.number.isRequired,\n  showGrid: PropTypes.bool.isRequired,\n  onEditElement: PropTypes.func.isRequired,\n  onDuplicateElement: PropTypes.func.isRequired,\n  onMoveElementUp: PropTypes.func.isRequired,\n  onMoveElementDown: PropTypes.func.isRequired,\n  onSelectChild: PropTypes.func.isRequired,\n  selectedChildId: PropTypes.string,\n  onAddChild: PropTypes.func.isRequired,\n  onUpdateChildPosition: PropTypes.func.isRequired,\n  onMoveChild: PropTypes.func.isRequired,\n  guideLine: PropTypes.shape({\n    show: PropTypes.bool,\n    y: PropTypes.number\n  }),\n  onShowAddSectionPopup: PropTypes.func.isRequired,\n  onSaveTemplate: PropTypes.func.isRequired,\n  onToggleVisibility: PropTypes.func.isRequired,\n  onDeleteChild: PropTypes.func.isRequired\n};\nexport default Canvas;\nvar _c, _c2;\n$RefreshReg$(_c, \"Canvas$React.memo\");\n$RefreshReg$(_c2, \"Canvas\");","map":{"version":3,"names":["React","useRef","useCallback","useState","useEffect","useDrop","useHotkeys","toast","PropTypes","Guidelines","SelectionOverlay","Element","ItemTypes","getCanvasPosition","snapToGrid","getElementBounds","renderComponentContent","AddSectionButton","eventController","jsxDEV","_jsxDEV","Fragment","_Fragment","useCanvasDrop","pageData","viewMode","zoomLevel","gridSize","showGrid","onAddElement","onMoveChild","updateCanvasHeight","canvasRef","_s","canvasBounds","width","current","offsetWidth","height","offsetHeight","isOver","dragItem","drop","accept","ELEMENT","CHILD_ELEMENT","hover","item","monitor","clientOffset","getClientOffset","setDragPreview","pos","x","y","snapPoints","getSnapPoints","elements","snapped","Infinity","getItemType","json","id","size","type","componentData","structure","styles","children","sourceElement","find","el","parentId","child","c","childId","newGuidelines","calculateGuidelines","setGuidelines","error","moved","sourceSection","success","newPosition","lastSectionY","filter","reduce","maxY","_el$position","_el$position$viewMode","_el$size","Math","max","position","newElement","Date","now","JSON","parse","stringify","undefined","desktop","tablet","mobile","visible","locked","meta","updated_at","toISOString","collect","getItem","useGuidelines","_s2","guidelines","usePopupManager","selectedIds","onSelectElement","handleSelectElement","_s3","visiblePopups","setVisiblePopups","unsubscribeOpen","subscribe","payload","popupElement","popupId","prev","Set","unsubscribeClose","includes","points","forEach","_el$children","bounds","push","left","top","right","bottom","centerX","centerY","childBounds","_el$children2","abs","vertical","Canvas","_s4","memo","_c","onUpdatePosition","onUpdateSize","onDeleteElement","onGroupElements","onEditElement","onDuplicateElement","onMoveElementUp","onMoveElementDown","onSelectChild","selectedChildId","onAddChild","onUpdateChildPosition","guideLine","onShowAddSectionPopup","onSaveTemplate","onToggleVisibility","onDeleteChild","contextMenu","setContextMenu","dragPreview","showPopup","setShowPopup","guideLinePosition","setGuideLinePosition","ids","ctrlKey","console","selectedElements","popupIds","map","lastSection","_el$position2","_el$position2$viewMod","_el$size2","newHeight","handleContextMenu","handleCanvasClick","e","stopPropagation","target","handleKeyDown","length","preventDefault","step","shiftKey","_element$position$vie5","_element$position$vie6","element","_element$position$vie","_element$position$vie2","_element$position$vie3","_element$position$vie4","newY","key","newX","handleClickOutside","document","addEventListener","removeEventListener","handleClosePopup","renderDragPreview","className","style","transform","fileName","_jsxFileName","lineNumber","columnNumber","renderAddSectionButton","onClick","renderContextMenu","onKeyDown","tabIndex","ref","node","canvas","background","transformOrigin","isSelected","onContextMenu","onClosePopup","show","onResize","_c2","propTypes","shape","number","oneOfType","string","isRequired","arrayOf","object","array","bool","created_at","func","oneOf","$RefreshReg$"],"sources":["F:/landinghub-iconic/apps/web/src/components/create-page/Canvas.js"],"sourcesContent":["import React, { useRef, useCallback, useState, useEffect } from 'react';\r\nimport { useDrop } from 'react-dnd';\r\nimport { useHotkeys } from 'react-hotkeys-hook';\r\nimport { toast } from 'react-toastify';\r\nimport PropTypes from 'prop-types';\r\nimport Guidelines from './Guidelines';\r\nimport SelectionOverlay from './SelectionOverlay';\r\nimport { Element } from './Element';\r\nimport { ItemTypes, getCanvasPosition, snapToGrid, getElementBounds, renderComponentContent } from './helpers';\r\nimport AddSectionButton from './AddSectionButton';\r\nimport eventController from '../../utils/EventController';\r\n\r\n// Custom hook để quản lý drag-and-drop\r\nconst useCanvasDrop = ({ pageData, viewMode, zoomLevel, gridSize, showGrid, onAddElement, onMoveChild, updateCanvasHeight, canvasRef }) => {\r\n    // Tính canvasBounds bên trong useCanvasDrop\r\n    const canvasBounds = {\r\n        width: canvasRef.current ? canvasRef.current.offsetWidth / (zoomLevel / 100) : (viewMode === 'mobile' ? 375 : 1200),\r\n        height: canvasRef.current ? canvasRef.current.offsetHeight / (zoomLevel / 100) : 1000,\r\n    };\r\n\r\n    const [{ isOver, dragItem }, drop] = useDrop({\r\n        accept: [ItemTypes.ELEMENT, ItemTypes.CHILD_ELEMENT],\r\n        hover: (item, monitor) => {\r\n            const clientOffset = monitor.getClientOffset();\r\n            if (!clientOffset || !canvasRef.current) {\r\n                setDragPreview(null);\r\n                return;\r\n            }\r\n            const pos = getCanvasPosition(clientOffset.x, clientOffset.y, canvasRef.current, zoomLevel);\r\n            const snapPoints = getSnapPoints(pageData.elements, canvasBounds, viewMode);\r\n            const snapped = snapToGrid(pos.x, pos.y, showGrid ? gridSize : Infinity, snapPoints);\r\n\r\n            if (monitor.getItemType() === ItemTypes.ELEMENT && item.json) {\r\n                setDragPreview({\r\n                    id: 'preview',\r\n                    x: snapped.x,\r\n                    y: snapped.y,\r\n                    size: item.json.size || { width: viewMode === 'mobile' ? 375 : 1200, height: 400 },\r\n                    type: item.json.type,\r\n                    componentData: item.json.componentData || { structure: 'ladi-standard' },\r\n                    styles: item.json.styles || {},\r\n                    children: item.json.children || [],\r\n                });\r\n            } else if (monitor.getItemType() === ItemTypes.CHILD_ELEMENT) {\r\n                const sourceElement = pageData.elements.find((el) => el.id === item.parentId);\r\n                const child = sourceElement?.children.find((c) => c.id === item.childId);\r\n                if (child) {\r\n                    setDragPreview({\r\n                        id: item.childId,\r\n                        x: snapped.x,\r\n                        y: snapped.y,\r\n                        size: item.size || { width: 200, height: 50 },\r\n                        type: child.type,\r\n                        componentData: child.componentData || {},\r\n                        styles: child.styles || {},\r\n                        children: [],\r\n                    });\r\n                }\r\n            }\r\n\r\n            const newGuidelines = calculateGuidelines(pageData.elements, snapped, viewMode, canvasBounds);\r\n            setGuidelines(newGuidelines);\r\n        },\r\n        drop: (item, monitor) => {\r\n            const clientOffset = monitor.getClientOffset();\r\n            if (!clientOffset || !canvasRef.current) {\r\n                toast.error('Không thể xác định vị trí thả!');\r\n                setDragPreview(null);\r\n                setGuidelines([]);\r\n                return { moved: false };\r\n            }\r\n            const pos = getCanvasPosition(clientOffset.x, clientOffset.y, canvasRef.current, zoomLevel);\r\n            const snapPoints = getSnapPoints(pageData.elements, canvasBounds, viewMode);\r\n            const snapped = snapToGrid(pos.x, pos.y, showGrid ? gridSize : Infinity, snapPoints);\r\n\r\n            if (monitor.getItemType() === ItemTypes.CHILD_ELEMENT) {\r\n                const sourceSection = pageData.elements.find((el) => el.id === item.parentId);\r\n                if (!sourceSection) {\r\n                    toast.error('Không tìm thấy section nguồn!');\r\n                    setDragPreview(null);\r\n                    setGuidelines([]);\r\n                    return { moved: false };\r\n                }\r\n                onMoveChild(item.parentId, item.childId, null, snapped);\r\n                toast.success('Đã di chuyển thành phần con ra canvas!');\r\n                setDragPreview(null);\r\n                setGuidelines([]);\r\n                return { moved: true, newPosition: snapped };\r\n            } else if (monitor.getItemType() === ItemTypes.ELEMENT) {\r\n                if (item.json.type !== 'section' && item.json.type !== 'popup' && item.json.type !== 'modal') {\r\n                    toast.error('Chỉ có thể thả section, popup hoặc modal lên canvas!');\r\n                    setDragPreview(null);\r\n                    setGuidelines([]);\r\n                    return { moved: false };\r\n                }\r\n                const lastSectionY = pageData.elements\r\n                    .filter((el) => el.type === 'section')\r\n                    .reduce((maxY, el) => Math.max(maxY, (el.position?.[viewMode]?.y || 0) + (el.size?.height || 400)), 0);\r\n                const newElement = {\r\n                    id: `${item.json.type}-${Date.now()}`,\r\n                    type: item.json.type,\r\n                    componentData: JSON.parse(JSON.stringify(item.json.componentData || { structure: item.json.type === 'section' ? 'ladi-standard' : undefined })),\r\n                    position: {\r\n                        [viewMode]: { x: item.json.type === 'section' ? 0 : snapped.x, y: item.json.type === 'section' ? lastSectionY + 10 : snapped.y },\r\n                        desktop: { x: item.json.type === 'section' ? 0 : snapped.x, y: item.json.type === 'section' ? lastSectionY + 10 : snapped.y },\r\n                        tablet: { x: item.json.type === 'section' ? 0 : snapped.x, y: item.json.type === 'section' ? lastSectionY + 10 : snapped.y },\r\n                        mobile: { x: item.json.type === 'section' ? 0 : snapped.x, y: item.json.type === 'section' ? lastSectionY + 10 : snapped.y },\r\n                    },\r\n                    size: { ...item.json.size, width: viewMode === 'mobile' ? 375 : item.json.type === 'section' ? 1200 : 600 },\r\n                    styles: JSON.parse(JSON.stringify(item.json.styles || {})),\r\n                    children: JSON.parse(JSON.stringify(item.json.children || [])),\r\n                    visible: true,\r\n                    locked: false,\r\n                    meta: { updated_at: new Date().toISOString() },\r\n                };\r\n                onAddElement(newElement);\r\n                if (item.json.type === 'section') {\r\n                    updateCanvasHeight();\r\n                }\r\n                toast.success(`Đã thêm ${item.json.type} mới!`);\r\n                setDragPreview(null);\r\n                setGuidelines([]);\r\n                return { moved: true, newPosition: { x: item.json.type === 'section' ? 0 : snapped.x, y: item.json.type === 'section' ? lastSectionY + 10 : snapped.y } };\r\n            }\r\n            setDragPreview(null);\r\n            setGuidelines([]);\r\n            return { moved: false };\r\n        },\r\n        collect: (monitor) => ({ isOver: monitor.isOver(), dragItem: monitor.getItem() }),\r\n    }, [pageData.elements, viewMode, zoomLevel, gridSize, showGrid, canvasBounds, onAddElement, onMoveChild, updateCanvasHeight]);\r\n\r\n    return { isOver, dragItem, drop, canvasBounds };\r\n};\r\n\r\n// Custom hook để quản lý guidelines\r\nconst useGuidelines = (pageData, viewMode, canvasBounds) => {\r\n    const [guidelines, setGuidelines] = useState([]);\r\n    return { guidelines, setGuidelines };\r\n};\r\n\r\n// Custom hook để quản lý popups\r\nconst usePopupManager = (pageData, selectedIds, onSelectElement, handleSelectElement) => {\r\n    const [visiblePopups, setVisiblePopups] = useState([]);\r\n\r\n    useEffect(() => {\r\n        const unsubscribeOpen = eventController.subscribe(\"popup-open\", (payload) => {\r\n            const popupElement = pageData.elements.find((el) => el.id === payload.popupId);\r\n            if (!popupElement) {\r\n                toast.error(`Popup \"${payload.popupId}\" not found!`);\r\n                return;\r\n            }\r\n            setVisiblePopups((prev) => [...new Set([...prev, payload.popupId])]);\r\n            onSelectElement([payload.popupId]);\r\n        });\r\n\r\n        const unsubscribeClose = eventController.subscribe(\"popup-close\", (payload) => {\r\n            setVisiblePopups((prev) => prev.filter((popupId) => popupId !== payload.popupId));\r\n            if (selectedIds.includes(payload.popupId)) {\r\n                handleSelectElement([]);\r\n            }\r\n        });\r\n\r\n        return () => {\r\n            unsubscribeOpen();\r\n            unsubscribeClose();\r\n        };\r\n    }, [pageData.elements, onSelectElement, selectedIds, handleSelectElement]);\r\n\r\n    return { visiblePopups, setVisiblePopups };\r\n};\r\n\r\n// Hàm tính toán snap points\r\nconst getSnapPoints = (elements, canvasBounds, viewMode) => {\r\n    const points = [\r\n        { x: 0, y: 0 },\r\n        { x: viewMode === 'mobile' ? 375 : 1200, y: canvasBounds.height },\r\n        { x: (viewMode === 'mobile' ? 375 : 1200) / 2, y: canvasBounds.height / 2 },\r\n    ];\r\n    elements.forEach((el) => {\r\n        const bounds = getElementBounds(el);\r\n        points.push(\r\n            { x: bounds.left, y: bounds.top },\r\n            { x: bounds.right, y: bounds.bottom },\r\n            { x: bounds.centerX, y: bounds.centerY },\r\n            { x: bounds.left, y: bounds.centerY },\r\n            { x: bounds.right, y: bounds.centerY },\r\n            { x: bounds.centerX, y: bounds.top },\r\n            { x: bounds.centerX, y: bounds.bottom }\r\n        );\r\n        el.children?.forEach((child) => {\r\n            const childBounds = getElementBounds(child);\r\n            points.push(\r\n                { x: childBounds.left, y: childBounds.top },\r\n                { x: childBounds.right, y: childBounds.bottom },\r\n                { x: childBounds.centerX, y: childBounds.centerY },\r\n                { x: childBounds.left, y: childBounds.centerY },\r\n                { x: childBounds.right, y: childBounds.centerY },\r\n                { x: childBounds.centerX, y: childBounds.top },\r\n                { x: childBounds.centerX, y: childBounds.bottom }\r\n            );\r\n        });\r\n    });\r\n    return points;\r\n};\r\n\r\n// Hàm tính toán guidelines\r\nconst calculateGuidelines = (elements, snapped, viewMode, canvasBounds) => {\r\n    const newGuidelines = [];\r\n    elements.forEach((el) => {\r\n        const bounds = getElementBounds(el);\r\n        if (Math.abs(snapped.x - bounds.left) < 15) newGuidelines.push({ vertical: true, position: bounds.left });\r\n        if (Math.abs(snapped.x - bounds.right) < 15) newGuidelines.push({ vertical: true, position: bounds.right });\r\n        if (Math.abs(snapped.x - bounds.centerX) < 15) newGuidelines.push({ vertical: true, position: bounds.centerX });\r\n        if (Math.abs(snapped.y - bounds.top) < 15) newGuidelines.push({ vertical: false, position: bounds.top });\r\n        if (Math.abs(snapped.y - bounds.bottom) < 15) newGuidelines.push({ vertical: false, position: bounds.bottom });\r\n        if (Math.abs(snapped.y - bounds.centerY) < 15) newGuidelines.push({ vertical: false, position: bounds.centerY });\r\n        el.children?.forEach((child) => {\r\n            const childBounds = getElementBounds(child);\r\n            if (Math.abs(snapped.x - childBounds.left) < 15) newGuidelines.push({ vertical: true, position: childBounds.left });\r\n            if (Math.abs(snapped.x - childBounds.right) < 15) newGuidelines.push({ vertical: true, position: childBounds.right });\r\n            if (Math.abs(snapped.x - childBounds.centerX) < 15) newGuidelines.push({ vertical: true, position: childBounds.centerX });\r\n            if (Math.abs(snapped.y - childBounds.top) < 15) newGuidelines.push({ vertical: false, position: childBounds.top });\r\n            if (Math.abs(snapped.y - childBounds.bottom) < 15) newGuidelines.push({ vertical: false, position: childBounds.bottom });\r\n            if (Math.abs(snapped.y - childBounds.centerY) < 15) newGuidelines.push({ vertical: false, position: childBounds.centerY });\r\n        });\r\n    });\r\n    if (Math.abs(snapped.x) < 15) newGuidelines.push({ vertical: true, position: 0 });\r\n    if (Math.abs(snapped.x - (viewMode === 'mobile' ? 375 : 1200)) < 15)\r\n        newGuidelines.push({ vertical: true, position: viewMode === 'mobile' ? 375 : 1200 });\r\n    if (Math.abs(snapped.x - (viewMode === 'mobile' ? 375 : 1200) / 2) < 15)\r\n        newGuidelines.push({ vertical: true, position: (viewMode === 'mobile' ? 375 : 1200) / 2 });\r\n    if (Math.abs(snapped.y) < 15) newGuidelines.push({ vertical: false, position: 0 });\r\n    if (Math.abs(snapped.y - canvasBounds.height) < 15) newGuidelines.push({ vertical: false, position: canvasBounds.height });\r\n    if (Math.abs(snapped.y - canvasBounds.height / 2) < 15)\r\n        newGuidelines.push({ vertical: false, position: canvasBounds.height / 2 });\r\n    return newGuidelines;\r\n};\r\n\r\nconst Canvas = React.memo(({\r\n                               pageData,\r\n                               selectedIds,\r\n                               onSelectElement,\r\n                               onUpdatePosition,\r\n                               onUpdateSize,\r\n                               onDeleteElement,\r\n                               onAddElement,\r\n                               onGroupElements,\r\n                               viewMode,\r\n                               zoomLevel,\r\n                               gridSize,\r\n                               showGrid,\r\n                               onEditElement,\r\n                               onDuplicateElement,\r\n                               onMoveElementUp,\r\n                               onMoveElementDown,\r\n                               onSelectChild,\r\n                               selectedChildId,\r\n                               onAddChild,\r\n                               onUpdateChildPosition,\r\n                               onMoveChild,\r\n                               guideLine,\r\n                               onShowAddSectionPopup,\r\n                               onSaveTemplate,\r\n                               onToggleVisibility,\r\n                               onDeleteChild,\r\n                           }) => {\r\n    const canvasRef = useRef(null);\r\n    const [contextMenu, setContextMenu] = useState(null);\r\n    const [dragPreview, setDragPreview] = useState(null);\r\n    const [showPopup, setShowPopup] = useState(false);\r\n    const [guideLinePosition, setGuideLinePosition] = useState(guideLine?.y || 0);\r\n\r\n    const { guidelines, setGuidelines } = useGuidelines(pageData, viewMode, canvasBounds);\r\n    const { visiblePopups, setVisiblePopups } = usePopupManager(pageData, selectedIds, onSelectElement, handleSelectElement);\r\n    const { isOver, dragItem, drop, canvasBounds } = useCanvasDrop({\r\n        pageData,\r\n        viewMode,\r\n        zoomLevel,\r\n        gridSize,\r\n        showGrid,\r\n        onAddElement,\r\n        onMoveChild,\r\n        updateCanvasHeight,\r\n        canvasRef,\r\n    });\r\n\r\n    const handleSelectElement = useCallback((ids, ctrlKey) => {\r\n        if (typeof onSelectElement !== 'function') {\r\n            console.error('onSelectElement is not a function');\r\n            return;\r\n        }\r\n        onSelectElement(ids, ctrlKey);\r\n        const selectedElements = pageData.elements.filter((el) => ids.includes(el.id));\r\n        const popupIds = selectedElements\r\n            .filter((el) => el.type === 'popup' || el.type === 'modal')\r\n            .map((el) => el.id);\r\n        setVisiblePopups(popupIds);\r\n    }, [onSelectElement, pageData.elements, setVisiblePopups]);\r\n\r\n    const updateCanvasHeight = useCallback(() => {\r\n        const lastSection = pageData.elements\r\n            .filter((el) => el.type === 'section')\r\n            .reduce((maxY, el) => Math.max(maxY, (el.position?.[viewMode]?.y || 0) + (el.size?.height || 400)), 0);\r\n        const newHeight = lastSection + 50;\r\n        setGuideLinePosition(lastSection + 10);\r\n        return newHeight;\r\n    }, [pageData.elements, viewMode]);\r\n\r\n    useEffect(() => {\r\n        updateCanvasHeight();\r\n    }, [updateCanvasHeight]);\r\n\r\n    const handleContextMenu = useCallback((id, position) => {\r\n        setContextMenu({ id, position });\r\n    }, []);\r\n\r\n    const handleCanvasClick = useCallback((e) => {\r\n        e.stopPropagation();\r\n        if (e.target === canvasRef.current) {\r\n            handleSelectElement([]);\r\n            onSelectChild(null, null);\r\n            setContextMenu(null);\r\n            setDragPreview(null);\r\n            setVisiblePopups([]);\r\n        }\r\n    }, [handleSelectElement, onSelectChild]);\r\n\r\n    const handleKeyDown = useCallback((e) => {\r\n        if (!selectedIds.length) return;\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        const step = e.shiftKey ? 10 : 1;\r\n        selectedIds.forEach((id) => {\r\n            const element = pageData.elements.find((el) => el.id === id);\r\n            if (element && element.type !== 'section' && element.type !== 'popup' && element.type !== 'modal') {\r\n                const newY = e.key === 'ArrowUp' ? Math.max(0, (element.position[viewMode]?.y || 0) - step) : (element.position[viewMode]?.y || 0) + step;\r\n                const newX = e.key === 'ArrowLeft' ? Math.max(0, (element.position[viewMode]?.x || 0) - step) : (element.position[viewMode]?.x || 0) + step;\r\n                switch (e.key) {\r\n                    case 'ArrowUp':\r\n                    case 'ArrowDown':\r\n                        onUpdatePosition(id, { [viewMode]: { x: element.position[viewMode]?.x || 0, y: newY } }, 'absolute');\r\n                        break;\r\n                    case 'ArrowLeft':\r\n                    case 'ArrowRight':\r\n                        onUpdatePosition(id, { [viewMode]: { x: newX, y: element.position[viewMode]?.y || 0 } }, 'absolute');\r\n                        break;\r\n                    case 'Delete':\r\n                    case 'Backspace':\r\n                        onDeleteElement(id);\r\n                        setVisiblePopups((prev) => prev.filter((popupId) => popupId !== id));\r\n                        break;\r\n                    case 'Escape':\r\n                        handleSelectElement([]);\r\n                        onSelectChild(null, null);\r\n                        setContextMenu(null);\r\n                        setDragPreview(null);\r\n                        setVisiblePopups([]);\r\n                        break;\r\n                    default:\r\n                        break;\r\n                }\r\n            }\r\n        });\r\n    }, [selectedIds, onUpdatePosition, onDeleteElement, handleSelectElement, onSelectChild, viewMode, pageData.elements]);\r\n\r\n    useHotkeys('ctrl+a', (e) => {\r\n        e.preventDefault();\r\n        handleSelectElement(pageData.elements.map((el) => el.id));\r\n    }, [pageData.elements, handleSelectElement]);\r\n\r\n    useHotkeys('ctrl+g', (e) => {\r\n        e.preventDefault();\r\n        if (selectedIds.length > 1) {\r\n            onGroupElements(selectedIds);\r\n        }\r\n    }, [selectedIds, onGroupElements]);\r\n\r\n    useEffect(() => {\r\n        const handleClickOutside = () => {\r\n            setContextMenu(null);\r\n            setDragPreview(null);\r\n            setVisiblePopups([]);\r\n        };\r\n        if (contextMenu || visiblePopups.length > 0) {\r\n            document.addEventListener('click', handleClickOutside);\r\n            return () => document.removeEventListener('click', handleClickOutside);\r\n        }\r\n    }, [contextMenu, visiblePopups]);\r\n\r\n    const handleClosePopup = useCallback((id) => {\r\n        setVisiblePopups((prev) => prev.filter((popupId) => popupId !== id));\r\n        handleSelectElement([]);\r\n    }, [handleSelectElement]);\r\n\r\n    const renderDragPreview = () => {\r\n        if (!dragPreview) return null;\r\n        const { x, y, size, type, componentData, styles, children } = dragPreview;\r\n        return (\r\n            <div className=\"absolute border-2 border-dashed border-blue-500 bg-blue-100/50 pointer-events-none z-[1000] opacity-50\" style={{ transform: `translate(${x}px, ${y}px)`, width: size.width, height: size.height, ...styles }}>\r\n                {renderComponentContent(type, componentData || {}, styles || {}, children || [])}\r\n            </div>\r\n        );\r\n    };\r\n\r\n    const renderAddSectionButton = () => {\r\n        if (pageData.elements.length > 0) return null;\r\n        return (\r\n            <div className=\"absolute left-1/2 top-1/2 transform -translate-x-1/2 -translate-y-1/2 z-[1000]\">\r\n                <button\r\n                    onClick={(e) => {\r\n                        e.stopPropagation();\r\n                        setShowPopup(true);\r\n                        if (typeof onShowAddSectionPopup === 'function') {\r\n                            onShowAddSectionPopup();\r\n                        }\r\n                    }}\r\n                    className=\"px-6 py-3 bg-blue-600 text-white rounded-lg font-semibold cursor-pointer hover:bg-blue-700\"\r\n                >\r\n                    Thêm Section\r\n                </button>\r\n            </div>\r\n        );\r\n    };\r\n\r\n    const renderContextMenu = () => {\r\n        if (!contextMenu) return null;\r\n        return (\r\n            <div className=\"fixed bg-white border border-gray-300 rounded shadow-lg min-w-[120px] z-[10000]\" style={{ left: contextMenu.position.x, top: contextMenu.position.y }}>\r\n                <div className=\"px-3 py-2 cursor-pointer hover:bg-gray-100\" onClick={() => { onDeleteElement(contextMenu.id); setContextMenu(null); setVisiblePopups((prev) => prev.filter((id) => id !== contextMenu.id)); }}>\r\n                    Xóa\r\n                </div>\r\n                <div className=\"px-3 py-2 cursor-pointer hover:bg-gray-100\" onClick={() => { onGroupElements([contextMenu.id]); setContextMenu(null); }}>\r\n                    Nhóm\r\n                </div>\r\n                <div className=\"px-3 py-2 cursor-pointer hover:bg-gray-100\" onClick={() => { onToggleVisibility(contextMenu.id); setContextMenu(null); }}>\r\n                    Ẩn/Hiện\r\n                </div>\r\n            </div>\r\n        );\r\n    };\r\n\r\n    return (\r\n        <div className=\"relative w-full h-screen overflow-y-auto focus:outline-none\" onKeyDown={handleKeyDown} tabIndex={0}>\r\n            <div\r\n                ref={(node) => {\r\n                    canvasRef.current = node;\r\n                    drop(node);\r\n                }}\r\n                className={`relative mx-auto ${viewMode === 'mobile' ? 'w-[375px]' : viewMode === 'tablet' ? 'w-[768px]' : 'w-[1200px]'}`}\r\n                onClick={handleCanvasClick}\r\n                style={{\r\n                    height: pageData.canvas.height ? `${pageData.canvas.height}px` : 'auto',\r\n                    background: pageData.canvas.background,\r\n                    transform: `scale(${zoomLevel / 100})`,\r\n                    transformOrigin: 'top center',\r\n                }}\r\n            >\r\n                <Guidelines guidelines={guidelines} zoomLevel={zoomLevel} />\r\n                {pageData.elements.map((element) => (\r\n                    <Element\r\n                        key={element.id}\r\n                        element={element}\r\n                        isSelected={selectedIds.includes(element.id)}\r\n                        onSelectElement={handleSelectElement}\r\n                        onUpdatePosition={onUpdatePosition}\r\n                        viewMode={viewMode}\r\n                        zoomLevel={zoomLevel}\r\n                        gridSize={gridSize}\r\n                        onContextMenu={handleContextMenu}\r\n                        canvasBounds={canvasBounds}\r\n                        canvasRef={canvasRef}\r\n                        onSelectChild={onSelectChild}\r\n                        selectedChildId={selectedChildId}\r\n                        onAddChild={onAddChild}\r\n                        onUpdateChildPosition={onUpdateChildPosition}\r\n                        onMoveChild={onMoveChild}\r\n                        showGrid={showGrid}\r\n                        setDragPreview={setDragPreview}\r\n                        visiblePopups={visiblePopups}\r\n                        onClosePopup={handleClosePopup}\r\n                        onSaveTemplate={onSaveTemplate}\r\n                        onToggleVisibility={onToggleVisibility}\r\n                        onEditElement={onEditElement}\r\n                        onDuplicateElement={onDuplicateElement}\r\n                        onMoveElementUp={onMoveElementUp}\r\n                        onMoveElementDown={onMoveElementDown}\r\n                        onDeleteElement={onDeleteElement}\r\n                        onDeleteChild={onDeleteChild}\r\n                    />\r\n                ))}\r\n                {renderDragPreview()}\r\n                {guideLine?.show && (\r\n                    <>\r\n                        <div className=\"absolute left-1/2 transform -translate-x-1/2 w-full h-px bg-blue-500 opacity-50 z-[1001]\" style={{ top: guideLinePosition }} />\r\n                        {pageData.elements.length > 0 && (\r\n                            <AddSectionButton guideLinePosition={guideLinePosition} setShowPopup={setShowPopup} onShowAddSectionPopup={onShowAddSectionPopup} />\r\n                        )}\r\n                        <div className=\"absolute top-0 w-px h-full bg-blue-500 opacity-50 z-[1001]\" style={{ left: viewMode === 'mobile' ? 'calc(50% - 187.5px)' : 'calc(50% - 600px)' }} />\r\n                        <div className=\"absolute top-0 w-px h-full bg-blue-500 opacity-50 z-[1001]\" style={{ left: viewMode === 'mobile' ? 'calc(50% + 187.5px)' : 'calc(50% + 600px)' }} />\r\n                    </>\r\n                )}\r\n                <SelectionOverlay\r\n                    selectedElements={pageData.elements.filter((el) => selectedIds.includes(el.id))}\r\n                    onResize={onUpdateSize}\r\n                    zoomLevel={zoomLevel}\r\n                />\r\n                {renderContextMenu()}\r\n                {renderAddSectionButton()}\r\n            </div>\r\n        </div>\r\n    );\r\n});\r\n\r\nCanvas.propTypes = {\r\n    pageData: PropTypes.shape({\r\n        canvas: PropTypes.shape({\r\n            width: PropTypes.number,\r\n            height: PropTypes.oneOfType([PropTypes.number, PropTypes.string]),\r\n            background: PropTypes.string,\r\n        }).isRequired,\r\n        elements: PropTypes.arrayOf(PropTypes.shape({\r\n            id: PropTypes.string.isRequired,\r\n            type: PropTypes.string.isRequired,\r\n            position: PropTypes.object,\r\n            size: PropTypes.shape({\r\n                width: PropTypes.number,\r\n                height: PropTypes.number,\r\n            }),\r\n            styles: PropTypes.object,\r\n            children: PropTypes.array,\r\n            visible: PropTypes.bool,\r\n            locked: PropTypes.bool,\r\n            meta: PropTypes.shape({\r\n                created_at: PropTypes.string,\r\n                updated_at: PropTypes.string,\r\n            }),\r\n        })).isRequired,\r\n        meta: PropTypes.shape({\r\n            created_at: PropTypes.string,\r\n            updated_at: PropTypes.string,\r\n        }),\r\n    }).isRequired,\r\n    selectedIds: PropTypes.arrayOf(PropTypes.string).isRequired,\r\n    onSelectElement: PropTypes.func.isRequired,\r\n    onUpdatePosition: PropTypes.func.isRequired,\r\n    onUpdateSize: PropTypes.func.isRequired,\r\n    onDeleteElement: PropTypes.func.isRequired,\r\n    onAddElement: PropTypes.func.isRequired,\r\n    onGroupElements: PropTypes.func.isRequired,\r\n    viewMode: PropTypes.oneOf(['desktop', 'tablet', 'mobile']).isRequired,\r\n    zoomLevel: PropTypes.number.isRequired,\r\n    gridSize: PropTypes.number.isRequired,\r\n    showGrid: PropTypes.bool.isRequired,\r\n    onEditElement: PropTypes.func.isRequired,\r\n    onDuplicateElement: PropTypes.func.isRequired,\r\n    onMoveElementUp: PropTypes.func.isRequired,\r\n    onMoveElementDown: PropTypes.func.isRequired,\r\n    onSelectChild: PropTypes.func.isRequired,\r\n    selectedChildId: PropTypes.string,\r\n    onAddChild: PropTypes.func.isRequired,\r\n    onUpdateChildPosition: PropTypes.func.isRequired,\r\n    onMoveChild: PropTypes.func.isRequired,\r\n    guideLine: PropTypes.shape({\r\n        show: PropTypes.bool,\r\n        y: PropTypes.number,\r\n    }),\r\n    onShowAddSectionPopup: PropTypes.func.isRequired,\r\n    onSaveTemplate: PropTypes.func.isRequired,\r\n    onToggleVisibility: PropTypes.func.isRequired,\r\n    onDeleteChild: PropTypes.func.isRequired,\r\n};\r\n\r\nexport default Canvas;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}