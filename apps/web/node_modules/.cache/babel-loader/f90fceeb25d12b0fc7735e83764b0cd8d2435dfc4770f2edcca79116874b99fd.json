{"ast":null,"code":"// web/src/utils/pageUtils.js\n\nimport { renderComponentContent } from '../components/create-page/helpers'; // Import renderComponentContent từ helpers.js để đồng bộ\n\nexport const CSS_VARIABLES = {\n  '--canvas-desktop': '1200px',\n  '--canvas-mobile': '375px',\n  '--white': '#ffffff',\n  '--border-radius': '8px',\n  '--border-radius-lg': '12px',\n  '--shadow': '0 4px 6px -1px rgba(0, 0, 0, 0.1)',\n  '--shadow-lg': '0 10px 15px -3px rgba(0, 0, 0, 0.1)',\n  '--primary-color': '#2563eb',\n  '--text-primary': '#1f2937',\n  '--text-secondary': '#4b5563',\n  '--transition': 'all 0.3s ease',\n  '--overlay-bg': 'rgba(0, 0, 0, 0.5)'\n};\n\n// Hàm parse style từ chuỗi\nconst parseStyles = styleString => {\n  const styles = {};\n  if (styleString) {\n    styleString.split(';').forEach(style => {\n      const [key, value] = style.split(':').map(s => s.trim());\n      if (key && value) {\n        styles[key] = value;\n      }\n    });\n  }\n  return styles;\n};\n\n// Hàm parse data attribute\nconst parseDataAttribute = (element, attr) => {\n  try {\n    const data = element.getAttribute(attr);\n    return data ? JSON.parse(data) : {};\n  } catch (error) {\n    console.error(`Error parsing ${attr}:`, error);\n    return {};\n  }\n};\n\n// Parse HTML to pageData\nexport const parseHTMLToPageData = html => {\n  try {\n    const parser = new DOMParser();\n    const doc = parser.parseFromString(html, 'text/html');\n    const canvasElement = doc.querySelector('.lpb-canvas');\n    if (!canvasElement) {\n      return {\n        canvas: {\n          width: parseInt(CSS_VARIABLES['--canvas-desktop']),\n          background: CSS_VARIABLES['--white']\n        },\n        elements: [],\n        visiblePopups: []\n      };\n    }\n    const elements = [];\n    const visiblePopups = [];\n    const canvasStyles = getComputedStyle(canvasElement);\n    const canvas = {\n      width: parseInt(canvasStyles.width) || parseInt(CSS_VARIABLES['--canvas-desktop']),\n      height: parseInt(canvasStyles.height) || 1000,\n      background: canvasStyles.backgroundColor || CSS_VARIABLES['--white']\n    };\n    const parseElement = (el, parentId = null) => {\n      const element = {\n        id: el.id || `element-${Date.now()}`,\n        type: el.dataset.type || 'section',\n        componentData: parseDataAttribute(el, 'data-component-data'),\n        position: {\n          desktop: {\n            x: parseFloat(el.style.left) || 0,\n            y: parseFloat(el.style.top) || 0\n          },\n          tablet: {\n            x: 0,\n            y: 0\n          },\n          mobile: {\n            x: 0,\n            y: 0\n          }\n        },\n        size: {\n          width: parseInt(el.style.width) || el.offsetWidth || 1200,\n          height: parseInt(el.style.height) || el.offsetHeight || 400\n        },\n        styles: {\n          backgroundColor: el.style.backgroundColor || '',\n          borderRadius: el.style.borderRadius || '',\n          boxShadow: el.style.boxShadow || '',\n          margin: el.style.margin || '0',\n          padding: el.style.padding || '0',\n          zIndex: parseInt(el.style.zIndex) || 1,\n          ':hover': el.dataset.hoverStyles ? JSON.parse(el.dataset.hoverStyles) : {},\n          ':active': el.dataset.activeStyles ? JSON.parse(el.dataset.activeStyles) : {},\n          transition: el.style.transition || CSS_VARIABLES['--transition']\n        },\n        visible: el.style.display !== 'none',\n        locked: el.dataset.locked === 'true',\n        children: []\n      };\n      if (element.type === 'popup' || element.type === 'modal') {\n        if (element.visible) visiblePopups.push(element.id);\n      }\n      const childElements = el.querySelectorAll(':scope > [data-type]');\n      childElements.forEach(child => {\n        element.children.push(parseElement(child, element.id));\n      });\n      return element;\n    };\n    const rootElements = doc.querySelectorAll('.lpb-canvas > [data-type]');\n    rootElements.forEach(el => {\n      elements.push(parseElement(el));\n    });\n    return {\n      canvas,\n      elements,\n      visiblePopups\n    };\n  } catch (error) {\n    console.error('Error parsing HTML to page data:', error);\n    return {\n      canvas: {\n        width: parseInt(CSS_VARIABLES['--canvas-desktop']),\n        background: CSS_VARIABLES['--white']\n      },\n      elements: [],\n      visiblePopups: []\n    };\n  }\n};\n\n// Hàm xử lý style cho pseudo-classes và keyframes\nconst processStyles = (styles, uniqueClass) => {\n  let css = '';\n  if (styles[':hover']) {\n    css += `.${uniqueClass}:hover {`;\n    Object.entries(styles[':hover']).forEach(([key, value]) => {\n      css += `${key}: ${value};`;\n    });\n    css += '}';\n  }\n  if (styles[':active']) {\n    css += `.${uniqueClass}:active {`;\n    Object.entries(styles[':active']).forEach(([key, value]) => {\n      css += `${key}: ${value};`;\n    });\n    css += '}';\n  }\n  if (styles.animation) {\n    const animationName = `anim-${uniqueClass}`;\n    css += `@keyframes ${animationName} {${styles.animation.keyframes || ''}}`;\n    css += `.${uniqueClass} { animation: ${animationName} ${styles.animation.duration || '1s'} ${styles.animation.timing || 'ease'} ${styles.animation.delay || '0s'}; }`;\n  }\n  return css;\n};\n\n// Render static HTML\nexport const renderStaticHTML = (pageData, viewMode = 'desktop') => {\n  try {\n    const {\n      canvas,\n      elements,\n      visiblePopups\n    } = pageData;\n    const canvasWidth = viewMode === 'mobile' ? parseInt(CSS_VARIABLES['--canvas-mobile']) : parseInt(CSS_VARIABLES['--canvas-desktop']);\n    const canvasHeight = canvas.height || 1000;\n\n    // Tính chiều cao canvas dựa trên section\n    const calculatedHeight = elements.filter(el => el.type === 'section').reduce((maxY, el) => {\n      var _el$position, _el$position$viewMode, _el$size;\n      const y = ((_el$position = el.position) === null || _el$position === void 0 ? void 0 : (_el$position$viewMode = _el$position[viewMode]) === null || _el$position$viewMode === void 0 ? void 0 : _el$position$viewMode.y) || 0;\n      const height = ((_el$size = el.size) === null || _el$size === void 0 ? void 0 : _el$size.height) || 400;\n      return Math.max(maxY, y + height);\n    }, canvasHeight);\n\n    // Base HTML structure\n    let html = `\n<!DOCTYPE html>\n<html lang=\"vi\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Landing Page Preview</title>\n    <style>\n        :root {\n            --canvas-desktop: ${CSS_VARIABLES['--canvas-desktop']};\n            --canvas-mobile: ${CSS_VARIABLES['--canvas-mobile']};\n            --white: ${CSS_VARIABLES['--white']};\n            --border-radius: ${CSS_VARIABLES['--border-radius']};\n            --border-radius-lg: ${CSS_VARIABLES['--border-radius-lg']};\n            --shadow: ${CSS_VARIABLES['--shadow']};\n            --shadow-lg: ${CSS_VARIABLES['--shadow-lg']};\n            --primary-color: ${CSS_VARIABLES['--primary-color']};\n            --text-primary: ${CSS_VARIABLES['--text-primary']};\n            --text-secondary: ${CSS_VARIABLES['--text-secondary']};\n            --transition: ${CSS_VARIABLES['--transition']};\n            --overlay-bg: ${CSS_VARIABLES['--overlay-bg']};\n        }\n        body { \n            margin: 0; \n            padding: 0; \n            font-family: 'Inter', Arial, sans-serif; \n            background: var(--white); \n        }\n        .lpb-canvas { \n            position: relative; \n            width: ${canvasWidth}px; \n            min-height: ${calculatedHeight}px; \n            background: ${canvas.background || 'var(--white)'}; \n            margin: 0 auto; \n            overflow: hidden; \n        }\n        .lpb-element { \n            position: absolute; \n            box-sizing: border-box; \n        }\n        .lpb-child-element { \n            position: absolute; \n            box-sizing: border-box; \n        }\n        .lpb-section { \n            width: 100%; \n        }\n        .lpb-popup, .lpb-modal { \n            display: none; \n            position: fixed; \n            top: 50%; \n            left: 50%; \n            transform: translate(-50%, -50%); \n            z-index: 9999; \n            background: var(--white); \n            border-radius: var(--border-radius-lg); \n            box-shadow: var(--shadow-lg); \n        }\n        .lpb-popup.visible, .lpb-modal.visible { \n            display: block; \n        }\n        .lpb-popup-overlay { \n            position: fixed; \n            top: 0; \n            left: 0; \n            right: 0; \n            bottom: 0; \n            background: var(--overlay-bg); \n            z-index: -1; \n        }\n        .lpb-heading { \n            font-size: 2rem; \n            font-weight: bold; \n            color: var(--text-primary); \n        }\n        .lpb-paragraph { \n            font-size: 1rem; \n            line-height: 1.6; \n            color: var(--text-secondary); \n        }\n        .lpb-button { \n            padding: 10px 20px; \n            background: var(--primary-color); \n            color: white; \n            border: none; \n            border-radius: var(--border-radius); \n            cursor: pointer; \n            transition: var(--transition); \n            font-size: 1rem; \n            font-weight: 600; \n        }\n        .lpb-button:hover { \n            background: #1e40af; \n            transform: translateY(-2px); \n        }\n        .lpb-button:active { \n            transform: translateY(0); \n        }\n        .lpb-image { \n            object-fit: cover; \n            max-width: 100%; \n            height: auto; \n        }\n        .lpb-icon { \n            font-size: 24px; \n            display: flex; \n            align-items: center; \n            justify-content: center; \n        }\n        .lpb-gallery { \n            display: grid; \n            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); \n            gap: 10px; \n        }\n        .lpb-gallery img { \n            width: 100%; \n            height: 100%; \n            object-fit: cover; \n            border-radius: var(--border-radius); \n            transition: var(--transition); \n        }\n        .lpb-gallery img:hover { \n            transform: scale(1.05); \n        }\n        .lpb-form { \n            display: flex; \n            flex-direction: column; \n            gap: 10px; \n        }\n        .lpb-form input { \n            padding: 8px; \n            border: 1px solid #e5e7eb; \n            border-radius: var(--border-radius); \n            font-size: 1rem; \n        }\n        .lpb-divider { \n            border: none; \n            height: 2px; \n            background: #e5e7eb; \n        }\n        .lpb-spacer { \n            width: 100%; \n        }\n        .lpb-card { \n            padding: 20px; \n            background: var(--white); \n            border-radius: var(--border-radius); \n            box-shadow: var(--shadow); \n        }\n        .lpb-grid { \n            display: grid; \n            grid-template-columns: repeat(2, 1fr); \n            gap: 20px; \n        }\n        .lpb-list { \n            list-style-type: none; \n            padding: 0; \n        }\n        @media (max-width: 768px) {\n            .lpb-canvas { \n                width: 100%; \n            }\n            .lpb-element, .lpb-child-element { \n                width: 100% !important; \n                left: 0 !important; \n            }\n            .lpb-grid { \n                grid-template-columns: 1fr; \n            }\n        }\n    </style>\n    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css\" crossorigin=\"anonymous\" referrerpolicy=\"no-referrer\">\n    <script>\n        window.LPB = {\n            openPopup(popupId) {\n                const popup = document.getElementById(popupId);\n                if (popup) {\n                    popup.classList.add('visible');\n                    document.body.style.overflow = 'hidden';\n                }\n            },\n            closePopup(popupId) {\n                const popup = document.getElementById(popupId);\n                if (popup) {\n                    popup.classList.remove('visible');\n                    document.body.style.overflow = '';\n                }\n            },\n            handleButtonClick(eventType, data, elementId) {\n                switch (eventType) {\n                    case 'navigate':\n                        if (data.newTab) {\n                            window.open(data.url, '_blank');\n                        } else {\n                            window.location.href = data.url;\n                        }\n                        break;\n                    case 'triggerApi':\n                        console.log('Trigger API:', data.apiUrl);\n                        fetch(data.apiUrl)\n                            .then(response => response.json())\n                            .then(data => console.log('API Data:', data))\n                            .catch(err => console.error('API Error:', err));\n                        break;\n                    case 'submitForm':\n                        console.log('Submit form to:', data.apiUrl);\n                        fetch(data.apiUrl, { method: 'POST' })\n                            .then(() => alert('Form submitted!'))\n                            .catch(err => console.error('Form Error:', err));\n                        break;\n                    case 'popup':\n                        this.openPopup(data.popupId);\n                        break;\n                    case 'scrollToSection':\n                        const section = document.getElementById(data.sectionId);\n                        if (section) {\n                            section.scrollIntoView({ behavior: data.smooth ? 'smooth' : 'auto' });\n                        }\n                        break;\n                }\n            },\n            handleGalleryClick(imageUrl, index) {\n                console.log('Open lightbox for image:', imageUrl, 'at index:', index);\n                \n            },\n            handleIconClick(eventType, data, elementId) {\n                this.handleButtonClick(eventType, data, elementId);\n            }\n        };\n        document.addEventListener('DOMContentLoaded', () => {\n            document.querySelectorAll('.lpb-popup').forEach(popup => {\n                const popupId = popup.id;\n                const closeBtn = popup.querySelector('.lpb-popup-close');\n                if (closeBtn) {\n                    closeBtn.addEventListener('click', () => window.LPB.closePopup(popupId));\n                }\n            });\n        });\n    </script>\n</head>\n<body>\n    <div class=\"lpb-canvas\">\n`;\n\n    // Render elements\n    elements.forEach(element => {\n      var _position$viewMode, _position$viewMode2;\n      const {\n        id,\n        type,\n        position,\n        size,\n        styles,\n        componentData,\n        children,\n        visible,\n        locked\n      } = element;\n      const isPopup = type === 'popup' || type === 'modal';\n      const isVisible = visible && (!isPopup || visiblePopups.includes(id));\n      const uniqueClass = `element-${id}`;\n      const elementStyles = `\n                left: ${((_position$viewMode = position[viewMode]) === null || _position$viewMode === void 0 ? void 0 : _position$viewMode.x) || 0}px;\n                top: ${((_position$viewMode2 = position[viewMode]) === null || _position$viewMode2 === void 0 ? void 0 : _position$viewMode2.y) || 0}px;\n                width: ${size.width}px;\n                height: ${size.height}px;\n                ${styles.backgroundColor ? `background-color: ${styles.backgroundColor};` : ''}\n                ${styles.borderRadius ? `border-radius: ${styles.borderRadius};` : ''}\n                ${styles.boxShadow ? `box-shadow: ${styles.boxShadow};` : ''}\n                ${styles.margin ? `margin: ${styles.margin};` : ''}\n                ${styles.padding ? `padding: ${styles.padding};` : ''}\n                z-index: ${styles.zIndex || 1};\n                ${locked ? 'pointer-events: none;' : ''}\n                ${styles.display ? `display: ${styles.display};` : ''}\n                ${styles.alignItems ? `align-items: ${styles.alignItems};` : ''}\n                ${styles.justifyContent ? `justify-content: ${styles.justifyContent};` : ''}\n                ${styles.transition ? `transition: ${styles.transition};` : ''}\n            `.trim();\n\n      // Generate CSS for pseudo-classes and keyframes\n      const cssStyles = processStyles(styles, uniqueClass);\n\n      // Sử dụng renderComponentContent từ helpers.js để đảm bảo đồng bộ với canvas\n      let content = renderComponentContent(type, componentData, styles, children);\n\n      // Ghi đè content cho một số loại đặc biệt\n      if (type === 'section') {\n        content = `\n                    <div class=\"ladi-section-background\" style=\"background-color: ${componentData.backgroundColor || 'transparent'}; background-image: ${componentData.backgroundImage ? `url(${componentData.backgroundImage})` : 'none'}; background-size: cover; background-position: center; position: absolute; top: 0; left: 0; right: 0; bottom: 0; z-index: 0;\"></div>\n                    <div class=\"ladi-overlay\" style=\"background-color: ${componentData.overlayColor || 'transparent'}; opacity: ${componentData.overlayOpacity || 0}; position: absolute; top: 0; left: 0; right: 0; bottom: 0; z-index: 0;\"></div>\n                    <div class=\"ladi-container\" style=\"position: relative; z-index: 1; padding: ${componentData.padding || '20px'}; width: 100%; height: 100%;\">\n                        ${content}\n                    </div>\n                `;\n      } else if (type === 'popup' || type === 'modal') {\n        content = `\n                    <div class=\"lpb-popup-overlay\" onclick=\"LPB.closePopup('${id}')\"></div>\n                    <div class=\"lpb-popup-content\" style=\"padding: ${componentData.padding || '20px'}; max-width: 600px; max-height: 80vh; overflow-y: auto;\">\n                        ${content}\n                        <button class=\"lpb-popup-close\" style=\"position: absolute; top: 10px; right: 10px; background: none; border: none; font-size: 1.2rem; cursor: pointer;\">✕</button>\n                    </div>\n                `;\n      }\n\n      // Thêm style và content vào HTML\n      html += `\n        <style>${cssStyles}</style>\n        <div id=\"${id}\" class=\"lpb-element lpb-${type} ${uniqueClass} ${isVisible && !isPopup ? 'visible' : ''}\" data-type=\"${type}\" data-component-data='${JSON.stringify(componentData)}' style=\"${elementStyles}\">\n            ${content}\n        </div>\n            `;\n\n      // Render popup riêng\n      if (isPopup) {\n        html += `\n        <style>${cssStyles}</style>\n        <div id=\"${id}\" class=\"lpb-popup ${uniqueClass} ${isVisible ? 'visible' : ''}\" data-type=\"${type}\" data-component-data='${JSON.stringify(componentData)}' style=\"${elementStyles}\">\n            ${content}\n        </div>\n                `;\n      }\n    });\n    html += `\n    </div>\n</body>\n</html>\n        `;\n    return html;\n  } catch (error) {\n    console.error('Error rendering static HTML:', error);\n    return `\n<!DOCTYPE html>\n<html lang=\"vi\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Error</title>\n</head>\n<body>\n    <div style=\"color: red; padding: 20px;\">Error rendering page: ${error.message}</div>\n</body>\n</html>\n        `;\n  }\n};","map":{"version":3,"names":["renderComponentContent","CSS_VARIABLES","parseStyles","styleString","styles","split","forEach","style","key","value","map","s","trim","parseDataAttribute","element","attr","data","getAttribute","JSON","parse","error","console","parseHTMLToPageData","html","parser","DOMParser","doc","parseFromString","canvasElement","querySelector","canvas","width","parseInt","background","elements","visiblePopups","canvasStyles","getComputedStyle","height","backgroundColor","parseElement","el","parentId","id","Date","now","type","dataset","componentData","position","desktop","x","parseFloat","left","y","top","tablet","mobile","size","offsetWidth","offsetHeight","borderRadius","boxShadow","margin","padding","zIndex","hoverStyles","activeStyles","transition","visible","display","locked","children","push","childElements","querySelectorAll","child","rootElements","processStyles","uniqueClass","css","Object","entries","animation","animationName","keyframes","duration","timing","delay","renderStaticHTML","pageData","viewMode","canvasWidth","canvasHeight","calculatedHeight","filter","reduce","maxY","_el$position","_el$position$viewMode","_el$size","Math","max","_position$viewMode","_position$viewMode2","isPopup","isVisible","includes","elementStyles","alignItems","justifyContent","cssStyles","content","backgroundImage","overlayColor","overlayOpacity","stringify","message"],"sources":["F:/landinghub-iconic/apps/web/src/utils/pageUtils.js"],"sourcesContent":["// web/src/utils/pageUtils.js\r\n\r\nimport { renderComponentContent } from '../components/create-page/helpers'; // Import renderComponentContent từ helpers.js để đồng bộ\r\n\r\nexport const CSS_VARIABLES = {\r\n    '--canvas-desktop': '1200px',\r\n    '--canvas-mobile': '375px',\r\n    '--white': '#ffffff',\r\n    '--border-radius': '8px',\r\n    '--border-radius-lg': '12px',\r\n    '--shadow': '0 4px 6px -1px rgba(0, 0, 0, 0.1)',\r\n    '--shadow-lg': '0 10px 15px -3px rgba(0, 0, 0, 0.1)',\r\n    '--primary-color': '#2563eb',\r\n    '--text-primary': '#1f2937',\r\n    '--text-secondary': '#4b5563',\r\n    '--transition': 'all 0.3s ease',\r\n    '--overlay-bg': 'rgba(0, 0, 0, 0.5)',\r\n};\r\n\r\n// Hàm parse style từ chuỗi\r\nconst parseStyles = (styleString) => {\r\n    const styles = {};\r\n    if (styleString) {\r\n        styleString.split(';').forEach((style) => {\r\n            const [key, value] = style.split(':').map(s => s.trim());\r\n            if (key && value) {\r\n                styles[key] = value;\r\n            }\r\n        });\r\n    }\r\n    return styles;\r\n};\r\n\r\n// Hàm parse data attribute\r\nconst parseDataAttribute = (element, attr) => {\r\n    try {\r\n        const data = element.getAttribute(attr);\r\n        return data ? JSON.parse(data) : {};\r\n    } catch (error) {\r\n        console.error(`Error parsing ${attr}:`, error);\r\n        return {};\r\n    }\r\n};\r\n\r\n// Parse HTML to pageData\r\nexport const parseHTMLToPageData = (html) => {\r\n    try {\r\n        const parser = new DOMParser();\r\n        const doc = parser.parseFromString(html, 'text/html');\r\n        const canvasElement = doc.querySelector('.lpb-canvas');\r\n        if (!canvasElement) {\r\n            return {\r\n                canvas: {\r\n                    width: parseInt(CSS_VARIABLES['--canvas-desktop']),\r\n                    background: CSS_VARIABLES['--white'],\r\n                },\r\n                elements: [],\r\n                visiblePopups: [],\r\n            };\r\n        }\r\n\r\n        const elements = [];\r\n        const visiblePopups = [];\r\n        const canvasStyles = getComputedStyle(canvasElement);\r\n        const canvas = {\r\n            width: parseInt(canvasStyles.width) || parseInt(CSS_VARIABLES['--canvas-desktop']),\r\n            height: parseInt(canvasStyles.height) || 1000,\r\n            background: canvasStyles.backgroundColor || CSS_VARIABLES['--white'],\r\n        };\r\n\r\n        const parseElement = (el, parentId = null) => {\r\n            const element = {\r\n                id: el.id || `element-${Date.now()}`,\r\n                type: el.dataset.type || 'section',\r\n                componentData: parseDataAttribute(el, 'data-component-data'),\r\n                position: {\r\n                    desktop: {\r\n                        x: parseFloat(el.style.left) || 0,\r\n                        y: parseFloat(el.style.top) || 0,\r\n                    },\r\n                    tablet: { x: 0, y: 0 },\r\n                    mobile: { x: 0, y: 0 },\r\n                },\r\n                size: {\r\n                    width: parseInt(el.style.width) || el.offsetWidth || 1200,\r\n                    height: parseInt(el.style.height) || el.offsetHeight || 400,\r\n                },\r\n                styles: {\r\n                    backgroundColor: el.style.backgroundColor || '',\r\n                    borderRadius: el.style.borderRadius || '',\r\n                    boxShadow: el.style.boxShadow || '',\r\n                    margin: el.style.margin || '0',\r\n                    padding: el.style.padding || '0',\r\n                    zIndex: parseInt(el.style.zIndex) || 1,\r\n                    ':hover': el.dataset.hoverStyles ? JSON.parse(el.dataset.hoverStyles) : {},\r\n                    ':active': el.dataset.activeStyles ? JSON.parse(el.dataset.activeStyles) : {},\r\n                    transition: el.style.transition || CSS_VARIABLES['--transition'],\r\n                },\r\n                visible: el.style.display !== 'none',\r\n                locked: el.dataset.locked === 'true',\r\n                children: [],\r\n            };\r\n\r\n            if (element.type === 'popup' || element.type === 'modal') {\r\n                if (element.visible) visiblePopups.push(element.id);\r\n            }\r\n\r\n            const childElements = el.querySelectorAll(':scope > [data-type]');\r\n            childElements.forEach((child) => {\r\n                element.children.push(parseElement(child, element.id));\r\n            });\r\n\r\n            return element;\r\n        };\r\n\r\n        const rootElements = doc.querySelectorAll('.lpb-canvas > [data-type]');\r\n        rootElements.forEach((el) => {\r\n            elements.push(parseElement(el));\r\n        });\r\n\r\n        return { canvas, elements, visiblePopups };\r\n    } catch (error) {\r\n        console.error('Error parsing HTML to page data:', error);\r\n        return {\r\n            canvas: {\r\n                width: parseInt(CSS_VARIABLES['--canvas-desktop']),\r\n                background: CSS_VARIABLES['--white'],\r\n            },\r\n            elements: [],\r\n            visiblePopups: [],\r\n        };\r\n    }\r\n};\r\n\r\n// Hàm xử lý style cho pseudo-classes và keyframes\r\nconst processStyles = (styles, uniqueClass) => {\r\n    let css = '';\r\n    if (styles[':hover']) {\r\n        css += `.${uniqueClass}:hover {`;\r\n        Object.entries(styles[':hover']).forEach(([key, value]) => {\r\n            css += `${key}: ${value};`;\r\n        });\r\n        css += '}';\r\n    }\r\n    if (styles[':active']) {\r\n        css += `.${uniqueClass}:active {`;\r\n        Object.entries(styles[':active']).forEach(([key, value]) => {\r\n            css += `${key}: ${value};`;\r\n        });\r\n        css += '}';\r\n    }\r\n    if (styles.animation) {\r\n        const animationName = `anim-${uniqueClass}`;\r\n        css += `@keyframes ${animationName} {${styles.animation.keyframes || ''}}`;\r\n        css += `.${uniqueClass} { animation: ${animationName} ${styles.animation.duration || '1s'} ${styles.animation.timing || 'ease'} ${styles.animation.delay || '0s'}; }`;\r\n    }\r\n    return css;\r\n};\r\n\r\n// Render static HTML\r\nexport const renderStaticHTML = (pageData, viewMode = 'desktop') => {\r\n    try {\r\n        const { canvas, elements, visiblePopups } = pageData;\r\n        const canvasWidth = viewMode === 'mobile' ? parseInt(CSS_VARIABLES['--canvas-mobile']) : parseInt(CSS_VARIABLES['--canvas-desktop']);\r\n        const canvasHeight = canvas.height || 1000;\r\n\r\n        // Tính chiều cao canvas dựa trên section\r\n        const calculatedHeight = elements\r\n            .filter((el) => el.type === 'section')\r\n            .reduce((maxY, el) => {\r\n                const y = el.position?.[viewMode]?.y || 0;\r\n                const height = el.size?.height || 400;\r\n                return Math.max(maxY, y + height);\r\n            }, canvasHeight);\r\n\r\n        // Base HTML structure\r\n        let html = `\r\n<!DOCTYPE html>\r\n<html lang=\"vi\">\r\n<head>\r\n    <meta charset=\"UTF-8\">\r\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n    <title>Landing Page Preview</title>\r\n    <style>\r\n        :root {\r\n            --canvas-desktop: ${CSS_VARIABLES['--canvas-desktop']};\r\n            --canvas-mobile: ${CSS_VARIABLES['--canvas-mobile']};\r\n            --white: ${CSS_VARIABLES['--white']};\r\n            --border-radius: ${CSS_VARIABLES['--border-radius']};\r\n            --border-radius-lg: ${CSS_VARIABLES['--border-radius-lg']};\r\n            --shadow: ${CSS_VARIABLES['--shadow']};\r\n            --shadow-lg: ${CSS_VARIABLES['--shadow-lg']};\r\n            --primary-color: ${CSS_VARIABLES['--primary-color']};\r\n            --text-primary: ${CSS_VARIABLES['--text-primary']};\r\n            --text-secondary: ${CSS_VARIABLES['--text-secondary']};\r\n            --transition: ${CSS_VARIABLES['--transition']};\r\n            --overlay-bg: ${CSS_VARIABLES['--overlay-bg']};\r\n        }\r\n        body { \r\n            margin: 0; \r\n            padding: 0; \r\n            font-family: 'Inter', Arial, sans-serif; \r\n            background: var(--white); \r\n        }\r\n        .lpb-canvas { \r\n            position: relative; \r\n            width: ${canvasWidth}px; \r\n            min-height: ${calculatedHeight}px; \r\n            background: ${canvas.background || 'var(--white)'}; \r\n            margin: 0 auto; \r\n            overflow: hidden; \r\n        }\r\n        .lpb-element { \r\n            position: absolute; \r\n            box-sizing: border-box; \r\n        }\r\n        .lpb-child-element { \r\n            position: absolute; \r\n            box-sizing: border-box; \r\n        }\r\n        .lpb-section { \r\n            width: 100%; \r\n        }\r\n        .lpb-popup, .lpb-modal { \r\n            display: none; \r\n            position: fixed; \r\n            top: 50%; \r\n            left: 50%; \r\n            transform: translate(-50%, -50%); \r\n            z-index: 9999; \r\n            background: var(--white); \r\n            border-radius: var(--border-radius-lg); \r\n            box-shadow: var(--shadow-lg); \r\n        }\r\n        .lpb-popup.visible, .lpb-modal.visible { \r\n            display: block; \r\n        }\r\n        .lpb-popup-overlay { \r\n            position: fixed; \r\n            top: 0; \r\n            left: 0; \r\n            right: 0; \r\n            bottom: 0; \r\n            background: var(--overlay-bg); \r\n            z-index: -1; \r\n        }\r\n        .lpb-heading { \r\n            font-size: 2rem; \r\n            font-weight: bold; \r\n            color: var(--text-primary); \r\n        }\r\n        .lpb-paragraph { \r\n            font-size: 1rem; \r\n            line-height: 1.6; \r\n            color: var(--text-secondary); \r\n        }\r\n        .lpb-button { \r\n            padding: 10px 20px; \r\n            background: var(--primary-color); \r\n            color: white; \r\n            border: none; \r\n            border-radius: var(--border-radius); \r\n            cursor: pointer; \r\n            transition: var(--transition); \r\n            font-size: 1rem; \r\n            font-weight: 600; \r\n        }\r\n        .lpb-button:hover { \r\n            background: #1e40af; \r\n            transform: translateY(-2px); \r\n        }\r\n        .lpb-button:active { \r\n            transform: translateY(0); \r\n        }\r\n        .lpb-image { \r\n            object-fit: cover; \r\n            max-width: 100%; \r\n            height: auto; \r\n        }\r\n        .lpb-icon { \r\n            font-size: 24px; \r\n            display: flex; \r\n            align-items: center; \r\n            justify-content: center; \r\n        }\r\n        .lpb-gallery { \r\n            display: grid; \r\n            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); \r\n            gap: 10px; \r\n        }\r\n        .lpb-gallery img { \r\n            width: 100%; \r\n            height: 100%; \r\n            object-fit: cover; \r\n            border-radius: var(--border-radius); \r\n            transition: var(--transition); \r\n        }\r\n        .lpb-gallery img:hover { \r\n            transform: scale(1.05); \r\n        }\r\n        .lpb-form { \r\n            display: flex; \r\n            flex-direction: column; \r\n            gap: 10px; \r\n        }\r\n        .lpb-form input { \r\n            padding: 8px; \r\n            border: 1px solid #e5e7eb; \r\n            border-radius: var(--border-radius); \r\n            font-size: 1rem; \r\n        }\r\n        .lpb-divider { \r\n            border: none; \r\n            height: 2px; \r\n            background: #e5e7eb; \r\n        }\r\n        .lpb-spacer { \r\n            width: 100%; \r\n        }\r\n        .lpb-card { \r\n            padding: 20px; \r\n            background: var(--white); \r\n            border-radius: var(--border-radius); \r\n            box-shadow: var(--shadow); \r\n        }\r\n        .lpb-grid { \r\n            display: grid; \r\n            grid-template-columns: repeat(2, 1fr); \r\n            gap: 20px; \r\n        }\r\n        .lpb-list { \r\n            list-style-type: none; \r\n            padding: 0; \r\n        }\r\n        @media (max-width: 768px) {\r\n            .lpb-canvas { \r\n                width: 100%; \r\n            }\r\n            .lpb-element, .lpb-child-element { \r\n                width: 100% !important; \r\n                left: 0 !important; \r\n            }\r\n            .lpb-grid { \r\n                grid-template-columns: 1fr; \r\n            }\r\n        }\r\n    </style>\r\n    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css\" crossorigin=\"anonymous\" referrerpolicy=\"no-referrer\">\r\n    <script>\r\n        window.LPB = {\r\n            openPopup(popupId) {\r\n                const popup = document.getElementById(popupId);\r\n                if (popup) {\r\n                    popup.classList.add('visible');\r\n                    document.body.style.overflow = 'hidden';\r\n                }\r\n            },\r\n            closePopup(popupId) {\r\n                const popup = document.getElementById(popupId);\r\n                if (popup) {\r\n                    popup.classList.remove('visible');\r\n                    document.body.style.overflow = '';\r\n                }\r\n            },\r\n            handleButtonClick(eventType, data, elementId) {\r\n                switch (eventType) {\r\n                    case 'navigate':\r\n                        if (data.newTab) {\r\n                            window.open(data.url, '_blank');\r\n                        } else {\r\n                            window.location.href = data.url;\r\n                        }\r\n                        break;\r\n                    case 'triggerApi':\r\n                        console.log('Trigger API:', data.apiUrl);\r\n                        fetch(data.apiUrl)\r\n                            .then(response => response.json())\r\n                            .then(data => console.log('API Data:', data))\r\n                            .catch(err => console.error('API Error:', err));\r\n                        break;\r\n                    case 'submitForm':\r\n                        console.log('Submit form to:', data.apiUrl);\r\n                        fetch(data.apiUrl, { method: 'POST' })\r\n                            .then(() => alert('Form submitted!'))\r\n                            .catch(err => console.error('Form Error:', err));\r\n                        break;\r\n                    case 'popup':\r\n                        this.openPopup(data.popupId);\r\n                        break;\r\n                    case 'scrollToSection':\r\n                        const section = document.getElementById(data.sectionId);\r\n                        if (section) {\r\n                            section.scrollIntoView({ behavior: data.smooth ? 'smooth' : 'auto' });\r\n                        }\r\n                        break;\r\n                }\r\n            },\r\n            handleGalleryClick(imageUrl, index) {\r\n                console.log('Open lightbox for image:', imageUrl, 'at index:', index);\r\n                \r\n            },\r\n            handleIconClick(eventType, data, elementId) {\r\n                this.handleButtonClick(eventType, data, elementId);\r\n            }\r\n        };\r\n        document.addEventListener('DOMContentLoaded', () => {\r\n            document.querySelectorAll('.lpb-popup').forEach(popup => {\r\n                const popupId = popup.id;\r\n                const closeBtn = popup.querySelector('.lpb-popup-close');\r\n                if (closeBtn) {\r\n                    closeBtn.addEventListener('click', () => window.LPB.closePopup(popupId));\r\n                }\r\n            });\r\n        });\r\n    </script>\r\n</head>\r\n<body>\r\n    <div class=\"lpb-canvas\">\r\n`;\r\n\r\n        // Render elements\r\n        elements.forEach((element) => {\r\n            const { id, type, position, size, styles, componentData, children, visible, locked } = element;\r\n            const isPopup = type === 'popup' || type === 'modal';\r\n            const isVisible = visible && (!isPopup || visiblePopups.includes(id));\r\n            const uniqueClass = `element-${id}`;\r\n            const elementStyles = `\r\n                left: ${position[viewMode]?.x || 0}px;\r\n                top: ${position[viewMode]?.y || 0}px;\r\n                width: ${size.width}px;\r\n                height: ${size.height}px;\r\n                ${styles.backgroundColor ? `background-color: ${styles.backgroundColor};` : ''}\r\n                ${styles.borderRadius ? `border-radius: ${styles.borderRadius};` : ''}\r\n                ${styles.boxShadow ? `box-shadow: ${styles.boxShadow};` : ''}\r\n                ${styles.margin ? `margin: ${styles.margin};` : ''}\r\n                ${styles.padding ? `padding: ${styles.padding};` : ''}\r\n                z-index: ${styles.zIndex || 1};\r\n                ${locked ? 'pointer-events: none;' : ''}\r\n                ${styles.display ? `display: ${styles.display};` : ''}\r\n                ${styles.alignItems ? `align-items: ${styles.alignItems};` : ''}\r\n                ${styles.justifyContent ? `justify-content: ${styles.justifyContent};` : ''}\r\n                ${styles.transition ? `transition: ${styles.transition};` : ''}\r\n            `.trim();\r\n\r\n            // Generate CSS for pseudo-classes and keyframes\r\n            const cssStyles = processStyles(styles, uniqueClass);\r\n\r\n            // Sử dụng renderComponentContent từ helpers.js để đảm bảo đồng bộ với canvas\r\n            let content = renderComponentContent(type, componentData, styles, children);\r\n\r\n            // Ghi đè content cho một số loại đặc biệt\r\n            if (type === 'section') {\r\n                content = `\r\n                    <div class=\"ladi-section-background\" style=\"background-color: ${componentData.backgroundColor || 'transparent'}; background-image: ${componentData.backgroundImage ? `url(${componentData.backgroundImage})` : 'none'}; background-size: cover; background-position: center; position: absolute; top: 0; left: 0; right: 0; bottom: 0; z-index: 0;\"></div>\r\n                    <div class=\"ladi-overlay\" style=\"background-color: ${componentData.overlayColor || 'transparent'}; opacity: ${componentData.overlayOpacity || 0}; position: absolute; top: 0; left: 0; right: 0; bottom: 0; z-index: 0;\"></div>\r\n                    <div class=\"ladi-container\" style=\"position: relative; z-index: 1; padding: ${componentData.padding || '20px'}; width: 100%; height: 100%;\">\r\n                        ${content}\r\n                    </div>\r\n                `;\r\n            } else if (type === 'popup' || type === 'modal') {\r\n                content = `\r\n                    <div class=\"lpb-popup-overlay\" onclick=\"LPB.closePopup('${id}')\"></div>\r\n                    <div class=\"lpb-popup-content\" style=\"padding: ${componentData.padding || '20px'}; max-width: 600px; max-height: 80vh; overflow-y: auto;\">\r\n                        ${content}\r\n                        <button class=\"lpb-popup-close\" style=\"position: absolute; top: 10px; right: 10px; background: none; border: none; font-size: 1.2rem; cursor: pointer;\">✕</button>\r\n                    </div>\r\n                `;\r\n            }\r\n\r\n            // Thêm style và content vào HTML\r\n            html += `\r\n        <style>${cssStyles}</style>\r\n        <div id=\"${id}\" class=\"lpb-element lpb-${type} ${uniqueClass} ${isVisible && !isPopup ? 'visible' : ''}\" data-type=\"${type}\" data-component-data='${JSON.stringify(componentData)}' style=\"${elementStyles}\">\r\n            ${content}\r\n        </div>\r\n            `;\r\n\r\n            // Render popup riêng\r\n            if (isPopup) {\r\n                html += `\r\n        <style>${cssStyles}</style>\r\n        <div id=\"${id}\" class=\"lpb-popup ${uniqueClass} ${isVisible ? 'visible' : ''}\" data-type=\"${type}\" data-component-data='${JSON.stringify(componentData)}' style=\"${elementStyles}\">\r\n            ${content}\r\n        </div>\r\n                `;\r\n            }\r\n        });\r\n\r\n        html += `\r\n    </div>\r\n</body>\r\n</html>\r\n        `;\r\n\r\n        return html;\r\n    } catch (error) {\r\n        console.error('Error rendering static HTML:', error);\r\n        return `\r\n<!DOCTYPE html>\r\n<html lang=\"vi\">\r\n<head>\r\n    <meta charset=\"UTF-8\">\r\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n    <title>Error</title>\r\n</head>\r\n<body>\r\n    <div style=\"color: red; padding: 20px;\">Error rendering page: ${error.message}</div>\r\n</body>\r\n</html>\r\n        `;\r\n    }\r\n};"],"mappings":"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A;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;IAEO;IACAC,QAAQ,CAAC5B,OAAO,CAAEQ,OAAO,IAAK;MAAA,IAAAyF,kBAAA,EAAAC,mBAAA;MAC1B,MAAM;QAAE7D,EAAE;QAAEG,IAAI;QAAEG,QAAQ;QAAES,IAAI;QAAEtD,MAAM;QAAE4C,aAAa;QAAEwB,QAAQ;QAAEH,OAAO;QAAEE;MAAO,CAAC,GAAGzD,OAAO;MAC9F,MAAM2F,OAAO,GAAG3D,IAAI,KAAK,OAAO,IAAIA,IAAI,KAAK,OAAO;MACpD,MAAM4D,SAAS,GAAGrC,OAAO,KAAK,CAACoC,OAAO,IAAItE,aAAa,CAACwE,QAAQ,CAAChE,EAAE,CAAC,CAAC;MACrE,MAAMoC,WAAW,GAAG,WAAWpC,EAAE,EAAE;MACnC,MAAMiE,aAAa,GAAG;AAClC,wBAAwB,EAAAL,kBAAA,GAAAtD,QAAQ,CAAC0C,QAAQ,CAAC,cAAAY,kBAAA,uBAAlBA,kBAAA,CAAoBpD,CAAC,KAAI,CAAC;AAClD,uBAAuB,EAAAqD,mBAAA,GAAAvD,QAAQ,CAAC0C,QAAQ,CAAC,cAAAa,mBAAA,uBAAlBA,mBAAA,CAAoBlD,CAAC,KAAI,CAAC;AACjD,yBAAyBI,IAAI,CAAC3B,KAAK;AACnC,0BAA0B2B,IAAI,CAACpB,MAAM;AACrC,kBAAkBlC,MAAM,CAACmC,eAAe,GAAG,qBAAqBnC,MAAM,CAACmC,eAAe,GAAG,GAAG,EAAE;AAC9F,kBAAkBnC,MAAM,CAACyD,YAAY,GAAG,kBAAkBzD,MAAM,CAACyD,YAAY,GAAG,GAAG,EAAE;AACrF,kBAAkBzD,MAAM,CAAC0D,SAAS,GAAG,eAAe1D,MAAM,CAAC0D,SAAS,GAAG,GAAG,EAAE;AAC5E,kBAAkB1D,MAAM,CAAC2D,MAAM,GAAG,WAAW3D,MAAM,CAAC2D,MAAM,GAAG,GAAG,EAAE;AAClE,kBAAkB3D,MAAM,CAAC4D,OAAO,GAAG,YAAY5D,MAAM,CAAC4D,OAAO,GAAG,GAAG,EAAE;AACrE,2BAA2B5D,MAAM,CAAC6D,MAAM,IAAI,CAAC;AAC7C,kBAAkBM,MAAM,GAAG,uBAAuB,GAAG,EAAE;AACvD,kBAAkBnE,MAAM,CAACkE,OAAO,GAAG,YAAYlE,MAAM,CAACkE,OAAO,GAAG,GAAG,EAAE;AACrE,kBAAkBlE,MAAM,CAACyG,UAAU,GAAG,gBAAgBzG,MAAM,CAACyG,UAAU,GAAG,GAAG,EAAE;AAC/E,kBAAkBzG,MAAM,CAAC0G,cAAc,GAAG,oBAAoB1G,MAAM,CAAC0G,cAAc,GAAG,GAAG,EAAE;AAC3F,kBAAkB1G,MAAM,CAACgE,UAAU,GAAG,eAAehE,MAAM,CAACgE,UAAU,GAAG,GAAG,EAAE;AAC9E,aAAa,CAACxD,IAAI,CAAC,CAAC;;MAER;MACA,MAAMmG,SAAS,GAAGjC,aAAa,CAAC1E,MAAM,EAAE2E,WAAW,CAAC;;MAEpD;MACA,IAAIiC,OAAO,GAAGhH,sBAAsB,CAAC8C,IAAI,EAAEE,aAAa,EAAE5C,MAAM,EAAEoE,QAAQ,CAAC;;MAE3E;MACA,IAAI1B,IAAI,KAAK,SAAS,EAAE;QACpBkE,OAAO,GAAG;AAC1B,oFAAoFhE,aAAa,CAACT,eAAe,IAAI,aAAa,uBAAuBS,aAAa,CAACiE,eAAe,GAAG,OAAOjE,aAAa,CAACiE,eAAe,GAAG,GAAG,MAAM;AACzO,yEAAyEjE,aAAa,CAACkE,YAAY,IAAI,aAAa,cAAclE,aAAa,CAACmE,cAAc,IAAI,CAAC;AACnK,kGAAkGnE,aAAa,CAACgB,OAAO,IAAI,MAAM;AACjI,0BAA0BgD,OAAO;AACjC;AACA,iBAAiB;MACL,CAAC,MAAM,IAAIlE,IAAI,KAAK,OAAO,IAAIA,IAAI,KAAK,OAAO,EAAE;QAC7CkE,OAAO,GAAG;AAC1B,8EAA8ErE,EAAE;AAChF,qEAAqEK,aAAa,CAACgB,OAAO,IAAI,MAAM;AACpG,0BAA0BgD,OAAO;AACjC;AACA;AACA,iBAAiB;MACL;;MAEA;MACAzF,IAAI,IAAI;AACpB,iBAAiBwF,SAAS;AAC1B,mBAAmBpE,EAAE,4BAA4BG,IAAI,IAAIiC,WAAW,IAAI2B,SAAS,IAAI,CAACD,OAAO,GAAG,SAAS,GAAG,EAAE,gBAAgB3D,IAAI,0BAA0B5B,IAAI,CAACkG,SAAS,CAACpE,aAAa,CAAC,YAAY4D,aAAa;AAClN,cAAcI,OAAO;AACrB;AACA,aAAa;;MAED;MACA,IAAIP,OAAO,EAAE;QACTlF,IAAI,IAAI;AACxB,iBAAiBwF,SAAS;AAC1B,mBAAmBpE,EAAE,sBAAsBoC,WAAW,IAAI2B,SAAS,GAAG,SAAS,GAAG,EAAE,gBAAgB5D,IAAI,0BAA0B5B,IAAI,CAACkG,SAAS,CAACpE,aAAa,CAAC,YAAY4D,aAAa;AACxL,cAAcI,OAAO;AACrB;AACA,iBAAiB;MACL;IACJ,CAAC,CAAC;IAEFzF,IAAI,IAAI;AAChB;AACA;AACA;AACA,SAAS;IAED,OAAOA,IAAI;EACf,CAAC,CAAC,OAAOH,KAAK,EAAE;IACZC,OAAO,CAACD,KAAK,CAAC,8BAA8B,EAAEA,KAAK,CAAC;IACpD,OAAO;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oEAAoEA,KAAK,CAACiG,OAAO;AACjF;AACA;AACA,SAAS;EACL;AACJ,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}