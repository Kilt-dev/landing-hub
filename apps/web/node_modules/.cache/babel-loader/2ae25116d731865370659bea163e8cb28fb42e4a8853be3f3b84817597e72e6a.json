{"ast":null,"code":"var _jsxFileName = \"F:\\\\landinghub-iconic\\\\apps\\\\web\\\\src\\\\components\\\\create-page\\\\Canvas.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { useRef, useMemo, useCallback, useState } from 'react';\nimport { useDrop, useDrag } from 'react-dnd';\nimport { useHotkeys } from 'react-hotkeys-hook';\nimport { toast } from 'react-toastify';\nimport QuickEditToolkit from './QuickEditToolkit';\nimport './Canvas.css';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst ItemTypes = {\n  COMPONENT: 'component',\n  EXISTING_ELEMENT: 'existingElement'\n};\n\n// Memoized component for rendering individual elements\nconst Element = /*#__PURE__*/_s(/*#__PURE__*/React.memo(_c = _s(({\n  component,\n  index,\n  isSelected,\n  hasQuickEdit,\n  onSelectElement,\n  handleElementHover,\n  onDuplicateElement,\n  onDeleteElement,\n  onMoveElement,\n  updatePosition,\n  canvasRef\n}) => {\n  var _component$json, _component$json2, _component$json3;\n  _s();\n  const [{\n    isDragging\n  }, drag, preview] = useDrag(() => ({\n    type: ItemTypes.EXISTING_ELEMENT,\n    item: {\n      id: component.id,\n      index\n    },\n    collect: monitor => ({\n      isDragging: !!monitor.isDragging()\n    })\n  }));\n  const [{\n    isOver\n  }, drop] = useDrop(() => ({\n    accept: ItemTypes.EXISTING_ELEMENT,\n    hover: item => {\n      if (item.id !== component.id) {\n        onMoveElement(item, index);\n      }\n    }\n  }));\n  const handleDrag = useCallback(monitor => {\n    if (isDragging && canvasRef.current) {\n      const clientOffset = monitor.getClientOffset();\n      if (clientOffset) {\n        var _component$json$style, _component$json$style2, _component$json$style3, _component$json$style4;\n        const rect = canvasRef.current.getBoundingClientRect();\n        const offsetX = clientOffset.x - rect.left;\n        const offsetY = clientOffset.y - rect.top;\n        const newX = offsetX - (((_component$json$style = component.json.styles) === null || _component$json$style === void 0 ? void 0 : (_component$json$style2 = _component$json$style.position) === null || _component$json$style2 === void 0 ? void 0 : _component$json$style2.offsetX) || 0);\n        const newY = offsetY - (((_component$json$style3 = component.json.styles) === null || _component$json$style3 === void 0 ? void 0 : (_component$json$style4 = _component$json$style3.position) === null || _component$json$style4 === void 0 ? void 0 : _component$json$style4.offsetY) || 0);\n        updatePosition(component.id, {\n          x: newX,\n          y: newY\n        });\n      }\n    }\n  }, [isDragging, component.id, updatePosition, canvasRef]);\n  const content = useMemo(() => {\n    var _component$json$style5, _component$json$style6, _component$json$style7, _component$json$style8, _component$json$conte, _component$json$conte2, _component$json$conte3, _component$json$conte4, _component$json$conte5, _component$json$conte6, _component$json$conte7, _component$json$conte8, _component$json$conte9, _component$json$conte0, _component$json$conte1, _component$json$conte10;\n    if (!component.json) {\n      console.warn('Invalid component structure:', component);\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"error-message\",\n        children: \"Component l\\u1ED7i: Thi\\u1EBFu json\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 66,\n        columnNumber: 16\n      }, this);\n    }\n    const styles = {\n      position: 'absolute',\n      left: ((_component$json$style5 = component.json.styles) === null || _component$json$style5 === void 0 ? void 0 : (_component$json$style6 = _component$json$style5.position) === null || _component$json$style6 === void 0 ? void 0 : _component$json$style6.x) || 0,\n      top: ((_component$json$style7 = component.json.styles) === null || _component$json$style7 === void 0 ? void 0 : (_component$json$style8 = _component$json$style7.position) === null || _component$json$style8 === void 0 ? void 0 : _component$json$style8.y) || 0,\n      transition: isDragging ? 'none' : 'all 0.3s ease',\n      ...component.json.styles\n    };\n    switch (component.json.type) {\n      case 'heading':\n        const HeadingTag = component.json.level === 2 ? 'h2' : 'h1';\n        return /*#__PURE__*/_jsxDEV(HeadingTag, {\n          style: styles,\n          children: component.json.content || 'Tiêu đề'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 80,\n          columnNumber: 18\n        }, this);\n      case 'paragraph':\n        return /*#__PURE__*/_jsxDEV(\"p\", {\n          style: styles,\n          children: component.json.content || 'Đoạn văn'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 82,\n          columnNumber: 18\n        }, this);\n      case 'button':\n        return /*#__PURE__*/_jsxDEV(\"button\", {\n          style: styles,\n          children: component.json.content || 'Nút'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 84,\n          columnNumber: 18\n        }, this);\n      case 'button-group':\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          style: styles,\n          children: ((_component$json$conte = component.json.content) === null || _component$json$conte === void 0 ? void 0 : _component$json$conte.map((btn, idx) => /*#__PURE__*/_jsxDEV(\"button\", {\n            style: {\n              marginRight: '10px',\n              ...btn.styles\n            },\n            children: btn.text || 'Nút'\n          }, idx, false, {\n            fileName: _jsxFileName,\n            lineNumber: 89,\n            columnNumber: 17\n          }, this))) || 'Nhóm nút'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 87,\n          columnNumber: 13\n        }, this);\n      case 'form':\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          style: styles,\n          children: ((_component$json$conte2 = component.json.content) === null || _component$json$conte2 === void 0 ? void 0 : (_component$json$conte3 = _component$json$conte2.fields) === null || _component$json$conte3 === void 0 ? void 0 : _component$json$conte3.map((field, idx) => /*#__PURE__*/_jsxDEV(\"input\", {\n            placeholder: field,\n            style: {\n              marginBottom: '10px',\n              ...component.json.styles\n            }\n          }, idx, false, {\n            fileName: _jsxFileName,\n            lineNumber: 99,\n            columnNumber: 17\n          }, this))) || 'Form'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 97,\n          columnNumber: 13\n        }, this);\n      case 'image':\n        return /*#__PURE__*/_jsxDEV(\"img\", {\n          src: component.json.content || 'https://via.placeholder.com/300x200',\n          style: styles,\n          alt: \"Image\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 104,\n          columnNumber: 18\n        }, this);\n      case 'gallery':\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            ...styles,\n            display: 'flex',\n            gap: '10px'\n          },\n          children: ((_component$json$conte4 = component.json.content) === null || _component$json$conte4 === void 0 ? void 0 : _component$json$conte4.map((src, idx) => /*#__PURE__*/_jsxDEV(\"img\", {\n            src: src || 'https://via.placeholder.com/150x150',\n            style: {\n              width: '150px'\n            },\n            alt: \"Gallery\"\n          }, idx, false, {\n            fileName: _jsxFileName,\n            lineNumber: 109,\n            columnNumber: 17\n          }, this))) || 'Gallery'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 107,\n          columnNumber: 13\n        }, this);\n      case 'product':\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          style: styles,\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            children: ((_component$json$conte5 = component.json.content) === null || _component$json$conte5 === void 0 ? void 0 : _component$json$conte5.title) || 'Sản phẩm'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 116,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: ((_component$json$conte6 = component.json.content) === null || _component$json$conte6 === void 0 ? void 0 : _component$json$conte6.price) || '$0.00'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 117,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            children: ((_component$json$conte7 = component.json.content) === null || _component$json$conte7 === void 0 ? void 0 : _component$json$conte7.button) || 'Mua ngay'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 118,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 115,\n          columnNumber: 13\n        }, this);\n      case 'carousel':\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            ...styles,\n            overflow: 'hidden',\n            width: '400px',\n            height: '200px'\n          },\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              display: 'flex',\n              transition: 'transform 0.5s'\n            },\n            children: (_component$json$conte8 = component.json.content) === null || _component$json$conte8 === void 0 ? void 0 : _component$json$conte8.map((src, idx) => /*#__PURE__*/_jsxDEV(\"img\", {\n              src: src || 'https://via.placeholder.com/400x200',\n              style: {\n                width: '400px'\n              },\n              alt: \"Carousel\"\n            }, idx, false, {\n              fileName: _jsxFileName,\n              lineNumber: 126,\n              columnNumber: 19\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 124,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 123,\n          columnNumber: 13\n        }, this);\n      case 'section':\n        return /*#__PURE__*/_jsxDEV(\"section\", {\n          style: styles,\n          children: [component.json.layout === 'hero' && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"container mx-auto\",\n            children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n              className: \"text-4xl font-bold mb-4 text-white\",\n              children: ((_component$json$conte9 = component.json.content) === null || _component$json$conte9 === void 0 ? void 0 : _component$json$conte9.title) || 'Welcome'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 136,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-xl mb-8 text-white\",\n              children: ((_component$json$conte0 = component.json.content) === null || _component$json$conte0 === void 0 ? void 0 : _component$json$conte0.subtitle) || 'Subtitle'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 139,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex gap-4 justify-center\",\n              children: ((_component$json$conte1 = component.json.content) === null || _component$json$conte1 === void 0 ? void 0 : (_component$json$conte10 = _component$json$conte1.buttons) === null || _component$json$conte10 === void 0 ? void 0 : _component$json$conte10.map((btn, idx) => /*#__PURE__*/_jsxDEV(\"button\", {\n                className: `px-6 py-3 rounded-lg font-semibold ${btn.type === 'primary' ? 'bg-white text-blue-600' : 'border-2 border-white text-white bg-transparent'}`,\n                children: btn.text || 'Nút'\n              }, idx, false, {\n                fileName: _jsxFileName,\n                lineNumber: 142,\n                columnNumber: 23\n              }, this))) || null\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 140,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 135,\n            columnNumber: 17\n          }, this), isSelected && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"section-label\",\n            children: \"Hero Section\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 156,\n            columnNumber: 30\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 133,\n          columnNumber: 13\n        }, this);\n      default:\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"unsupported-type\",\n          children: \"Lo\\u1EA1i kh\\xF4ng h\\u1ED7 tr\\u1EE3\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 160,\n          columnNumber: 18\n        }, this);\n    }\n  }, [component, isDragging, isSelected]);\n  if (((_component$json = component.json) === null || _component$json === void 0 ? void 0 : _component$json.type) === 'section') {\n    return content;\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    ref: node => drag(drop(node)),\n    className: `canvas-element ${isSelected ? 'selected' : ''} ${hasQuickEdit ? 'quick-edit' : ''} ${isOver ? 'hover-over' : ''}`,\n    onClick: () => onSelectElement(component),\n    onMouseEnter: e => handleElementHover(e, component),\n    onDrag: (e, monitor) => handleDrag(monitor),\n    style: {\n      zIndex: isDragging ? 1000 : 'auto'\n    },\n    children: [content, isSelected && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"element-label\",\n      children: ((_component$json2 = component.json) === null || _component$json2 === void 0 ? void 0 : _component$json2.type.charAt(0).toUpperCase()) + ((_component$json3 = component.json) === null || _component$json3 === void 0 ? void 0 : _component$json3.type.slice(1)) || 'Không xác định'\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 181,\n      columnNumber: 11\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 169,\n    columnNumber: 7\n  }, this);\n}, \"k+l6Snn2svXQni8D2OY6Ju4pDcc=\", false, function () {\n  return [useDrag, useDrop];\n})), \"k+l6Snn2svXQni8D2OY6Ju4pDcc=\", false, function () {\n  return [useDrag, useDrop];\n});\n_c2 = Element;\nconst Canvas = /*#__PURE__*/_s2(/*#__PURE__*/React.memo(_c3 = _s2(({\n  pageStructure,\n  selectedElement,\n  onSelectElement,\n  quickEditElement,\n  quickEditPosition,\n  onQuickEdit,\n  onCloseQuickEdit,\n  onDuplicateElement,\n  onDeleteElement,\n  onMoveElement,\n  viewMode,\n  addComponent,\n  moveElement,\n  zoomLevel,\n  setPageStructure\n}) => {\n  _s2();\n  const canvasRef = useRef(null);\n  const [dropIndex, setDropIndex] = useState(null);\n  const [history, setHistory] = useState([]);\n  const [historyIndex, setHistoryIndex] = useState(-1);\n  const updatePosition = useCallback((id, newPosition) => {\n    setPageStructure(prev => {\n      const newStructure = prev.map(el => el.id === id ? {\n        ...el,\n        json: {\n          ...el.json,\n          styles: {\n            ...el.json.styles,\n            position: {\n              x: newPosition.x,\n              y: newPosition.y\n            }\n          }\n        }\n      } : el);\n      return newStructure;\n    });\n  }, [setPageStructure]);\n\n  // Make the entire canvas a drop target\n  const [{\n    isOver\n  }, drop] = useDrop(() => ({\n    accept: [ItemTypes.COMPONENT, ItemTypes.EXISTING_ELEMENT],\n    hover: (item, monitor) => {\n      const clientOffset = monitor.getClientOffset();\n      if (clientOffset && canvasRef.current) {\n        const rect = canvasRef.current.getBoundingClientRect();\n        const y = clientOffset.y - rect.top;\n        const index = calculateDropIndex(y);\n        setDropIndex(index);\n        if (item.componentData) {\n          item.componentData.json.styles = {\n            ...item.componentData.json.styles,\n            position: {\n              x: clientOffset.x - rect.left,\n              y\n            }\n          };\n        }\n      }\n    },\n    drop: (item, monitor) => {\n      const clientOffset = monitor.getClientOffset();\n      if (!clientOffset || !canvasRef.current) {\n        toast.error('Không thể xác định vị trí thả. Vui lòng thử lại!');\n        return;\n      }\n      const rect = canvasRef.current.getBoundingClientRect();\n      const position = {\n        x: clientOffset.x - rect.left,\n        y: clientOffset.y - rect.top\n      };\n      setHistory(prev => {\n        const newHistory = prev.slice(0, historyIndex + 1);\n        newHistory.push([...pageStructure]);\n        return newHistory;\n      });\n      setHistoryIndex(prev => prev + 1);\n      if (item.componentData) {\n        const index = calculateDropIndex(position.y);\n        addComponent({\n          ...item.componentData,\n          json: {\n            ...item.componentData.json,\n            styles: {\n              ...item.componentData.json.styles,\n              position\n            }\n          }\n        }, index);\n      } else {\n        const newIndex = calculateDropIndex(position.y);\n        moveElement(item.id, newIndex);\n        const updatedStructure = [...pageStructure];\n        const targetIndex = updatedStructure.findIndex(el => el.id === item.id);\n        if (targetIndex !== -1) {\n          updatedStructure[targetIndex] = {\n            ...updatedStructure[targetIndex],\n            json: {\n              ...updatedStructure[targetIndex].json,\n              styles: {\n                ...updatedStructure[targetIndex].json.styles,\n                position\n              }\n            }\n          };\n          setPageStructure(updatedStructure);\n        }\n      }\n      setDropIndex(null);\n    },\n    collect: monitor => ({\n      isOver: !!monitor.isOver()\n    })\n  }));\n\n  // Calculate drop index based on y-position\n  const calculateDropIndex = useCallback(y => {\n    if (!canvasRef.current) return pageStructure.length;\n    const elements = canvasRef.current.querySelectorAll('.canvas-element');\n    let index = pageStructure.length;\n    elements.forEach((el, i) => {\n      const rect = el.getBoundingClientRect();\n      const canvasRect = canvasRef.current.getBoundingClientRect();\n      const elTop = rect.top - canvasRect.top;\n      const elHeight = rect.height;\n      if (y < elTop + elHeight / 2) {\n        index = i;\n        return false;\n      }\n    });\n    return index;\n  }, [pageStructure]);\n\n  // Handle element hover for quick edit\n  const handleElementHover = useCallback((e, component) => {\n    var _canvasRef$current;\n    if ((quickEditElement === null || quickEditElement === void 0 ? void 0 : quickEditElement.id) === component.id) return;\n    const rect = e.currentTarget.getBoundingClientRect();\n    const canvasRect = ((_canvasRef$current = canvasRef.current) === null || _canvasRef$current === void 0 ? void 0 : _canvasRef$current.getBoundingClientRect()) || {\n      left: 0,\n      top: 0\n    };\n    onQuickEdit(component, {\n      x: rect.left - canvasRect.left,\n      y: rect.top - canvasRect.top + 20\n    });\n  }, [quickEditElement, onQuickEdit]);\n\n  // Keyboard shortcuts\n  useHotkeys('delete', () => {\n    if (selectedElement) {\n      setHistory(prev => {\n        const newHistory = prev.slice(0, historyIndex + 1);\n        newHistory.push([...pageStructure]);\n        return newHistory;\n      });\n      setHistoryIndex(prev => prev + 1);\n      onDeleteElement(selectedElement);\n    }\n  }, [selectedElement, onDeleteElement]);\n  useHotkeys('up', () => {\n    if (selectedElement) {\n      onMoveElement(selectedElement, 'up');\n    }\n  }, [selectedElement, onMoveElement]);\n  useHotkeys('down', () => {\n    if (selectedElement) {\n      onMoveElement(selectedElement, 'down');\n    }\n  }, [selectedElement, onMoveElement]);\n  useHotkeys('ctrl+z', () => {\n    if (historyIndex > 0) {\n      setHistoryIndex(prev => prev - 1);\n      setPageStructure([...history[historyIndex - 1]]);\n      toast.info('Đã hoàn tác!');\n    }\n  }, [historyIndex, history, setPageStructure]);\n  useHotkeys('ctrl+y', () => {\n    if (historyIndex < history.length - 1) {\n      setHistoryIndex(prev => prev + 1);\n      setPageStructure([...history[historyIndex + 1]]);\n      toast.info('Đã khôi phục!');\n    }\n  }, [historyIndex, history, setPageStructure]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"canvas-wrapper\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      ref: node => {\n        canvasRef.current = node;\n        drop(node);\n      },\n      className: `canvas ${viewMode === 'mobile' ? 'mobile' : viewMode === 'tablet' ? 'tablet' : ''}`,\n      onMouseLeave: onCloseQuickEdit,\n      style: {\n        zoom: `${zoomLevel / 100}`\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"canvas-content\",\n        children: pageStructure.length === 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"empty-state\",\n          children: [/*#__PURE__*/_jsxDEV(\"i\", {\n            className: \"far fa-mouse-pointer\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 420,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"K\\xE9o th\\u1EA3 component \\u0111\\u1EC3 b\\u1EAFt \\u0111\\u1EA7u\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 421,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 419,\n          columnNumber: 15\n        }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [pageStructure.map((component, index) => /*#__PURE__*/_jsxDEV(React.Fragment, {\n            children: [dropIndex === index && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"drop-zone\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 427,\n              columnNumber: 45\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"canvas-element-wrapper\",\n              children: /*#__PURE__*/_jsxDEV(Element, {\n                component: component,\n                index: index,\n                isSelected: (selectedElement === null || selectedElement === void 0 ? void 0 : selectedElement.id) === component.id,\n                hasQuickEdit: (quickEditElement === null || quickEditElement === void 0 ? void 0 : quickEditElement.id) === component.id,\n                onSelectElement: onSelectElement,\n                handleElementHover: handleElementHover,\n                onDuplicateElement: onDuplicateElement,\n                onDeleteElement: onDeleteElement,\n                onMoveElement: onMoveElement,\n                updatePosition: updatePosition,\n                canvasRef: canvasRef\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 429,\n                columnNumber: 23\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 428,\n              columnNumber: 21\n            }, this)]\n          }, component.id || index, true, {\n            fileName: _jsxFileName,\n            lineNumber: 426,\n            columnNumber: 19\n          }, this)), dropIndex === pageStructure.length && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"drop-zone\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 445,\n            columnNumber: 56\n          }, this)]\n        }, void 0, true)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 417,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(QuickEditToolkit, {\n        element: quickEditElement,\n        position: quickEditPosition,\n        onEdit: () => onSelectElement(quickEditElement),\n        onDuplicate: () => onDuplicateElement(quickEditElement),\n        onDelete: () => onDeleteElement(quickEditElement),\n        onMoveUp: () => onMoveElement(quickEditElement, 'up'),\n        onMoveDown: () => onMoveElement(quickEditElement, 'down'),\n        onClose: onCloseQuickEdit\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 450,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 408,\n      columnNumber: 9\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 407,\n    columnNumber: 7\n  }, this);\n}, \"91ohOrV6vv+NG063xmdovS3lZQo=\", false, function () {\n  return [useDrop, useHotkeys, useHotkeys, useHotkeys, useHotkeys, useHotkeys];\n})), \"91ohOrV6vv+NG063xmdovS3lZQo=\", false, function () {\n  return [useDrop, useHotkeys, useHotkeys, useHotkeys, useHotkeys, useHotkeys];\n});\n_c4 = Canvas;\nexport default Canvas;\nvar _c, _c2, _c3, _c4;\n$RefreshReg$(_c, \"Element$React.memo\");\n$RefreshReg$(_c2, \"Element\");\n$RefreshReg$(_c3, \"Canvas$React.memo\");\n$RefreshReg$(_c4, \"Canvas\");","map":{"version":3,"names":["React","useRef","useMemo","useCallback","useState","useDrop","useDrag","useHotkeys","toast","QuickEditToolkit","jsxDEV","_jsxDEV","Fragment","_Fragment","ItemTypes","COMPONENT","EXISTING_ELEMENT","Element","_s","memo","_c","component","index","isSelected","hasQuickEdit","onSelectElement","handleElementHover","onDuplicateElement","onDeleteElement","onMoveElement","updatePosition","canvasRef","_component$json","_component$json2","_component$json3","isDragging","drag","preview","type","item","id","collect","monitor","isOver","drop","accept","hover","handleDrag","current","clientOffset","getClientOffset","_component$json$style","_component$json$style2","_component$json$style3","_component$json$style4","rect","getBoundingClientRect","offsetX","x","left","offsetY","y","top","newX","json","styles","position","newY","content","_component$json$style5","_component$json$style6","_component$json$style7","_component$json$style8","_component$json$conte","_component$json$conte2","_component$json$conte3","_component$json$conte4","_component$json$conte5","_component$json$conte6","_component$json$conte7","_component$json$conte8","_component$json$conte9","_component$json$conte0","_component$json$conte1","_component$json$conte10","console","warn","className","children","fileName","_jsxFileName","lineNumber","columnNumber","transition","HeadingTag","level","style","map","btn","idx","marginRight","text","fields","field","placeholder","marginBottom","src","alt","display","gap","width","title","price","button","overflow","height","layout","subtitle","buttons","ref","node","onClick","onMouseEnter","e","onDrag","zIndex","charAt","toUpperCase","slice","_c2","Canvas","_s2","_c3","pageStructure","selectedElement","quickEditElement","quickEditPosition","onQuickEdit","onCloseQuickEdit","viewMode","addComponent","moveElement","zoomLevel","setPageStructure","dropIndex","setDropIndex","history","setHistory","historyIndex","setHistoryIndex","newPosition","prev","newStructure","el","calculateDropIndex","componentData","error","newHistory","push","newIndex","updatedStructure","targetIndex","findIndex","length","elements","querySelectorAll","forEach","i","canvasRect","elTop","elHeight","_canvasRef$current","currentTarget","info","onMouseLeave","zoom","element","onEdit","onDuplicate","onDelete","onMoveUp","onMoveDown","onClose","_c4","$RefreshReg$"],"sources":["F:/landinghub-iconic/apps/web/src/components/create-page/Canvas.js"],"sourcesContent":["\r\nimport React, { useRef, useMemo, useCallback, useState } from 'react';\r\nimport { useDrop, useDrag } from 'react-dnd';\r\nimport { useHotkeys } from 'react-hotkeys-hook';\r\nimport { toast } from 'react-toastify';\r\nimport QuickEditToolkit from './QuickEditToolkit';\r\nimport './Canvas.css';\r\n\r\nconst ItemTypes = {\r\n  COMPONENT: 'component',\r\n  EXISTING_ELEMENT: 'existingElement',\r\n};\r\n\r\n// Memoized component for rendering individual elements\r\nconst Element = React.memo(\r\n  ({\r\n    component,\r\n    index,\r\n    isSelected,\r\n    hasQuickEdit,\r\n    onSelectElement,\r\n    handleElementHover,\r\n    onDuplicateElement,\r\n    onDeleteElement,\r\n    onMoveElement,\r\n    updatePosition,\r\n    canvasRef,\r\n  }) => {\r\n    const [{ isDragging }, drag, preview] = useDrag(() => ({\r\n      type: ItemTypes.EXISTING_ELEMENT,\r\n      item: { id: component.id, index },\r\n      collect: (monitor) => ({\r\n        isDragging: !!monitor.isDragging(),\r\n      }),\r\n    }));\r\n\r\n    const [{ isOver }, drop] = useDrop(() => ({\r\n      accept: ItemTypes.EXISTING_ELEMENT,\r\n      hover: (item) => {\r\n        if (item.id !== component.id) {\r\n          onMoveElement(item, index);\r\n        }\r\n      },\r\n    }));\r\n\r\n    const handleDrag = useCallback(\r\n      (monitor) => {\r\n        if (isDragging && canvasRef.current) {\r\n          const clientOffset = monitor.getClientOffset();\r\n          if (clientOffset) {\r\n            const rect = canvasRef.current.getBoundingClientRect();\r\n            const offsetX = clientOffset.x - rect.left;\r\n            const offsetY = clientOffset.y - rect.top;\r\n            const newX = offsetX - (component.json.styles?.position?.offsetX || 0);\r\n            const newY = offsetY - (component.json.styles?.position?.offsetY || 0);\r\n            updatePosition(component.id, { x: newX, y: newY });\r\n          }\r\n        }\r\n      },\r\n      [isDragging, component.id, updatePosition, canvasRef]\r\n    );\r\n\r\n    const content = useMemo(() => {\r\n      if (!component.json) {\r\n        console.warn('Invalid component structure:', component);\r\n        return <div className=\"error-message\">Component lỗi: Thiếu json</div>;\r\n      }\r\n\r\n      const styles = {\r\n        position: 'absolute',\r\n        left: component.json.styles?.position?.x || 0,\r\n        top: component.json.styles?.position?.y || 0,\r\n        transition: isDragging ? 'none' : 'all 0.3s ease',\r\n        ...component.json.styles,\r\n      };\r\n\r\n      switch (component.json.type) {\r\n        case 'heading':\r\n          const HeadingTag = component.json.level === 2 ? 'h2' : 'h1';\r\n          return <HeadingTag style={styles}>{component.json.content || 'Tiêu đề'}</HeadingTag>;\r\n        case 'paragraph':\r\n          return <p style={styles}>{component.json.content || 'Đoạn văn'}</p>;\r\n        case 'button':\r\n          return <button style={styles}>{component.json.content || 'Nút'}</button>;\r\n        case 'button-group':\r\n          return (\r\n            <div style={styles}>\r\n              {component.json.content?.map((btn, idx) => (\r\n                <button key={idx} style={{ marginRight: '10px', ...btn.styles }}>\r\n                  {btn.text || 'Nút'}\r\n                </button>\r\n              )) || 'Nhóm nút'}\r\n            </div>\r\n          );\r\n        case 'form':\r\n          return (\r\n            <div style={styles}>\r\n              {component.json.content?.fields?.map((field, idx) => (\r\n                <input key={idx} placeholder={field} style={{ marginBottom: '10px', ...component.json.styles }} />\r\n              )) || 'Form'}\r\n            </div>\r\n          );\r\n        case 'image':\r\n          return <img src={component.json.content || 'https://via.placeholder.com/300x200'} style={styles} alt=\"Image\" />;\r\n        case 'gallery':\r\n          return (\r\n            <div style={{ ...styles, display: 'flex', gap: '10px' }}>\r\n              {component.json.content?.map((src, idx) => (\r\n                <img key={idx} src={src || 'https://via.placeholder.com/150x150'} style={{ width: '150px' }} alt=\"Gallery\" />\r\n              )) || 'Gallery'}\r\n            </div>\r\n          );\r\n        case 'product':\r\n          return (\r\n            <div style={styles}>\r\n              <h3>{component.json.content?.title || 'Sản phẩm'}</h3>\r\n              <p>{component.json.content?.price || '$0.00'}</p>\r\n              <button>{component.json.content?.button || 'Mua ngay'}</button>\r\n            </div>\r\n          );\r\n        case 'carousel':\r\n          return (\r\n            <div style={{ ...styles, overflow: 'hidden', width: '400px', height: '200px' }}>\r\n              <div style={{ display: 'flex', transition: 'transform 0.5s' }}>\r\n                {component.json.content?.map((src, idx) => (\r\n                  <img key={idx} src={src || 'https://via.placeholder.com/400x200'} style={{ width: '400px' }} alt=\"Carousel\" />\r\n                ))}\r\n              </div>\r\n            </div>\r\n          );\r\n        case 'section':\r\n          return (\r\n            <section style={styles}>\r\n              {component.json.layout === 'hero' && (\r\n                <div className=\"container mx-auto\">\r\n                  <h1 className=\"text-4xl font-bold mb-4 text-white\">\r\n                    {component.json.content?.title || 'Welcome'}\r\n                  </h1>\r\n                  <p className=\"text-xl mb-8 text-white\">{component.json.content?.subtitle || 'Subtitle'}</p>\r\n                  <div className=\"flex gap-4 justify-center\">\r\n                    {component.json.content?.buttons?.map((btn, idx) => (\r\n                      <button\r\n                        key={idx}\r\n                        className={`px-6 py-3 rounded-lg font-semibold ${\r\n    btn.type === 'primary'\r\n        ? 'bg-white text-blue-600'\r\n        : 'border-2 border-white text-white bg-transparent'\r\n}`}\r\n                      >\r\n                        {btn.text || 'Nút'}\r\n                      </button>\r\n                    )) || null}\r\n                  </div>\r\n                </div>\r\n              )}\r\n              {isSelected && <div className=\"section-label\">Hero Section</div>}\r\n            </section>\r\n          );\r\n        default:\r\n          return <div className=\"unsupported-type\">Loại không hỗ trợ</div>;\r\n      }\r\n    }, [component, isDragging, isSelected]);\r\n\r\n    if (component.json?.type === 'section') {\r\n      return content;\r\n    }\r\n\r\n    return (\r\n      <div\r\n        ref={(node) => drag(drop(node))}\r\n        className={`canvas-element ${isSelected ? 'selected' : ''} ${hasQuickEdit ? 'quick-edit' : ''} ${\r\n    isOver ? 'hover-over' : ''\r\n}`}\r\n        onClick={() => onSelectElement(component)}\r\n        onMouseEnter={(e) => handleElementHover(e, component)}\r\n        onDrag={(e, monitor) => handleDrag(monitor)}\r\n        style={{ zIndex: isDragging ? 1000 : 'auto' }}\r\n      >\r\n        {content}\r\n        {isSelected && (\r\n          <div className=\"element-label\">\r\n            {component.json?.type.charAt(0).toUpperCase() + component.json?.type.slice(1) || 'Không xác định'}\r\n          </div>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n);\r\n\r\nconst Canvas = React.memo(\r\n  ({\r\n    pageStructure,\r\n    selectedElement,\r\n    onSelectElement,\r\n    quickEditElement,\r\n    quickEditPosition,\r\n    onQuickEdit,\r\n    onCloseQuickEdit,\r\n    onDuplicateElement,\r\n    onDeleteElement,\r\n    onMoveElement,\r\n    viewMode,\r\n    addComponent,\r\n    moveElement,\r\n    zoomLevel,\r\n    setPageStructure,\r\n  }) => {\r\n    const canvasRef = useRef(null);\r\n    const [dropIndex, setDropIndex] = useState(null);\r\n    const [history, setHistory] = useState([]);\r\n    const [historyIndex, setHistoryIndex] = useState(-1);\r\n\r\n    const updatePosition = useCallback((id, newPosition) => {\r\n      setPageStructure((prev) => {\r\n        const newStructure = prev.map((el) =>\r\n          el.id === id\r\n            ? {\r\n                ...el,\r\n                json: {\r\n                  ...el.json,\r\n                  styles: {\r\n                    ...el.json.styles,\r\n                    position: {\r\n                      x: newPosition.x,\r\n                      y: newPosition.y,\r\n                    },\r\n                  },\r\n                },\r\n              }\r\n            : el\r\n        );\r\n        return newStructure;\r\n      });\r\n    }, [setPageStructure]);\r\n\r\n    // Make the entire canvas a drop target\r\n    const [{ isOver }, drop] = useDrop(() => ({\r\n      accept: [ItemTypes.COMPONENT, ItemTypes.EXISTING_ELEMENT],\r\n      hover: (item, monitor) => {\r\n        const clientOffset = monitor.getClientOffset();\r\n        if (clientOffset && canvasRef.current) {\r\n          const rect = canvasRef.current.getBoundingClientRect();\r\n          const y = clientOffset.y - rect.top;\r\n          const index = calculateDropIndex(y);\r\n          setDropIndex(index);\r\n\r\n          if (item.componentData) {\r\n            item.componentData.json.styles = {\r\n              ...item.componentData.json.styles,\r\n              position: { x: clientOffset.x - rect.left, y },\r\n            };\r\n          }\r\n        }\r\n      },\r\n      drop: (item, monitor) => {\r\n        const clientOffset = monitor.getClientOffset();\r\n        if (!clientOffset || !canvasRef.current) {\r\n          toast.error('Không thể xác định vị trí thả. Vui lòng thử lại!');\r\n          return;\r\n        }\r\n\r\n        const rect = canvasRef.current.getBoundingClientRect();\r\n        const position = {\r\n          x: clientOffset.x - rect.left,\r\n          y: clientOffset.y - rect.top,\r\n        };\r\n\r\n        setHistory((prev) => {\r\n          const newHistory = prev.slice(0, historyIndex + 1);\r\n          newHistory.push([...pageStructure]);\r\n          return newHistory;\r\n        });\r\n        setHistoryIndex((prev) => prev + 1);\r\n\r\n        if (item.componentData) {\r\n          const index = calculateDropIndex(position.y);\r\n          addComponent(\r\n            {\r\n              ...item.componentData,\r\n              json: {\r\n                ...item.componentData.json,\r\n                styles: { ...item.componentData.json.styles, position },\r\n              },\r\n            },\r\n            index\r\n          );\r\n        } else {\r\n          const newIndex = calculateDropIndex(position.y);\r\n          moveElement(item.id, newIndex);\r\n          const updatedStructure = [...pageStructure];\r\n          const targetIndex = updatedStructure.findIndex((el) => el.id === item.id);\r\n          if (targetIndex !== -1) {\r\n            updatedStructure[targetIndex] = {\r\n              ...updatedStructure[targetIndex],\r\n              json: {\r\n                ...updatedStructure[targetIndex].json,\r\n                styles: { ...updatedStructure[targetIndex].json.styles, position },\r\n              },\r\n            };\r\n            setPageStructure(updatedStructure);\r\n          }\r\n        }\r\n        setDropIndex(null);\r\n      },\r\n      collect: (monitor) => ({\r\n        isOver: !!monitor.isOver(),\r\n      }),\r\n    }));\r\n\r\n    // Calculate drop index based on y-position\r\n    const calculateDropIndex = useCallback(\r\n      (y) => {\r\n        if (!canvasRef.current) return pageStructure.length;\r\n        const elements = canvasRef.current.querySelectorAll('.canvas-element');\r\n        let index = pageStructure.length;\r\n\r\n        elements.forEach((el, i) => {\r\n          const rect = el.getBoundingClientRect();\r\n          const canvasRect = canvasRef.current.getBoundingClientRect();\r\n          const elTop = rect.top - canvasRect.top;\r\n          const elHeight = rect.height;\r\n\r\n          if (y < elTop + elHeight / 2) {\r\n            index = i;\r\n            return false;\r\n          }\r\n        });\r\n\r\n        return index;\r\n      },\r\n      [pageStructure]\r\n    );\r\n\r\n    // Handle element hover for quick edit\r\n    const handleElementHover = useCallback(\r\n      (e, component) => {\r\n        if (quickEditElement?.id === component.id) return;\r\n\r\n        const rect = e.currentTarget.getBoundingClientRect();\r\n        const canvasRect = canvasRef.current?.getBoundingClientRect() || { left: 0, top: 0 };\r\n        onQuickEdit(component, {\r\n          x: rect.left - canvasRect.left,\r\n          y: rect.top - canvasRect.top + 20,\r\n        });\r\n      },\r\n      [quickEditElement, onQuickEdit]\r\n    );\r\n\r\n    // Keyboard shortcuts\r\n    useHotkeys(\r\n      'delete',\r\n      () => {\r\n        if (selectedElement) {\r\n          setHistory((prev) => {\r\n            const newHistory = prev.slice(0, historyIndex + 1);\r\n            newHistory.push([...pageStructure]);\r\n            return newHistory;\r\n          });\r\n          setHistoryIndex((prev) => prev + 1);\r\n          onDeleteElement(selectedElement);\r\n        }\r\n      },\r\n      [selectedElement, onDeleteElement]\r\n    );\r\n    useHotkeys(\r\n      'up',\r\n      () => {\r\n        if (selectedElement) {\r\n          onMoveElement(selectedElement, 'up');\r\n        }\r\n      },\r\n      [selectedElement, onMoveElement]\r\n    );\r\n    useHotkeys(\r\n      'down',\r\n      () => {\r\n        if (selectedElement) {\r\n          onMoveElement(selectedElement, 'down');\r\n        }\r\n      },\r\n      [selectedElement, onMoveElement]\r\n    );\r\n    useHotkeys(\r\n      'ctrl+z',\r\n      () => {\r\n        if (historyIndex > 0) {\r\n          setHistoryIndex((prev) => prev - 1);\r\n          setPageStructure([...history[historyIndex - 1]]);\r\n          toast.info('Đã hoàn tác!');\r\n        }\r\n      },\r\n      [historyIndex, history, setPageStructure]\r\n    );\r\n    useHotkeys(\r\n      'ctrl+y',\r\n      () => {\r\n        if (historyIndex < history.length - 1) {\r\n          setHistoryIndex((prev) => prev + 1);\r\n          setPageStructure([...history[historyIndex + 1]]);\r\n          toast.info('Đã khôi phục!');\r\n        }\r\n      },\r\n      [historyIndex, history, setPageStructure]\r\n    );\r\n\r\n    return (\r\n      <div className=\"canvas-wrapper\">\r\n        <div\r\n          ref={(node) => {\r\n            canvasRef.current = node;\r\n            drop(node);\r\n          }}\r\n          className={`canvas ${viewMode === 'mobile' ? 'mobile' : viewMode === 'tablet' ? 'tablet' : ''}`}\r\n          onMouseLeave={onCloseQuickEdit}\r\n          style={{ zoom: `${zoomLevel / 100}` }}\r\n        >\r\n          <div className=\"canvas-content\">\r\n            {pageStructure.length === 0 ? (\r\n              <div className=\"empty-state\">\r\n                <i className=\"far fa-mouse-pointer\"></i>\r\n                <p>Kéo thả component để bắt đầu</p>\r\n              </div>\r\n            ) : (\r\n              <>\r\n                {pageStructure.map((component, index) => (\r\n                  <React.Fragment key={component.id || index}>\r\n                    {dropIndex === index && <div className=\"drop-zone\" />}\r\n                    <div className=\"canvas-element-wrapper\">\r\n                      <Element\r\n                        component={component}\r\n                        index={index}\r\n                        isSelected={selectedElement?.id === component.id}\r\n                        hasQuickEdit={quickEditElement?.id === component.id}\r\n                        onSelectElement={onSelectElement}\r\n                        handleElementHover={handleElementHover}\r\n                        onDuplicateElement={onDuplicateElement}\r\n                        onDeleteElement={onDeleteElement}\r\n                        onMoveElement={onMoveElement}\r\n                        updatePosition={updatePosition}\r\n                        canvasRef={canvasRef}\r\n                      />\r\n                    </div>\r\n                  </React.Fragment>\r\n                ))}\r\n                {dropIndex === pageStructure.length && <div className=\"drop-zone\" />}\r\n              </>\r\n            )}\r\n          </div>\r\n\r\n          <QuickEditToolkit\r\n            element={quickEditElement}\r\n            position={quickEditPosition}\r\n            onEdit={() => onSelectElement(quickEditElement)}\r\n            onDuplicate={() => onDuplicateElement(quickEditElement)}\r\n            onDelete={() => onDeleteElement(quickEditElement)}\r\n            onMoveUp={() => onMoveElement(quickEditElement, 'up')}\r\n            onMoveDown={() => onMoveElement(quickEditElement, 'down')}\r\n            onClose={onCloseQuickEdit}\r\n          />\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n);\r\n\r\nexport default Canvas;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}